MODULE YOMOROG

!$ACDC methods 


USE PARKIND1, ONLY : JPIM, JPRB

IMPLICIT NONE

SAVE

!     ------------------------------------------------------------------

!*    Orography: structure TOROG

! OROG       : grid-point surface orography "Phi_s".
! OROGL      : zonal component of "grad Phi_s".
! OROGM      : meridian component of "grad Phi_s".
! OROGLL,OROGMM,OROGLM: second-order reduced derivatives of surface orography.

TYPE TOROG
  REAL(KIND=JPRB), ALLOCATABLE :: OROG(:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGL(:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGM(:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGLL(:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGMM(:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGLM(:)
CONTAINS
PROCEDURE :: COPY => COPY_TOROG
PROCEDURE :: CRC64 => CRC64_TOROG
PROCEDURE :: HOST => HOST_TOROG
PROCEDURE :: LOAD => LOAD_TOROG
PROCEDURE :: SAVE => SAVE_TOROG
PROCEDURE :: SIZE => SIZE_TOROG
PROCEDURE :: WIPE => WIPE_TOROG
END TYPE TOROG

TYPE TOROG_BLOCKED
  REAL(KIND=JPRB), ALLOCATABLE :: OROG(:,:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGL(:,:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGM(:,:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGLL(:,:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGMM(:,:)
  REAL(KIND=JPRB), ALLOCATABLE :: OROGLM(:,:)
CONTAINS
PROCEDURE :: COPY => COPY_TOROG_BLOCKED
PROCEDURE :: CRC64 => CRC64_TOROG_BLOCKED
PROCEDURE :: HOST => HOST_TOROG_BLOCKED
PROCEDURE :: LOAD => LOAD_TOROG_BLOCKED
PROCEDURE :: SAVE => SAVE_TOROG_BLOCKED
PROCEDURE :: SIZE => SIZE_TOROG_BLOCKED
PROCEDURE :: WIPE => WIPE_TOROG_BLOCKED
END TYPE TOROG_BLOCKED

! ------------------------------------------------------------------

INTERFACE

MODULE SUBROUTINE COPY_TOROG (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TOROG), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE CRC64_TOROG (SELF, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
CLASS (TOROG), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE HOST_TOROG (SELF)

IMPLICIT NONE
CLASS (TOROG), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE LOAD_TOROG (SELF, KLUN)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
CLASS (TOROG), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE SAVE_TOROG (SELF, KLUN)

IMPLICIT NONE
CLASS (TOROG), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION SIZE_TOROG (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TOROG),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE WIPE_TOROG (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TOROG), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE COPY_TOROG_BLOCKED (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TOROG_BLOCKED), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE CRC64_TOROG_BLOCKED (SELF, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
CLASS (TOROG_BLOCKED), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE HOST_TOROG_BLOCKED (SELF)

IMPLICIT NONE
CLASS (TOROG_BLOCKED), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE LOAD_TOROG_BLOCKED (SELF, KLUN)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
CLASS (TOROG_BLOCKED), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE SAVE_TOROG_BLOCKED (SELF, KLUN)

IMPLICIT NONE
CLASS (TOROG_BLOCKED), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION SIZE_TOROG_BLOCKED (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TOROG_BLOCKED),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE WIPE_TOROG_BLOCKED (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TOROG_BLOCKED), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

END MODULE YOMOROG
