MODULE YOMCUMFS

!$ACDC methods 

USE PARKIND1, ONLY : JPRB
USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

IMPLICIT NONE

SAVE

!       ----------------------------------------------------------------
!**    ** *YOMCUMFS* CONTAINS VARIABLES FOR SIMPLIFIED CONVECTION SCHEME 
!       ----------------------------------------------------------------

TYPE :: TCUMFS
LOGICAL :: LECUMFS
LOGICAL :: LREGCV
LOGICAL :: LMFCFL2_SHSTEP
!----------------------------------------------------------------------------
CONTAINS
  PROCEDURE, PASS :: PRINT => PRINT_CONFIGURATION 
PROCEDURE :: COPY => COPY_TCUMFS
PROCEDURE :: CRC64 => CRC64_TCUMFS
PROCEDURE :: HOST => HOST_TCUMFS
PROCEDURE :: LOAD => LOAD_TCUMFS
PROCEDURE :: SAVE => SAVE_TCUMFS
PROCEDURE :: SIZE => SIZE_TCUMFS
PROCEDURE :: WIPE => WIPE_TCUMFS
END TYPE TCUMFS
!============================================================================

!!TYPE(TCUMFS), POINTER :: YRCUMFS => NULL()

!*    *YOMCUMFS* CONTAINS VARIABLES FOR SIMPLIFIED CONVECTION SCHEME 

!     P. LOPEZ      E.C.M.W.F.    09/01/2002

!     NAME            TYPE     DESCRIPTION
!     ----            ----     -----------

!***  LECUMFS         LOGICAL  SWITCH ON SIMPLIFIED CONVECTIVE MASS-FLUX SCHEME IN TRAJECTORY
!***  LREGCV          LOGICAL  SWITCH ON REGULARIZATIONS OF SIMPLIFIED CONVECTION SCHEME 
!***                           IN TANGENT-LINEAR AND ADJOINT CALCULATIONS
!***  LMFCFL2_SHSTEP  LOGICAL  SWITCH ON REDUCTION OF MASS FLUX CFL CRITERION FOR SHORT TIME STEPS 

!     ------------------------------------------------------------------
INTERFACE

MODULE SUBROUTINE COPY_TCUMFS (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TCUMFS), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE CRC64_TCUMFS (SELF, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
CLASS (TCUMFS), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE HOST_TCUMFS (SELF)

IMPLICIT NONE
CLASS (TCUMFS), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE LOAD_TCUMFS (SELF, KLUN)

IMPLICIT NONE
CLASS (TCUMFS), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE SAVE_TCUMFS (SELF, KLUN)

IMPLICIT NONE
CLASS (TCUMFS), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION SIZE_TCUMFS (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TCUMFS),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE WIPE_TCUMFS (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TCUMFS), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS

SUBROUTINE PRINT_CONFIGURATION(SELF, KDEPTH, KOUTNO)

  IMPLICIT NONE
  CLASS(TCUMFS), INTENT(IN) :: SELF
  INTEGER      , INTENT(IN) :: KDEPTH
  INTEGER      , INTENT(IN) :: KOUTNO
  
  INTEGER :: IDEPTHLOC
  REAL(KIND=JPHOOK) :: ZHOOK_HANDLE

  IF (LHOOK) CALL DR_HOOK('YOMCUMFS:PRINT_CONFIGURATION',0,ZHOOK_HANDLE)
  IDEPTHLOC = KDEPTH+2

  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LECUMFS = ', SELF%LECUMFS
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LREGCV = ', SELF%LREGCV
  WRITE(KOUTNO,*) REPEAT(' ',IDEPTHLOC) // 'LMFCFL2_SHSTEP = ', SELF%LMFCFL2_SHSTEP
  IF (LHOOK) CALL DR_HOOK('YOMCUMFS:PRINT_CONFIGURATION',1,ZHOOK_HANDLE)
  
END SUBROUTINE PRINT_CONFIGURATION
END MODULE YOMCUMFS
