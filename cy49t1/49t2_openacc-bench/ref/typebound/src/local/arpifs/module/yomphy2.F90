! (C) Copyright 1988- ECMWF.
!
! This software is licensed under the terms of the Apache Licence Version 2.0
! which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.
!
! In applying this licence, ECMWF does not waive the privileges and immunities
! granted to it by virtue of its status as an intergovernmental organisation
! nor does it submit to any jurisdiction.

MODULE YOMPHY2

!$ACDC methods 


USE PARKIND1  ,ONLY : JPIM     ,JPRB

IMPLICIT NONE

SAVE

TYPE TPHY2
!*
!     ------------------------------------------------------------------
!     CONSTANTES DEFINISSANT LE CONTEXTE DE L'EXPERIENCE POUR LA
!     PHYSIQUE : DISCRETISATION TEMPORELLE, STRUCTURE VERTICALE,
!     SORTIES.
!       TSPHY     : PAS DE TEMPS DE LA PHYSIQUE.
!                 : PHYSICS TIME STEP.
!       XMUCVPP   : FACTEUR DE CVPP POUR "ANTI-FIBRIL.". 
!                 : "ANTI-FIBRIL." FACTOR FOR CVPP.
!       XMULAF    : FACTEUR "ANTI-FIBRIL." (1. RECOMMANDE SI ACTIF).
!                 : "ANTI-FIBRIL." FACTOR (1. RECOMMENDED IF ACTIVATED).
!       XDAMP     : DAMPING FACTOR USED IN THE NEW TREATMENT OF
!                   SHALLOW CONVECTION.
!                   IF ZERO => OLD TREATMENT
!                   IF /= 0 => XMUCVPP SHOULD BE ZERO
!       LMULAF    : CONTROL DE l'ANTI-FIBRIL. SUR LA VERTICALE
!                 : CONTROL "ANTI-FIBRIL." ON VERTICAL
!       HCLP      : HAUTEUR MOYENNE DE LA CLP ( EN GENERAL 1500M ).
!                 : MEAN PBL DEPTH ( IN GENERAL 1500M ).
!       HTCLS     : HAUTEUR METEO POUR T ET Q ( EN GENERAL 2M ).
!                 : SCREEN HEIGHT FOR T AND Q ( IN GENERAL 2M ).
!       HVCLS     : HAUTEUR METEO POUR U ET V ( EN GENERAL 10M ).
!                 : MEASURING HEIGHT FOR U AND V (IN GENERAL 10M ).

!       HTSHM     : HAUTEUR DE TRANSITION EN "S" NUAGES HAUTS/MOYENS.
!                 : TRANSITION HEIGHT IN "S" COORDINATE H/M CLOUDS.
!       HTSML     : HAUTEUR DE TRANSITION EN "S" NUAGES MOYENS/BAS.
!                 : TRANSITION HEIGHT IN "S" COORDINATE M/L CLOUDS.
!       LWMOCLOUD : ACTIVATION DU DIAGNOSTIC DE L'HAUTEUR NUAGES SELON L'OMM.
!                 : ACTIVATE CLOUD HEIGHT DIAGNOSTICS ACCORDING TO WMO.
!       HWMOHIGH  : HAUTEUR DE NUAGES HAUTS SELON L'OMM.
!                 : HEIGHT OF HIGH CLOUDS ACCORDING TO WMO.
!       HWMOLOW   : HAUTEUR DE NUAGES BAS SELON L'OMM.
!                 : HEIGHT OF LOW CLOUDS ACCORDING TO WMO.
!       NTSHM     : INDICE DU NIVEAU DE TRANSITION NUAGES HAUTS/MOYENS.
!                 : TRANSITION LEVEL BETWEEN HIGH/MEDIUM CLOUDS.
!       NTSML     : INDICE DU NIVEAU DE TRANSITION NUAGES MOYENS/BAS.
!                 : TRANSITION LEVEL BETWEEN MEDIUM/LOW CLOUDS.
!       LRAFTUR   : ACTIVATION DU DIAGNOSTIC DES RAFALES TURBULENTES
!                   ACTIVATE DIAGNOSTIC OF TURBULENT GUSTS
!       LRAFTKE   : ACTIVATION DU DIAGNOSTIC DES RAFALES TURBULENTES AVEC LA TKE
!                   ACTIVATE DIAGNOSTIC OF TURBULENT GUSTS FROM TKE
!       GZ0RAF    : Z0 FOIS G UTILISE POUR LE CALCUL DES RAFALES TURBULENTES
!                   Z0 TIMES G USED TO COMPUTE TURBULENT GUSTS
!       FACRAF    : COEFFICIENT DE CALCUL DES RAFALES TURBULENTES
!                   COEFFICIENT FOR THE COMPUTATION OF TURBULENT GUSTS
!       FACRAFCV  : COEFFICIENT DE CALCUL DES RAFALES CONVECTIVES (TRANSPORT VERTICAL)
!                   COEFFICIENT FOR THE COMPUTATION OF CONVECTIVE GUSTS (VERTICAL TRANSPORT)
!       FACRAFDCAPE: COEFFICIENT DE CALCUL DES RAFALES CONVECTIVES (GENERATION DE VENT PAR COURANT DE DENSITE)
!                   COEFFICIENT FOR THE COMPUTATION OF CONVECTIVE GUSTS (DENSITY CURRENTS)
!       GCAPERAF  : SEUIL EN CAPE POUR LES RAFALES CONVECTIVES
!                   CAPE THRESHOLD FOR CONVECTIVE GUSTS
!       HTKERAF   : HAUTEUR DE CALCUL DES RAFALES TURBULENTES
!                   HEIGHT FOR THE COMPUTATION OF TURBULENT GUSTS

INTEGER(KIND=JPIM) :: NTSHM
INTEGER(KIND=JPIM) :: NTSML
REAL(KIND=JPRB) :: TSPHY
REAL(KIND=JPRB) :: XMUCVPP
REAL(KIND=JPRB) :: XMULAF
REAL(KIND=JPRB) :: XDAMP
REAL(KIND=JPRB) :: HCLP
REAL(KIND=JPRB) :: HTCLS
REAL(KIND=JPRB) :: HVCLS
REAL(KIND=JPRB) :: HTSHM
REAL(KIND=JPRB) :: HTSML
REAL(KIND=JPRB) :: HWMOHIGH
REAL(KIND=JPRB) :: HWMOLOW
REAL(KIND=JPRB) :: GZ0RAF
REAL(KIND=JPRB) :: FACRAF
REAL(KIND=JPRB) :: FACRAFCV
REAL(KIND=JPRB) :: FACRAFDCAPE
REAL(KIND=JPRB) :: GCAPERAF
REAL(KIND=JPRB) :: HTKERAF
LOGICAL :: LRAFTUR
LOGICAL :: LMULAF
LOGICAL :: LWMOCLOUD
LOGICAL :: LRAFTKE

CONTAINS
PROCEDURE :: COPY => COPY_TPHY2
PROCEDURE :: CRC64 => CRC64_TPHY2
PROCEDURE :: HOST => HOST_TPHY2
PROCEDURE :: LOAD => LOAD_TPHY2
PROCEDURE :: SAVE => SAVE_TPHY2
PROCEDURE :: SIZE => SIZE_TPHY2
PROCEDURE :: WIPE => WIPE_TPHY2
END TYPE TPHY2

TYPE(TPHY2), POINTER :: YRPHY2 => NULL()

!     ------------------------------------------------------------------
INTERFACE

MODULE SUBROUTINE COPY_TPHY2 (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TPHY2), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE CRC64_TPHY2 (SELF, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
CLASS (TPHY2), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
END SUBROUTINE

MODULE SUBROUTINE HOST_TPHY2 (SELF)

IMPLICIT NONE
CLASS (TPHY2), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE LOAD_TPHY2 (SELF, KLUN)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
CLASS (TPHY2), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE SUBROUTINE SAVE_TPHY2 (SELF, KLUN)

IMPLICIT NONE
CLASS (TPHY2), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
END SUBROUTINE

MODULE FUNCTION SIZE_TPHY2 (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
CLASS (TPHY2),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
END FUNCTION

MODULE SUBROUTINE WIPE_TPHY2 (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TPHY2), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

END MODULE YOMPHY2
