SUBMODULE (TYPE_GEOMETRY) TYPE_GEOMETRY_GEOMETRY_SAVE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE SAVE_GEOMETRY (SELF, KLUN)

IMPLICIT NONE
CLASS (GEOMETRY), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LYRELBC_GEO
WRITE (KLUN) SELF%LNHX_GEOM
CALL SELF%YRVERT_GEOM%SAVE (KLUN)
CALL SELF%YRSTA%SAVE (KLUN)
CALL SELF%YRLAP%SAVE (KLUN)
CALL SELF%YRCSGLEG%SAVE (KLUN)
CALL SELF%YRDIM%SAVE (KLUN)
CALL SELF%YRDIMV%SAVE (KLUN)
CALL SELF%YRMP%SAVE (KLUN)
CALL SELF%YRGEM%SAVE (KLUN)
WRITE (KLUN) SELF%AD_GEOM
CALL SELF%YROROG_B%SAVE (KLUN)
CALL SELF%YSPGEOM%SAVE (KLUN)
CALL SELF%YVABIO%SAVE (KLUN)
CALL SELF%YREDIM%SAVE (KLUN)
CALL SELF%YREGEO%SAVE (KLUN)
CALL SELF%YREMP%SAVE (KLUN)
CALL SELF%YRELAP%SAVE (KLUN)
CALL SELF%YREGSL%SAVE (KLUN)
LYRELBC_GEO = ASSOCIATED (SELF%YRELBC_GEO)
WRITE (KLUN) LYRELBC_GEO
IF (LYRELBC_GEO) THEN
  CALL SELF%YRELBC_GEO%SAVE (KLUN)
ENDIF
END SUBROUTINE

END SUBMODULE
