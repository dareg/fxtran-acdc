MODULE UTIL_CPG_OPTS_TYPE_MOD

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE

INTERFACE SAVE
MODULE PROCEDURE SAVE_CPG_OPTS_TYPE
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_CPG_OPTS_TYPE
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_CPG_OPTS_TYPE
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_CPG_OPTS_TYPE
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_CPG_OPTS_TYPE
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_CPG_OPTS_TYPE
END INTERFACE



CONTAINS

SUBROUTINE SAVE_CPG_OPTS_TYPE (KLUN, YD)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (CPG_OPTS_TYPE), INTENT (IN), TARGET :: YD
LOGICAL :: LXPNUDG
WRITE (KLUN) YD%KLON
WRITE (KLUN) YD%KFLEVG
WRITE (KLUN) YD%KGPTOT
WRITE (KLUN) YD%KGPBLKS
WRITE (KLUN) YD%KGPCOMP
WRITE (KLUN) YD%KGPTOTB
WRITE (KLUN) YD%JBLKMIN
WRITE (KLUN) YD%JBLKMAX
WRITE (KLUN) YD%KGL1
WRITE (KLUN) YD%KGL2
WRITE (KLUN) YD%NSTEP
WRITE (KLUN) YD%KTDIA
WRITE (KLUN) YD%KVCLIS
WRITE (KLUN) YD%NDTPREC
WRITE (KLUN) YD%NDTPREC2
WRITE (KLUN) YD%NDTPRECCUR
WRITE (KLUN) YD%NDTPRECCUR2
WRITE (KLUN) YD%KTSSG
WRITE (KLUN) YD%KGRADIENTS
WRITE (KLUN) YD%KMAXDRAFT
WRITE (KLUN) YD%KSW
WRITE (KLUN) YD%NPROC
WRITE (KLUN) YD%NCONF
WRITE (KLUN) YD%N2DINI
CALL SAVE_CPG_OPTS_SURF_TYPE (KLUN, YD%YRSURF_OPTS)
CALL SAVE_CPG_DIMS_SURF_TYPE (KLUN, YD%YRSURF_DIMS)
CALL SAVE_CPG_DIMS_VARS_TYPE (KLUN, YD%YRVARS_DIMS)
WRITE (KLUN) YD%LCONFX
WRITE (KLUN) YD%L_DFISTEP
WRITE (KLUN) YD%LFSTEP
WRITE (KLUN) YD%LDIAB
WRITE (KLUN) YD%LSLPHY
WRITE (KLUN) YD%LUSEPB1
WRITE (KLUN) YD%ZDT
WRITE (KLUN) YD%ZDTPHY
WRITE (KLUN) YD%ZTE
WRITE (KLUN) YD%ZBETADT
CALL SAVE_TCLI (KLUN, YD%YRCLI)
WRITE (KLUN) YD%NSSSSS
WRITE (KLUN) YD%NFNUDG
WRITE (KLUN) YD%NINDAT
WRITE (KLUN) YD%LAROME
WRITE (KLUN) YD%LCALLSFX
WRITE (KLUN) YD%LCORWAT
WRITE (KLUN) YD%LECMWF
WRITE (KLUN) YD%LINITER
WRITE (KLUN) YD%LELAM
WRITE (KLUN) YD%LFLASH
WRITE (KLUN) YD%LWSNOW
WRITE (KLUN) YD%LNUDG
WRITE (KLUN) YD%LRPLANE
WRITE (KLUN) YD%LSFORC
WRITE (KLUN) YD%LSFORCS
WRITE (KLUN) YD%LSOMEGA_FRC
WRITE (KLUN) YD%LSPS_FRC
WRITE (KLUN) YD%LSW_FRC
WRITE (KLUN) YD%LXCLP
WRITE (KLUN) YD%LXCLPMF
WRITE (KLUN) YD%LXVMAXTH
WRITE (KLUN) YD%LXTGST
WRITE (KLUN) YD%LXXGST
WRITE (KLUN) YD%RPLDARE
WRITE (KLUN) YD%RPLRG
WRITE (KLUN) YD%TOPPRES
WRITE (KLUN) YD%RPSTRA
WRITE (KLUN) YD%RPTROP
WRITE (KLUN) YD%RTSUR
LXPNUDG = ALLOCATED (YD%XPNUDG)
WRITE (KLUN) LXPNUDG
IF (LXPNUDG) THEN
  WRITE (KLUN) LBOUND (YD%XPNUDG)
  WRITE (KLUN) UBOUND (YD%XPNUDG)
  WRITE (KLUN) YD%XPNUDG
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_CPG_OPTS_TYPE (KLUN, YD)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (CPG_OPTS_TYPE), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LXPNUDG
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) YD%KLON
READ (KLUN) YD%KFLEVG
READ (KLUN) YD%KGPTOT
READ (KLUN) YD%KGPBLKS
READ (KLUN) YD%KGPCOMP
READ (KLUN) YD%KGPTOTB
READ (KLUN) YD%JBLKMIN
READ (KLUN) YD%JBLKMAX
READ (KLUN) YD%KGL1
READ (KLUN) YD%KGL2
READ (KLUN) YD%NSTEP
READ (KLUN) YD%KTDIA
READ (KLUN) YD%KVCLIS
READ (KLUN) YD%NDTPREC
READ (KLUN) YD%NDTPREC2
READ (KLUN) YD%NDTPRECCUR
READ (KLUN) YD%NDTPRECCUR2
READ (KLUN) YD%KTSSG
READ (KLUN) YD%KGRADIENTS
READ (KLUN) YD%KMAXDRAFT
READ (KLUN) YD%KSW
READ (KLUN) YD%NPROC
READ (KLUN) YD%NCONF
READ (KLUN) YD%N2DINI
CALL LOAD_CPG_OPTS_SURF_TYPE (KLUN, YD%YRSURF_OPTS)
CALL LOAD_CPG_DIMS_SURF_TYPE (KLUN, YD%YRSURF_DIMS)
CALL LOAD_CPG_DIMS_VARS_TYPE (KLUN, YD%YRVARS_DIMS)
READ (KLUN) YD%LCONFX
READ (KLUN) YD%L_DFISTEP
READ (KLUN) YD%LFSTEP
READ (KLUN) YD%LDIAB
READ (KLUN) YD%LSLPHY
READ (KLUN) YD%LUSEPB1
READ (KLUN) ZTMP0
YD%ZDT = ZTMP0
READ (KLUN) ZTMP0
YD%ZDTPHY = ZTMP0
READ (KLUN) ZTMP0
YD%ZTE = ZTMP0
READ (KLUN) ZTMP0
YD%ZBETADT = ZTMP0
CALL LOAD_TCLI (KLUN, YD%YRCLI)
READ (KLUN) YD%NSSSSS
READ (KLUN) YD%NFNUDG
READ (KLUN) YD%NINDAT
READ (KLUN) YD%LAROME
READ (KLUN) YD%LCALLSFX
READ (KLUN) YD%LCORWAT
READ (KLUN) YD%LECMWF
READ (KLUN) YD%LINITER
READ (KLUN) YD%LELAM
READ (KLUN) YD%LFLASH
READ (KLUN) YD%LWSNOW
READ (KLUN) YD%LNUDG
READ (KLUN) YD%LRPLANE
READ (KLUN) YD%LSFORC
READ (KLUN) YD%LSFORCS
READ (KLUN) YD%LSOMEGA_FRC
READ (KLUN) YD%LSPS_FRC
READ (KLUN) YD%LSW_FRC
READ (KLUN) YD%LXCLP
READ (KLUN) YD%LXCLPMF
READ (KLUN) YD%LXVMAXTH
READ (KLUN) YD%LXTGST
READ (KLUN) YD%LXXGST
READ (KLUN) ZTMP0
YD%RPLDARE = ZTMP0
READ (KLUN) ZTMP0
YD%RPLRG = ZTMP0
READ (KLUN) ZTMP0
YD%TOPPRES = ZTMP0
READ (KLUN) ZTMP0
YD%RPSTRA = ZTMP0
READ (KLUN) ZTMP0
YD%RPTROP = ZTMP0
READ (KLUN) ZTMP0
YD%RTSUR = ZTMP0
READ (KLUN) LXPNUDG
IF (LXPNUDG) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%XPNUDG (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%XPNUDG,1):UBOUND(YD%XPNUDG,1)))
  READ (KLUN) ZTMP1
  YD%XPNUDG = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_CPG_OPTS_TYPE (YD, LDCREATED, LDFIELDAPI)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LXPNUDG

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
























CALL COPY_CPG_OPTS_SURF_TYPE (YD%YRSURF_OPTS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_CPG_DIMS_SURF_TYPE (YD%YRSURF_DIMS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_CPG_DIMS_VARS_TYPE (YD%YRVARS_DIMS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)











CALL COPY_TCLI (YD%YRCLI, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)






























LXPNUDG = ALLOCATED (YD%XPNUDG)
IF (LXPNUDG) THEN
  !$ACC ENTER DATA CREATE (YD%XPNUDG)
  !$ACC UPDATE DEVICE (YD%XPNUDG)
  !$ACC ENTER DATA ATTACH (YD%XPNUDG)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_CPG_OPTS_TYPE (YD)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD

IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), TARGET :: YD
LOGICAL :: LXPNUDG
























CALL HOST_CPG_OPTS_SURF_TYPE (YD%YRSURF_OPTS)

CALL HOST_CPG_DIMS_SURF_TYPE (YD%YRSURF_DIMS)

CALL HOST_CPG_DIMS_VARS_TYPE (YD%YRVARS_DIMS)











CALL HOST_TCLI (YD%YRCLI)































END SUBROUTINE

     

SUBROUTINE CRC64_CPG_OPTS_TYPE (YD, KLUN, CDPATH)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LXPNUDG
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KLON), CDPATH//'%KLON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KFLEVG), CDPATH//'%KFLEVG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KGPTOT), CDPATH//'%KGPTOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KGPBLKS), CDPATH//'%KGPBLKS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KGPCOMP), CDPATH//'%KGPCOMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KGPTOTB), CDPATH//'%KGPTOTB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%JBLKMIN), CDPATH//'%JBLKMIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%JBLKMAX), CDPATH//'%JBLKMAX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KGL1), CDPATH//'%KGL1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KGL2), CDPATH//'%KGL2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSTEP), CDPATH//'%NSTEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KTDIA), CDPATH//'%KTDIA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KVCLIS), CDPATH//'%KVCLIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDTPREC), CDPATH//'%NDTPREC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDTPREC2), CDPATH//'%NDTPREC2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDTPRECCUR), CDPATH//'%NDTPRECCUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDTPRECCUR2), CDPATH//'%NDTPRECCUR2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KTSSG), CDPATH//'%KTSSG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KGRADIENTS), CDPATH//'%KGRADIENTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KMAXDRAFT), CDPATH//'%KMAXDRAFT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KSW), CDPATH//'%KSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPROC), CDPATH//'%NPROC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCONF), CDPATH//'%NCONF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%N2DINI), CDPATH//'%N2DINI'

CLIND = ''
CALL CRC64_CPG_OPTS_SURF_TYPE (YD%YRSURF_OPTS, KLUN, CDPATH//'%YRSURF_OPTS'//TRIM(CLIND))

CLIND = ''
CALL CRC64_CPG_DIMS_SURF_TYPE (YD%YRSURF_DIMS, KLUN, CDPATH//'%YRSURF_DIMS'//TRIM(CLIND))

CLIND = ''
CALL CRC64_CPG_DIMS_VARS_TYPE (YD%YRVARS_DIMS, KLUN, CDPATH//'%YRVARS_DIMS'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCONFX), CDPATH//'%LCONFX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%L_DFISTEP), CDPATH//'%L_DFISTEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LFSTEP), CDPATH//'%LFSTEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LDIAB), CDPATH//'%LDIAB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSLPHY), CDPATH//'%LSLPHY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LUSEPB1), CDPATH//'%LUSEPB1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZDT), CDPATH//'%ZDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZDTPHY), CDPATH//'%ZDTPHY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZTE), CDPATH//'%ZTE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZBETADT), CDPATH//'%ZBETADT'

CLIND = ''
CALL CRC64_TCLI (YD%YRCLI, KLUN, CDPATH//'%YRCLI'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSSSSS), CDPATH//'%NSSSSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NFNUDG), CDPATH//'%NFNUDG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NINDAT), CDPATH//'%NINDAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAROME), CDPATH//'%LAROME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCALLSFX), CDPATH//'%LCALLSFX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCORWAT), CDPATH//'%LCORWAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LECMWF), CDPATH//'%LECMWF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LINITER), CDPATH//'%LINITER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LELAM), CDPATH//'%LELAM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LFLASH), CDPATH//'%LFLASH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWSNOW), CDPATH//'%LWSNOW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNUDG), CDPATH//'%LNUDG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRPLANE), CDPATH//'%LRPLANE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSFORC), CDPATH//'%LSFORC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSFORCS), CDPATH//'%LSFORCS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSOMEGA_FRC), CDPATH//'%LSOMEGA_FRC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPS_FRC), CDPATH//'%LSPS_FRC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSW_FRC), CDPATH//'%LSW_FRC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LXCLP), CDPATH//'%LXCLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LXCLPMF), CDPATH//'%LXCLPMF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LXVMAXTH), CDPATH//'%LXVMAXTH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LXTGST), CDPATH//'%LXTGST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LXXGST), CDPATH//'%LXXGST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RPLDARE), CDPATH//'%RPLDARE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RPLRG), CDPATH//'%RPLRG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TOPPRES), CDPATH//'%TOPPRES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RPSTRA), CDPATH//'%RPSTRA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RPTROP), CDPATH//'%RPTROP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RTSUR), CDPATH//'%RTSUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XPNUDG), CDPATH//'%XPNUDG'

END SUBROUTINE

SUBROUTINE WIPE_CPG_OPTS_TYPE (YD, LDDELETED, LDFIELDAPI)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LXPNUDG

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
























CALL WIPE_CPG_OPTS_SURF_TYPE (YD%YRSURF_OPTS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_CPG_DIMS_SURF_TYPE (YD%YRSURF_DIMS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_CPG_DIMS_VARS_TYPE (YD%YRVARS_DIMS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)











CALL WIPE_TCLI (YD%YRCLI, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)






























LXPNUDG = ALLOCATED (YD%XPNUDG)
IF (LXPNUDG) THEN
  !$ACC EXIT DATA DETACH (YD%XPNUDG)
  !$ACC EXIT DATA DETACH (YD%XPNUDG)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE



END MODULE
