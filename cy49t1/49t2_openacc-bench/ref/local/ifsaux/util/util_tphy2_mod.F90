MODULE UTIL_TPHY2_MOD

USE YOMPHY2, ONLY : TPHY2

INTERFACE SAVE
MODULE PROCEDURE SAVE_TPHY2
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TPHY2
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TPHY2
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TPHY2
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TPHY2
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TPHY2
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TPHY2
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TPHY2 (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TPHY2), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%NTSHM
WRITE (KLUN) YD%NTSML
WRITE (KLUN) YD%TSPHY
WRITE (KLUN) YD%XMUCVPP
WRITE (KLUN) YD%XMULAF
WRITE (KLUN) YD%XDAMP
WRITE (KLUN) YD%HCLP
WRITE (KLUN) YD%HTCLS
WRITE (KLUN) YD%HVCLS
WRITE (KLUN) YD%HTSHM
WRITE (KLUN) YD%HTSML
WRITE (KLUN) YD%HWMOHIGH
WRITE (KLUN) YD%HWMOLOW
WRITE (KLUN) YD%GZ0RAF
WRITE (KLUN) YD%FACRAF
WRITE (KLUN) YD%FACRAFCV
WRITE (KLUN) YD%FACRAFDCAPE
WRITE (KLUN) YD%GCAPERAF
WRITE (KLUN) YD%HTKERAF
WRITE (KLUN) YD%LRAFTUR
WRITE (KLUN) YD%LMULAF
WRITE (KLUN) YD%LWMOCLOUD
WRITE (KLUN) YD%LRAFTKE
END SUBROUTINE

SUBROUTINE LOAD_TPHY2 (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TPHY2), INTENT (OUT), TARGET :: YD
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) YD%NTSHM
READ (KLUN) YD%NTSML
READ (KLUN) ZTMP0
YD%TSPHY = ZTMP0
READ (KLUN) ZTMP0
YD%XMUCVPP = ZTMP0
READ (KLUN) ZTMP0
YD%XMULAF = ZTMP0
READ (KLUN) ZTMP0
YD%XDAMP = ZTMP0
READ (KLUN) ZTMP0
YD%HCLP = ZTMP0
READ (KLUN) ZTMP0
YD%HTCLS = ZTMP0
READ (KLUN) ZTMP0
YD%HVCLS = ZTMP0
READ (KLUN) ZTMP0
YD%HTSHM = ZTMP0
READ (KLUN) ZTMP0
YD%HTSML = ZTMP0
READ (KLUN) ZTMP0
YD%HWMOHIGH = ZTMP0
READ (KLUN) ZTMP0
YD%HWMOLOW = ZTMP0
READ (KLUN) ZTMP0
YD%GZ0RAF = ZTMP0
READ (KLUN) ZTMP0
YD%FACRAF = ZTMP0
READ (KLUN) ZTMP0
YD%FACRAFCV = ZTMP0
READ (KLUN) ZTMP0
YD%FACRAFDCAPE = ZTMP0
READ (KLUN) ZTMP0
YD%GCAPERAF = ZTMP0
READ (KLUN) ZTMP0
YD%HTKERAF = ZTMP0
READ (KLUN) YD%LRAFTUR
READ (KLUN) YD%LMULAF
READ (KLUN) YD%LWMOCLOUD
READ (KLUN) YD%LRAFTKE
END SUBROUTINE


SUBROUTINE COPY_TPHY2 (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TPHY2), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF























END SUBROUTINE

SUBROUTINE HOST_TPHY2 (YD)

IMPLICIT NONE
TYPE (TPHY2), TARGET :: YD
























END SUBROUTINE

     

SUBROUTINE CRC64_TPHY2 (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TPHY2), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTSHM), CDPATH//'%NTSHM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTSML), CDPATH//'%NTSML'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TSPHY), CDPATH//'%TSPHY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XMUCVPP), CDPATH//'%XMUCVPP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XMULAF), CDPATH//'%XMULAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDAMP), CDPATH//'%XDAMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%HCLP), CDPATH//'%HCLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%HTCLS), CDPATH//'%HTCLS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%HVCLS), CDPATH//'%HVCLS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%HTSHM), CDPATH//'%HTSHM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%HTSML), CDPATH//'%HTSML'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%HWMOHIGH), CDPATH//'%HWMOHIGH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%HWMOLOW), CDPATH//'%HWMOLOW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GZ0RAF), CDPATH//'%GZ0RAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%FACRAF), CDPATH//'%FACRAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%FACRAFCV), CDPATH//'%FACRAFCV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%FACRAFDCAPE), CDPATH//'%FACRAFDCAPE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GCAPERAF), CDPATH//'%GCAPERAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%HTKERAF), CDPATH//'%HTKERAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRAFTUR), CDPATH//'%LRAFTUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMULAF), CDPATH//'%LMULAF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWMOCLOUD), CDPATH//'%LWMOCLOUD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRAFTKE), CDPATH//'%LRAFTKE'

END SUBROUTINE

SUBROUTINE WIPE_TPHY2 (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TPHY2), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF























LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TPHY2 (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TPHY2),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%NTSHM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTSHM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTSML)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTSML'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TSPHY)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TSPHY'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XMUCVPP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XMUCVPP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XMULAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XMULAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDAMP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDAMP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%HCLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HCLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%HTCLS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HTCLS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%HVCLS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HVCLS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%HTSHM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HTSHM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%HTSML)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HTSML'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%HWMOHIGH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HWMOHIGH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%HWMOLOW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HWMOLOW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%GZ0RAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%GZ0RAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%FACRAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%FACRAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%FACRAFCV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%FACRAFCV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%FACRAFDCAPE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%FACRAFDCAPE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%GCAPERAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%GCAPERAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%HTKERAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%HTKERAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LRAFTUR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRAFTUR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMULAF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMULAF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWMOCLOUD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWMOCLOUD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LRAFTKE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRAFTKE'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
