MODULE UTIL_TYPE_AERO_DESC_MOD

USE YOEAERATM, ONLY : TYPE_AERO_DESC

INTERFACE SAVE
MODULE PROCEDURE SAVE_TYPE_AERO_DESC
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TYPE_AERO_DESC
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TYPE_AERO_DESC
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TYPE_AERO_DESC
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TYPE_AERO_DESC
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TYPE_AERO_DESC
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TYPE_AERO_DESC
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TYPE_AERO_DESC (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TYPE_AERO_DESC), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%CNAME
WRITE (KLUN) YD%IGRBCODE
WRITE (KLUN) YD%NTYP
WRITE (KLUN) YD%NBIN
WRITE (KLUN) YD%IGRIBDIAG
WRITE (KLUN) YD%RDDEPVSEA
WRITE (KLUN) YD%RDDEPVLIC
WRITE (KLUN) YD%RSEDIMV
WRITE (KLUN) YD%RSCAVIN
WRITE (KLUN) YD%RSCAVBCR
WRITE (KLUN) YD%RSCAVBCS
WRITE (KLUN) YD%COPTCLASS
WRITE (KLUN) YD%CHYGCLASS
WRITE (KLUN) YD%IAEROCV
END SUBROUTINE

SUBROUTINE LOAD_TYPE_AERO_DESC (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TYPE_AERO_DESC), INTENT (OUT), TARGET :: YD
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) YD%CNAME
READ (KLUN) YD%IGRBCODE
READ (KLUN) YD%NTYP
READ (KLUN) YD%NBIN
READ (KLUN) YD%IGRIBDIAG
READ (KLUN) ZTMP0
YD%RDDEPVSEA = ZTMP0
READ (KLUN) ZTMP0
YD%RDDEPVLIC = ZTMP0
READ (KLUN) ZTMP0
YD%RSEDIMV = ZTMP0
READ (KLUN) ZTMP0
YD%RSCAVIN = ZTMP0
READ (KLUN) ZTMP0
YD%RSCAVBCR = ZTMP0
READ (KLUN) ZTMP0
YD%RSCAVBCS = ZTMP0
READ (KLUN) YD%COPTCLASS
READ (KLUN) YD%CHYGCLASS
READ (KLUN) YD%IAEROCV
END SUBROUTINE


SUBROUTINE COPY_TYPE_AERO_DESC (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TYPE_AERO_DESC), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF














END SUBROUTINE

SUBROUTINE HOST_TYPE_AERO_DESC (YD)

IMPLICIT NONE
TYPE (TYPE_AERO_DESC), TARGET :: YD















END SUBROUTINE

     

SUBROUTINE CRC64_TYPE_AERO_DESC (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TYPE_AERO_DESC), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CNAME), CDPATH//'%CNAME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IGRBCODE), CDPATH//'%IGRBCODE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTYP), CDPATH//'%NTYP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NBIN), CDPATH//'%NBIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IGRIBDIAG), CDPATH//'%IGRIBDIAG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDDEPVSEA), CDPATH//'%RDDEPVSEA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDDEPVLIC), CDPATH//'%RDDEPVLIC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSEDIMV), CDPATH//'%RSEDIMV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSCAVIN), CDPATH//'%RSCAVIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSCAVBCR), CDPATH//'%RSCAVBCR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSCAVBCS), CDPATH//'%RSCAVBCS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%COPTCLASS), CDPATH//'%COPTCLASS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CHYGCLASS), CDPATH//'%CHYGCLASS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IAEROCV), CDPATH//'%IAEROCV'

END SUBROUTINE

SUBROUTINE WIPE_TYPE_AERO_DESC (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TYPE_AERO_DESC), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF














LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TYPE_AERO_DESC (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TYPE_AERO_DESC),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%CNAME) * LEN (YD%CNAME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CNAME'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IGRBCODE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IGRBCODE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTYP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTYP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NBIN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NBIN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IGRIBDIAG) * SIZE (YD%IGRIBDIAG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IGRIBDIAG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDDEPVSEA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDDEPVSEA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDDEPVLIC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDDEPVLIC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSEDIMV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSEDIMV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSCAVIN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSCAVIN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSCAVBCR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSCAVBCR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSCAVBCS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSCAVBCS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%COPTCLASS) * LEN (YD%COPTCLASS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%COPTCLASS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CHYGCLASS) * LEN (YD%CHYGCLASS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHYGCLASS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IAEROCV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IAEROCV'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
