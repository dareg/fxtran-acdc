MODULE UTIL_TVDOZ_MOD

USE YOMVDOZ, ONLY : TVDOZ

INTERFACE SAVE
MODULE PROCEDURE SAVE_TVDOZ
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TVDOZ
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TVDOZ
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TVDOZ
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TVDOZ
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TVDOZ
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TVDOZ
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TVDOZ (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TVDOZ), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%VDHJS
WRITE (KLUN) YD%VDHJH
WRITE (KLUN) YD%VDHNS
WRITE (KLUN) YD%VDHNH
WRITE (KLUN) YD%VDPJS
WRITE (KLUN) YD%VDPJH
WRITE (KLUN) YD%VDPNS
WRITE (KLUN) YD%VDPNH
WRITE (KLUN) YD%VDEJS
WRITE (KLUN) YD%VDEJH
WRITE (KLUN) YD%VDENS
WRITE (KLUN) YD%VDENH
WRITE (KLUN) YD%VDAJS
WRITE (KLUN) YD%VDAJH
WRITE (KLUN) YD%VDANS
WRITE (KLUN) YD%VDANH
WRITE (KLUN) YD%VDNJS
WRITE (KLUN) YD%VDNJH
WRITE (KLUN) YD%VDNNS
WRITE (KLUN) YD%VDNNH
WRITE (KLUN) YD%VOZNJ
WRITE (KLUN) YD%VOZHS
WRITE (KLUN) YD%LRDIFOZ
WRITE (KLUN) YD%LRDEPOZ
END SUBROUTINE

SUBROUTINE LOAD_TVDOZ (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TVDOZ), INTENT (OUT), TARGET :: YD
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
ALLOCATE (ZTMP1(LBOUND(YD%VDHJS,1):UBOUND(YD%VDHJS,1)))
READ (KLUN) ZTMP1
YD%VDHJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDHJH,1):UBOUND(YD%VDHJH,1)))
READ (KLUN) ZTMP1
YD%VDHJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDHNS,1):UBOUND(YD%VDHNS,1)))
READ (KLUN) ZTMP1
YD%VDHNS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDHNH,1):UBOUND(YD%VDHNH,1)))
READ (KLUN) ZTMP1
YD%VDHNH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDPJS,1):UBOUND(YD%VDPJS,1)))
READ (KLUN) ZTMP1
YD%VDPJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDPJH,1):UBOUND(YD%VDPJH,1)))
READ (KLUN) ZTMP1
YD%VDPJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDPNS,1):UBOUND(YD%VDPNS,1)))
READ (KLUN) ZTMP1
YD%VDPNS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDPNH,1):UBOUND(YD%VDPNH,1)))
READ (KLUN) ZTMP1
YD%VDPNH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDEJS,1):UBOUND(YD%VDEJS,1)))
READ (KLUN) ZTMP1
YD%VDEJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDEJH,1):UBOUND(YD%VDEJH,1)))
READ (KLUN) ZTMP1
YD%VDEJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDENS,1):UBOUND(YD%VDENS,1)))
READ (KLUN) ZTMP1
YD%VDENS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDENH,1):UBOUND(YD%VDENH,1)))
READ (KLUN) ZTMP1
YD%VDENH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDAJS,1):UBOUND(YD%VDAJS,1)))
READ (KLUN) ZTMP1
YD%VDAJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDAJH,1):UBOUND(YD%VDAJH,1)))
READ (KLUN) ZTMP1
YD%VDAJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDANS,1):UBOUND(YD%VDANS,1)))
READ (KLUN) ZTMP1
YD%VDANS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDANH,1):UBOUND(YD%VDANH,1)))
READ (KLUN) ZTMP1
YD%VDANH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDNJS,1):UBOUND(YD%VDNJS,1)))
READ (KLUN) ZTMP1
YD%VDNJS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDNJH,1):UBOUND(YD%VDNJH,1)))
READ (KLUN) ZTMP1
YD%VDNJH = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDNNS,1):UBOUND(YD%VDNNS,1)))
READ (KLUN) ZTMP1
YD%VDNNS = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%VDNNH,1):UBOUND(YD%VDNNH,1)))
READ (KLUN) ZTMP1
YD%VDNNH = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) ZTMP0
YD%VOZNJ = ZTMP0
READ (KLUN) ZTMP0
YD%VOZHS = ZTMP0
READ (KLUN) YD%LRDIFOZ
READ (KLUN) YD%LRDEPOZ
END SUBROUTINE


SUBROUTINE COPY_TVDOZ (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TVDOZ), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
























END SUBROUTINE

SUBROUTINE HOST_TVDOZ (YD)

IMPLICIT NONE
TYPE (TVDOZ), TARGET :: YD

























END SUBROUTINE

     

SUBROUTINE CRC64_TVDOZ (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TVDOZ), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDHJS), CDPATH//'%VDHJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDHJH), CDPATH//'%VDHJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDHNS), CDPATH//'%VDHNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDHNH), CDPATH//'%VDHNH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDPJS), CDPATH//'%VDPJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDPJH), CDPATH//'%VDPJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDPNS), CDPATH//'%VDPNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDPNH), CDPATH//'%VDPNH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDEJS), CDPATH//'%VDEJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDEJH), CDPATH//'%VDEJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDENS), CDPATH//'%VDENS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDENH), CDPATH//'%VDENH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDAJS), CDPATH//'%VDAJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDAJH), CDPATH//'%VDAJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDANS), CDPATH//'%VDANS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDANH), CDPATH//'%VDANH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDNJS), CDPATH//'%VDNJS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDNJH), CDPATH//'%VDNJH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDNNS), CDPATH//'%VDNNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VDNNH), CDPATH//'%VDNNH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VOZNJ), CDPATH//'%VOZNJ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VOZHS), CDPATH//'%VOZHS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRDIFOZ), CDPATH//'%LRDIFOZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRDEPOZ), CDPATH//'%LRDEPOZ'

END SUBROUTINE

SUBROUTINE WIPE_TVDOZ (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TVDOZ), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
























LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TVDOZ (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TVDOZ),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%VDHJS) * SIZE (YD%VDHJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDHJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDHJH) * SIZE (YD%VDHJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDHJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDHNS) * SIZE (YD%VDHNS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDHNS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDHNH) * SIZE (YD%VDHNH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDHNH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDPJS) * SIZE (YD%VDPJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDPJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDPJH) * SIZE (YD%VDPJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDPJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDPNS) * SIZE (YD%VDPNS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDPNS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDPNH) * SIZE (YD%VDPNH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDPNH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDEJS) * SIZE (YD%VDEJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDEJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDEJH) * SIZE (YD%VDEJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDEJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDENS) * SIZE (YD%VDENS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDENS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDENH) * SIZE (YD%VDENH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDENH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDAJS) * SIZE (YD%VDAJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDAJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDAJH) * SIZE (YD%VDAJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDAJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDANS) * SIZE (YD%VDANS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDANS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDANH) * SIZE (YD%VDANH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDANH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDNJS) * SIZE (YD%VDNJS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDNJS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDNJH) * SIZE (YD%VDNJH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDNJH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDNNS) * SIZE (YD%VDNNS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDNNS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VDNNH) * SIZE (YD%VDNNH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VDNNH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VOZNJ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VOZNJ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VOZHS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VOZHS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LRDIFOZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRDIFOZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LRDEPOZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRDEPOZ'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
