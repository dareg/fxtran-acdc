MODULE UTIL_TYPE_SFL_VARSF_MOD

USE SURFACE_FIELDS_MIX, ONLY : TYPE_SFL_VARSF

INTERFACE SAVE
MODULE PROCEDURE SAVE_TYPE_SFL_VARSF
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TYPE_SFL_VARSF
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TYPE_SFL_VARSF
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TYPE_SFL_VARSF
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TYPE_SFL_VARSF
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TYPE_SFL_VARSF
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TYPE_SFL_VARSF (KLUN, YD)
USE UTIL_TYPE_SURF_MTL_2D_MOD
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TYPE_SFL_VARSF), INTENT (IN), TARGET :: YD
INTEGER :: J1
LOGICAL :: LYAERDEP, LYAERLTS, LYAERSCC, LYALBF, LYALBSF, LYALNID, LYALNIG, LYALNII, LYALNIP, LYALNIV
LOGICAL :: LYALUVD, LYALUVG, LYALUVI, LYALUVP, LYALUVV, LYCGPP, LYCHEMDDFLX, LYCHEMDV, LYCHEMFLXO, LYCHEMWDFLX
LOGICAL :: LYCI, LYCLK, LYCO2TYP, LYCREC, LYCUR, LYCVH, LYCVL, LYDL, LYDMSO, LYDSF
LOGICAL :: LYDSZ, LYEMIS2D, LYEMIS2DAUX, LYEMISF, LYFCA1, LYFCA2, LYFP1, LYFWET, LYGETRL, LYLAIH
LOGICAL :: LYLAIL, LYLAN, LYLSM, LYLZ0H, LYNUDM, LYSDFOR, LYSIG, LYSO2DD, LYSOTY, LYSSS
LOGICAL :: LYSST, LYTVH, LYTVL, LYUCUR, LYURBF, LYVCUR, LYVEG, LYVF, LYVRLAN, LYVRLDI
LOGICAL :: LYZ0F, LYZ0RLF
LYZ0F = ASSOCIATED (YD%YZ0F)
WRITE (KLUN) LYZ0F
IF (LYZ0F) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YZ0F)
ENDIF
LYALBF = ASSOCIATED (YD%YALBF)
WRITE (KLUN) LYALBF
IF (LYALBF) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALBF)
ENDIF
LYEMISF = ASSOCIATED (YD%YEMISF)
WRITE (KLUN) LYEMISF
IF (LYEMISF) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YEMISF)
ENDIF
LYGETRL = ASSOCIATED (YD%YGETRL)
WRITE (KLUN) LYGETRL
IF (LYGETRL) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YGETRL)
ENDIF
LYLSM = ASSOCIATED (YD%YLSM)
WRITE (KLUN) LYLSM
IF (LYLSM) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YLSM)
ENDIF
LYVEG = ASSOCIATED (YD%YVEG)
WRITE (KLUN) LYVEG
IF (LYVEG) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YVEG)
ENDIF
LYVRLAN = ASSOCIATED (YD%YVRLAN)
WRITE (KLUN) LYVRLAN
IF (LYVRLAN) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YVRLAN)
ENDIF
LYVRLDI = ASSOCIATED (YD%YVRLDI)
WRITE (KLUN) LYVRLDI
IF (LYVRLDI) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YVRLDI)
ENDIF
LYSIG = ASSOCIATED (YD%YSIG)
WRITE (KLUN) LYSIG
IF (LYSIG) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YSIG)
ENDIF
LYALBSF = ASSOCIATED (YD%YALBSF)
WRITE (KLUN) LYALBSF
IF (LYALBSF) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALBSF)
ENDIF
LYLAN = ASSOCIATED (YD%YLAN)
WRITE (KLUN) LYLAN
IF (LYLAN) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YLAN)
ENDIF
LYSST = ASSOCIATED (YD%YSST)
WRITE (KLUN) LYSST
IF (LYSST) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YSST)
ENDIF
LYSSS = ASSOCIATED (YD%YSSS)
WRITE (KLUN) LYSSS
IF (LYSSS) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YSSS)
ENDIF
LYLZ0H = ASSOCIATED (YD%YLZ0H)
WRITE (KLUN) LYLZ0H
IF (LYLZ0H) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YLZ0H)
ENDIF
LYCVL = ASSOCIATED (YD%YCVL)
WRITE (KLUN) LYCVL
IF (LYCVL) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCVL)
ENDIF
LYCO2TYP = ASSOCIATED (YD%YCO2TYP)
WRITE (KLUN) LYCO2TYP
IF (LYCO2TYP) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCO2TYP)
ENDIF
LYCVH = ASSOCIATED (YD%YCVH)
WRITE (KLUN) LYCVH
IF (LYCVH) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCVH)
ENDIF
LYCUR = ASSOCIATED (YD%YCUR)
WRITE (KLUN) LYCUR
IF (LYCUR) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCUR)
ENDIF
LYTVL = ASSOCIATED (YD%YTVL)
WRITE (KLUN) LYTVL
IF (LYTVL) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YTVL)
ENDIF
LYTVH = ASSOCIATED (YD%YTVH)
WRITE (KLUN) LYTVH
IF (LYTVH) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YTVH)
ENDIF
LYFWET = ASSOCIATED (YD%YFWET)
WRITE (KLUN) LYFWET
IF (LYFWET) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YFWET)
ENDIF
LYLAIL = ASSOCIATED (YD%YLAIL)
WRITE (KLUN) LYLAIL
IF (LYLAIL) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YLAIL)
ENDIF
LYLAIH = ASSOCIATED (YD%YLAIH)
WRITE (KLUN) LYLAIH
IF (LYLAIH) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YLAIH)
ENDIF
LYSOTY = ASSOCIATED (YD%YSOTY)
WRITE (KLUN) LYSOTY
IF (LYSOTY) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YSOTY)
ENDIF
LYCLK = ASSOCIATED (YD%YCLK)
WRITE (KLUN) LYCLK
IF (LYCLK) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCLK)
ENDIF
LYDL = ASSOCIATED (YD%YDL)
WRITE (KLUN) LYDL
IF (LYDL) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YDL)
ENDIF
LYCI = ASSOCIATED (YD%YCI)
WRITE (KLUN) LYCI
IF (LYCI) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCI)
ENDIF
LYUCUR = ASSOCIATED (YD%YUCUR)
WRITE (KLUN) LYUCUR
IF (LYUCUR) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YUCUR)
ENDIF
LYVCUR = ASSOCIATED (YD%YVCUR)
WRITE (KLUN) LYVCUR
IF (LYVCUR) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YVCUR)
ENDIF
LYZ0RLF = ASSOCIATED (YD%YZ0RLF)
WRITE (KLUN) LYZ0RLF
IF (LYZ0RLF) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YZ0RLF)
ENDIF
LYCGPP = ASSOCIATED (YD%YCGPP)
WRITE (KLUN) LYCGPP
IF (LYCGPP) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCGPP)
ENDIF
LYCREC = ASSOCIATED (YD%YCREC)
WRITE (KLUN) LYCREC
IF (LYCREC) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCREC)
ENDIF
LYSDFOR = ASSOCIATED (YD%YSDFOR)
WRITE (KLUN) LYSDFOR
IF (LYSDFOR) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YSDFOR)
ENDIF
LYALUVP = ASSOCIATED (YD%YALUVP)
WRITE (KLUN) LYALUVP
IF (LYALUVP) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALUVP)
ENDIF
LYALUVD = ASSOCIATED (YD%YALUVD)
WRITE (KLUN) LYALUVD
IF (LYALUVD) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALUVD)
ENDIF
LYALNIP = ASSOCIATED (YD%YALNIP)
WRITE (KLUN) LYALNIP
IF (LYALNIP) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALNIP)
ENDIF
LYALNID = ASSOCIATED (YD%YALNID)
WRITE (KLUN) LYALNID
IF (LYALNID) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALNID)
ENDIF
LYALUVI = ASSOCIATED (YD%YALUVI)
WRITE (KLUN) LYALUVI
IF (LYALUVI) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALUVI)
ENDIF
LYALNII = ASSOCIATED (YD%YALNII)
WRITE (KLUN) LYALNII
IF (LYALNII) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALNII)
ENDIF
LYALUVV = ASSOCIATED (YD%YALUVV)
WRITE (KLUN) LYALUVV
IF (LYALUVV) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALUVV)
ENDIF
LYALNIV = ASSOCIATED (YD%YALNIV)
WRITE (KLUN) LYALNIV
IF (LYALNIV) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALNIV)
ENDIF
LYALUVG = ASSOCIATED (YD%YALUVG)
WRITE (KLUN) LYALUVG
IF (LYALUVG) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALUVG)
ENDIF
LYALNIG = ASSOCIATED (YD%YALNIG)
WRITE (KLUN) LYALNIG
IF (LYALNIG) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YALNIG)
ENDIF
WRITE (KLUN) YD%IALSTART
WRITE (KLUN) YD%IALEND
LYFP1 = ASSOCIATED (YD%YFP1)
WRITE (KLUN) LYFP1
IF (LYFP1) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YFP1)
ENDIF
LYSO2DD = ASSOCIATED (YD%YSO2DD)
WRITE (KLUN) LYSO2DD
IF (LYSO2DD) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YSO2DD)
ENDIF
LYDMSO = ASSOCIATED (YD%YDMSO)
WRITE (KLUN) LYDMSO
IF (LYDMSO) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YDMSO)
ENDIF
LYURBF = ASSOCIATED (YD%YURBF)
WRITE (KLUN) LYURBF
IF (LYURBF) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YURBF)
ENDIF
LYFCA1 = ASSOCIATED (YD%YFCA1)
WRITE (KLUN) LYFCA1
IF (LYFCA1) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YFCA1)
ENDIF
LYFCA2 = ASSOCIATED (YD%YFCA2)
WRITE (KLUN) LYFCA2
IF (LYFCA2) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YFCA2)
ENDIF
LYAERDEP = ASSOCIATED (YD%YAERDEP)
WRITE (KLUN) LYAERDEP
IF (LYAERDEP) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YAERDEP)
ENDIF
LYAERLTS = ASSOCIATED (YD%YAERLTS)
WRITE (KLUN) LYAERLTS
IF (LYAERLTS) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YAERLTS)
ENDIF
LYAERSCC = ASSOCIATED (YD%YAERSCC)
WRITE (KLUN) LYAERSCC
IF (LYAERSCC) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YAERSCC)
ENDIF
LYDSF = ASSOCIATED (YD%YDSF)
WRITE (KLUN) LYDSF
IF (LYDSF) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YDSF)
ENDIF
LYDSZ = ASSOCIATED (YD%YDSZ)
WRITE (KLUN) LYDSZ
IF (LYDSZ) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YDSZ)
ENDIF
LYCHEMFLXO = ASSOCIATED (YD%YCHEMFLXO)
WRITE (KLUN) LYCHEMFLXO
IF (LYCHEMFLXO) THEN
  WRITE (KLUN) LBOUND (YD%YCHEMFLXO)
  WRITE (KLUN) UBOUND (YD%YCHEMFLXO)
  DO J1 = LBOUND (YD%YCHEMFLXO, 1), UBOUND (YD%YCHEMFLXO, 1)
    CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCHEMFLXO (J1))
  ENDDO
ENDIF
LYCHEMWDFLX = ASSOCIATED (YD%YCHEMWDFLX)
WRITE (KLUN) LYCHEMWDFLX
IF (LYCHEMWDFLX) THEN
  WRITE (KLUN) LBOUND (YD%YCHEMWDFLX)
  WRITE (KLUN) UBOUND (YD%YCHEMWDFLX)
  DO J1 = LBOUND (YD%YCHEMWDFLX, 1), UBOUND (YD%YCHEMWDFLX, 1)
    CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCHEMWDFLX (J1))
  ENDDO
ENDIF
LYCHEMDDFLX = ASSOCIATED (YD%YCHEMDDFLX)
WRITE (KLUN) LYCHEMDDFLX
IF (LYCHEMDDFLX) THEN
  WRITE (KLUN) LBOUND (YD%YCHEMDDFLX)
  WRITE (KLUN) UBOUND (YD%YCHEMDDFLX)
  DO J1 = LBOUND (YD%YCHEMDDFLX, 1), UBOUND (YD%YCHEMDDFLX, 1)
    CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCHEMDDFLX (J1))
  ENDDO
ENDIF
LYCHEMDV = ASSOCIATED (YD%YCHEMDV)
WRITE (KLUN) LYCHEMDV
IF (LYCHEMDV) THEN
  WRITE (KLUN) LBOUND (YD%YCHEMDV)
  WRITE (KLUN) UBOUND (YD%YCHEMDV)
  DO J1 = LBOUND (YD%YCHEMDV, 1), UBOUND (YD%YCHEMDV, 1)
    CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YCHEMDV (J1))
  ENDDO
ENDIF
LYEMIS2D = ASSOCIATED (YD%YEMIS2D)
WRITE (KLUN) LYEMIS2D
IF (LYEMIS2D) THEN
  WRITE (KLUN) LBOUND (YD%YEMIS2D)
  WRITE (KLUN) UBOUND (YD%YEMIS2D)
  DO J1 = LBOUND (YD%YEMIS2D, 1), UBOUND (YD%YEMIS2D, 1)
    CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YEMIS2D (J1))
  ENDDO
ENDIF
LYEMIS2DAUX = ASSOCIATED (YD%YEMIS2DAUX)
WRITE (KLUN) LYEMIS2DAUX
IF (LYEMIS2DAUX) THEN
  WRITE (KLUN) LBOUND (YD%YEMIS2DAUX)
  WRITE (KLUN) UBOUND (YD%YEMIS2DAUX)
  DO J1 = LBOUND (YD%YEMIS2DAUX, 1), UBOUND (YD%YEMIS2DAUX, 1)
    CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YEMIS2DAUX (J1))
  ENDDO
ENDIF
LYNUDM = ASSOCIATED (YD%YNUDM)
WRITE (KLUN) LYNUDM
IF (LYNUDM) THEN
  CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YNUDM)
ENDIF
LYVF = ASSOCIATED (YD%YVF)
WRITE (KLUN) LYVF
IF (LYVF) THEN
  WRITE (KLUN) LBOUND (YD%YVF)
  WRITE (KLUN) UBOUND (YD%YVF)
  DO J1 = LBOUND (YD%YVF, 1), UBOUND (YD%YVF, 1)
    CALL SAVE_TYPE_SURF_MTL_2D (KLUN, YD%YVF (J1))
  ENDDO
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_TYPE_SFL_VARSF (KLUN, YD)
USE UTIL_TYPE_SURF_MTL_2D_MOD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TYPE_SFL_VARSF), INTENT (OUT), TARGET :: YD
INTEGER :: J1
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LYAERDEP, LYAERLTS, LYAERSCC, LYALBF, LYALBSF, LYALNID, LYALNIG, LYALNII, LYALNIP, LYALNIV
LOGICAL :: LYALUVD, LYALUVG, LYALUVI, LYALUVP, LYALUVV, LYCGPP, LYCHEMDDFLX, LYCHEMDV, LYCHEMFLXO, LYCHEMWDFLX
LOGICAL :: LYCI, LYCLK, LYCO2TYP, LYCREC, LYCUR, LYCVH, LYCVL, LYDL, LYDMSO, LYDSF
LOGICAL :: LYDSZ, LYEMIS2D, LYEMIS2DAUX, LYEMISF, LYFCA1, LYFCA2, LYFP1, LYFWET, LYGETRL, LYLAIH
LOGICAL :: LYLAIL, LYLAN, LYLSM, LYLZ0H, LYNUDM, LYSDFOR, LYSIG, LYSO2DD, LYSOTY, LYSSS
LOGICAL :: LYSST, LYTVH, LYTVL, LYUCUR, LYURBF, LYVCUR, LYVEG, LYVF, LYVRLAN, LYVRLDI
LOGICAL :: LYZ0F, LYZ0RLF
READ (KLUN) LYZ0F
IF (LYZ0F) THEN
  ALLOCATE (YD%YZ0F)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YZ0F)
ELSE
  NULLIFY (YD%YZ0F)
ENDIF
READ (KLUN) LYALBF
IF (LYALBF) THEN
  ALLOCATE (YD%YALBF)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALBF)
ELSE
  NULLIFY (YD%YALBF)
ENDIF
READ (KLUN) LYEMISF
IF (LYEMISF) THEN
  ALLOCATE (YD%YEMISF)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YEMISF)
ELSE
  NULLIFY (YD%YEMISF)
ENDIF
READ (KLUN) LYGETRL
IF (LYGETRL) THEN
  ALLOCATE (YD%YGETRL)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YGETRL)
ELSE
  NULLIFY (YD%YGETRL)
ENDIF
READ (KLUN) LYLSM
IF (LYLSM) THEN
  ALLOCATE (YD%YLSM)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YLSM)
ELSE
  NULLIFY (YD%YLSM)
ENDIF
READ (KLUN) LYVEG
IF (LYVEG) THEN
  ALLOCATE (YD%YVEG)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YVEG)
ELSE
  NULLIFY (YD%YVEG)
ENDIF
READ (KLUN) LYVRLAN
IF (LYVRLAN) THEN
  ALLOCATE (YD%YVRLAN)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YVRLAN)
ELSE
  NULLIFY (YD%YVRLAN)
ENDIF
READ (KLUN) LYVRLDI
IF (LYVRLDI) THEN
  ALLOCATE (YD%YVRLDI)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YVRLDI)
ELSE
  NULLIFY (YD%YVRLDI)
ENDIF
READ (KLUN) LYSIG
IF (LYSIG) THEN
  ALLOCATE (YD%YSIG)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YSIG)
ELSE
  NULLIFY (YD%YSIG)
ENDIF
READ (KLUN) LYALBSF
IF (LYALBSF) THEN
  ALLOCATE (YD%YALBSF)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALBSF)
ELSE
  NULLIFY (YD%YALBSF)
ENDIF
READ (KLUN) LYLAN
IF (LYLAN) THEN
  ALLOCATE (YD%YLAN)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YLAN)
ELSE
  NULLIFY (YD%YLAN)
ENDIF
READ (KLUN) LYSST
IF (LYSST) THEN
  ALLOCATE (YD%YSST)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YSST)
ELSE
  NULLIFY (YD%YSST)
ENDIF
READ (KLUN) LYSSS
IF (LYSSS) THEN
  ALLOCATE (YD%YSSS)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YSSS)
ELSE
  NULLIFY (YD%YSSS)
ENDIF
READ (KLUN) LYLZ0H
IF (LYLZ0H) THEN
  ALLOCATE (YD%YLZ0H)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YLZ0H)
ELSE
  NULLIFY (YD%YLZ0H)
ENDIF
READ (KLUN) LYCVL
IF (LYCVL) THEN
  ALLOCATE (YD%YCVL)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCVL)
ELSE
  NULLIFY (YD%YCVL)
ENDIF
READ (KLUN) LYCO2TYP
IF (LYCO2TYP) THEN
  ALLOCATE (YD%YCO2TYP)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCO2TYP)
ELSE
  NULLIFY (YD%YCO2TYP)
ENDIF
READ (KLUN) LYCVH
IF (LYCVH) THEN
  ALLOCATE (YD%YCVH)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCVH)
ELSE
  NULLIFY (YD%YCVH)
ENDIF
READ (KLUN) LYCUR
IF (LYCUR) THEN
  ALLOCATE (YD%YCUR)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCUR)
ELSE
  NULLIFY (YD%YCUR)
ENDIF
READ (KLUN) LYTVL
IF (LYTVL) THEN
  ALLOCATE (YD%YTVL)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YTVL)
ELSE
  NULLIFY (YD%YTVL)
ENDIF
READ (KLUN) LYTVH
IF (LYTVH) THEN
  ALLOCATE (YD%YTVH)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YTVH)
ELSE
  NULLIFY (YD%YTVH)
ENDIF
READ (KLUN) LYFWET
IF (LYFWET) THEN
  ALLOCATE (YD%YFWET)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YFWET)
ELSE
  NULLIFY (YD%YFWET)
ENDIF
READ (KLUN) LYLAIL
IF (LYLAIL) THEN
  ALLOCATE (YD%YLAIL)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YLAIL)
ELSE
  NULLIFY (YD%YLAIL)
ENDIF
READ (KLUN) LYLAIH
IF (LYLAIH) THEN
  ALLOCATE (YD%YLAIH)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YLAIH)
ELSE
  NULLIFY (YD%YLAIH)
ENDIF
READ (KLUN) LYSOTY
IF (LYSOTY) THEN
  ALLOCATE (YD%YSOTY)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YSOTY)
ELSE
  NULLIFY (YD%YSOTY)
ENDIF
READ (KLUN) LYCLK
IF (LYCLK) THEN
  ALLOCATE (YD%YCLK)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCLK)
ELSE
  NULLIFY (YD%YCLK)
ENDIF
READ (KLUN) LYDL
IF (LYDL) THEN
  ALLOCATE (YD%YDL)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YDL)
ELSE
  NULLIFY (YD%YDL)
ENDIF
READ (KLUN) LYCI
IF (LYCI) THEN
  ALLOCATE (YD%YCI)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCI)
ELSE
  NULLIFY (YD%YCI)
ENDIF
READ (KLUN) LYUCUR
IF (LYUCUR) THEN
  ALLOCATE (YD%YUCUR)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YUCUR)
ELSE
  NULLIFY (YD%YUCUR)
ENDIF
READ (KLUN) LYVCUR
IF (LYVCUR) THEN
  ALLOCATE (YD%YVCUR)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YVCUR)
ELSE
  NULLIFY (YD%YVCUR)
ENDIF
READ (KLUN) LYZ0RLF
IF (LYZ0RLF) THEN
  ALLOCATE (YD%YZ0RLF)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YZ0RLF)
ELSE
  NULLIFY (YD%YZ0RLF)
ENDIF
READ (KLUN) LYCGPP
IF (LYCGPP) THEN
  ALLOCATE (YD%YCGPP)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCGPP)
ELSE
  NULLIFY (YD%YCGPP)
ENDIF
READ (KLUN) LYCREC
IF (LYCREC) THEN
  ALLOCATE (YD%YCREC)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCREC)
ELSE
  NULLIFY (YD%YCREC)
ENDIF
READ (KLUN) LYSDFOR
IF (LYSDFOR) THEN
  ALLOCATE (YD%YSDFOR)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YSDFOR)
ELSE
  NULLIFY (YD%YSDFOR)
ENDIF
READ (KLUN) LYALUVP
IF (LYALUVP) THEN
  ALLOCATE (YD%YALUVP)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALUVP)
ELSE
  NULLIFY (YD%YALUVP)
ENDIF
READ (KLUN) LYALUVD
IF (LYALUVD) THEN
  ALLOCATE (YD%YALUVD)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALUVD)
ELSE
  NULLIFY (YD%YALUVD)
ENDIF
READ (KLUN) LYALNIP
IF (LYALNIP) THEN
  ALLOCATE (YD%YALNIP)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALNIP)
ELSE
  NULLIFY (YD%YALNIP)
ENDIF
READ (KLUN) LYALNID
IF (LYALNID) THEN
  ALLOCATE (YD%YALNID)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALNID)
ELSE
  NULLIFY (YD%YALNID)
ENDIF
READ (KLUN) LYALUVI
IF (LYALUVI) THEN
  ALLOCATE (YD%YALUVI)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALUVI)
ELSE
  NULLIFY (YD%YALUVI)
ENDIF
READ (KLUN) LYALNII
IF (LYALNII) THEN
  ALLOCATE (YD%YALNII)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALNII)
ELSE
  NULLIFY (YD%YALNII)
ENDIF
READ (KLUN) LYALUVV
IF (LYALUVV) THEN
  ALLOCATE (YD%YALUVV)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALUVV)
ELSE
  NULLIFY (YD%YALUVV)
ENDIF
READ (KLUN) LYALNIV
IF (LYALNIV) THEN
  ALLOCATE (YD%YALNIV)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALNIV)
ELSE
  NULLIFY (YD%YALNIV)
ENDIF
READ (KLUN) LYALUVG
IF (LYALUVG) THEN
  ALLOCATE (YD%YALUVG)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALUVG)
ELSE
  NULLIFY (YD%YALUVG)
ENDIF
READ (KLUN) LYALNIG
IF (LYALNIG) THEN
  ALLOCATE (YD%YALNIG)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YALNIG)
ELSE
  NULLIFY (YD%YALNIG)
ENDIF
READ (KLUN) YD%IALSTART
READ (KLUN) YD%IALEND
READ (KLUN) LYFP1
IF (LYFP1) THEN
  ALLOCATE (YD%YFP1)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YFP1)
ELSE
  NULLIFY (YD%YFP1)
ENDIF
READ (KLUN) LYSO2DD
IF (LYSO2DD) THEN
  ALLOCATE (YD%YSO2DD)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YSO2DD)
ELSE
  NULLIFY (YD%YSO2DD)
ENDIF
READ (KLUN) LYDMSO
IF (LYDMSO) THEN
  ALLOCATE (YD%YDMSO)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YDMSO)
ELSE
  NULLIFY (YD%YDMSO)
ENDIF
READ (KLUN) LYURBF
IF (LYURBF) THEN
  ALLOCATE (YD%YURBF)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YURBF)
ELSE
  NULLIFY (YD%YURBF)
ENDIF
READ (KLUN) LYFCA1
IF (LYFCA1) THEN
  ALLOCATE (YD%YFCA1)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YFCA1)
ELSE
  NULLIFY (YD%YFCA1)
ENDIF
READ (KLUN) LYFCA2
IF (LYFCA2) THEN
  ALLOCATE (YD%YFCA2)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YFCA2)
ELSE
  NULLIFY (YD%YFCA2)
ENDIF
READ (KLUN) LYAERDEP
IF (LYAERDEP) THEN
  ALLOCATE (YD%YAERDEP)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YAERDEP)
ELSE
  NULLIFY (YD%YAERDEP)
ENDIF
READ (KLUN) LYAERLTS
IF (LYAERLTS) THEN
  ALLOCATE (YD%YAERLTS)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YAERLTS)
ELSE
  NULLIFY (YD%YAERLTS)
ENDIF
READ (KLUN) LYAERSCC
IF (LYAERSCC) THEN
  ALLOCATE (YD%YAERSCC)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YAERSCC)
ELSE
  NULLIFY (YD%YAERSCC)
ENDIF
READ (KLUN) LYDSF
IF (LYDSF) THEN
  ALLOCATE (YD%YDSF)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YDSF)
ELSE
  NULLIFY (YD%YDSF)
ENDIF
READ (KLUN) LYDSZ
IF (LYDSZ) THEN
  ALLOCATE (YD%YDSZ)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YDSZ)
ELSE
  NULLIFY (YD%YDSZ)
ENDIF
READ (KLUN) LYCHEMFLXO
IF (LYCHEMFLXO) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%YCHEMFLXO (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%YCHEMFLXO, 1), UBOUND (YD%YCHEMFLXO, 1)
    CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCHEMFLXO (J1))
  ENDDO
ELSE
  NULLIFY (YD%YCHEMFLXO)
ENDIF
READ (KLUN) LYCHEMWDFLX
IF (LYCHEMWDFLX) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%YCHEMWDFLX (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%YCHEMWDFLX, 1), UBOUND (YD%YCHEMWDFLX, 1)
    CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCHEMWDFLX (J1))
  ENDDO
ELSE
  NULLIFY (YD%YCHEMWDFLX)
ENDIF
READ (KLUN) LYCHEMDDFLX
IF (LYCHEMDDFLX) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%YCHEMDDFLX (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%YCHEMDDFLX, 1), UBOUND (YD%YCHEMDDFLX, 1)
    CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCHEMDDFLX (J1))
  ENDDO
ELSE
  NULLIFY (YD%YCHEMDDFLX)
ENDIF
READ (KLUN) LYCHEMDV
IF (LYCHEMDV) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%YCHEMDV (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%YCHEMDV, 1), UBOUND (YD%YCHEMDV, 1)
    CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YCHEMDV (J1))
  ENDDO
ELSE
  NULLIFY (YD%YCHEMDV)
ENDIF
READ (KLUN) LYEMIS2D
IF (LYEMIS2D) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%YEMIS2D (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%YEMIS2D, 1), UBOUND (YD%YEMIS2D, 1)
    CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YEMIS2D (J1))
  ENDDO
ELSE
  NULLIFY (YD%YEMIS2D)
ENDIF
READ (KLUN) LYEMIS2DAUX
IF (LYEMIS2DAUX) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%YEMIS2DAUX (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%YEMIS2DAUX, 1), UBOUND (YD%YEMIS2DAUX, 1)
    CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YEMIS2DAUX (J1))
  ENDDO
ELSE
  NULLIFY (YD%YEMIS2DAUX)
ENDIF
READ (KLUN) LYNUDM
IF (LYNUDM) THEN
  ALLOCATE (YD%YNUDM)
  CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YNUDM)
ELSE
  NULLIFY (YD%YNUDM)
ENDIF
READ (KLUN) LYVF
IF (LYVF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%YVF (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%YVF, 1), UBOUND (YD%YVF, 1)
    CALL LOAD_TYPE_SURF_MTL_2D (KLUN, YD%YVF (J1))
  ENDDO
ELSE
  NULLIFY (YD%YVF)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_TYPE_SFL_VARSF (YD, LDCREATED, LDFIELDAPI)
USE UTIL_TYPE_SURF_MTL_2D_MOD
IMPLICIT NONE
TYPE (TYPE_SFL_VARSF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LYAERDEP, LYAERLTS, LYAERSCC, LYALBF, LYALBSF, LYALNID, LYALNIG, LYALNII, LYALNIP, LYALNIV
LOGICAL :: LYALUVD, LYALUVG, LYALUVI, LYALUVP, LYALUVV, LYCGPP, LYCHEMDDFLX, LYCHEMDV, LYCHEMFLXO, LYCHEMWDFLX
LOGICAL :: LYCI, LYCLK, LYCO2TYP, LYCREC, LYCUR, LYCVH, LYCVL, LYDL, LYDMSO, LYDSF
LOGICAL :: LYDSZ, LYEMIS2D, LYEMIS2DAUX, LYEMISF, LYFCA1, LYFCA2, LYFP1, LYFWET, LYGETRL, LYLAIH
LOGICAL :: LYLAIL, LYLAN, LYLSM, LYLZ0H, LYNUDM, LYSDFOR, LYSIG, LYSO2DD, LYSOTY, LYSSS
LOGICAL :: LYSST, LYTVH, LYTVL, LYUCUR, LYURBF, LYVCUR, LYVEG, LYVF, LYVRLAN, LYVRLDI
LOGICAL :: LYZ0F, LYZ0RLF

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
LYZ0F = ASSOCIATED (YD%YZ0F)
IF (LYZ0F) THEN
  !$ACC ENTER DATA CREATE (YD%YZ0F)
  !$ACC UPDATE DEVICE (YD%YZ0F)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YZ0F, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YZ0F)
ENDIF

LYALBF = ASSOCIATED (YD%YALBF)
IF (LYALBF) THEN
  !$ACC ENTER DATA CREATE (YD%YALBF)
  !$ACC UPDATE DEVICE (YD%YALBF)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALBF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALBF)
ENDIF

LYEMISF = ASSOCIATED (YD%YEMISF)
IF (LYEMISF) THEN
  !$ACC ENTER DATA CREATE (YD%YEMISF)
  !$ACC UPDATE DEVICE (YD%YEMISF)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YEMISF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YEMISF)
ENDIF

LYGETRL = ASSOCIATED (YD%YGETRL)
IF (LYGETRL) THEN
  !$ACC ENTER DATA CREATE (YD%YGETRL)
  !$ACC UPDATE DEVICE (YD%YGETRL)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YGETRL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YGETRL)
ENDIF

LYLSM = ASSOCIATED (YD%YLSM)
IF (LYLSM) THEN
  !$ACC ENTER DATA CREATE (YD%YLSM)
  !$ACC UPDATE DEVICE (YD%YLSM)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YLSM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YLSM)
ENDIF

LYVEG = ASSOCIATED (YD%YVEG)
IF (LYVEG) THEN
  !$ACC ENTER DATA CREATE (YD%YVEG)
  !$ACC UPDATE DEVICE (YD%YVEG)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YVEG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YVEG)
ENDIF

LYVRLAN = ASSOCIATED (YD%YVRLAN)
IF (LYVRLAN) THEN
  !$ACC ENTER DATA CREATE (YD%YVRLAN)
  !$ACC UPDATE DEVICE (YD%YVRLAN)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YVRLAN, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YVRLAN)
ENDIF

LYVRLDI = ASSOCIATED (YD%YVRLDI)
IF (LYVRLDI) THEN
  !$ACC ENTER DATA CREATE (YD%YVRLDI)
  !$ACC UPDATE DEVICE (YD%YVRLDI)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YVRLDI, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YVRLDI)
ENDIF

LYSIG = ASSOCIATED (YD%YSIG)
IF (LYSIG) THEN
  !$ACC ENTER DATA CREATE (YD%YSIG)
  !$ACC UPDATE DEVICE (YD%YSIG)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YSIG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YSIG)
ENDIF

LYALBSF = ASSOCIATED (YD%YALBSF)
IF (LYALBSF) THEN
  !$ACC ENTER DATA CREATE (YD%YALBSF)
  !$ACC UPDATE DEVICE (YD%YALBSF)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALBSF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALBSF)
ENDIF

LYLAN = ASSOCIATED (YD%YLAN)
IF (LYLAN) THEN
  !$ACC ENTER DATA CREATE (YD%YLAN)
  !$ACC UPDATE DEVICE (YD%YLAN)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YLAN, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YLAN)
ENDIF

LYSST = ASSOCIATED (YD%YSST)
IF (LYSST) THEN
  !$ACC ENTER DATA CREATE (YD%YSST)
  !$ACC UPDATE DEVICE (YD%YSST)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YSST, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YSST)
ENDIF

LYSSS = ASSOCIATED (YD%YSSS)
IF (LYSSS) THEN
  !$ACC ENTER DATA CREATE (YD%YSSS)
  !$ACC UPDATE DEVICE (YD%YSSS)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YSSS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YSSS)
ENDIF

LYLZ0H = ASSOCIATED (YD%YLZ0H)
IF (LYLZ0H) THEN
  !$ACC ENTER DATA CREATE (YD%YLZ0H)
  !$ACC UPDATE DEVICE (YD%YLZ0H)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YLZ0H, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YLZ0H)
ENDIF

LYCVL = ASSOCIATED (YD%YCVL)
IF (LYCVL) THEN
  !$ACC ENTER DATA CREATE (YD%YCVL)
  !$ACC UPDATE DEVICE (YD%YCVL)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YCVL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YCVL)
ENDIF

LYCO2TYP = ASSOCIATED (YD%YCO2TYP)
IF (LYCO2TYP) THEN
  !$ACC ENTER DATA CREATE (YD%YCO2TYP)
  !$ACC UPDATE DEVICE (YD%YCO2TYP)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YCO2TYP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YCO2TYP)
ENDIF

LYCVH = ASSOCIATED (YD%YCVH)
IF (LYCVH) THEN
  !$ACC ENTER DATA CREATE (YD%YCVH)
  !$ACC UPDATE DEVICE (YD%YCVH)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YCVH, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YCVH)
ENDIF

LYCUR = ASSOCIATED (YD%YCUR)
IF (LYCUR) THEN
  !$ACC ENTER DATA CREATE (YD%YCUR)
  !$ACC UPDATE DEVICE (YD%YCUR)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YCUR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YCUR)
ENDIF

LYTVL = ASSOCIATED (YD%YTVL)
IF (LYTVL) THEN
  !$ACC ENTER DATA CREATE (YD%YTVL)
  !$ACC UPDATE DEVICE (YD%YTVL)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YTVL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YTVL)
ENDIF

LYTVH = ASSOCIATED (YD%YTVH)
IF (LYTVH) THEN
  !$ACC ENTER DATA CREATE (YD%YTVH)
  !$ACC UPDATE DEVICE (YD%YTVH)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YTVH, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YTVH)
ENDIF

LYFWET = ASSOCIATED (YD%YFWET)
IF (LYFWET) THEN
  !$ACC ENTER DATA CREATE (YD%YFWET)
  !$ACC UPDATE DEVICE (YD%YFWET)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YFWET, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YFWET)
ENDIF

LYLAIL = ASSOCIATED (YD%YLAIL)
IF (LYLAIL) THEN
  !$ACC ENTER DATA CREATE (YD%YLAIL)
  !$ACC UPDATE DEVICE (YD%YLAIL)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YLAIL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YLAIL)
ENDIF

LYLAIH = ASSOCIATED (YD%YLAIH)
IF (LYLAIH) THEN
  !$ACC ENTER DATA CREATE (YD%YLAIH)
  !$ACC UPDATE DEVICE (YD%YLAIH)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YLAIH, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YLAIH)
ENDIF

LYSOTY = ASSOCIATED (YD%YSOTY)
IF (LYSOTY) THEN
  !$ACC ENTER DATA CREATE (YD%YSOTY)
  !$ACC UPDATE DEVICE (YD%YSOTY)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YSOTY, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YSOTY)
ENDIF

LYCLK = ASSOCIATED (YD%YCLK)
IF (LYCLK) THEN
  !$ACC ENTER DATA CREATE (YD%YCLK)
  !$ACC UPDATE DEVICE (YD%YCLK)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YCLK, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YCLK)
ENDIF

LYDL = ASSOCIATED (YD%YDL)
IF (LYDL) THEN
  !$ACC ENTER DATA CREATE (YD%YDL)
  !$ACC UPDATE DEVICE (YD%YDL)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YDL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YDL)
ENDIF

LYCI = ASSOCIATED (YD%YCI)
IF (LYCI) THEN
  !$ACC ENTER DATA CREATE (YD%YCI)
  !$ACC UPDATE DEVICE (YD%YCI)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YCI, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YCI)
ENDIF

LYUCUR = ASSOCIATED (YD%YUCUR)
IF (LYUCUR) THEN
  !$ACC ENTER DATA CREATE (YD%YUCUR)
  !$ACC UPDATE DEVICE (YD%YUCUR)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YUCUR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YUCUR)
ENDIF

LYVCUR = ASSOCIATED (YD%YVCUR)
IF (LYVCUR) THEN
  !$ACC ENTER DATA CREATE (YD%YVCUR)
  !$ACC UPDATE DEVICE (YD%YVCUR)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YVCUR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YVCUR)
ENDIF

LYZ0RLF = ASSOCIATED (YD%YZ0RLF)
IF (LYZ0RLF) THEN
  !$ACC ENTER DATA CREATE (YD%YZ0RLF)
  !$ACC UPDATE DEVICE (YD%YZ0RLF)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YZ0RLF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YZ0RLF)
ENDIF

LYCGPP = ASSOCIATED (YD%YCGPP)
IF (LYCGPP) THEN
  !$ACC ENTER DATA CREATE (YD%YCGPP)
  !$ACC UPDATE DEVICE (YD%YCGPP)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YCGPP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YCGPP)
ENDIF

LYCREC = ASSOCIATED (YD%YCREC)
IF (LYCREC) THEN
  !$ACC ENTER DATA CREATE (YD%YCREC)
  !$ACC UPDATE DEVICE (YD%YCREC)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YCREC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YCREC)
ENDIF

LYSDFOR = ASSOCIATED (YD%YSDFOR)
IF (LYSDFOR) THEN
  !$ACC ENTER DATA CREATE (YD%YSDFOR)
  !$ACC UPDATE DEVICE (YD%YSDFOR)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YSDFOR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YSDFOR)
ENDIF

LYALUVP = ASSOCIATED (YD%YALUVP)
IF (LYALUVP) THEN
  !$ACC ENTER DATA CREATE (YD%YALUVP)
  !$ACC UPDATE DEVICE (YD%YALUVP)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALUVP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALUVP)
ENDIF

LYALUVD = ASSOCIATED (YD%YALUVD)
IF (LYALUVD) THEN
  !$ACC ENTER DATA CREATE (YD%YALUVD)
  !$ACC UPDATE DEVICE (YD%YALUVD)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALUVD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALUVD)
ENDIF

LYALNIP = ASSOCIATED (YD%YALNIP)
IF (LYALNIP) THEN
  !$ACC ENTER DATA CREATE (YD%YALNIP)
  !$ACC UPDATE DEVICE (YD%YALNIP)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALNIP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALNIP)
ENDIF

LYALNID = ASSOCIATED (YD%YALNID)
IF (LYALNID) THEN
  !$ACC ENTER DATA CREATE (YD%YALNID)
  !$ACC UPDATE DEVICE (YD%YALNID)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALNID, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALNID)
ENDIF

LYALUVI = ASSOCIATED (YD%YALUVI)
IF (LYALUVI) THEN
  !$ACC ENTER DATA CREATE (YD%YALUVI)
  !$ACC UPDATE DEVICE (YD%YALUVI)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALUVI, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALUVI)
ENDIF

LYALNII = ASSOCIATED (YD%YALNII)
IF (LYALNII) THEN
  !$ACC ENTER DATA CREATE (YD%YALNII)
  !$ACC UPDATE DEVICE (YD%YALNII)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALNII, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALNII)
ENDIF

LYALUVV = ASSOCIATED (YD%YALUVV)
IF (LYALUVV) THEN
  !$ACC ENTER DATA CREATE (YD%YALUVV)
  !$ACC UPDATE DEVICE (YD%YALUVV)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALUVV, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALUVV)
ENDIF

LYALNIV = ASSOCIATED (YD%YALNIV)
IF (LYALNIV) THEN
  !$ACC ENTER DATA CREATE (YD%YALNIV)
  !$ACC UPDATE DEVICE (YD%YALNIV)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALNIV, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALNIV)
ENDIF

LYALUVG = ASSOCIATED (YD%YALUVG)
IF (LYALUVG) THEN
  !$ACC ENTER DATA CREATE (YD%YALUVG)
  !$ACC UPDATE DEVICE (YD%YALUVG)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALUVG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALUVG)
ENDIF

LYALNIG = ASSOCIATED (YD%YALNIG)
IF (LYALNIG) THEN
  !$ACC ENTER DATA CREATE (YD%YALNIG)
  !$ACC UPDATE DEVICE (YD%YALNIG)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YALNIG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YALNIG)
ENDIF



LYFP1 = ASSOCIATED (YD%YFP1)
IF (LYFP1) THEN
  !$ACC ENTER DATA CREATE (YD%YFP1)
  !$ACC UPDATE DEVICE (YD%YFP1)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YFP1, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YFP1)
ENDIF

LYSO2DD = ASSOCIATED (YD%YSO2DD)
IF (LYSO2DD) THEN
  !$ACC ENTER DATA CREATE (YD%YSO2DD)
  !$ACC UPDATE DEVICE (YD%YSO2DD)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YSO2DD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YSO2DD)
ENDIF

LYDMSO = ASSOCIATED (YD%YDMSO)
IF (LYDMSO) THEN
  !$ACC ENTER DATA CREATE (YD%YDMSO)
  !$ACC UPDATE DEVICE (YD%YDMSO)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YDMSO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YDMSO)
ENDIF

LYURBF = ASSOCIATED (YD%YURBF)
IF (LYURBF) THEN
  !$ACC ENTER DATA CREATE (YD%YURBF)
  !$ACC UPDATE DEVICE (YD%YURBF)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YURBF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YURBF)
ENDIF

LYFCA1 = ASSOCIATED (YD%YFCA1)
IF (LYFCA1) THEN
  !$ACC ENTER DATA CREATE (YD%YFCA1)
  !$ACC UPDATE DEVICE (YD%YFCA1)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YFCA1, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YFCA1)
ENDIF

LYFCA2 = ASSOCIATED (YD%YFCA2)
IF (LYFCA2) THEN
  !$ACC ENTER DATA CREATE (YD%YFCA2)
  !$ACC UPDATE DEVICE (YD%YFCA2)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YFCA2, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YFCA2)
ENDIF

LYAERDEP = ASSOCIATED (YD%YAERDEP)
IF (LYAERDEP) THEN
  !$ACC ENTER DATA CREATE (YD%YAERDEP)
  !$ACC UPDATE DEVICE (YD%YAERDEP)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YAERDEP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YAERDEP)
ENDIF

LYAERLTS = ASSOCIATED (YD%YAERLTS)
IF (LYAERLTS) THEN
  !$ACC ENTER DATA CREATE (YD%YAERLTS)
  !$ACC UPDATE DEVICE (YD%YAERLTS)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YAERLTS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YAERLTS)
ENDIF

LYAERSCC = ASSOCIATED (YD%YAERSCC)
IF (LYAERSCC) THEN
  !$ACC ENTER DATA CREATE (YD%YAERSCC)
  !$ACC UPDATE DEVICE (YD%YAERSCC)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YAERSCC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YAERSCC)
ENDIF

LYDSF = ASSOCIATED (YD%YDSF)
IF (LYDSF) THEN
  !$ACC ENTER DATA CREATE (YD%YDSF)
  !$ACC UPDATE DEVICE (YD%YDSF)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YDSF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YDSF)
ENDIF

LYDSZ = ASSOCIATED (YD%YDSZ)
IF (LYDSZ) THEN
  !$ACC ENTER DATA CREATE (YD%YDSZ)
  !$ACC UPDATE DEVICE (YD%YDSZ)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YDSZ, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YDSZ)
ENDIF

LYCHEMFLXO = ASSOCIATED (YD%YCHEMFLXO)
IF (LYCHEMFLXO) THEN
  !$ACC ENTER DATA CREATE (YD%YCHEMFLXO)
  !$ACC UPDATE DEVICE (YD%YCHEMFLXO)
  DO J1 = LBOUND (YD%YCHEMFLXO, 1), UBOUND (YD%YCHEMFLXO, 1)
    CALL COPY_TYPE_SURF_MTL_2D (YD%YCHEMFLXO (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%YCHEMFLXO)
ENDIF

LYCHEMWDFLX = ASSOCIATED (YD%YCHEMWDFLX)
IF (LYCHEMWDFLX) THEN
  !$ACC ENTER DATA CREATE (YD%YCHEMWDFLX)
  !$ACC UPDATE DEVICE (YD%YCHEMWDFLX)
  DO J1 = LBOUND (YD%YCHEMWDFLX, 1), UBOUND (YD%YCHEMWDFLX, 1)
    CALL COPY_TYPE_SURF_MTL_2D (YD%YCHEMWDFLX (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%YCHEMWDFLX)
ENDIF

LYCHEMDDFLX = ASSOCIATED (YD%YCHEMDDFLX)
IF (LYCHEMDDFLX) THEN
  !$ACC ENTER DATA CREATE (YD%YCHEMDDFLX)
  !$ACC UPDATE DEVICE (YD%YCHEMDDFLX)
  DO J1 = LBOUND (YD%YCHEMDDFLX, 1), UBOUND (YD%YCHEMDDFLX, 1)
    CALL COPY_TYPE_SURF_MTL_2D (YD%YCHEMDDFLX (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%YCHEMDDFLX)
ENDIF

LYCHEMDV = ASSOCIATED (YD%YCHEMDV)
IF (LYCHEMDV) THEN
  !$ACC ENTER DATA CREATE (YD%YCHEMDV)
  !$ACC UPDATE DEVICE (YD%YCHEMDV)
  DO J1 = LBOUND (YD%YCHEMDV, 1), UBOUND (YD%YCHEMDV, 1)
    CALL COPY_TYPE_SURF_MTL_2D (YD%YCHEMDV (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%YCHEMDV)
ENDIF

LYEMIS2D = ASSOCIATED (YD%YEMIS2D)
IF (LYEMIS2D) THEN
  !$ACC ENTER DATA CREATE (YD%YEMIS2D)
  !$ACC UPDATE DEVICE (YD%YEMIS2D)
  DO J1 = LBOUND (YD%YEMIS2D, 1), UBOUND (YD%YEMIS2D, 1)
    CALL COPY_TYPE_SURF_MTL_2D (YD%YEMIS2D (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%YEMIS2D)
ENDIF

LYEMIS2DAUX = ASSOCIATED (YD%YEMIS2DAUX)
IF (LYEMIS2DAUX) THEN
  !$ACC ENTER DATA CREATE (YD%YEMIS2DAUX)
  !$ACC UPDATE DEVICE (YD%YEMIS2DAUX)
  DO J1 = LBOUND (YD%YEMIS2DAUX, 1), UBOUND (YD%YEMIS2DAUX, 1)
    CALL COPY_TYPE_SURF_MTL_2D (YD%YEMIS2DAUX (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%YEMIS2DAUX)
ENDIF

LYNUDM = ASSOCIATED (YD%YNUDM)
IF (LYNUDM) THEN
  !$ACC ENTER DATA CREATE (YD%YNUDM)
  !$ACC UPDATE DEVICE (YD%YNUDM)
  CALL COPY_TYPE_SURF_MTL_2D (YD%YNUDM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YNUDM)
ENDIF

LYVF = ASSOCIATED (YD%YVF)
IF (LYVF) THEN
  !$ACC ENTER DATA CREATE (YD%YVF)
  !$ACC UPDATE DEVICE (YD%YVF)
  DO J1 = LBOUND (YD%YVF, 1), UBOUND (YD%YVF, 1)
    CALL COPY_TYPE_SURF_MTL_2D (YD%YVF (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%YVF)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_TYPE_SFL_VARSF (YD)
USE UTIL_TYPE_SURF_MTL_2D_MOD

IMPLICIT NONE
TYPE (TYPE_SFL_VARSF), TARGET :: YD
INTEGER :: J1
LOGICAL :: LYAERDEP, LYAERLTS, LYAERSCC, LYALBF, LYALBSF, LYALNID, LYALNIG, LYALNII, LYALNIP, LYALNIV
LOGICAL :: LYALUVD, LYALUVG, LYALUVI, LYALUVP, LYALUVV, LYCGPP, LYCHEMDDFLX, LYCHEMDV, LYCHEMFLXO, LYCHEMWDFLX
LOGICAL :: LYCI, LYCLK, LYCO2TYP, LYCREC, LYCUR, LYCVH, LYCVL, LYDL, LYDMSO, LYDSF
LOGICAL :: LYDSZ, LYEMIS2D, LYEMIS2DAUX, LYEMISF, LYFCA1, LYFCA2, LYFP1, LYFWET, LYGETRL, LYLAIH
LOGICAL :: LYLAIL, LYLAN, LYLSM, LYLZ0H, LYNUDM, LYSDFOR, LYSIG, LYSO2DD, LYSOTY, LYSSS
LOGICAL :: LYSST, LYTVH, LYTVL, LYUCUR, LYURBF, LYVCUR, LYVEG, LYVF, LYVRLAN, LYVRLDI
LOGICAL :: LYZ0F, LYZ0RLF
LYZ0F = ASSOCIATED (YD%YZ0F)
IF (LYZ0F) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YZ0F)
ENDIF

LYALBF = ASSOCIATED (YD%YALBF)
IF (LYALBF) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALBF)
ENDIF

LYEMISF = ASSOCIATED (YD%YEMISF)
IF (LYEMISF) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YEMISF)
ENDIF

LYGETRL = ASSOCIATED (YD%YGETRL)
IF (LYGETRL) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YGETRL)
ENDIF

LYLSM = ASSOCIATED (YD%YLSM)
IF (LYLSM) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YLSM)
ENDIF

LYVEG = ASSOCIATED (YD%YVEG)
IF (LYVEG) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YVEG)
ENDIF

LYVRLAN = ASSOCIATED (YD%YVRLAN)
IF (LYVRLAN) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YVRLAN)
ENDIF

LYVRLDI = ASSOCIATED (YD%YVRLDI)
IF (LYVRLDI) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YVRLDI)
ENDIF

LYSIG = ASSOCIATED (YD%YSIG)
IF (LYSIG) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YSIG)
ENDIF

LYALBSF = ASSOCIATED (YD%YALBSF)
IF (LYALBSF) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALBSF)
ENDIF

LYLAN = ASSOCIATED (YD%YLAN)
IF (LYLAN) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YLAN)
ENDIF

LYSST = ASSOCIATED (YD%YSST)
IF (LYSST) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YSST)
ENDIF

LYSSS = ASSOCIATED (YD%YSSS)
IF (LYSSS) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YSSS)
ENDIF

LYLZ0H = ASSOCIATED (YD%YLZ0H)
IF (LYLZ0H) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YLZ0H)
ENDIF

LYCVL = ASSOCIATED (YD%YCVL)
IF (LYCVL) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YCVL)
ENDIF

LYCO2TYP = ASSOCIATED (YD%YCO2TYP)
IF (LYCO2TYP) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YCO2TYP)
ENDIF

LYCVH = ASSOCIATED (YD%YCVH)
IF (LYCVH) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YCVH)
ENDIF

LYCUR = ASSOCIATED (YD%YCUR)
IF (LYCUR) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YCUR)
ENDIF

LYTVL = ASSOCIATED (YD%YTVL)
IF (LYTVL) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YTVL)
ENDIF

LYTVH = ASSOCIATED (YD%YTVH)
IF (LYTVH) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YTVH)
ENDIF

LYFWET = ASSOCIATED (YD%YFWET)
IF (LYFWET) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YFWET)
ENDIF

LYLAIL = ASSOCIATED (YD%YLAIL)
IF (LYLAIL) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YLAIL)
ENDIF

LYLAIH = ASSOCIATED (YD%YLAIH)
IF (LYLAIH) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YLAIH)
ENDIF

LYSOTY = ASSOCIATED (YD%YSOTY)
IF (LYSOTY) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YSOTY)
ENDIF

LYCLK = ASSOCIATED (YD%YCLK)
IF (LYCLK) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YCLK)
ENDIF

LYDL = ASSOCIATED (YD%YDL)
IF (LYDL) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YDL)
ENDIF

LYCI = ASSOCIATED (YD%YCI)
IF (LYCI) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YCI)
ENDIF

LYUCUR = ASSOCIATED (YD%YUCUR)
IF (LYUCUR) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YUCUR)
ENDIF

LYVCUR = ASSOCIATED (YD%YVCUR)
IF (LYVCUR) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YVCUR)
ENDIF

LYZ0RLF = ASSOCIATED (YD%YZ0RLF)
IF (LYZ0RLF) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YZ0RLF)
ENDIF

LYCGPP = ASSOCIATED (YD%YCGPP)
IF (LYCGPP) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YCGPP)
ENDIF

LYCREC = ASSOCIATED (YD%YCREC)
IF (LYCREC) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YCREC)
ENDIF

LYSDFOR = ASSOCIATED (YD%YSDFOR)
IF (LYSDFOR) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YSDFOR)
ENDIF

LYALUVP = ASSOCIATED (YD%YALUVP)
IF (LYALUVP) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALUVP)
ENDIF

LYALUVD = ASSOCIATED (YD%YALUVD)
IF (LYALUVD) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALUVD)
ENDIF

LYALNIP = ASSOCIATED (YD%YALNIP)
IF (LYALNIP) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALNIP)
ENDIF

LYALNID = ASSOCIATED (YD%YALNID)
IF (LYALNID) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALNID)
ENDIF

LYALUVI = ASSOCIATED (YD%YALUVI)
IF (LYALUVI) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALUVI)
ENDIF

LYALNII = ASSOCIATED (YD%YALNII)
IF (LYALNII) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALNII)
ENDIF

LYALUVV = ASSOCIATED (YD%YALUVV)
IF (LYALUVV) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALUVV)
ENDIF

LYALNIV = ASSOCIATED (YD%YALNIV)
IF (LYALNIV) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALNIV)
ENDIF

LYALUVG = ASSOCIATED (YD%YALUVG)
IF (LYALUVG) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALUVG)
ENDIF

LYALNIG = ASSOCIATED (YD%YALNIG)
IF (LYALNIG) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YALNIG)
ENDIF



LYFP1 = ASSOCIATED (YD%YFP1)
IF (LYFP1) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YFP1)
ENDIF

LYSO2DD = ASSOCIATED (YD%YSO2DD)
IF (LYSO2DD) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YSO2DD)
ENDIF

LYDMSO = ASSOCIATED (YD%YDMSO)
IF (LYDMSO) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YDMSO)
ENDIF

LYURBF = ASSOCIATED (YD%YURBF)
IF (LYURBF) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YURBF)
ENDIF

LYFCA1 = ASSOCIATED (YD%YFCA1)
IF (LYFCA1) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YFCA1)
ENDIF

LYFCA2 = ASSOCIATED (YD%YFCA2)
IF (LYFCA2) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YFCA2)
ENDIF

LYAERDEP = ASSOCIATED (YD%YAERDEP)
IF (LYAERDEP) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YAERDEP)
ENDIF

LYAERLTS = ASSOCIATED (YD%YAERLTS)
IF (LYAERLTS) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YAERLTS)
ENDIF

LYAERSCC = ASSOCIATED (YD%YAERSCC)
IF (LYAERSCC) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YAERSCC)
ENDIF

LYDSF = ASSOCIATED (YD%YDSF)
IF (LYDSF) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YDSF)
ENDIF

LYDSZ = ASSOCIATED (YD%YDSZ)
IF (LYDSZ) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YDSZ)
ENDIF

LYCHEMFLXO = ASSOCIATED (YD%YCHEMFLXO)
IF (LYCHEMFLXO) THEN
  DO J1 = LBOUND (YD%YCHEMFLXO, 1), UBOUND (YD%YCHEMFLXO, 1)
    CALL HOST_TYPE_SURF_MTL_2D (YD%YCHEMFLXO (J1))
  ENDDO
ENDIF

LYCHEMWDFLX = ASSOCIATED (YD%YCHEMWDFLX)
IF (LYCHEMWDFLX) THEN
  DO J1 = LBOUND (YD%YCHEMWDFLX, 1), UBOUND (YD%YCHEMWDFLX, 1)
    CALL HOST_TYPE_SURF_MTL_2D (YD%YCHEMWDFLX (J1))
  ENDDO
ENDIF

LYCHEMDDFLX = ASSOCIATED (YD%YCHEMDDFLX)
IF (LYCHEMDDFLX) THEN
  DO J1 = LBOUND (YD%YCHEMDDFLX, 1), UBOUND (YD%YCHEMDDFLX, 1)
    CALL HOST_TYPE_SURF_MTL_2D (YD%YCHEMDDFLX (J1))
  ENDDO
ENDIF

LYCHEMDV = ASSOCIATED (YD%YCHEMDV)
IF (LYCHEMDV) THEN
  DO J1 = LBOUND (YD%YCHEMDV, 1), UBOUND (YD%YCHEMDV, 1)
    CALL HOST_TYPE_SURF_MTL_2D (YD%YCHEMDV (J1))
  ENDDO
ENDIF

LYEMIS2D = ASSOCIATED (YD%YEMIS2D)
IF (LYEMIS2D) THEN
  DO J1 = LBOUND (YD%YEMIS2D, 1), UBOUND (YD%YEMIS2D, 1)
    CALL HOST_TYPE_SURF_MTL_2D (YD%YEMIS2D (J1))
  ENDDO
ENDIF

LYEMIS2DAUX = ASSOCIATED (YD%YEMIS2DAUX)
IF (LYEMIS2DAUX) THEN
  DO J1 = LBOUND (YD%YEMIS2DAUX, 1), UBOUND (YD%YEMIS2DAUX, 1)
    CALL HOST_TYPE_SURF_MTL_2D (YD%YEMIS2DAUX (J1))
  ENDDO
ENDIF

LYNUDM = ASSOCIATED (YD%YNUDM)
IF (LYNUDM) THEN
  CALL HOST_TYPE_SURF_MTL_2D (YD%YNUDM)
ENDIF

LYVF = ASSOCIATED (YD%YVF)
IF (LYVF) THEN
  DO J1 = LBOUND (YD%YVF, 1), UBOUND (YD%YVF, 1)
    CALL HOST_TYPE_SURF_MTL_2D (YD%YVF (J1))
  ENDDO
ENDIF

END SUBROUTINE

     

SUBROUTINE CRC64_TYPE_SFL_VARSF (YD, KLUN, CDPATH)
USE UTIL_TYPE_SURF_MTL_2D_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TYPE_SFL_VARSF), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
INTEGER :: J1
LOGICAL :: LYAERDEP, LYAERLTS, LYAERSCC, LYALBF, LYALBSF, LYALNID, LYALNIG, LYALNII, LYALNIP, LYALNIV
LOGICAL :: LYALUVD, LYALUVG, LYALUVI, LYALUVP, LYALUVV, LYCGPP, LYCHEMDDFLX, LYCHEMDV, LYCHEMFLXO, LYCHEMWDFLX
LOGICAL :: LYCI, LYCLK, LYCO2TYP, LYCREC, LYCUR, LYCVH, LYCVL, LYDL, LYDMSO, LYDSF
LOGICAL :: LYDSZ, LYEMIS2D, LYEMIS2DAUX, LYEMISF, LYFCA1, LYFCA2, LYFP1, LYFWET, LYGETRL, LYLAIH
LOGICAL :: LYLAIL, LYLAN, LYLSM, LYLZ0H, LYNUDM, LYSDFOR, LYSIG, LYSO2DD, LYSOTY, LYSSS
LOGICAL :: LYSST, LYTVH, LYTVL, LYUCUR, LYURBF, LYVCUR, LYVEG, LYVF, LYVRLAN, LYVRLDI
LOGICAL :: LYZ0F, LYZ0RLF
LYZ0F = ASSOCIATED (YD%YZ0F)
IF (LYZ0F) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YZ0F, KLUN, CDPATH//'%YZ0F'//TRIM(CLIND))
ENDIF

LYALBF = ASSOCIATED (YD%YALBF)
IF (LYALBF) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALBF, KLUN, CDPATH//'%YALBF'//TRIM(CLIND))
ENDIF

LYEMISF = ASSOCIATED (YD%YEMISF)
IF (LYEMISF) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YEMISF, KLUN, CDPATH//'%YEMISF'//TRIM(CLIND))
ENDIF

LYGETRL = ASSOCIATED (YD%YGETRL)
IF (LYGETRL) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YGETRL, KLUN, CDPATH//'%YGETRL'//TRIM(CLIND))
ENDIF

LYLSM = ASSOCIATED (YD%YLSM)
IF (LYLSM) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YLSM, KLUN, CDPATH//'%YLSM'//TRIM(CLIND))
ENDIF

LYVEG = ASSOCIATED (YD%YVEG)
IF (LYVEG) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YVEG, KLUN, CDPATH//'%YVEG'//TRIM(CLIND))
ENDIF

LYVRLAN = ASSOCIATED (YD%YVRLAN)
IF (LYVRLAN) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YVRLAN, KLUN, CDPATH//'%YVRLAN'//TRIM(CLIND))
ENDIF

LYVRLDI = ASSOCIATED (YD%YVRLDI)
IF (LYVRLDI) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YVRLDI, KLUN, CDPATH//'%YVRLDI'//TRIM(CLIND))
ENDIF

LYSIG = ASSOCIATED (YD%YSIG)
IF (LYSIG) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YSIG, KLUN, CDPATH//'%YSIG'//TRIM(CLIND))
ENDIF

LYALBSF = ASSOCIATED (YD%YALBSF)
IF (LYALBSF) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALBSF, KLUN, CDPATH//'%YALBSF'//TRIM(CLIND))
ENDIF

LYLAN = ASSOCIATED (YD%YLAN)
IF (LYLAN) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YLAN, KLUN, CDPATH//'%YLAN'//TRIM(CLIND))
ENDIF

LYSST = ASSOCIATED (YD%YSST)
IF (LYSST) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YSST, KLUN, CDPATH//'%YSST'//TRIM(CLIND))
ENDIF

LYSSS = ASSOCIATED (YD%YSSS)
IF (LYSSS) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YSSS, KLUN, CDPATH//'%YSSS'//TRIM(CLIND))
ENDIF

LYLZ0H = ASSOCIATED (YD%YLZ0H)
IF (LYLZ0H) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YLZ0H, KLUN, CDPATH//'%YLZ0H'//TRIM(CLIND))
ENDIF

LYCVL = ASSOCIATED (YD%YCVL)
IF (LYCVL) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YCVL, KLUN, CDPATH//'%YCVL'//TRIM(CLIND))
ENDIF

LYCO2TYP = ASSOCIATED (YD%YCO2TYP)
IF (LYCO2TYP) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YCO2TYP, KLUN, CDPATH//'%YCO2TYP'//TRIM(CLIND))
ENDIF

LYCVH = ASSOCIATED (YD%YCVH)
IF (LYCVH) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YCVH, KLUN, CDPATH//'%YCVH'//TRIM(CLIND))
ENDIF

LYCUR = ASSOCIATED (YD%YCUR)
IF (LYCUR) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YCUR, KLUN, CDPATH//'%YCUR'//TRIM(CLIND))
ENDIF

LYTVL = ASSOCIATED (YD%YTVL)
IF (LYTVL) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YTVL, KLUN, CDPATH//'%YTVL'//TRIM(CLIND))
ENDIF

LYTVH = ASSOCIATED (YD%YTVH)
IF (LYTVH) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YTVH, KLUN, CDPATH//'%YTVH'//TRIM(CLIND))
ENDIF

LYFWET = ASSOCIATED (YD%YFWET)
IF (LYFWET) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YFWET, KLUN, CDPATH//'%YFWET'//TRIM(CLIND))
ENDIF

LYLAIL = ASSOCIATED (YD%YLAIL)
IF (LYLAIL) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YLAIL, KLUN, CDPATH//'%YLAIL'//TRIM(CLIND))
ENDIF

LYLAIH = ASSOCIATED (YD%YLAIH)
IF (LYLAIH) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YLAIH, KLUN, CDPATH//'%YLAIH'//TRIM(CLIND))
ENDIF

LYSOTY = ASSOCIATED (YD%YSOTY)
IF (LYSOTY) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YSOTY, KLUN, CDPATH//'%YSOTY'//TRIM(CLIND))
ENDIF

LYCLK = ASSOCIATED (YD%YCLK)
IF (LYCLK) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YCLK, KLUN, CDPATH//'%YCLK'//TRIM(CLIND))
ENDIF

LYDL = ASSOCIATED (YD%YDL)
IF (LYDL) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YDL, KLUN, CDPATH//'%YDL'//TRIM(CLIND))
ENDIF

LYCI = ASSOCIATED (YD%YCI)
IF (LYCI) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YCI, KLUN, CDPATH//'%YCI'//TRIM(CLIND))
ENDIF

LYUCUR = ASSOCIATED (YD%YUCUR)
IF (LYUCUR) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YUCUR, KLUN, CDPATH//'%YUCUR'//TRIM(CLIND))
ENDIF

LYVCUR = ASSOCIATED (YD%YVCUR)
IF (LYVCUR) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YVCUR, KLUN, CDPATH//'%YVCUR'//TRIM(CLIND))
ENDIF

LYZ0RLF = ASSOCIATED (YD%YZ0RLF)
IF (LYZ0RLF) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YZ0RLF, KLUN, CDPATH//'%YZ0RLF'//TRIM(CLIND))
ENDIF

LYCGPP = ASSOCIATED (YD%YCGPP)
IF (LYCGPP) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YCGPP, KLUN, CDPATH//'%YCGPP'//TRIM(CLIND))
ENDIF

LYCREC = ASSOCIATED (YD%YCREC)
IF (LYCREC) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YCREC, KLUN, CDPATH//'%YCREC'//TRIM(CLIND))
ENDIF

LYSDFOR = ASSOCIATED (YD%YSDFOR)
IF (LYSDFOR) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YSDFOR, KLUN, CDPATH//'%YSDFOR'//TRIM(CLIND))
ENDIF

LYALUVP = ASSOCIATED (YD%YALUVP)
IF (LYALUVP) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALUVP, KLUN, CDPATH//'%YALUVP'//TRIM(CLIND))
ENDIF

LYALUVD = ASSOCIATED (YD%YALUVD)
IF (LYALUVD) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALUVD, KLUN, CDPATH//'%YALUVD'//TRIM(CLIND))
ENDIF

LYALNIP = ASSOCIATED (YD%YALNIP)
IF (LYALNIP) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALNIP, KLUN, CDPATH//'%YALNIP'//TRIM(CLIND))
ENDIF

LYALNID = ASSOCIATED (YD%YALNID)
IF (LYALNID) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALNID, KLUN, CDPATH//'%YALNID'//TRIM(CLIND))
ENDIF

LYALUVI = ASSOCIATED (YD%YALUVI)
IF (LYALUVI) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALUVI, KLUN, CDPATH//'%YALUVI'//TRIM(CLIND))
ENDIF

LYALNII = ASSOCIATED (YD%YALNII)
IF (LYALNII) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALNII, KLUN, CDPATH//'%YALNII'//TRIM(CLIND))
ENDIF

LYALUVV = ASSOCIATED (YD%YALUVV)
IF (LYALUVV) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALUVV, KLUN, CDPATH//'%YALUVV'//TRIM(CLIND))
ENDIF

LYALNIV = ASSOCIATED (YD%YALNIV)
IF (LYALNIV) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALNIV, KLUN, CDPATH//'%YALNIV'//TRIM(CLIND))
ENDIF

LYALUVG = ASSOCIATED (YD%YALUVG)
IF (LYALUVG) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALUVG, KLUN, CDPATH//'%YALUVG'//TRIM(CLIND))
ENDIF

LYALNIG = ASSOCIATED (YD%YALNIG)
IF (LYALNIG) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YALNIG, KLUN, CDPATH//'%YALNIG'//TRIM(CLIND))
ENDIF

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IALSTART), CDPATH//'%IALSTART'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IALEND), CDPATH//'%IALEND'

LYFP1 = ASSOCIATED (YD%YFP1)
IF (LYFP1) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YFP1, KLUN, CDPATH//'%YFP1'//TRIM(CLIND))
ENDIF

LYSO2DD = ASSOCIATED (YD%YSO2DD)
IF (LYSO2DD) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YSO2DD, KLUN, CDPATH//'%YSO2DD'//TRIM(CLIND))
ENDIF

LYDMSO = ASSOCIATED (YD%YDMSO)
IF (LYDMSO) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YDMSO, KLUN, CDPATH//'%YDMSO'//TRIM(CLIND))
ENDIF

LYURBF = ASSOCIATED (YD%YURBF)
IF (LYURBF) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YURBF, KLUN, CDPATH//'%YURBF'//TRIM(CLIND))
ENDIF

LYFCA1 = ASSOCIATED (YD%YFCA1)
IF (LYFCA1) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YFCA1, KLUN, CDPATH//'%YFCA1'//TRIM(CLIND))
ENDIF

LYFCA2 = ASSOCIATED (YD%YFCA2)
IF (LYFCA2) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YFCA2, KLUN, CDPATH//'%YFCA2'//TRIM(CLIND))
ENDIF

LYAERDEP = ASSOCIATED (YD%YAERDEP)
IF (LYAERDEP) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YAERDEP, KLUN, CDPATH//'%YAERDEP'//TRIM(CLIND))
ENDIF

LYAERLTS = ASSOCIATED (YD%YAERLTS)
IF (LYAERLTS) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YAERLTS, KLUN, CDPATH//'%YAERLTS'//TRIM(CLIND))
ENDIF

LYAERSCC = ASSOCIATED (YD%YAERSCC)
IF (LYAERSCC) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YAERSCC, KLUN, CDPATH//'%YAERSCC'//TRIM(CLIND))
ENDIF

LYDSF = ASSOCIATED (YD%YDSF)
IF (LYDSF) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YDSF, KLUN, CDPATH//'%YDSF'//TRIM(CLIND))
ENDIF

LYDSZ = ASSOCIATED (YD%YDSZ)
IF (LYDSZ) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YDSZ, KLUN, CDPATH//'%YDSZ'//TRIM(CLIND))
ENDIF

LYCHEMFLXO = ASSOCIATED (YD%YCHEMFLXO)
IF (LYCHEMFLXO) THEN
  DO J1 = LBOUND (YD%YCHEMFLXO, 1), UBOUND (YD%YCHEMFLXO, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_SURF_MTL_2D (YD%YCHEMFLXO (J1), KLUN, CDPATH//'%YCHEMFLXO'//TRIM(CLIND))
  ENDDO
ENDIF

LYCHEMWDFLX = ASSOCIATED (YD%YCHEMWDFLX)
IF (LYCHEMWDFLX) THEN
  DO J1 = LBOUND (YD%YCHEMWDFLX, 1), UBOUND (YD%YCHEMWDFLX, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_SURF_MTL_2D (YD%YCHEMWDFLX (J1), KLUN, CDPATH//'%YCHEMWDFLX'//TRIM(CLIND))
  ENDDO
ENDIF

LYCHEMDDFLX = ASSOCIATED (YD%YCHEMDDFLX)
IF (LYCHEMDDFLX) THEN
  DO J1 = LBOUND (YD%YCHEMDDFLX, 1), UBOUND (YD%YCHEMDDFLX, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_SURF_MTL_2D (YD%YCHEMDDFLX (J1), KLUN, CDPATH//'%YCHEMDDFLX'//TRIM(CLIND))
  ENDDO
ENDIF

LYCHEMDV = ASSOCIATED (YD%YCHEMDV)
IF (LYCHEMDV) THEN
  DO J1 = LBOUND (YD%YCHEMDV, 1), UBOUND (YD%YCHEMDV, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_SURF_MTL_2D (YD%YCHEMDV (J1), KLUN, CDPATH//'%YCHEMDV'//TRIM(CLIND))
  ENDDO
ENDIF

LYEMIS2D = ASSOCIATED (YD%YEMIS2D)
IF (LYEMIS2D) THEN
  DO J1 = LBOUND (YD%YEMIS2D, 1), UBOUND (YD%YEMIS2D, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_SURF_MTL_2D (YD%YEMIS2D (J1), KLUN, CDPATH//'%YEMIS2D'//TRIM(CLIND))
  ENDDO
ENDIF

LYEMIS2DAUX = ASSOCIATED (YD%YEMIS2DAUX)
IF (LYEMIS2DAUX) THEN
  DO J1 = LBOUND (YD%YEMIS2DAUX, 1), UBOUND (YD%YEMIS2DAUX, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_SURF_MTL_2D (YD%YEMIS2DAUX (J1), KLUN, CDPATH//'%YEMIS2DAUX'//TRIM(CLIND))
  ENDDO
ENDIF

LYNUDM = ASSOCIATED (YD%YNUDM)
IF (LYNUDM) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_2D (YD%YNUDM, KLUN, CDPATH//'%YNUDM'//TRIM(CLIND))
ENDIF

LYVF = ASSOCIATED (YD%YVF)
IF (LYVF) THEN
  DO J1 = LBOUND (YD%YVF, 1), UBOUND (YD%YVF, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_SURF_MTL_2D (YD%YVF (J1), KLUN, CDPATH//'%YVF'//TRIM(CLIND))
  ENDDO
ENDIF

END SUBROUTINE

SUBROUTINE WIPE_TYPE_SFL_VARSF (YD, LDDELETED, LDFIELDAPI)
USE UTIL_TYPE_SURF_MTL_2D_MOD
IMPLICIT NONE
TYPE (TYPE_SFL_VARSF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LYAERDEP, LYAERLTS, LYAERSCC, LYALBF, LYALBSF, LYALNID, LYALNIG, LYALNII, LYALNIP, LYALNIV
LOGICAL :: LYALUVD, LYALUVG, LYALUVI, LYALUVP, LYALUVV, LYCGPP, LYCHEMDDFLX, LYCHEMDV, LYCHEMFLXO, LYCHEMWDFLX
LOGICAL :: LYCI, LYCLK, LYCO2TYP, LYCREC, LYCUR, LYCVH, LYCVL, LYDL, LYDMSO, LYDSF
LOGICAL :: LYDSZ, LYEMIS2D, LYEMIS2DAUX, LYEMISF, LYFCA1, LYFCA2, LYFP1, LYFWET, LYGETRL, LYLAIH
LOGICAL :: LYLAIL, LYLAN, LYLSM, LYLZ0H, LYNUDM, LYSDFOR, LYSIG, LYSO2DD, LYSOTY, LYSSS
LOGICAL :: LYSST, LYTVH, LYTVL, LYUCUR, LYURBF, LYVCUR, LYVEG, LYVF, LYVRLAN, LYVRLDI
LOGICAL :: LYZ0F, LYZ0RLF

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LYZ0F = ASSOCIATED (YD%YZ0F)
IF (LYZ0F) THEN
  !$ACC EXIT DATA DETACH (YD%YZ0F)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YZ0F, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YZ0F)
ENDIF

LYALBF = ASSOCIATED (YD%YALBF)
IF (LYALBF) THEN
  !$ACC EXIT DATA DETACH (YD%YALBF)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALBF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALBF)
ENDIF

LYEMISF = ASSOCIATED (YD%YEMISF)
IF (LYEMISF) THEN
  !$ACC EXIT DATA DETACH (YD%YEMISF)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YEMISF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YEMISF)
ENDIF

LYGETRL = ASSOCIATED (YD%YGETRL)
IF (LYGETRL) THEN
  !$ACC EXIT DATA DETACH (YD%YGETRL)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YGETRL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YGETRL)
ENDIF

LYLSM = ASSOCIATED (YD%YLSM)
IF (LYLSM) THEN
  !$ACC EXIT DATA DETACH (YD%YLSM)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YLSM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YLSM)
ENDIF

LYVEG = ASSOCIATED (YD%YVEG)
IF (LYVEG) THEN
  !$ACC EXIT DATA DETACH (YD%YVEG)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YVEG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YVEG)
ENDIF

LYVRLAN = ASSOCIATED (YD%YVRLAN)
IF (LYVRLAN) THEN
  !$ACC EXIT DATA DETACH (YD%YVRLAN)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YVRLAN, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YVRLAN)
ENDIF

LYVRLDI = ASSOCIATED (YD%YVRLDI)
IF (LYVRLDI) THEN
  !$ACC EXIT DATA DETACH (YD%YVRLDI)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YVRLDI, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YVRLDI)
ENDIF

LYSIG = ASSOCIATED (YD%YSIG)
IF (LYSIG) THEN
  !$ACC EXIT DATA DETACH (YD%YSIG)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YSIG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YSIG)
ENDIF

LYALBSF = ASSOCIATED (YD%YALBSF)
IF (LYALBSF) THEN
  !$ACC EXIT DATA DETACH (YD%YALBSF)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALBSF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALBSF)
ENDIF

LYLAN = ASSOCIATED (YD%YLAN)
IF (LYLAN) THEN
  !$ACC EXIT DATA DETACH (YD%YLAN)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YLAN, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YLAN)
ENDIF

LYSST = ASSOCIATED (YD%YSST)
IF (LYSST) THEN
  !$ACC EXIT DATA DETACH (YD%YSST)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YSST, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YSST)
ENDIF

LYSSS = ASSOCIATED (YD%YSSS)
IF (LYSSS) THEN
  !$ACC EXIT DATA DETACH (YD%YSSS)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YSSS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YSSS)
ENDIF

LYLZ0H = ASSOCIATED (YD%YLZ0H)
IF (LYLZ0H) THEN
  !$ACC EXIT DATA DETACH (YD%YLZ0H)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YLZ0H, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YLZ0H)
ENDIF

LYCVL = ASSOCIATED (YD%YCVL)
IF (LYCVL) THEN
  !$ACC EXIT DATA DETACH (YD%YCVL)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YCVL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YCVL)
ENDIF

LYCO2TYP = ASSOCIATED (YD%YCO2TYP)
IF (LYCO2TYP) THEN
  !$ACC EXIT DATA DETACH (YD%YCO2TYP)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YCO2TYP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YCO2TYP)
ENDIF

LYCVH = ASSOCIATED (YD%YCVH)
IF (LYCVH) THEN
  !$ACC EXIT DATA DETACH (YD%YCVH)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YCVH, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YCVH)
ENDIF

LYCUR = ASSOCIATED (YD%YCUR)
IF (LYCUR) THEN
  !$ACC EXIT DATA DETACH (YD%YCUR)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YCUR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YCUR)
ENDIF

LYTVL = ASSOCIATED (YD%YTVL)
IF (LYTVL) THEN
  !$ACC EXIT DATA DETACH (YD%YTVL)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YTVL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YTVL)
ENDIF

LYTVH = ASSOCIATED (YD%YTVH)
IF (LYTVH) THEN
  !$ACC EXIT DATA DETACH (YD%YTVH)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YTVH, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YTVH)
ENDIF

LYFWET = ASSOCIATED (YD%YFWET)
IF (LYFWET) THEN
  !$ACC EXIT DATA DETACH (YD%YFWET)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YFWET, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YFWET)
ENDIF

LYLAIL = ASSOCIATED (YD%YLAIL)
IF (LYLAIL) THEN
  !$ACC EXIT DATA DETACH (YD%YLAIL)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YLAIL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YLAIL)
ENDIF

LYLAIH = ASSOCIATED (YD%YLAIH)
IF (LYLAIH) THEN
  !$ACC EXIT DATA DETACH (YD%YLAIH)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YLAIH, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YLAIH)
ENDIF

LYSOTY = ASSOCIATED (YD%YSOTY)
IF (LYSOTY) THEN
  !$ACC EXIT DATA DETACH (YD%YSOTY)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YSOTY, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YSOTY)
ENDIF

LYCLK = ASSOCIATED (YD%YCLK)
IF (LYCLK) THEN
  !$ACC EXIT DATA DETACH (YD%YCLK)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YCLK, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YCLK)
ENDIF

LYDL = ASSOCIATED (YD%YDL)
IF (LYDL) THEN
  !$ACC EXIT DATA DETACH (YD%YDL)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YDL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YDL)
ENDIF

LYCI = ASSOCIATED (YD%YCI)
IF (LYCI) THEN
  !$ACC EXIT DATA DETACH (YD%YCI)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YCI, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YCI)
ENDIF

LYUCUR = ASSOCIATED (YD%YUCUR)
IF (LYUCUR) THEN
  !$ACC EXIT DATA DETACH (YD%YUCUR)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YUCUR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YUCUR)
ENDIF

LYVCUR = ASSOCIATED (YD%YVCUR)
IF (LYVCUR) THEN
  !$ACC EXIT DATA DETACH (YD%YVCUR)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YVCUR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YVCUR)
ENDIF

LYZ0RLF = ASSOCIATED (YD%YZ0RLF)
IF (LYZ0RLF) THEN
  !$ACC EXIT DATA DETACH (YD%YZ0RLF)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YZ0RLF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YZ0RLF)
ENDIF

LYCGPP = ASSOCIATED (YD%YCGPP)
IF (LYCGPP) THEN
  !$ACC EXIT DATA DETACH (YD%YCGPP)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YCGPP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YCGPP)
ENDIF

LYCREC = ASSOCIATED (YD%YCREC)
IF (LYCREC) THEN
  !$ACC EXIT DATA DETACH (YD%YCREC)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YCREC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YCREC)
ENDIF

LYSDFOR = ASSOCIATED (YD%YSDFOR)
IF (LYSDFOR) THEN
  !$ACC EXIT DATA DETACH (YD%YSDFOR)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YSDFOR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YSDFOR)
ENDIF

LYALUVP = ASSOCIATED (YD%YALUVP)
IF (LYALUVP) THEN
  !$ACC EXIT DATA DETACH (YD%YALUVP)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALUVP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALUVP)
ENDIF

LYALUVD = ASSOCIATED (YD%YALUVD)
IF (LYALUVD) THEN
  !$ACC EXIT DATA DETACH (YD%YALUVD)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALUVD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALUVD)
ENDIF

LYALNIP = ASSOCIATED (YD%YALNIP)
IF (LYALNIP) THEN
  !$ACC EXIT DATA DETACH (YD%YALNIP)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALNIP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALNIP)
ENDIF

LYALNID = ASSOCIATED (YD%YALNID)
IF (LYALNID) THEN
  !$ACC EXIT DATA DETACH (YD%YALNID)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALNID, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALNID)
ENDIF

LYALUVI = ASSOCIATED (YD%YALUVI)
IF (LYALUVI) THEN
  !$ACC EXIT DATA DETACH (YD%YALUVI)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALUVI, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALUVI)
ENDIF

LYALNII = ASSOCIATED (YD%YALNII)
IF (LYALNII) THEN
  !$ACC EXIT DATA DETACH (YD%YALNII)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALNII, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALNII)
ENDIF

LYALUVV = ASSOCIATED (YD%YALUVV)
IF (LYALUVV) THEN
  !$ACC EXIT DATA DETACH (YD%YALUVV)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALUVV, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALUVV)
ENDIF

LYALNIV = ASSOCIATED (YD%YALNIV)
IF (LYALNIV) THEN
  !$ACC EXIT DATA DETACH (YD%YALNIV)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALNIV, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALNIV)
ENDIF

LYALUVG = ASSOCIATED (YD%YALUVG)
IF (LYALUVG) THEN
  !$ACC EXIT DATA DETACH (YD%YALUVG)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALUVG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALUVG)
ENDIF

LYALNIG = ASSOCIATED (YD%YALNIG)
IF (LYALNIG) THEN
  !$ACC EXIT DATA DETACH (YD%YALNIG)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YALNIG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YALNIG)
ENDIF



LYFP1 = ASSOCIATED (YD%YFP1)
IF (LYFP1) THEN
  !$ACC EXIT DATA DETACH (YD%YFP1)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YFP1, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YFP1)
ENDIF

LYSO2DD = ASSOCIATED (YD%YSO2DD)
IF (LYSO2DD) THEN
  !$ACC EXIT DATA DETACH (YD%YSO2DD)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YSO2DD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YSO2DD)
ENDIF

LYDMSO = ASSOCIATED (YD%YDMSO)
IF (LYDMSO) THEN
  !$ACC EXIT DATA DETACH (YD%YDMSO)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YDMSO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YDMSO)
ENDIF

LYURBF = ASSOCIATED (YD%YURBF)
IF (LYURBF) THEN
  !$ACC EXIT DATA DETACH (YD%YURBF)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YURBF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YURBF)
ENDIF

LYFCA1 = ASSOCIATED (YD%YFCA1)
IF (LYFCA1) THEN
  !$ACC EXIT DATA DETACH (YD%YFCA1)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YFCA1, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YFCA1)
ENDIF

LYFCA2 = ASSOCIATED (YD%YFCA2)
IF (LYFCA2) THEN
  !$ACC EXIT DATA DETACH (YD%YFCA2)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YFCA2, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YFCA2)
ENDIF

LYAERDEP = ASSOCIATED (YD%YAERDEP)
IF (LYAERDEP) THEN
  !$ACC EXIT DATA DETACH (YD%YAERDEP)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YAERDEP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YAERDEP)
ENDIF

LYAERLTS = ASSOCIATED (YD%YAERLTS)
IF (LYAERLTS) THEN
  !$ACC EXIT DATA DETACH (YD%YAERLTS)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YAERLTS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YAERLTS)
ENDIF

LYAERSCC = ASSOCIATED (YD%YAERSCC)
IF (LYAERSCC) THEN
  !$ACC EXIT DATA DETACH (YD%YAERSCC)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YAERSCC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YAERSCC)
ENDIF

LYDSF = ASSOCIATED (YD%YDSF)
IF (LYDSF) THEN
  !$ACC EXIT DATA DETACH (YD%YDSF)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YDSF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YDSF)
ENDIF

LYDSZ = ASSOCIATED (YD%YDSZ)
IF (LYDSZ) THEN
  !$ACC EXIT DATA DETACH (YD%YDSZ)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YDSZ, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YDSZ)
ENDIF

LYCHEMFLXO = ASSOCIATED (YD%YCHEMFLXO)
IF (LYCHEMFLXO) THEN
  !$ACC EXIT DATA DETACH (YD%YCHEMFLXO)
  DO J1 = LBOUND (YD%YCHEMFLXO, 1), UBOUND (YD%YCHEMFLXO, 1)
    CALL WIPE_TYPE_SURF_MTL_2D (YD%YCHEMFLXO (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%YCHEMFLXO)
ENDIF

LYCHEMWDFLX = ASSOCIATED (YD%YCHEMWDFLX)
IF (LYCHEMWDFLX) THEN
  !$ACC EXIT DATA DETACH (YD%YCHEMWDFLX)
  DO J1 = LBOUND (YD%YCHEMWDFLX, 1), UBOUND (YD%YCHEMWDFLX, 1)
    CALL WIPE_TYPE_SURF_MTL_2D (YD%YCHEMWDFLX (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%YCHEMWDFLX)
ENDIF

LYCHEMDDFLX = ASSOCIATED (YD%YCHEMDDFLX)
IF (LYCHEMDDFLX) THEN
  !$ACC EXIT DATA DETACH (YD%YCHEMDDFLX)
  DO J1 = LBOUND (YD%YCHEMDDFLX, 1), UBOUND (YD%YCHEMDDFLX, 1)
    CALL WIPE_TYPE_SURF_MTL_2D (YD%YCHEMDDFLX (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%YCHEMDDFLX)
ENDIF

LYCHEMDV = ASSOCIATED (YD%YCHEMDV)
IF (LYCHEMDV) THEN
  !$ACC EXIT DATA DETACH (YD%YCHEMDV)
  DO J1 = LBOUND (YD%YCHEMDV, 1), UBOUND (YD%YCHEMDV, 1)
    CALL WIPE_TYPE_SURF_MTL_2D (YD%YCHEMDV (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%YCHEMDV)
ENDIF

LYEMIS2D = ASSOCIATED (YD%YEMIS2D)
IF (LYEMIS2D) THEN
  !$ACC EXIT DATA DETACH (YD%YEMIS2D)
  DO J1 = LBOUND (YD%YEMIS2D, 1), UBOUND (YD%YEMIS2D, 1)
    CALL WIPE_TYPE_SURF_MTL_2D (YD%YEMIS2D (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%YEMIS2D)
ENDIF

LYEMIS2DAUX = ASSOCIATED (YD%YEMIS2DAUX)
IF (LYEMIS2DAUX) THEN
  !$ACC EXIT DATA DETACH (YD%YEMIS2DAUX)
  DO J1 = LBOUND (YD%YEMIS2DAUX, 1), UBOUND (YD%YEMIS2DAUX, 1)
    CALL WIPE_TYPE_SURF_MTL_2D (YD%YEMIS2DAUX (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%YEMIS2DAUX)
ENDIF

LYNUDM = ASSOCIATED (YD%YNUDM)
IF (LYNUDM) THEN
  !$ACC EXIT DATA DETACH (YD%YNUDM)
  CALL WIPE_TYPE_SURF_MTL_2D (YD%YNUDM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YNUDM)
ENDIF

LYVF = ASSOCIATED (YD%YVF)
IF (LYVF) THEN
  !$ACC EXIT DATA DETACH (YD%YVF)
  DO J1 = LBOUND (YD%YVF, 1), UBOUND (YD%YVF, 1)
    CALL WIPE_TYPE_SURF_MTL_2D (YD%YVF (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%YVF)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE



END MODULE
