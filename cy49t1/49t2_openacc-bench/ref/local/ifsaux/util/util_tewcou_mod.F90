MODULE UTIL_TEWCOU_MOD

USE YOEWCOU, ONLY : TEWCOU

INTERFACE SAVE
MODULE PROCEDURE SAVE_TEWCOU
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TEWCOU
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TEWCOU
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TEWCOU
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TEWCOU
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TEWCOU
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TEWCOU
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TEWCOU (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TEWCOU), INTENT (IN), TARGET :: YD
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
WRITE (KLUN) YD%NATMFLX
WRITE (KLUN) YD%NGAUSSW
WRITE (KLUN) YD%NLONW
WRITE (KLUN) YD%NLATW
WRITE (KLUN) YD%NLON1W
WRITE (KLUN) YD%NLAT1W
WRITE (KLUN) YD%NNORXW
WRITE (KLUN) YD%NSTPW
WRITE (KLUN) YD%NGRIB_HANDLE_FOR_WAM
WRITE (KLUN) YD%RSOUTW
WRITE (KLUN) YD%RNORTW
WRITE (KLUN) YD%RDEGREW
WRITE (KLUN) YD%RMISSW
WRITE (KLUN) YD%LWCOU
WRITE (KLUN) YD%LWCOU2W
WRITE (KLUN) YD%LWCOUNORMS
WRITE (KLUN) YD%LWCUR
WRITE (KLUN) YD%LWCOURNW
WRITE (KLUN) YD%LWCOUHMF
WRITE (KLUN) YD%LWSTOKES
WRITE (KLUN) YD%LWFLUX
WRITE (KLUN) YD%CBEGDAT
LMASK_WAVE_IN = ALLOCATED (YD%MASK_WAVE_IN)
WRITE (KLUN) LMASK_WAVE_IN
IF (LMASK_WAVE_IN) THEN
  WRITE (KLUN) LBOUND (YD%MASK_WAVE_IN)
  WRITE (KLUN) UBOUND (YD%MASK_WAVE_IN)
  WRITE (KLUN) YD%MASK_WAVE_IN
ENDIF
LMASK_WAVE_OUT = ALLOCATED (YD%MASK_WAVE_OUT)
WRITE (KLUN) LMASK_WAVE_OUT
IF (LMASK_WAVE_OUT) THEN
  WRITE (KLUN) LBOUND (YD%MASK_WAVE_OUT)
  WRITE (KLUN) UBOUND (YD%MASK_WAVE_OUT)
  WRITE (KLUN) YD%MASK_WAVE_OUT
ENDIF
WRITE (KLUN) YD%LWVIN_MASK_NOT_SET
WRITE (KLUN) YD%LWVOUT_MASK_NOT_SET
WRITE (KLUN) YD%LWVIN_UNINITIALISED
WRITE (KLUN) YD%MWVIN_SENDTOT
WRITE (KLUN) YD%MWVIN_RECVTOT
LMWVIN_SENDCNT = ALLOCATED (YD%MWVIN_SENDCNT)
WRITE (KLUN) LMWVIN_SENDCNT
IF (LMWVIN_SENDCNT) THEN
  WRITE (KLUN) LBOUND (YD%MWVIN_SENDCNT)
  WRITE (KLUN) UBOUND (YD%MWVIN_SENDCNT)
  WRITE (KLUN) YD%MWVIN_SENDCNT
ENDIF
LMWVIN_RECVCNT = ALLOCATED (YD%MWVIN_RECVCNT)
WRITE (KLUN) LMWVIN_RECVCNT
IF (LMWVIN_RECVCNT) THEN
  WRITE (KLUN) LBOUND (YD%MWVIN_RECVCNT)
  WRITE (KLUN) UBOUND (YD%MWVIN_RECVCNT)
  WRITE (KLUN) YD%MWVIN_RECVCNT
ENDIF
LMWVIN_SENDOFF = ALLOCATED (YD%MWVIN_SENDOFF)
WRITE (KLUN) LMWVIN_SENDOFF
IF (LMWVIN_SENDOFF) THEN
  WRITE (KLUN) LBOUND (YD%MWVIN_SENDOFF)
  WRITE (KLUN) UBOUND (YD%MWVIN_SENDOFF)
  WRITE (KLUN) YD%MWVIN_SENDOFF
ENDIF
LMWVIN_RECVOFF = ALLOCATED (YD%MWVIN_RECVOFF)
WRITE (KLUN) LMWVIN_RECVOFF
IF (LMWVIN_RECVOFF) THEN
  WRITE (KLUN) LBOUND (YD%MWVIN_RECVOFF)
  WRITE (KLUN) UBOUND (YD%MWVIN_RECVOFF)
  WRITE (KLUN) YD%MWVIN_RECVOFF
ENDIF
LMWVIN_SENDBUF = ALLOCATED (YD%MWVIN_SENDBUF)
WRITE (KLUN) LMWVIN_SENDBUF
IF (LMWVIN_SENDBUF) THEN
  WRITE (KLUN) LBOUND (YD%MWVIN_SENDBUF)
  WRITE (KLUN) UBOUND (YD%MWVIN_SENDBUF)
  WRITE (KLUN) YD%MWVIN_SENDBUF
ENDIF
LMWVIN_RECVBUF = ALLOCATED (YD%MWVIN_RECVBUF)
WRITE (KLUN) LMWVIN_RECVBUF
IF (LMWVIN_RECVBUF) THEN
  WRITE (KLUN) LBOUND (YD%MWVIN_RECVBUF)
  WRITE (KLUN) UBOUND (YD%MWVIN_RECVBUF)
  WRITE (KLUN) YD%MWVIN_RECVBUF
ENDIF
LMWVIN_SENDIND = ALLOCATED (YD%MWVIN_SENDIND)
WRITE (KLUN) LMWVIN_SENDIND
IF (LMWVIN_SENDIND) THEN
  WRITE (KLUN) LBOUND (YD%MWVIN_SENDIND)
  WRITE (KLUN) UBOUND (YD%MWVIN_SENDIND)
  WRITE (KLUN) YD%MWVIN_SENDIND
ENDIF
WRITE (KLUN) YD%LWFRSTIME
WRITE (KLUN) YD%LWINIT
WRITE (KLUN) YD%NADV_WAVE
WRITE (KLUN) YD%NWV_W2IWGHT
LIWV_LON = ALLOCATED (YD%IWV_LON)
WRITE (KLUN) LIWV_LON
IF (LIWV_LON) THEN
  WRITE (KLUN) LBOUND (YD%IWV_LON)
  WRITE (KLUN) UBOUND (YD%IWV_LON)
  WRITE (KLUN) YD%IWV_LON
ENDIF
LIWV_LAT = ALLOCATED (YD%IWV_LAT)
WRITE (KLUN) LIWV_LAT
IF (LIWV_LAT) THEN
  WRITE (KLUN) LBOUND (YD%IWV_LAT)
  WRITE (KLUN) UBOUND (YD%IWV_LAT)
  WRITE (KLUN) YD%IWV_LAT
ENDIF
LWV_W2IWGHT = ALLOCATED (YD%WV_W2IWGHT)
WRITE (KLUN) LWV_W2IWGHT
IF (LWV_W2IWGHT) THEN
  WRITE (KLUN) LBOUND (YD%WV_W2IWGHT)
  WRITE (KLUN) UBOUND (YD%WV_W2IWGHT)
  WRITE (KLUN) YD%WV_W2IWGHT
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_TEWCOU (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TEWCOU), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2)
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
READ (KLUN) YD%NATMFLX
READ (KLUN) YD%NGAUSSW
READ (KLUN) YD%NLONW
READ (KLUN) YD%NLATW
READ (KLUN) YD%NLON1W
READ (KLUN) YD%NLAT1W
READ (KLUN) YD%NNORXW
READ (KLUN) YD%NSTPW
READ (KLUN) YD%NGRIB_HANDLE_FOR_WAM
READ (KLUN) ZTMP0
YD%RSOUTW = ZTMP0
READ (KLUN) ZTMP0
YD%RNORTW = ZTMP0
READ (KLUN) ZTMP0
YD%RDEGREW = ZTMP0
READ (KLUN) ZTMP0
YD%RMISSW = ZTMP0
READ (KLUN) YD%LWCOU
READ (KLUN) YD%LWCOU2W
READ (KLUN) YD%LWCOUNORMS
READ (KLUN) YD%LWCUR
READ (KLUN) YD%LWCOURNW
READ (KLUN) YD%LWCOUHMF
READ (KLUN) YD%LWSTOKES
READ (KLUN) YD%LWFLUX
READ (KLUN) YD%CBEGDAT
READ (KLUN) LMASK_WAVE_IN
IF (LMASK_WAVE_IN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%MASK_WAVE_IN (IL1(1):IU1(1)))
  READ (KLUN) YD%MASK_WAVE_IN
ENDIF
READ (KLUN) LMASK_WAVE_OUT
IF (LMASK_WAVE_OUT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%MASK_WAVE_OUT (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%MASK_WAVE_OUT
ENDIF
READ (KLUN) YD%LWVIN_MASK_NOT_SET
READ (KLUN) YD%LWVOUT_MASK_NOT_SET
READ (KLUN) YD%LWVIN_UNINITIALISED
READ (KLUN) YD%MWVIN_SENDTOT
READ (KLUN) YD%MWVIN_RECVTOT
READ (KLUN) LMWVIN_SENDCNT
IF (LMWVIN_SENDCNT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%MWVIN_SENDCNT (IL1(1):IU1(1)))
  READ (KLUN) YD%MWVIN_SENDCNT
ENDIF
READ (KLUN) LMWVIN_RECVCNT
IF (LMWVIN_RECVCNT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%MWVIN_RECVCNT (IL1(1):IU1(1)))
  READ (KLUN) YD%MWVIN_RECVCNT
ENDIF
READ (KLUN) LMWVIN_SENDOFF
IF (LMWVIN_SENDOFF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%MWVIN_SENDOFF (IL1(1):IU1(1)))
  READ (KLUN) YD%MWVIN_SENDOFF
ENDIF
READ (KLUN) LMWVIN_RECVOFF
IF (LMWVIN_RECVOFF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%MWVIN_RECVOFF (IL1(1):IU1(1)))
  READ (KLUN) YD%MWVIN_RECVOFF
ENDIF
READ (KLUN) LMWVIN_SENDBUF
IF (LMWVIN_SENDBUF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%MWVIN_SENDBUF (IL1(1):IU1(1)))
  READ (KLUN) YD%MWVIN_SENDBUF
ENDIF
READ (KLUN) LMWVIN_RECVBUF
IF (LMWVIN_RECVBUF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%MWVIN_RECVBUF (IL1(1):IU1(1)))
  READ (KLUN) YD%MWVIN_RECVBUF
ENDIF
READ (KLUN) LMWVIN_SENDIND
IF (LMWVIN_SENDIND) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%MWVIN_SENDIND (IL1(1):IU1(1)))
  READ (KLUN) YD%MWVIN_SENDIND
ENDIF
READ (KLUN) YD%LWFRSTIME
READ (KLUN) YD%LWINIT
READ (KLUN) YD%NADV_WAVE
READ (KLUN) YD%NWV_W2IWGHT
READ (KLUN) LIWV_LON
IF (LIWV_LON) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%IWV_LON (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%IWV_LON
ENDIF
READ (KLUN) LIWV_LAT
IF (LIWV_LAT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%IWV_LAT (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%IWV_LAT
ENDIF
READ (KLUN) LWV_W2IWGHT
IF (LWV_W2IWGHT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%WV_W2IWGHT (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%WV_W2IWGHT,1):UBOUND(YD%WV_W2IWGHT,1), LBOUND(YD%WV_W2IWGHT,2):UBOUND(YD%WV_W2IWGHT,2)))
  READ (KLUN) ZTMP2
  YD%WV_W2IWGHT = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_TEWCOU (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TEWCOU), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF






















LMASK_WAVE_IN = ALLOCATED (YD%MASK_WAVE_IN)
IF (LMASK_WAVE_IN) THEN
  !$ACC ENTER DATA CREATE (YD%MASK_WAVE_IN)
  !$ACC UPDATE DEVICE (YD%MASK_WAVE_IN)
  !$ACC ENTER DATA ATTACH (YD%MASK_WAVE_IN)
ENDIF

LMASK_WAVE_OUT = ALLOCATED (YD%MASK_WAVE_OUT)
IF (LMASK_WAVE_OUT) THEN
  !$ACC ENTER DATA CREATE (YD%MASK_WAVE_OUT)
  !$ACC UPDATE DEVICE (YD%MASK_WAVE_OUT)
  !$ACC ENTER DATA ATTACH (YD%MASK_WAVE_OUT)
ENDIF






LMWVIN_SENDCNT = ALLOCATED (YD%MWVIN_SENDCNT)
IF (LMWVIN_SENDCNT) THEN
  !$ACC ENTER DATA CREATE (YD%MWVIN_SENDCNT)
  !$ACC UPDATE DEVICE (YD%MWVIN_SENDCNT)
  !$ACC ENTER DATA ATTACH (YD%MWVIN_SENDCNT)
ENDIF

LMWVIN_RECVCNT = ALLOCATED (YD%MWVIN_RECVCNT)
IF (LMWVIN_RECVCNT) THEN
  !$ACC ENTER DATA CREATE (YD%MWVIN_RECVCNT)
  !$ACC UPDATE DEVICE (YD%MWVIN_RECVCNT)
  !$ACC ENTER DATA ATTACH (YD%MWVIN_RECVCNT)
ENDIF

LMWVIN_SENDOFF = ALLOCATED (YD%MWVIN_SENDOFF)
IF (LMWVIN_SENDOFF) THEN
  !$ACC ENTER DATA CREATE (YD%MWVIN_SENDOFF)
  !$ACC UPDATE DEVICE (YD%MWVIN_SENDOFF)
  !$ACC ENTER DATA ATTACH (YD%MWVIN_SENDOFF)
ENDIF

LMWVIN_RECVOFF = ALLOCATED (YD%MWVIN_RECVOFF)
IF (LMWVIN_RECVOFF) THEN
  !$ACC ENTER DATA CREATE (YD%MWVIN_RECVOFF)
  !$ACC UPDATE DEVICE (YD%MWVIN_RECVOFF)
  !$ACC ENTER DATA ATTACH (YD%MWVIN_RECVOFF)
ENDIF

LMWVIN_SENDBUF = ALLOCATED (YD%MWVIN_SENDBUF)
IF (LMWVIN_SENDBUF) THEN
  !$ACC ENTER DATA CREATE (YD%MWVIN_SENDBUF)
  !$ACC UPDATE DEVICE (YD%MWVIN_SENDBUF)
  !$ACC ENTER DATA ATTACH (YD%MWVIN_SENDBUF)
ENDIF

LMWVIN_RECVBUF = ALLOCATED (YD%MWVIN_RECVBUF)
IF (LMWVIN_RECVBUF) THEN
  !$ACC ENTER DATA CREATE (YD%MWVIN_RECVBUF)
  !$ACC UPDATE DEVICE (YD%MWVIN_RECVBUF)
  !$ACC ENTER DATA ATTACH (YD%MWVIN_RECVBUF)
ENDIF

LMWVIN_SENDIND = ALLOCATED (YD%MWVIN_SENDIND)
IF (LMWVIN_SENDIND) THEN
  !$ACC ENTER DATA CREATE (YD%MWVIN_SENDIND)
  !$ACC UPDATE DEVICE (YD%MWVIN_SENDIND)
  !$ACC ENTER DATA ATTACH (YD%MWVIN_SENDIND)
ENDIF





LIWV_LON = ALLOCATED (YD%IWV_LON)
IF (LIWV_LON) THEN
  !$ACC ENTER DATA CREATE (YD%IWV_LON)
  !$ACC UPDATE DEVICE (YD%IWV_LON)
  !$ACC ENTER DATA ATTACH (YD%IWV_LON)
ENDIF

LIWV_LAT = ALLOCATED (YD%IWV_LAT)
IF (LIWV_LAT) THEN
  !$ACC ENTER DATA CREATE (YD%IWV_LAT)
  !$ACC UPDATE DEVICE (YD%IWV_LAT)
  !$ACC ENTER DATA ATTACH (YD%IWV_LAT)
ENDIF

LWV_W2IWGHT = ALLOCATED (YD%WV_W2IWGHT)
IF (LWV_W2IWGHT) THEN
  !$ACC ENTER DATA CREATE (YD%WV_W2IWGHT)
  !$ACC UPDATE DEVICE (YD%WV_W2IWGHT)
  !$ACC ENTER DATA ATTACH (YD%WV_W2IWGHT)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_TEWCOU (YD)

IMPLICIT NONE
TYPE (TEWCOU), TARGET :: YD
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT











































END SUBROUTINE

     

SUBROUTINE CRC64_TEWCOU (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TEWCOU), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NATMFLX), CDPATH//'%NATMFLX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NGAUSSW), CDPATH//'%NGAUSSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLONW), CDPATH//'%NLONW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLATW), CDPATH//'%NLATW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLON1W), CDPATH//'%NLON1W'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLAT1W), CDPATH//'%NLAT1W'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NNORXW), CDPATH//'%NNORXW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSTPW), CDPATH//'%NSTPW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NGRIB_HANDLE_FOR_WAM), CDPATH//'%NGRIB_HANDLE_FOR_WAM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSOUTW), CDPATH//'%RSOUTW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RNORTW), CDPATH//'%RNORTW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDEGREW), CDPATH//'%RDEGREW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RMISSW), CDPATH//'%RMISSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWCOU), CDPATH//'%LWCOU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWCOU2W), CDPATH//'%LWCOU2W'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWCOUNORMS), CDPATH//'%LWCOUNORMS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWCUR), CDPATH//'%LWCUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWCOURNW), CDPATH//'%LWCOURNW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWCOUHMF), CDPATH//'%LWCOUHMF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWSTOKES), CDPATH//'%LWSTOKES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWFLUX), CDPATH//'%LWFLUX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CBEGDAT), CDPATH//'%CBEGDAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MASK_WAVE_IN), CDPATH//'%MASK_WAVE_IN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MASK_WAVE_OUT), CDPATH//'%MASK_WAVE_OUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWVIN_MASK_NOT_SET), CDPATH//'%LWVIN_MASK_NOT_SET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWVOUT_MASK_NOT_SET), CDPATH//'%LWVOUT_MASK_NOT_SET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWVIN_UNINITIALISED), CDPATH//'%LWVIN_UNINITIALISED'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MWVIN_SENDTOT), CDPATH//'%MWVIN_SENDTOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MWVIN_RECVTOT), CDPATH//'%MWVIN_RECVTOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MWVIN_SENDCNT), CDPATH//'%MWVIN_SENDCNT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MWVIN_RECVCNT), CDPATH//'%MWVIN_RECVCNT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MWVIN_SENDOFF), CDPATH//'%MWVIN_SENDOFF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MWVIN_RECVOFF), CDPATH//'%MWVIN_RECVOFF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MWVIN_SENDBUF), CDPATH//'%MWVIN_SENDBUF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MWVIN_RECVBUF), CDPATH//'%MWVIN_RECVBUF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MWVIN_SENDIND), CDPATH//'%MWVIN_SENDIND'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWFRSTIME), CDPATH//'%LWFRSTIME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWINIT), CDPATH//'%LWINIT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NADV_WAVE), CDPATH//'%NADV_WAVE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NWV_W2IWGHT), CDPATH//'%NWV_W2IWGHT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IWV_LON), CDPATH//'%IWV_LON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IWV_LAT), CDPATH//'%IWV_LAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%WV_W2IWGHT), CDPATH//'%WV_W2IWGHT'

END SUBROUTINE

SUBROUTINE WIPE_TEWCOU (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TEWCOU), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF






















LMASK_WAVE_IN = ALLOCATED (YD%MASK_WAVE_IN)
IF (LMASK_WAVE_IN) THEN
  !$ACC EXIT DATA DETACH (YD%MASK_WAVE_IN)
  !$ACC EXIT DATA DETACH (YD%MASK_WAVE_IN)
ENDIF

LMASK_WAVE_OUT = ALLOCATED (YD%MASK_WAVE_OUT)
IF (LMASK_WAVE_OUT) THEN
  !$ACC EXIT DATA DETACH (YD%MASK_WAVE_OUT)
  !$ACC EXIT DATA DETACH (YD%MASK_WAVE_OUT)
ENDIF






LMWVIN_SENDCNT = ALLOCATED (YD%MWVIN_SENDCNT)
IF (LMWVIN_SENDCNT) THEN
  !$ACC EXIT DATA DETACH (YD%MWVIN_SENDCNT)
  !$ACC EXIT DATA DETACH (YD%MWVIN_SENDCNT)
ENDIF

LMWVIN_RECVCNT = ALLOCATED (YD%MWVIN_RECVCNT)
IF (LMWVIN_RECVCNT) THEN
  !$ACC EXIT DATA DETACH (YD%MWVIN_RECVCNT)
  !$ACC EXIT DATA DETACH (YD%MWVIN_RECVCNT)
ENDIF

LMWVIN_SENDOFF = ALLOCATED (YD%MWVIN_SENDOFF)
IF (LMWVIN_SENDOFF) THEN
  !$ACC EXIT DATA DETACH (YD%MWVIN_SENDOFF)
  !$ACC EXIT DATA DETACH (YD%MWVIN_SENDOFF)
ENDIF

LMWVIN_RECVOFF = ALLOCATED (YD%MWVIN_RECVOFF)
IF (LMWVIN_RECVOFF) THEN
  !$ACC EXIT DATA DETACH (YD%MWVIN_RECVOFF)
  !$ACC EXIT DATA DETACH (YD%MWVIN_RECVOFF)
ENDIF

LMWVIN_SENDBUF = ALLOCATED (YD%MWVIN_SENDBUF)
IF (LMWVIN_SENDBUF) THEN
  !$ACC EXIT DATA DETACH (YD%MWVIN_SENDBUF)
  !$ACC EXIT DATA DETACH (YD%MWVIN_SENDBUF)
ENDIF

LMWVIN_RECVBUF = ALLOCATED (YD%MWVIN_RECVBUF)
IF (LMWVIN_RECVBUF) THEN
  !$ACC EXIT DATA DETACH (YD%MWVIN_RECVBUF)
  !$ACC EXIT DATA DETACH (YD%MWVIN_RECVBUF)
ENDIF

LMWVIN_SENDIND = ALLOCATED (YD%MWVIN_SENDIND)
IF (LMWVIN_SENDIND) THEN
  !$ACC EXIT DATA DETACH (YD%MWVIN_SENDIND)
  !$ACC EXIT DATA DETACH (YD%MWVIN_SENDIND)
ENDIF





LIWV_LON = ALLOCATED (YD%IWV_LON)
IF (LIWV_LON) THEN
  !$ACC EXIT DATA DETACH (YD%IWV_LON)
  !$ACC EXIT DATA DETACH (YD%IWV_LON)
ENDIF

LIWV_LAT = ALLOCATED (YD%IWV_LAT)
IF (LIWV_LAT) THEN
  !$ACC EXIT DATA DETACH (YD%IWV_LAT)
  !$ACC EXIT DATA DETACH (YD%IWV_LAT)
ENDIF

LWV_W2IWGHT = ALLOCATED (YD%WV_W2IWGHT)
IF (LWV_W2IWGHT) THEN
  !$ACC EXIT DATA DETACH (YD%WV_W2IWGHT)
  !$ACC EXIT DATA DETACH (YD%WV_W2IWGHT)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TEWCOU (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TEWCOU),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%NATMFLX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NATMFLX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NGAUSSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NGAUSSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLONW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLONW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLATW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLATW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLON1W)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLON1W'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLAT1W)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLAT1W'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NNORXW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NNORXW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSTPW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSTPW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NGRIB_HANDLE_FOR_WAM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NGRIB_HANDLE_FOR_WAM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSOUTW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSOUTW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RNORTW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNORTW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDEGREW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDEGREW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RMISSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RMISSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWCOU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWCOU2W)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOU2W'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWCOUNORMS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOUNORMS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWCUR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCUR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWCOURNW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOURNW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWCOUHMF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOUHMF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWSTOKES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWSTOKES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWFLUX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWFLUX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CBEGDAT) * LEN (YD%CBEGDAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CBEGDAT'
ENDIF
KSIZE = KSIZE + ISIZE
LMASK_WAVE_IN = ALLOCATED (YD%MASK_WAVE_IN)
IF (LMASK_WAVE_IN) THEN
  ISIZE = KIND (YD%MASK_WAVE_IN) * SIZE (YD%MASK_WAVE_IN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MASK_WAVE_IN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMASK_WAVE_OUT = ALLOCATED (YD%MASK_WAVE_OUT)
IF (LMASK_WAVE_OUT) THEN
  ISIZE = KIND (YD%MASK_WAVE_OUT) * SIZE (YD%MASK_WAVE_OUT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MASK_WAVE_OUT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%LWVIN_MASK_NOT_SET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWVIN_MASK_NOT_SET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWVOUT_MASK_NOT_SET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWVOUT_MASK_NOT_SET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWVIN_UNINITIALISED)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWVIN_UNINITIALISED'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%MWVIN_SENDTOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDTOT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%MWVIN_RECVTOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MWVIN_RECVTOT'
ENDIF
KSIZE = KSIZE + ISIZE
LMWVIN_SENDCNT = ALLOCATED (YD%MWVIN_SENDCNT)
IF (LMWVIN_SENDCNT) THEN
  ISIZE = KIND (YD%MWVIN_SENDCNT) * SIZE (YD%MWVIN_SENDCNT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDCNT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_RECVCNT = ALLOCATED (YD%MWVIN_RECVCNT)
IF (LMWVIN_RECVCNT) THEN
  ISIZE = KIND (YD%MWVIN_RECVCNT) * SIZE (YD%MWVIN_RECVCNT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_RECVCNT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_SENDOFF = ALLOCATED (YD%MWVIN_SENDOFF)
IF (LMWVIN_SENDOFF) THEN
  ISIZE = KIND (YD%MWVIN_SENDOFF) * SIZE (YD%MWVIN_SENDOFF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDOFF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_RECVOFF = ALLOCATED (YD%MWVIN_RECVOFF)
IF (LMWVIN_RECVOFF) THEN
  ISIZE = KIND (YD%MWVIN_RECVOFF) * SIZE (YD%MWVIN_RECVOFF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_RECVOFF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_SENDBUF = ALLOCATED (YD%MWVIN_SENDBUF)
IF (LMWVIN_SENDBUF) THEN
  ISIZE = KIND (YD%MWVIN_SENDBUF) * SIZE (YD%MWVIN_SENDBUF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDBUF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_RECVBUF = ALLOCATED (YD%MWVIN_RECVBUF)
IF (LMWVIN_RECVBUF) THEN
  ISIZE = KIND (YD%MWVIN_RECVBUF) * SIZE (YD%MWVIN_RECVBUF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_RECVBUF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_SENDIND = ALLOCATED (YD%MWVIN_SENDIND)
IF (LMWVIN_SENDIND) THEN
  ISIZE = KIND (YD%MWVIN_SENDIND) * SIZE (YD%MWVIN_SENDIND)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDIND'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%LWFRSTIME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWFRSTIME'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWINIT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWINIT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NADV_WAVE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NADV_WAVE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NWV_W2IWGHT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NWV_W2IWGHT'
ENDIF
KSIZE = KSIZE + ISIZE
LIWV_LON = ALLOCATED (YD%IWV_LON)
IF (LIWV_LON) THEN
  ISIZE = KIND (YD%IWV_LON) * SIZE (YD%IWV_LON)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%IWV_LON'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LIWV_LAT = ALLOCATED (YD%IWV_LAT)
IF (LIWV_LAT) THEN
  ISIZE = KIND (YD%IWV_LAT) * SIZE (YD%IWV_LAT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%IWV_LAT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LWV_W2IWGHT = ALLOCATED (YD%WV_W2IWGHT)
IF (LWV_W2IWGHT) THEN
  ISIZE = KIND (YD%WV_W2IWGHT) * SIZE (YD%WV_W2IWGHT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%WV_W2IWGHT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
