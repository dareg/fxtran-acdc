MODULE UTIL_CPG_GPAR_TYPE_MOD

USE CPG_TYPE_MOD, ONLY : CPG_GPAR_TYPE



INTERFACE COPY
MODULE PROCEDURE COPY_CPG_GPAR_TYPE
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_CPG_GPAR_TYPE
END INTERFACE

     

INTERFACE WIPE
MODULE PROCEDURE WIPE_CPG_GPAR_TYPE
END INTERFACE



CONTAINS





SUBROUTINE COPY_CPG_GPAR_TYPE (YD, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
TYPE (CPG_GPAR_TYPE), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LF_ACPRG, LF_ACPRR, LF_ACPRS, LF_ALBDIR, LF_ALBSCA, LF_CD, LF_CH, LF_DATA, LF_GZ0, LF_GZ0H
LOGICAL :: LF_INPRG, LF_INPRR, LF_INPRS, LF_LSM, LF_RAIN, LF_SNOW, LF_SWDIF, LF_SWDIR, LF_VEMIS, LF_VQS
LOGICAL :: LF_VTS, LZDATA, LZVIEW

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF

LZVIEW = ASSOCIATED (YD%ZVIEW)
IF (LZVIEW) THEN
  !$ACC ENTER DATA CREATE (YD%ZVIEW)
  !$ACC UPDATE DEVICE (YD%ZVIEW)
  !$ACC ENTER DATA ATTACH (YD%ZVIEW)
ENDIF

LZDATA = ASSOCIATED (YD%ZDATA)
IF (LZDATA) THEN
  !$ACC ENTER DATA CREATE (YD%ZDATA)
  !$ACC UPDATE DEVICE (YD%ZDATA)
  !$ACC ENTER DATA ATTACH (YD%ZDATA)
ENDIF

LF_DATA = ASSOCIATED (YD%F_DATA)
IF (LF_DATA .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (YD%F_DATA)
  !$ACC ENTER DATA ATTACH (YD%F_DATA)
ENDIF

LF_INPRR = ASSOCIATED (YD%F_INPRR)
IF (LF_INPRR .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_INPRR)
  !$ACC ENTER DATA ATTACH (YD%F_INPRR)
ENDIF

LF_INPRS = ASSOCIATED (YD%F_INPRS)
IF (LF_INPRS .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_INPRS)
  !$ACC ENTER DATA ATTACH (YD%F_INPRS)
ENDIF

LF_INPRG = ASSOCIATED (YD%F_INPRG)
IF (LF_INPRG .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_INPRG)
  !$ACC ENTER DATA ATTACH (YD%F_INPRG)
ENDIF

LF_ACPRR = ASSOCIATED (YD%F_ACPRR)
IF (LF_ACPRR .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_ACPRR)
  !$ACC ENTER DATA ATTACH (YD%F_ACPRR)
ENDIF

LF_ACPRS = ASSOCIATED (YD%F_ACPRS)
IF (LF_ACPRS .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_ACPRS)
  !$ACC ENTER DATA ATTACH (YD%F_ACPRS)
ENDIF

LF_ACPRG = ASSOCIATED (YD%F_ACPRG)
IF (LF_ACPRG .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_ACPRG)
  !$ACC ENTER DATA ATTACH (YD%F_ACPRG)
ENDIF

LF_ALBDIR = ASSOCIATED (YD%F_ALBDIR)
IF (LF_ALBDIR .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (YD%F_ALBDIR)
  !$ACC ENTER DATA ATTACH (YD%F_ALBDIR)
ENDIF

LF_ALBSCA = ASSOCIATED (YD%F_ALBSCA)
IF (LF_ALBSCA .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (YD%F_ALBSCA)
  !$ACC ENTER DATA ATTACH (YD%F_ALBSCA)
ENDIF

LF_RAIN = ASSOCIATED (YD%F_RAIN)
IF (LF_RAIN .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_RAIN)
  !$ACC ENTER DATA ATTACH (YD%F_RAIN)
ENDIF

LF_SNOW = ASSOCIATED (YD%F_SNOW)
IF (LF_SNOW .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_SNOW)
  !$ACC ENTER DATA ATTACH (YD%F_SNOW)
ENDIF

LF_GZ0 = ASSOCIATED (YD%F_GZ0)
IF (LF_GZ0 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_GZ0)
  !$ACC ENTER DATA ATTACH (YD%F_GZ0)
ENDIF

LF_GZ0H = ASSOCIATED (YD%F_GZ0H)
IF (LF_GZ0H .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_GZ0H)
  !$ACC ENTER DATA ATTACH (YD%F_GZ0H)
ENDIF

LF_VQS = ASSOCIATED (YD%F_VQS)
IF (LF_VQS .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_VQS)
  !$ACC ENTER DATA ATTACH (YD%F_VQS)
ENDIF

LF_VTS = ASSOCIATED (YD%F_VTS)
IF (LF_VTS .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_VTS)
  !$ACC ENTER DATA ATTACH (YD%F_VTS)
ENDIF

LF_VEMIS = ASSOCIATED (YD%F_VEMIS)
IF (LF_VEMIS .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_VEMIS)
  !$ACC ENTER DATA ATTACH (YD%F_VEMIS)
ENDIF

LF_SWDIR = ASSOCIATED (YD%F_SWDIR)
IF (LF_SWDIR .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (YD%F_SWDIR)
  !$ACC ENTER DATA ATTACH (YD%F_SWDIR)
ENDIF

LF_SWDIF = ASSOCIATED (YD%F_SWDIF)
IF (LF_SWDIF .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (YD%F_SWDIF)
  !$ACC ENTER DATA ATTACH (YD%F_SWDIF)
ENDIF

LF_LSM = ASSOCIATED (YD%F_LSM)
IF (LF_LSM .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_LSM)
  !$ACC ENTER DATA ATTACH (YD%F_LSM)
ENDIF

LF_CD = ASSOCIATED (YD%F_CD)
IF (LF_CD .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CD)
  !$ACC ENTER DATA ATTACH (YD%F_CD)
ENDIF

LF_CH = ASSOCIATED (YD%F_CH)
IF (LF_CH .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CH)
  !$ACC ENTER DATA ATTACH (YD%F_CH)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_CPG_GPAR_TYPE (YD)
USE FIELD_UTIL_MODULE

IMPLICIT NONE
TYPE (CPG_GPAR_TYPE), TARGET :: YD
LOGICAL :: LF_ACPRG, LF_ACPRR, LF_ACPRS, LF_ALBDIR, LF_ALBSCA, LF_CD, LF_CH, LF_DATA, LF_GZ0, LF_GZ0H
LOGICAL :: LF_INPRG, LF_INPRR, LF_INPRS, LF_LSM, LF_RAIN, LF_SNOW, LF_SWDIF, LF_SWDIR, LF_VEMIS, LF_VQS
LOGICAL :: LF_VTS, LZDATA, LZVIEW



LF_DATA = ASSOCIATED (YD%F_DATA)
IF (LF_DATA) THEN
  CALL HOST_FIELD_3RB (YD%F_DATA)
ENDIF

LF_INPRR = ASSOCIATED (YD%F_INPRR)
IF (LF_INPRR) THEN
  CALL HOST_FIELD_2RB (YD%F_INPRR)
ENDIF

LF_INPRS = ASSOCIATED (YD%F_INPRS)
IF (LF_INPRS) THEN
  CALL HOST_FIELD_2RB (YD%F_INPRS)
ENDIF

LF_INPRG = ASSOCIATED (YD%F_INPRG)
IF (LF_INPRG) THEN
  CALL HOST_FIELD_2RB (YD%F_INPRG)
ENDIF

LF_ACPRR = ASSOCIATED (YD%F_ACPRR)
IF (LF_ACPRR) THEN
  CALL HOST_FIELD_2RB (YD%F_ACPRR)
ENDIF

LF_ACPRS = ASSOCIATED (YD%F_ACPRS)
IF (LF_ACPRS) THEN
  CALL HOST_FIELD_2RB (YD%F_ACPRS)
ENDIF

LF_ACPRG = ASSOCIATED (YD%F_ACPRG)
IF (LF_ACPRG) THEN
  CALL HOST_FIELD_2RB (YD%F_ACPRG)
ENDIF

LF_ALBDIR = ASSOCIATED (YD%F_ALBDIR)
IF (LF_ALBDIR) THEN
  CALL HOST_FIELD_3RB (YD%F_ALBDIR)
ENDIF

LF_ALBSCA = ASSOCIATED (YD%F_ALBSCA)
IF (LF_ALBSCA) THEN
  CALL HOST_FIELD_3RB (YD%F_ALBSCA)
ENDIF

LF_RAIN = ASSOCIATED (YD%F_RAIN)
IF (LF_RAIN) THEN
  CALL HOST_FIELD_2RB (YD%F_RAIN)
ENDIF

LF_SNOW = ASSOCIATED (YD%F_SNOW)
IF (LF_SNOW) THEN
  CALL HOST_FIELD_2RB (YD%F_SNOW)
ENDIF

LF_GZ0 = ASSOCIATED (YD%F_GZ0)
IF (LF_GZ0) THEN
  CALL HOST_FIELD_2RB (YD%F_GZ0)
ENDIF

LF_GZ0H = ASSOCIATED (YD%F_GZ0H)
IF (LF_GZ0H) THEN
  CALL HOST_FIELD_2RB (YD%F_GZ0H)
ENDIF

LF_VQS = ASSOCIATED (YD%F_VQS)
IF (LF_VQS) THEN
  CALL HOST_FIELD_2RB (YD%F_VQS)
ENDIF

LF_VTS = ASSOCIATED (YD%F_VTS)
IF (LF_VTS) THEN
  CALL HOST_FIELD_2RB (YD%F_VTS)
ENDIF

LF_VEMIS = ASSOCIATED (YD%F_VEMIS)
IF (LF_VEMIS) THEN
  CALL HOST_FIELD_2RB (YD%F_VEMIS)
ENDIF

LF_SWDIR = ASSOCIATED (YD%F_SWDIR)
IF (LF_SWDIR) THEN
  CALL HOST_FIELD_3RB (YD%F_SWDIR)
ENDIF

LF_SWDIF = ASSOCIATED (YD%F_SWDIF)
IF (LF_SWDIF) THEN
  CALL HOST_FIELD_3RB (YD%F_SWDIF)
ENDIF

LF_LSM = ASSOCIATED (YD%F_LSM)
IF (LF_LSM) THEN
  CALL HOST_FIELD_2RB (YD%F_LSM)
ENDIF

LF_CD = ASSOCIATED (YD%F_CD)
IF (LF_CD) THEN
  CALL HOST_FIELD_2RB (YD%F_CD)
ENDIF

LF_CH = ASSOCIATED (YD%F_CH)
IF (LF_CH) THEN
  CALL HOST_FIELD_2RB (YD%F_CH)
ENDIF

END SUBROUTINE

     



SUBROUTINE WIPE_CPG_GPAR_TYPE (YD, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
TYPE (CPG_GPAR_TYPE), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LF_ACPRG, LF_ACPRR, LF_ACPRS, LF_ALBDIR, LF_ALBSCA, LF_CD, LF_CH, LF_DATA, LF_GZ0, LF_GZ0H
LOGICAL :: LF_INPRG, LF_INPRR, LF_INPRS, LF_LSM, LF_RAIN, LF_SNOW, LF_SWDIF, LF_SWDIR, LF_VEMIS, LF_VQS
LOGICAL :: LF_VTS, LZDATA, LZVIEW

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LZVIEW = ASSOCIATED (YD%ZVIEW)
IF (LZVIEW) THEN
  !$ACC EXIT DATA DETACH (YD%ZVIEW)
  !$ACC EXIT DATA DETACH (YD%ZVIEW)
ENDIF

LZDATA = ASSOCIATED (YD%ZDATA)
IF (LZDATA) THEN
  !$ACC EXIT DATA DETACH (YD%ZDATA)
  !$ACC EXIT DATA DETACH (YD%ZDATA)
ENDIF

LF_DATA = ASSOCIATED (YD%F_DATA)
IF (LF_DATA .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_3RB (YD%F_DATA)
ENDIF

LF_INPRR = ASSOCIATED (YD%F_INPRR)
IF (LF_INPRR .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_INPRR)
ENDIF

LF_INPRS = ASSOCIATED (YD%F_INPRS)
IF (LF_INPRS .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_INPRS)
ENDIF

LF_INPRG = ASSOCIATED (YD%F_INPRG)
IF (LF_INPRG .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_INPRG)
ENDIF

LF_ACPRR = ASSOCIATED (YD%F_ACPRR)
IF (LF_ACPRR .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_ACPRR)
ENDIF

LF_ACPRS = ASSOCIATED (YD%F_ACPRS)
IF (LF_ACPRS .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_ACPRS)
ENDIF

LF_ACPRG = ASSOCIATED (YD%F_ACPRG)
IF (LF_ACPRG .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_ACPRG)
ENDIF

LF_ALBDIR = ASSOCIATED (YD%F_ALBDIR)
IF (LF_ALBDIR .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_3RB (YD%F_ALBDIR)
ENDIF

LF_ALBSCA = ASSOCIATED (YD%F_ALBSCA)
IF (LF_ALBSCA .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_3RB (YD%F_ALBSCA)
ENDIF

LF_RAIN = ASSOCIATED (YD%F_RAIN)
IF (LF_RAIN .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_RAIN)
ENDIF

LF_SNOW = ASSOCIATED (YD%F_SNOW)
IF (LF_SNOW .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_SNOW)
ENDIF

LF_GZ0 = ASSOCIATED (YD%F_GZ0)
IF (LF_GZ0 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_GZ0)
ENDIF

LF_GZ0H = ASSOCIATED (YD%F_GZ0H)
IF (LF_GZ0H .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_GZ0H)
ENDIF

LF_VQS = ASSOCIATED (YD%F_VQS)
IF (LF_VQS .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_VQS)
ENDIF

LF_VTS = ASSOCIATED (YD%F_VTS)
IF (LF_VTS .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_VTS)
ENDIF

LF_VEMIS = ASSOCIATED (YD%F_VEMIS)
IF (LF_VEMIS .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_VEMIS)
ENDIF

LF_SWDIR = ASSOCIATED (YD%F_SWDIR)
IF (LF_SWDIR .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_3RB (YD%F_SWDIR)
ENDIF

LF_SWDIF = ASSOCIATED (YD%F_SWDIF)
IF (LF_SWDIF .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_3RB (YD%F_SWDIF)
ENDIF

LF_LSM = ASSOCIATED (YD%F_LSM)
IF (LF_LSM .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_LSM)
ENDIF

LF_CD = ASSOCIATED (YD%F_CD)
IF (LF_CD .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CD)
ENDIF

LF_CH = ASSOCIATED (YD%F_CH)
IF (LF_CH .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CH)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE



END MODULE
