MODULE UTIL_TSPDDH_MOD

USE YOMSPDDH, ONLY : TSPDDH

INTERFACE SAVE
MODULE PROCEDURE SAVE_TSPDDH
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TSPDDH
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TSPDDH
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TSPDDH
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TSPDDH
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TSPDDH
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TSPDDH
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TSPDDH (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TSPDDH), INTENT (IN), TARGET :: YD
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR
LSPTNDHD_VOR = ALLOCATED (YD%SPTNDHD_VOR)
WRITE (KLUN) LSPTNDHD_VOR
IF (LSPTNDHD_VOR) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDHD_VOR)
  WRITE (KLUN) UBOUND (YD%SPTNDHD_VOR)
  WRITE (KLUN) YD%SPTNDHD_VOR
ENDIF
LSPTNDHD_DIV = ALLOCATED (YD%SPTNDHD_DIV)
WRITE (KLUN) LSPTNDHD_DIV
IF (LSPTNDHD_DIV) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDHD_DIV)
  WRITE (KLUN) UBOUND (YD%SPTNDHD_DIV)
  WRITE (KLUN) YD%SPTNDHD_DIV
ENDIF
LSPTNDHD_T = ALLOCATED (YD%SPTNDHD_T)
WRITE (KLUN) LSPTNDHD_T
IF (LSPTNDHD_T) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDHD_T)
  WRITE (KLUN) UBOUND (YD%SPTNDHD_T)
  WRITE (KLUN) YD%SPTNDHD_T
ENDIF
LSPTNDHD_SPD = ALLOCATED (YD%SPTNDHD_SPD)
WRITE (KLUN) LSPTNDHD_SPD
IF (LSPTNDHD_SPD) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDHD_SPD)
  WRITE (KLUN) UBOUND (YD%SPTNDHD_SPD)
  WRITE (KLUN) YD%SPTNDHD_SPD
ENDIF
LSPTNDHD_SVD = ALLOCATED (YD%SPTNDHD_SVD)
WRITE (KLUN) LSPTNDHD_SVD
IF (LSPTNDHD_SVD) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDHD_SVD)
  WRITE (KLUN) UBOUND (YD%SPTNDHD_SVD)
  WRITE (KLUN) YD%SPTNDHD_SVD
ENDIF
LSPTNDHD_SNHX = ALLOCATED (YD%SPTNDHD_SNHX)
WRITE (KLUN) LSPTNDHD_SNHX
IF (LSPTNDHD_SNHX) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDHD_SNHX)
  WRITE (KLUN) UBOUND (YD%SPTNDHD_SNHX)
  WRITE (KLUN) YD%SPTNDHD_SNHX
ENDIF
LSPTNDHD_GFL = ALLOCATED (YD%SPTNDHD_GFL)
WRITE (KLUN) LSPTNDHD_GFL
IF (LSPTNDHD_GFL) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDHD_GFL)
  WRITE (KLUN) UBOUND (YD%SPTNDHD_GFL)
  WRITE (KLUN) YD%SPTNDHD_GFL
ENDIF
LSPTNDSI_VOR = ALLOCATED (YD%SPTNDSI_VOR)
WRITE (KLUN) LSPTNDSI_VOR
IF (LSPTNDSI_VOR) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDSI_VOR)
  WRITE (KLUN) UBOUND (YD%SPTNDSI_VOR)
  WRITE (KLUN) YD%SPTNDSI_VOR
ENDIF
LSPTNDSI_DIV = ALLOCATED (YD%SPTNDSI_DIV)
WRITE (KLUN) LSPTNDSI_DIV
IF (LSPTNDSI_DIV) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDSI_DIV)
  WRITE (KLUN) UBOUND (YD%SPTNDSI_DIV)
  WRITE (KLUN) YD%SPTNDSI_DIV
ENDIF
LSPTNDSI_T = ALLOCATED (YD%SPTNDSI_T)
WRITE (KLUN) LSPTNDSI_T
IF (LSPTNDSI_T) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDSI_T)
  WRITE (KLUN) UBOUND (YD%SPTNDSI_T)
  WRITE (KLUN) YD%SPTNDSI_T
ENDIF
LSPTNDSI_SPD = ALLOCATED (YD%SPTNDSI_SPD)
WRITE (KLUN) LSPTNDSI_SPD
IF (LSPTNDSI_SPD) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDSI_SPD)
  WRITE (KLUN) UBOUND (YD%SPTNDSI_SPD)
  WRITE (KLUN) YD%SPTNDSI_SPD
ENDIF
LSPTNDSI_SVD = ALLOCATED (YD%SPTNDSI_SVD)
WRITE (KLUN) LSPTNDSI_SVD
IF (LSPTNDSI_SVD) THEN
  WRITE (KLUN) LBOUND (YD%SPTNDSI_SVD)
  WRITE (KLUN) UBOUND (YD%SPTNDSI_SVD)
  WRITE (KLUN) YD%SPTNDSI_SVD
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_TSPDDH (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TSPDDH), INTENT (OUT), TARGET :: YD
INTEGER :: IL2(2), IU2(2), IL3(3), IU3(3)
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
READ (KLUN) LSPTNDHD_VOR
IF (LSPTNDHD_VOR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDHD_VOR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDHD_VOR,1):UBOUND(YD%SPTNDHD_VOR,1), LBOUND(YD%SPTNDHD_VOR,2):UBOUND(YD%SPTNDHD_VOR,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDHD_VOR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_DIV
IF (LSPTNDHD_DIV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDHD_DIV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDHD_DIV,1):UBOUND(YD%SPTNDHD_DIV,1), LBOUND(YD%SPTNDHD_DIV,2):UBOUND(YD%SPTNDHD_DIV,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDHD_DIV = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_T
IF (LSPTNDHD_T) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDHD_T (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDHD_T,1):UBOUND(YD%SPTNDHD_T,1), LBOUND(YD%SPTNDHD_T,2):UBOUND(YD%SPTNDHD_T,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDHD_T = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_SPD
IF (LSPTNDHD_SPD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDHD_SPD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDHD_SPD,1):UBOUND(YD%SPTNDHD_SPD,1), LBOUND(YD%SPTNDHD_SPD,2):UBOUND(YD%SPTNDHD_SPD,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDHD_SPD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_SVD
IF (LSPTNDHD_SVD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDHD_SVD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDHD_SVD,1):UBOUND(YD%SPTNDHD_SVD,1), LBOUND(YD%SPTNDHD_SVD,2):UBOUND(YD%SPTNDHD_SVD,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDHD_SVD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_SNHX
IF (LSPTNDHD_SNHX) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDHD_SNHX (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDHD_SNHX,1):UBOUND(YD%SPTNDHD_SNHX,1), LBOUND(YD%SPTNDHD_SNHX,2):UBOUND(YD%SPTNDHD_SNHX,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDHD_SNHX = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_GFL
IF (LSPTNDHD_GFL) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SPTNDHD_GFL (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SPTNDHD_GFL,1):UBOUND(YD%SPTNDHD_GFL,1), LBOUND(YD%SPTNDHD_GFL,2):UBOUND(YD%SPTNDHD_GFL,2), LBOUND(YD%SPTNDHD_GFL,3):UBOUND(YD%SPTNDHD_GFL,3)))
  READ (KLUN) ZTMP3
  YD%SPTNDHD_GFL = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LSPTNDSI_VOR
IF (LSPTNDSI_VOR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDSI_VOR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDSI_VOR,1):UBOUND(YD%SPTNDSI_VOR,1), LBOUND(YD%SPTNDSI_VOR,2):UBOUND(YD%SPTNDSI_VOR,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDSI_VOR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDSI_DIV
IF (LSPTNDSI_DIV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDSI_DIV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDSI_DIV,1):UBOUND(YD%SPTNDSI_DIV,1), LBOUND(YD%SPTNDSI_DIV,2):UBOUND(YD%SPTNDSI_DIV,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDSI_DIV = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDSI_T
IF (LSPTNDSI_T) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDSI_T (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDSI_T,1):UBOUND(YD%SPTNDSI_T,1), LBOUND(YD%SPTNDSI_T,2):UBOUND(YD%SPTNDSI_T,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDSI_T = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDSI_SPD
IF (LSPTNDSI_SPD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDSI_SPD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDSI_SPD,1):UBOUND(YD%SPTNDSI_SPD,1), LBOUND(YD%SPTNDSI_SPD,2):UBOUND(YD%SPTNDSI_SPD,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDSI_SPD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDSI_SVD
IF (LSPTNDSI_SVD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTNDSI_SVD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTNDSI_SVD,1):UBOUND(YD%SPTNDSI_SVD,1), LBOUND(YD%SPTNDSI_SVD,2):UBOUND(YD%SPTNDSI_SVD,2)))
  READ (KLUN) ZTMP2
  YD%SPTNDSI_SVD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_TSPDDH (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TSPDDH), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
LSPTNDHD_VOR = ALLOCATED (YD%SPTNDHD_VOR)
IF (LSPTNDHD_VOR) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDHD_VOR)
  !$ACC UPDATE DEVICE (YD%SPTNDHD_VOR)
  !$ACC ENTER DATA ATTACH (YD%SPTNDHD_VOR)
ENDIF

LSPTNDHD_DIV = ALLOCATED (YD%SPTNDHD_DIV)
IF (LSPTNDHD_DIV) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDHD_DIV)
  !$ACC UPDATE DEVICE (YD%SPTNDHD_DIV)
  !$ACC ENTER DATA ATTACH (YD%SPTNDHD_DIV)
ENDIF

LSPTNDHD_T = ALLOCATED (YD%SPTNDHD_T)
IF (LSPTNDHD_T) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDHD_T)
  !$ACC UPDATE DEVICE (YD%SPTNDHD_T)
  !$ACC ENTER DATA ATTACH (YD%SPTNDHD_T)
ENDIF

LSPTNDHD_SPD = ALLOCATED (YD%SPTNDHD_SPD)
IF (LSPTNDHD_SPD) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDHD_SPD)
  !$ACC UPDATE DEVICE (YD%SPTNDHD_SPD)
  !$ACC ENTER DATA ATTACH (YD%SPTNDHD_SPD)
ENDIF

LSPTNDHD_SVD = ALLOCATED (YD%SPTNDHD_SVD)
IF (LSPTNDHD_SVD) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDHD_SVD)
  !$ACC UPDATE DEVICE (YD%SPTNDHD_SVD)
  !$ACC ENTER DATA ATTACH (YD%SPTNDHD_SVD)
ENDIF

LSPTNDHD_SNHX = ALLOCATED (YD%SPTNDHD_SNHX)
IF (LSPTNDHD_SNHX) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDHD_SNHX)
  !$ACC UPDATE DEVICE (YD%SPTNDHD_SNHX)
  !$ACC ENTER DATA ATTACH (YD%SPTNDHD_SNHX)
ENDIF

LSPTNDHD_GFL = ALLOCATED (YD%SPTNDHD_GFL)
IF (LSPTNDHD_GFL) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDHD_GFL)
  !$ACC UPDATE DEVICE (YD%SPTNDHD_GFL)
  !$ACC ENTER DATA ATTACH (YD%SPTNDHD_GFL)
ENDIF

LSPTNDSI_VOR = ALLOCATED (YD%SPTNDSI_VOR)
IF (LSPTNDSI_VOR) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDSI_VOR)
  !$ACC UPDATE DEVICE (YD%SPTNDSI_VOR)
  !$ACC ENTER DATA ATTACH (YD%SPTNDSI_VOR)
ENDIF

LSPTNDSI_DIV = ALLOCATED (YD%SPTNDSI_DIV)
IF (LSPTNDSI_DIV) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDSI_DIV)
  !$ACC UPDATE DEVICE (YD%SPTNDSI_DIV)
  !$ACC ENTER DATA ATTACH (YD%SPTNDSI_DIV)
ENDIF

LSPTNDSI_T = ALLOCATED (YD%SPTNDSI_T)
IF (LSPTNDSI_T) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDSI_T)
  !$ACC UPDATE DEVICE (YD%SPTNDSI_T)
  !$ACC ENTER DATA ATTACH (YD%SPTNDSI_T)
ENDIF

LSPTNDSI_SPD = ALLOCATED (YD%SPTNDSI_SPD)
IF (LSPTNDSI_SPD) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDSI_SPD)
  !$ACC UPDATE DEVICE (YD%SPTNDSI_SPD)
  !$ACC ENTER DATA ATTACH (YD%SPTNDSI_SPD)
ENDIF

LSPTNDSI_SVD = ALLOCATED (YD%SPTNDSI_SVD)
IF (LSPTNDSI_SVD) THEN
  !$ACC ENTER DATA CREATE (YD%SPTNDSI_SVD)
  !$ACC UPDATE DEVICE (YD%SPTNDSI_SVD)
  !$ACC ENTER DATA ATTACH (YD%SPTNDSI_SVD)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_TSPDDH (YD)

IMPLICIT NONE
TYPE (TSPDDH), TARGET :: YD
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR












END SUBROUTINE

     

SUBROUTINE CRC64_TSPDDH (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TSPDDH), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDHD_VOR), CDPATH//'%SPTNDHD_VOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDHD_DIV), CDPATH//'%SPTNDHD_DIV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDHD_T), CDPATH//'%SPTNDHD_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDHD_SPD), CDPATH//'%SPTNDHD_SPD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDHD_SVD), CDPATH//'%SPTNDHD_SVD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDHD_SNHX), CDPATH//'%SPTNDHD_SNHX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDHD_GFL), CDPATH//'%SPTNDHD_GFL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDSI_VOR), CDPATH//'%SPTNDSI_VOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDSI_DIV), CDPATH//'%SPTNDSI_DIV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDSI_T), CDPATH//'%SPTNDSI_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDSI_SPD), CDPATH//'%SPTNDSI_SPD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTNDSI_SVD), CDPATH//'%SPTNDSI_SVD'

END SUBROUTINE

SUBROUTINE WIPE_TSPDDH (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TSPDDH), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LSPTNDHD_VOR = ALLOCATED (YD%SPTNDHD_VOR)
IF (LSPTNDHD_VOR) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_VOR)
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_VOR)
ENDIF

LSPTNDHD_DIV = ALLOCATED (YD%SPTNDHD_DIV)
IF (LSPTNDHD_DIV) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_DIV)
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_DIV)
ENDIF

LSPTNDHD_T = ALLOCATED (YD%SPTNDHD_T)
IF (LSPTNDHD_T) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_T)
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_T)
ENDIF

LSPTNDHD_SPD = ALLOCATED (YD%SPTNDHD_SPD)
IF (LSPTNDHD_SPD) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_SPD)
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_SPD)
ENDIF

LSPTNDHD_SVD = ALLOCATED (YD%SPTNDHD_SVD)
IF (LSPTNDHD_SVD) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_SVD)
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_SVD)
ENDIF

LSPTNDHD_SNHX = ALLOCATED (YD%SPTNDHD_SNHX)
IF (LSPTNDHD_SNHX) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_SNHX)
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_SNHX)
ENDIF

LSPTNDHD_GFL = ALLOCATED (YD%SPTNDHD_GFL)
IF (LSPTNDHD_GFL) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_GFL)
  !$ACC EXIT DATA DETACH (YD%SPTNDHD_GFL)
ENDIF

LSPTNDSI_VOR = ALLOCATED (YD%SPTNDSI_VOR)
IF (LSPTNDSI_VOR) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_VOR)
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_VOR)
ENDIF

LSPTNDSI_DIV = ALLOCATED (YD%SPTNDSI_DIV)
IF (LSPTNDSI_DIV) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_DIV)
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_DIV)
ENDIF

LSPTNDSI_T = ALLOCATED (YD%SPTNDSI_T)
IF (LSPTNDSI_T) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_T)
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_T)
ENDIF

LSPTNDSI_SPD = ALLOCATED (YD%SPTNDSI_SPD)
IF (LSPTNDSI_SPD) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_SPD)
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_SPD)
ENDIF

LSPTNDSI_SVD = ALLOCATED (YD%SPTNDSI_SVD)
IF (LSPTNDSI_SVD) THEN
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_SVD)
  !$ACC EXIT DATA DETACH (YD%SPTNDSI_SVD)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TSPDDH (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TSPDDH),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LSPTNDHD_VOR = ALLOCATED (YD%SPTNDHD_VOR)
IF (LSPTNDHD_VOR) THEN
  ISIZE = KIND (YD%SPTNDHD_VOR) * SIZE (YD%SPTNDHD_VOR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_VOR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_DIV = ALLOCATED (YD%SPTNDHD_DIV)
IF (LSPTNDHD_DIV) THEN
  ISIZE = KIND (YD%SPTNDHD_DIV) * SIZE (YD%SPTNDHD_DIV)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_DIV'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_T = ALLOCATED (YD%SPTNDHD_T)
IF (LSPTNDHD_T) THEN
  ISIZE = KIND (YD%SPTNDHD_T) * SIZE (YD%SPTNDHD_T)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_T'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_SPD = ALLOCATED (YD%SPTNDHD_SPD)
IF (LSPTNDHD_SPD) THEN
  ISIZE = KIND (YD%SPTNDHD_SPD) * SIZE (YD%SPTNDHD_SPD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_SPD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_SVD = ALLOCATED (YD%SPTNDHD_SVD)
IF (LSPTNDHD_SVD) THEN
  ISIZE = KIND (YD%SPTNDHD_SVD) * SIZE (YD%SPTNDHD_SVD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_SVD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_SNHX = ALLOCATED (YD%SPTNDHD_SNHX)
IF (LSPTNDHD_SNHX) THEN
  ISIZE = KIND (YD%SPTNDHD_SNHX) * SIZE (YD%SPTNDHD_SNHX)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_SNHX'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_GFL = ALLOCATED (YD%SPTNDHD_GFL)
IF (LSPTNDHD_GFL) THEN
  ISIZE = KIND (YD%SPTNDHD_GFL) * SIZE (YD%SPTNDHD_GFL)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_GFL'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_VOR = ALLOCATED (YD%SPTNDSI_VOR)
IF (LSPTNDSI_VOR) THEN
  ISIZE = KIND (YD%SPTNDSI_VOR) * SIZE (YD%SPTNDSI_VOR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_VOR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_DIV = ALLOCATED (YD%SPTNDSI_DIV)
IF (LSPTNDSI_DIV) THEN
  ISIZE = KIND (YD%SPTNDSI_DIV) * SIZE (YD%SPTNDSI_DIV)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_DIV'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_T = ALLOCATED (YD%SPTNDSI_T)
IF (LSPTNDSI_T) THEN
  ISIZE = KIND (YD%SPTNDSI_T) * SIZE (YD%SPTNDSI_T)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_T'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_SPD = ALLOCATED (YD%SPTNDSI_SPD)
IF (LSPTNDSI_SPD) THEN
  ISIZE = KIND (YD%SPTNDSI_SPD) * SIZE (YD%SPTNDSI_SPD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_SPD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_SVD = ALLOCATED (YD%SPTNDSI_SVD)
IF (LSPTNDSI_SVD) THEN
  ISIZE = KIND (YD%SPTNDSI_SVD) * SIZE (YD%SPTNDSI_SVD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_SVD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
