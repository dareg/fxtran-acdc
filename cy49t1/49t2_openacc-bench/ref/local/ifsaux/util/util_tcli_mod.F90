MODULE UTIL_TCLI_MOD

USE YOMCLI, ONLY : TCLI

INTERFACE SAVE
MODULE PROCEDURE SAVE_TCLI
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TCLI
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TCLI
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TCLI
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TCLI
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TCLI
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TCLI (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TCLI), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%LIEEE
WRITE (KLUN) YD%LGLOBE
WRITE (KLUN) YD%LZ0THER
WRITE (KLUN) YD%NPINT
WRITE (KLUN) YD%NDATX
WRITE (KLUN) YD%NDATY
WRITE (KLUN) YD%NAEROF
WRITE (KLUN) YD%NGLOBX
WRITE (KLUN) YD%NGLOBY
WRITE (KLUN) YD%NTPMER
WRITE (KLUN) YD%NTPGLA
WRITE (KLUN) YD%NTPDES
WRITE (KLUN) YD%NTPLAC
WRITE (KLUN) YD%NSLICE
WRITE (KLUN) YD%ELONSW
WRITE (KLUN) YD%ELATSW
WRITE (KLUN) YD%ELONNE
WRITE (KLUN) YD%ELATNE
WRITE (KLUN) YD%EDLON
WRITE (KLUN) YD%EDLAT
WRITE (KLUN) YD%SMASK
WRITE (KLUN) YD%SMANQ
WRITE (KLUN) YD%SVEG
WRITE (KLUN) YD%SFCZ0
WRITE (KLUN) YD%RSTR
WRITE (KLUN) YD%RSWR
WRITE (KLUN) YD%STHER
WRITE (KLUN) YD%SALBN
WRITE (KLUN) YD%SALBX
WRITE (KLUN) YD%SALBM
WRITE (KLUN) YD%SALBG
WRITE (KLUN) YD%SALBB
WRITE (KLUN) YD%SALBD
WRITE (KLUN) YD%SEMIN
WRITE (KLUN) YD%SEMIX
WRITE (KLUN) YD%SEMIM
WRITE (KLUN) YD%SEMIG
WRITE (KLUN) YD%SEMIB
WRITE (KLUN) YD%SEMID
WRITE (KLUN) YD%SDEPN
WRITE (KLUN) YD%SDEPX
WRITE (KLUN) YD%SDEPD
WRITE (KLUN) YD%SARGN
WRITE (KLUN) YD%SARGX
WRITE (KLUN) YD%SARGD
WRITE (KLUN) YD%SSABN
WRITE (KLUN) YD%SSABX
WRITE (KLUN) YD%SSABD
WRITE (KLUN) YD%SRSMN
WRITE (KLUN) YD%SRSMX
WRITE (KLUN) YD%SRSMD
WRITE (KLUN) YD%SZZ0N
WRITE (KLUN) YD%SZZ0M
WRITE (KLUN) YD%SZZ0B
WRITE (KLUN) YD%SZZ0U
WRITE (KLUN) YD%SZZ0D
END SUBROUTINE

SUBROUTINE LOAD_TCLI (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TCLI), INTENT (OUT), TARGET :: YD
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) YD%LIEEE
READ (KLUN) YD%LGLOBE
READ (KLUN) YD%LZ0THER
READ (KLUN) YD%NPINT
READ (KLUN) YD%NDATX
READ (KLUN) YD%NDATY
READ (KLUN) YD%NAEROF
READ (KLUN) YD%NGLOBX
READ (KLUN) YD%NGLOBY
READ (KLUN) YD%NTPMER
READ (KLUN) YD%NTPGLA
READ (KLUN) YD%NTPDES
READ (KLUN) YD%NTPLAC
READ (KLUN) YD%NSLICE
READ (KLUN) ZTMP0
YD%ELONSW = ZTMP0
READ (KLUN) ZTMP0
YD%ELATSW = ZTMP0
READ (KLUN) ZTMP0
YD%ELONNE = ZTMP0
READ (KLUN) ZTMP0
YD%ELATNE = ZTMP0
READ (KLUN) ZTMP0
YD%EDLON = ZTMP0
READ (KLUN) ZTMP0
YD%EDLAT = ZTMP0
READ (KLUN) ZTMP0
YD%SMASK = ZTMP0
READ (KLUN) ZTMP0
YD%SMANQ = ZTMP0
READ (KLUN) ZTMP0
YD%SVEG = ZTMP0
READ (KLUN) ZTMP0
YD%SFCZ0 = ZTMP0
READ (KLUN) ZTMP0
YD%RSTR = ZTMP0
READ (KLUN) ZTMP0
YD%RSWR = ZTMP0
READ (KLUN) ZTMP0
YD%STHER = ZTMP0
READ (KLUN) ZTMP0
YD%SALBN = ZTMP0
READ (KLUN) ZTMP0
YD%SALBX = ZTMP0
READ (KLUN) ZTMP0
YD%SALBM = ZTMP0
READ (KLUN) ZTMP0
YD%SALBG = ZTMP0
READ (KLUN) ZTMP0
YD%SALBB = ZTMP0
READ (KLUN) ZTMP0
YD%SALBD = ZTMP0
READ (KLUN) ZTMP0
YD%SEMIN = ZTMP0
READ (KLUN) ZTMP0
YD%SEMIX = ZTMP0
READ (KLUN) ZTMP0
YD%SEMIM = ZTMP0
READ (KLUN) ZTMP0
YD%SEMIG = ZTMP0
READ (KLUN) ZTMP0
YD%SEMIB = ZTMP0
READ (KLUN) ZTMP0
YD%SEMID = ZTMP0
READ (KLUN) ZTMP0
YD%SDEPN = ZTMP0
READ (KLUN) ZTMP0
YD%SDEPX = ZTMP0
READ (KLUN) ZTMP0
YD%SDEPD = ZTMP0
READ (KLUN) ZTMP0
YD%SARGN = ZTMP0
READ (KLUN) ZTMP0
YD%SARGX = ZTMP0
READ (KLUN) ZTMP0
YD%SARGD = ZTMP0
READ (KLUN) ZTMP0
YD%SSABN = ZTMP0
READ (KLUN) ZTMP0
YD%SSABX = ZTMP0
READ (KLUN) ZTMP0
YD%SSABD = ZTMP0
READ (KLUN) ZTMP0
YD%SRSMN = ZTMP0
READ (KLUN) ZTMP0
YD%SRSMX = ZTMP0
READ (KLUN) ZTMP0
YD%SRSMD = ZTMP0
READ (KLUN) ZTMP0
YD%SZZ0N = ZTMP0
READ (KLUN) ZTMP0
YD%SZZ0M = ZTMP0
READ (KLUN) ZTMP0
YD%SZZ0B = ZTMP0
READ (KLUN) ZTMP0
YD%SZZ0U = ZTMP0
READ (KLUN) ZTMP0
YD%SZZ0D = ZTMP0
END SUBROUTINE


SUBROUTINE COPY_TCLI (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TCLI), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
























































END SUBROUTINE

SUBROUTINE HOST_TCLI (YD)

IMPLICIT NONE
TYPE (TCLI), TARGET :: YD

























































END SUBROUTINE

     

SUBROUTINE CRC64_TCLI (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TCLI), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LIEEE), CDPATH//'%LIEEE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LGLOBE), CDPATH//'%LGLOBE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LZ0THER), CDPATH//'%LZ0THER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPINT), CDPATH//'%NPINT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDATX), CDPATH//'%NDATX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDATY), CDPATH//'%NDATY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NAEROF), CDPATH//'%NAEROF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NGLOBX), CDPATH//'%NGLOBX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NGLOBY), CDPATH//'%NGLOBY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTPMER), CDPATH//'%NTPMER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTPGLA), CDPATH//'%NTPGLA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTPDES), CDPATH//'%NTPDES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTPLAC), CDPATH//'%NTPLAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLICE), CDPATH//'%NSLICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ELONSW), CDPATH//'%ELONSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ELATSW), CDPATH//'%ELATSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ELONNE), CDPATH//'%ELONNE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ELATNE), CDPATH//'%ELATNE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%EDLON), CDPATH//'%EDLON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%EDLAT), CDPATH//'%EDLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SMASK), CDPATH//'%SMASK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SMANQ), CDPATH//'%SMANQ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SVEG), CDPATH//'%SVEG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SFCZ0), CDPATH//'%SFCZ0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSTR), CDPATH//'%RSTR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSWR), CDPATH//'%RSWR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%STHER), CDPATH//'%STHER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SALBN), CDPATH//'%SALBN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SALBX), CDPATH//'%SALBX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SALBM), CDPATH//'%SALBM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SALBG), CDPATH//'%SALBG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SALBB), CDPATH//'%SALBB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SALBD), CDPATH//'%SALBD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SEMIN), CDPATH//'%SEMIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SEMIX), CDPATH//'%SEMIX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SEMIM), CDPATH//'%SEMIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SEMIG), CDPATH//'%SEMIG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SEMIB), CDPATH//'%SEMIB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SEMID), CDPATH//'%SEMID'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SDEPN), CDPATH//'%SDEPN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SDEPX), CDPATH//'%SDEPX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SDEPD), CDPATH//'%SDEPD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SARGN), CDPATH//'%SARGN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SARGX), CDPATH//'%SARGX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SARGD), CDPATH//'%SARGD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SSABN), CDPATH//'%SSABN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SSABX), CDPATH//'%SSABX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SSABD), CDPATH//'%SSABD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SRSMN), CDPATH//'%SRSMN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SRSMX), CDPATH//'%SRSMX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SRSMD), CDPATH//'%SRSMD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SZZ0N), CDPATH//'%SZZ0N'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SZZ0M), CDPATH//'%SZZ0M'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SZZ0B), CDPATH//'%SZZ0B'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SZZ0U), CDPATH//'%SZZ0U'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SZZ0D), CDPATH//'%SZZ0D'

END SUBROUTINE

SUBROUTINE WIPE_TCLI (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TCLI), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
























































LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE



END MODULE
