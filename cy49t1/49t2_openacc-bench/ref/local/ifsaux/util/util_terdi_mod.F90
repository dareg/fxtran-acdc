MODULE UTIL_TERDI_MOD

USE YOERDI, ONLY : TERDI

INTERFACE SAVE
MODULE PROCEDURE SAVE_TERDI
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TERDI
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TERDI
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TERDI
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TERDI
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TERDI
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TERDI
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TERDI (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TERDI), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%RRAE
WRITE (KLUN) YD%RSUNDUR
WRITE (KLUN) YD%RCARDI
WRITE (KLUN) YD%RCH4
WRITE (KLUN) YD%RN2O
WRITE (KLUN) YD%RNO2
WRITE (KLUN) YD%RO3
WRITE (KLUN) YD%RCCL4
WRITE (KLUN) YD%RCFC11
WRITE (KLUN) YD%RCFC12
WRITE (KLUN) YD%RCFC22
WRITE (KLUN) YD%REPCLC
WRITE (KLUN) YD%REPH2O
WRITE (KLUN) YD%RCCO2
WRITE (KLUN) YD%RCCH4
WRITE (KLUN) YD%RCN2O
WRITE (KLUN) YD%RCNO2
WRITE (KLUN) YD%RCCFC11
WRITE (KLUN) YD%RCCFC12
WRITE (KLUN) YD%RCCFC22
WRITE (KLUN) YD%RCCCL4
WRITE (KLUN) YD%RSOLINC
END SUBROUTINE

SUBROUTINE LOAD_TERDI (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TERDI), INTENT (OUT), TARGET :: YD
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) ZTMP0
YD%RRAE = ZTMP0
READ (KLUN) ZTMP0
YD%RSUNDUR = ZTMP0
READ (KLUN) ZTMP0
YD%RCARDI = ZTMP0
READ (KLUN) ZTMP0
YD%RCH4 = ZTMP0
READ (KLUN) ZTMP0
YD%RN2O = ZTMP0
READ (KLUN) ZTMP0
YD%RNO2 = ZTMP0
READ (KLUN) ZTMP0
YD%RO3 = ZTMP0
READ (KLUN) ZTMP0
YD%RCCL4 = ZTMP0
READ (KLUN) ZTMP0
YD%RCFC11 = ZTMP0
READ (KLUN) ZTMP0
YD%RCFC12 = ZTMP0
READ (KLUN) ZTMP0
YD%RCFC22 = ZTMP0
READ (KLUN) ZTMP0
YD%REPCLC = ZTMP0
READ (KLUN) ZTMP0
YD%REPH2O = ZTMP0
READ (KLUN) ZTMP0
YD%RCCO2 = ZTMP0
READ (KLUN) ZTMP0
YD%RCCH4 = ZTMP0
READ (KLUN) ZTMP0
YD%RCN2O = ZTMP0
READ (KLUN) ZTMP0
YD%RCNO2 = ZTMP0
READ (KLUN) ZTMP0
YD%RCCFC11 = ZTMP0
READ (KLUN) ZTMP0
YD%RCCFC12 = ZTMP0
READ (KLUN) ZTMP0
YD%RCCFC22 = ZTMP0
READ (KLUN) ZTMP0
YD%RCCCL4 = ZTMP0
READ (KLUN) ZTMP0
YD%RSOLINC = ZTMP0
END SUBROUTINE


SUBROUTINE COPY_TERDI (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TERDI), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF






















END SUBROUTINE

SUBROUTINE HOST_TERDI (YD)

IMPLICIT NONE
TYPE (TERDI), TARGET :: YD























END SUBROUTINE

     

SUBROUTINE CRC64_TERDI (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TERDI), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RRAE), CDPATH//'%RRAE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSUNDUR), CDPATH//'%RSUNDUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCARDI), CDPATH//'%RCARDI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCH4), CDPATH//'%RCH4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RN2O), CDPATH//'%RN2O'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RNO2), CDPATH//'%RNO2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RO3), CDPATH//'%RO3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCCL4), CDPATH//'%RCCL4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCFC11), CDPATH//'%RCFC11'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCFC12), CDPATH//'%RCFC12'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCFC22), CDPATH//'%RCFC22'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%REPCLC), CDPATH//'%REPCLC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%REPH2O), CDPATH//'%REPH2O'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCCO2), CDPATH//'%RCCO2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCCH4), CDPATH//'%RCCH4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCN2O), CDPATH//'%RCN2O'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCNO2), CDPATH//'%RCNO2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCCFC11), CDPATH//'%RCCFC11'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCCFC12), CDPATH//'%RCCFC12'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCCFC22), CDPATH//'%RCCFC22'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCCCL4), CDPATH//'%RCCCL4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSOLINC), CDPATH//'%RSOLINC'

END SUBROUTINE

SUBROUTINE WIPE_TERDI (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TERDI), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF






















LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TERDI (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TERDI),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%RRAE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRAE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSUNDUR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSUNDUR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCARDI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCARDI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCH4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCH4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RN2O)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RN2O'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RNO2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNO2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RO3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RO3'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCCL4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCL4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCFC11)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCFC11'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCFC12)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCFC12'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCFC22)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCFC22'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%REPCLC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%REPCLC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%REPH2O)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%REPH2O'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCCO2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCO2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCCH4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCH4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCN2O)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCN2O'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCNO2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCNO2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCCFC11)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCFC11'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCCFC12)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCFC12'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCCFC22)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCFC22'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCCCL4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCCL4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSOLINC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSOLINC'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
