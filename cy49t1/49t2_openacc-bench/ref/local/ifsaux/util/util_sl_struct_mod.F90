MODULE UTIL_SL_STRUCT_MOD

USE EINT_MOD, ONLY : SL_STRUCT

INTERFACE SAVE
MODULE PROCEDURE SAVE_SL_STRUCT
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_SL_STRUCT
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_SL_STRUCT
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_SL_STRUCT
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_SL_STRUCT
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_SL_STRUCT
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_SL_STRUCT
END INTERFACE


CONTAINS

SUBROUTINE SAVE_SL_STRUCT (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (SL_STRUCT), INTENT (IN), TARGET :: YD
LOGICAL :: LDIST1GP, LLCOMPLAT, LLSLCOMM, LLSLCORE, LNADDR, LNLATGLO, LNLOENG, LNOFFLEV, LNSLCOMM, LNSLCORE
LOGICAL :: LNSLEXT, LNSLEXTPOLFISTA, LNSLEXTPOLIJPTA, LNSLEXTPOLIPTA, LNSLMAP, LNSLOFF, LNSLONL, LNSLPTSEAST, LNSLPTSWEST, LNSLRECVPOS
LOGICAL :: LNSLRECVPTR, LNSLSENDPOS, LNSLSENDPTR, LNSLSTA, LNSTALAT, LRLSDEPI
WRITE (KLUN) YD%CVER
WRITE (KLUN) YD%NSLGROUP
LNSLSTA = ALLOCATED (YD%NSLSTA)
WRITE (KLUN) LNSLSTA
IF (LNSLSTA) THEN
  WRITE (KLUN) LBOUND (YD%NSLSTA)
  WRITE (KLUN) UBOUND (YD%NSLSTA)
  WRITE (KLUN) YD%NSLSTA
ENDIF
LNSLONL = ALLOCATED (YD%NSLONL)
WRITE (KLUN) LNSLONL
IF (LNSLONL) THEN
  WRITE (KLUN) LBOUND (YD%NSLONL)
  WRITE (KLUN) UBOUND (YD%NSLONL)
  WRITE (KLUN) YD%NSLONL
ENDIF
LNSLOFF = ALLOCATED (YD%NSLOFF)
WRITE (KLUN) LNSLOFF
IF (LNSLOFF) THEN
  WRITE (KLUN) LBOUND (YD%NSLOFF)
  WRITE (KLUN) UBOUND (YD%NSLOFF)
  WRITE (KLUN) YD%NSLOFF
ENDIF
LNSLPTSWEST = ALLOCATED (YD%NSLPTSWEST)
WRITE (KLUN) LNSLPTSWEST
IF (LNSLPTSWEST) THEN
  WRITE (KLUN) LBOUND (YD%NSLPTSWEST)
  WRITE (KLUN) UBOUND (YD%NSLPTSWEST)
  WRITE (KLUN) YD%NSLPTSWEST
ENDIF
LNSLPTSEAST = ALLOCATED (YD%NSLPTSEAST)
WRITE (KLUN) LNSLPTSEAST
IF (LNSLPTSEAST) THEN
  WRITE (KLUN) LBOUND (YD%NSLPTSEAST)
  WRITE (KLUN) UBOUND (YD%NSLPTSEAST)
  WRITE (KLUN) YD%NSLPTSEAST
ENDIF
LNSLEXT = ALLOCATED (YD%NSLEXT)
WRITE (KLUN) LNSLEXT
IF (LNSLEXT) THEN
  WRITE (KLUN) LBOUND (YD%NSLEXT)
  WRITE (KLUN) UBOUND (YD%NSLEXT)
  WRITE (KLUN) YD%NSLEXT
ENDIF
LLCOMPLAT = ALLOCATED (YD%LCOMPLAT)
WRITE (KLUN) LLCOMPLAT
IF (LLCOMPLAT) THEN
  WRITE (KLUN) LBOUND (YD%LCOMPLAT)
  WRITE (KLUN) UBOUND (YD%LCOMPLAT)
  WRITE (KLUN) YD%LCOMPLAT
ENDIF
LNLATGLO = ALLOCATED (YD%NLATGLO)
WRITE (KLUN) LNLATGLO
IF (LNLATGLO) THEN
  WRITE (KLUN) LBOUND (YD%NLATGLO)
  WRITE (KLUN) UBOUND (YD%NLATGLO)
  WRITE (KLUN) YD%NLATGLO
ENDIF
LDIST1GP = ALLOCATED (YD%DIST1GP)
WRITE (KLUN) LDIST1GP
IF (LDIST1GP) THEN
  WRITE (KLUN) LBOUND (YD%DIST1GP)
  WRITE (KLUN) UBOUND (YD%DIST1GP)
  WRITE (KLUN) YD%DIST1GP
ENDIF
LNSLSENDPOS = ALLOCATED (YD%NSLSENDPOS)
WRITE (KLUN) LNSLSENDPOS
IF (LNSLSENDPOS) THEN
  WRITE (KLUN) LBOUND (YD%NSLSENDPOS)
  WRITE (KLUN) UBOUND (YD%NSLSENDPOS)
  WRITE (KLUN) YD%NSLSENDPOS
ENDIF
LNSLRECVPOS = ALLOCATED (YD%NSLRECVPOS)
WRITE (KLUN) LNSLRECVPOS
IF (LNSLRECVPOS) THEN
  WRITE (KLUN) LBOUND (YD%NSLRECVPOS)
  WRITE (KLUN) UBOUND (YD%NSLRECVPOS)
  WRITE (KLUN) YD%NSLRECVPOS
ENDIF
LNSLSENDPTR = ALLOCATED (YD%NSLSENDPTR)
WRITE (KLUN) LNSLSENDPTR
IF (LNSLSENDPTR) THEN
  WRITE (KLUN) LBOUND (YD%NSLSENDPTR)
  WRITE (KLUN) UBOUND (YD%NSLSENDPTR)
  WRITE (KLUN) YD%NSLSENDPTR
ENDIF
LNSLRECVPTR = ALLOCATED (YD%NSLRECVPTR)
WRITE (KLUN) LNSLRECVPTR
IF (LNSLRECVPTR) THEN
  WRITE (KLUN) LBOUND (YD%NSLRECVPTR)
  WRITE (KLUN) UBOUND (YD%NSLRECVPTR)
  WRITE (KLUN) YD%NSLRECVPTR
ENDIF
LNSLCOMM = ALLOCATED (YD%NSLCOMM)
WRITE (KLUN) LNSLCOMM
IF (LNSLCOMM) THEN
  WRITE (KLUN) LBOUND (YD%NSLCOMM)
  WRITE (KLUN) UBOUND (YD%NSLCOMM)
  WRITE (KLUN) YD%NSLCOMM
ENDIF
LLSLCOMM = ALLOCATED (YD%LSLCOMM)
WRITE (KLUN) LLSLCOMM
IF (LLSLCOMM) THEN
  WRITE (KLUN) LBOUND (YD%LSLCOMM)
  WRITE (KLUN) UBOUND (YD%LSLCOMM)
  WRITE (KLUN) YD%LSLCOMM
ENDIF
WRITE (KLUN) YD%NASLB1
WRITE (KLUN) YD%NASLMASK
WRITE (KLUN) YD%NASLB1_TRUE
WRITE (KLUN) YD%NSLPAD
WRITE (KLUN) YD%LSLT_ARRAYS_INIT
WRITE (KLUN) YD%LSLONDEM
WRITE (KLUN) YD%LSLONDEM_ACTIVE
WRITE (KLUN) YD%NUNUSEDHALO
WRITE (KLUN) YD%DISTUNUSEDHALO
WRITE (KLUN) YD%NSLPROCS
WRITE (KLUN) YD%NSLRPT
WRITE (KLUN) YD%NSLSPT
WRITE (KLUN) YD%NSLWIDEN
WRITE (KLUN) YD%NSLWIDES
WRITE (KLUN) YD%NSLWIDEE
WRITE (KLUN) YD%NSLWIDEW
WRITE (KLUN) YD%NSLWIDE
LNSLMAP = ALLOCATED (YD%NSLMAP)
WRITE (KLUN) LNSLMAP
IF (LNSLMAP) THEN
  WRITE (KLUN) LBOUND (YD%NSLMAP)
  WRITE (KLUN) UBOUND (YD%NSLMAP)
  WRITE (KLUN) YD%NSLMAP
ENDIF
LNSLCORE = ALLOCATED (YD%NSLCORE)
WRITE (KLUN) LNSLCORE
IF (LNSLCORE) THEN
  WRITE (KLUN) LBOUND (YD%NSLCORE)
  WRITE (KLUN) UBOUND (YD%NSLCORE)
  WRITE (KLUN) YD%NSLCORE
ENDIF
LLSLCORE = ALLOCATED (YD%LSLCORE)
WRITE (KLUN) LLSLCORE
IF (LLSLCORE) THEN
  WRITE (KLUN) LBOUND (YD%LSLCORE)
  WRITE (KLUN) UBOUND (YD%LSLCORE)
  WRITE (KLUN) YD%LSLCORE
ENDIF
WRITE (KLUN) YD%NDGLG
WRITE (KLUN) YD%NDLON
WRITE (KLUN) YD%NDGSAG
WRITE (KLUN) YD%NDGENG
WRITE (KLUN) YD%NDGSAL
WRITE (KLUN) YD%NDGENL
WRITE (KLUN) YD%NDGSAH
WRITE (KLUN) YD%NDGENH
WRITE (KLUN) YD%NGPTOT
WRITE (KLUN) YD%NDGUXL
WRITE (KLUN) YD%NDLUNG
WRITE (KLUN) YD%NDLUXG
WRITE (KLUN) YD%NDGUNG
WRITE (KLUN) YD%NDGUXG
WRITE (KLUN) YD%NDSUR1
WRITE (KLUN) YD%NDLSUR
WRITE (KLUN) YD%NDGSUR
WRITE (KLUN) YD%NPTRFLOFF
WRITE (KLUN) YD%NFRSTLOFF
WRITE (KLUN) YD%MYFRSTACTLAT
WRITE (KLUN) YD%MYLSTACTLAT
LNLOENG = ALLOCATED (YD%NLOENG)
WRITE (KLUN) LNLOENG
IF (LNLOENG) THEN
  WRITE (KLUN) LBOUND (YD%NLOENG)
  WRITE (KLUN) UBOUND (YD%NLOENG)
  WRITE (KLUN) YD%NLOENG
ENDIF
WRITE (KLUN) YD%NPROC
LNSTALAT = ALLOCATED (YD%NSTALAT)
WRITE (KLUN) LNSTALAT
IF (LNSTALAT) THEN
  WRITE (KLUN) LBOUND (YD%NSTALAT)
  WRITE (KLUN) UBOUND (YD%NSTALAT)
  WRITE (KLUN) YD%NSTALAT
ENDIF
LNADDR = ALLOCATED (YD%NADDR)
WRITE (KLUN) LNADDR
IF (LNADDR) THEN
  WRITE (KLUN) LBOUND (YD%NADDR)
  WRITE (KLUN) UBOUND (YD%NADDR)
  WRITE (KLUN) YD%NADDR
ENDIF
LNOFFLEV = ALLOCATED (YD%NOFFLEV)
WRITE (KLUN) LNOFFLEV
IF (LNOFFLEV) THEN
  WRITE (KLUN) LBOUND (YD%NOFFLEV)
  WRITE (KLUN) UBOUND (YD%NOFFLEV)
  WRITE (KLUN) YD%NOFFLEV
ENDIF
LRLSDEPI = ALLOCATED (YD%RLSDEPI)
WRITE (KLUN) LRLSDEPI
IF (LRLSDEPI) THEN
  WRITE (KLUN) LBOUND (YD%RLSDEPI)
  WRITE (KLUN) UBOUND (YD%RLSDEPI)
  WRITE (KLUN) YD%RLSDEPI
ENDIF
LNSLEXTPOLFISTA = ALLOCATED (YD%NSLEXTPOLFISTA)
WRITE (KLUN) LNSLEXTPOLFISTA
IF (LNSLEXTPOLFISTA) THEN
  WRITE (KLUN) LBOUND (YD%NSLEXTPOLFISTA)
  WRITE (KLUN) UBOUND (YD%NSLEXTPOLFISTA)
  WRITE (KLUN) YD%NSLEXTPOLFISTA
ENDIF
LNSLEXTPOLIJPTA = ALLOCATED (YD%NSLEXTPOLIJPTA)
WRITE (KLUN) LNSLEXTPOLIJPTA
IF (LNSLEXTPOLIJPTA) THEN
  WRITE (KLUN) LBOUND (YD%NSLEXTPOLIJPTA)
  WRITE (KLUN) UBOUND (YD%NSLEXTPOLIJPTA)
  WRITE (KLUN) YD%NSLEXTPOLIJPTA
ENDIF
LNSLEXTPOLIPTA = ALLOCATED (YD%NSLEXTPOLIPTA)
WRITE (KLUN) LNSLEXTPOLIPTA
IF (LNSLEXTPOLIPTA) THEN
  WRITE (KLUN) LBOUND (YD%NSLEXTPOLIPTA)
  WRITE (KLUN) UBOUND (YD%NSLEXTPOLIPTA)
  WRITE (KLUN) YD%NSLEXTPOLIPTA
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_SL_STRUCT (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (SL_STRUCT), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2), IL3(3), IU3(3)
LOGICAL :: LDIST1GP, LLCOMPLAT, LLSLCOMM, LLSLCORE, LNADDR, LNLATGLO, LNLOENG, LNOFFLEV, LNSLCOMM, LNSLCORE
LOGICAL :: LNSLEXT, LNSLEXTPOLFISTA, LNSLEXTPOLIJPTA, LNSLEXTPOLIPTA, LNSLMAP, LNSLOFF, LNSLONL, LNSLPTSEAST, LNSLPTSWEST, LNSLRECVPOS
LOGICAL :: LNSLRECVPTR, LNSLSENDPOS, LNSLSENDPTR, LNSLSTA, LNSTALAT, LRLSDEPI
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) YD%CVER
READ (KLUN) YD%NSLGROUP
READ (KLUN) LNSLSTA
IF (LNSLSTA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLSTA (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLSTA
ENDIF
READ (KLUN) LNSLONL
IF (LNSLONL) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLONL (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLONL
ENDIF
READ (KLUN) LNSLOFF
IF (LNSLOFF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLOFF (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLOFF
ENDIF
READ (KLUN) LNSLPTSWEST
IF (LNSLPTSWEST) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLPTSWEST (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLPTSWEST
ENDIF
READ (KLUN) LNSLPTSEAST
IF (LNSLPTSEAST) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLPTSEAST (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLPTSEAST
ENDIF
READ (KLUN) LNSLEXT
IF (LNSLEXT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%NSLEXT (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%NSLEXT
ENDIF
READ (KLUN) LLCOMPLAT
IF (LLCOMPLAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%LCOMPLAT (IL1(1):IU1(1)))
  READ (KLUN) YD%LCOMPLAT
ENDIF
READ (KLUN) LNLATGLO
IF (LNLATGLO) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NLATGLO (IL1(1):IU1(1)))
  READ (KLUN) YD%NLATGLO
ENDIF
READ (KLUN) LDIST1GP
IF (LDIST1GP) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%DIST1GP (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%DIST1GP,1):UBOUND(YD%DIST1GP,1)))
  READ (KLUN) ZTMP1
  YD%DIST1GP = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LNSLSENDPOS
IF (LNSLSENDPOS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLSENDPOS (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLSENDPOS
ENDIF
READ (KLUN) LNSLRECVPOS
IF (LNSLRECVPOS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLRECVPOS (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLRECVPOS
ENDIF
READ (KLUN) LNSLSENDPTR
IF (LNSLSENDPTR) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLSENDPTR (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLSENDPTR
ENDIF
READ (KLUN) LNSLRECVPTR
IF (LNSLRECVPTR) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLRECVPTR (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLRECVPTR
ENDIF
READ (KLUN) LNSLCOMM
IF (LNSLCOMM) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLCOMM (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLCOMM
ENDIF
READ (KLUN) LLSLCOMM
IF (LLSLCOMM) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%LSLCOMM (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%LSLCOMM
ENDIF
READ (KLUN) YD%NASLB1
READ (KLUN) YD%NASLMASK
READ (KLUN) YD%NASLB1_TRUE
READ (KLUN) YD%NSLPAD
READ (KLUN) YD%LSLT_ARRAYS_INIT
READ (KLUN) YD%LSLONDEM
READ (KLUN) YD%LSLONDEM_ACTIVE
READ (KLUN) YD%NUNUSEDHALO
READ (KLUN) ZTMP0
YD%DISTUNUSEDHALO = ZTMP0
READ (KLUN) YD%NSLPROCS
READ (KLUN) YD%NSLRPT
READ (KLUN) YD%NSLSPT
READ (KLUN) YD%NSLWIDEN
READ (KLUN) YD%NSLWIDES
READ (KLUN) YD%NSLWIDEE
READ (KLUN) YD%NSLWIDEW
READ (KLUN) YD%NSLWIDE
READ (KLUN) LNSLMAP
IF (LNSLMAP) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%NSLMAP (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%NSLMAP
ENDIF
READ (KLUN) LNSLCORE
IF (LNSLCORE) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLCORE (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLCORE
ENDIF
READ (KLUN) LLSLCORE
IF (LLSLCORE) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%LSLCORE (IL1(1):IU1(1)))
  READ (KLUN) YD%LSLCORE
ENDIF
READ (KLUN) YD%NDGLG
READ (KLUN) YD%NDLON
READ (KLUN) YD%NDGSAG
READ (KLUN) YD%NDGENG
READ (KLUN) YD%NDGSAL
READ (KLUN) YD%NDGENL
READ (KLUN) YD%NDGSAH
READ (KLUN) YD%NDGENH
READ (KLUN) YD%NGPTOT
READ (KLUN) YD%NDGUXL
READ (KLUN) YD%NDLUNG
READ (KLUN) YD%NDLUXG
READ (KLUN) YD%NDGUNG
READ (KLUN) YD%NDGUXG
READ (KLUN) YD%NDSUR1
READ (KLUN) YD%NDLSUR
READ (KLUN) YD%NDGSUR
READ (KLUN) YD%NPTRFLOFF
READ (KLUN) YD%NFRSTLOFF
READ (KLUN) YD%MYFRSTACTLAT
READ (KLUN) YD%MYLSTACTLAT
READ (KLUN) LNLOENG
IF (LNLOENG) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NLOENG (IL1(1):IU1(1)))
  READ (KLUN) YD%NLOENG
ENDIF
READ (KLUN) YD%NPROC
READ (KLUN) LNSTALAT
IF (LNSTALAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSTALAT (IL1(1):IU1(1)))
  READ (KLUN) YD%NSTALAT
ENDIF
READ (KLUN) LNADDR
IF (LNADDR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%NADDR (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%NADDR
ENDIF
READ (KLUN) LNOFFLEV
IF (LNOFFLEV) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%NOFFLEV (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  READ (KLUN) YD%NOFFLEV
ENDIF
READ (KLUN) LRLSDEPI
IF (LRLSDEPI) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RLSDEPI (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RLSDEPI,1):UBOUND(YD%RLSDEPI,1)))
  READ (KLUN) ZTMP1
  YD%RLSDEPI = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LNSLEXTPOLFISTA
IF (LNSLEXTPOLFISTA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLEXTPOLFISTA (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLEXTPOLFISTA
ENDIF
READ (KLUN) LNSLEXTPOLIJPTA
IF (LNSLEXTPOLIJPTA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLEXTPOLIJPTA (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLEXTPOLIJPTA
ENDIF
READ (KLUN) LNSLEXTPOLIPTA
IF (LNSLEXTPOLIPTA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NSLEXTPOLIPTA (IL1(1):IU1(1)))
  READ (KLUN) YD%NSLEXTPOLIPTA
ENDIF
END SUBROUTINE


SUBROUTINE COPY_SL_STRUCT (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (SL_STRUCT), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LDIST1GP, LLCOMPLAT, LLSLCOMM, LLSLCORE, LNADDR, LNLATGLO, LNLOENG, LNOFFLEV, LNSLCOMM, LNSLCORE
LOGICAL :: LNSLEXT, LNSLEXTPOLFISTA, LNSLEXTPOLIJPTA, LNSLEXTPOLIPTA, LNSLMAP, LNSLOFF, LNSLONL, LNSLPTSEAST, LNSLPTSWEST, LNSLRECVPOS
LOGICAL :: LNSLRECVPTR, LNSLSENDPOS, LNSLSENDPTR, LNSLSTA, LNSTALAT, LRLSDEPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF


LNSLSTA = ALLOCATED (YD%NSLSTA)
IF (LNSLSTA) THEN
  !$ACC ENTER DATA CREATE (YD%NSLSTA)
  !$ACC UPDATE DEVICE (YD%NSLSTA)
  !$ACC ENTER DATA ATTACH (YD%NSLSTA)
ENDIF

LNSLONL = ALLOCATED (YD%NSLONL)
IF (LNSLONL) THEN
  !$ACC ENTER DATA CREATE (YD%NSLONL)
  !$ACC UPDATE DEVICE (YD%NSLONL)
  !$ACC ENTER DATA ATTACH (YD%NSLONL)
ENDIF

LNSLOFF = ALLOCATED (YD%NSLOFF)
IF (LNSLOFF) THEN
  !$ACC ENTER DATA CREATE (YD%NSLOFF)
  !$ACC UPDATE DEVICE (YD%NSLOFF)
  !$ACC ENTER DATA ATTACH (YD%NSLOFF)
ENDIF

LNSLPTSWEST = ALLOCATED (YD%NSLPTSWEST)
IF (LNSLPTSWEST) THEN
  !$ACC ENTER DATA CREATE (YD%NSLPTSWEST)
  !$ACC UPDATE DEVICE (YD%NSLPTSWEST)
  !$ACC ENTER DATA ATTACH (YD%NSLPTSWEST)
ENDIF

LNSLPTSEAST = ALLOCATED (YD%NSLPTSEAST)
IF (LNSLPTSEAST) THEN
  !$ACC ENTER DATA CREATE (YD%NSLPTSEAST)
  !$ACC UPDATE DEVICE (YD%NSLPTSEAST)
  !$ACC ENTER DATA ATTACH (YD%NSLPTSEAST)
ENDIF

LNSLEXT = ALLOCATED (YD%NSLEXT)
IF (LNSLEXT) THEN
  !$ACC ENTER DATA CREATE (YD%NSLEXT)
  !$ACC UPDATE DEVICE (YD%NSLEXT)
  !$ACC ENTER DATA ATTACH (YD%NSLEXT)
ENDIF

LLCOMPLAT = ALLOCATED (YD%LCOMPLAT)
IF (LLCOMPLAT) THEN
  !$ACC ENTER DATA CREATE (YD%LCOMPLAT)
  !$ACC UPDATE DEVICE (YD%LCOMPLAT)
  !$ACC ENTER DATA ATTACH (YD%LCOMPLAT)
ENDIF

LNLATGLO = ALLOCATED (YD%NLATGLO)
IF (LNLATGLO) THEN
  !$ACC ENTER DATA CREATE (YD%NLATGLO)
  !$ACC UPDATE DEVICE (YD%NLATGLO)
  !$ACC ENTER DATA ATTACH (YD%NLATGLO)
ENDIF

LDIST1GP = ALLOCATED (YD%DIST1GP)
IF (LDIST1GP) THEN
  !$ACC ENTER DATA CREATE (YD%DIST1GP)
  !$ACC UPDATE DEVICE (YD%DIST1GP)
  !$ACC ENTER DATA ATTACH (YD%DIST1GP)
ENDIF

LNSLSENDPOS = ALLOCATED (YD%NSLSENDPOS)
IF (LNSLSENDPOS) THEN
  !$ACC ENTER DATA CREATE (YD%NSLSENDPOS)
  !$ACC UPDATE DEVICE (YD%NSLSENDPOS)
  !$ACC ENTER DATA ATTACH (YD%NSLSENDPOS)
ENDIF

LNSLRECVPOS = ALLOCATED (YD%NSLRECVPOS)
IF (LNSLRECVPOS) THEN
  !$ACC ENTER DATA CREATE (YD%NSLRECVPOS)
  !$ACC UPDATE DEVICE (YD%NSLRECVPOS)
  !$ACC ENTER DATA ATTACH (YD%NSLRECVPOS)
ENDIF

LNSLSENDPTR = ALLOCATED (YD%NSLSENDPTR)
IF (LNSLSENDPTR) THEN
  !$ACC ENTER DATA CREATE (YD%NSLSENDPTR)
  !$ACC UPDATE DEVICE (YD%NSLSENDPTR)
  !$ACC ENTER DATA ATTACH (YD%NSLSENDPTR)
ENDIF

LNSLRECVPTR = ALLOCATED (YD%NSLRECVPTR)
IF (LNSLRECVPTR) THEN
  !$ACC ENTER DATA CREATE (YD%NSLRECVPTR)
  !$ACC UPDATE DEVICE (YD%NSLRECVPTR)
  !$ACC ENTER DATA ATTACH (YD%NSLRECVPTR)
ENDIF

LNSLCOMM = ALLOCATED (YD%NSLCOMM)
IF (LNSLCOMM) THEN
  !$ACC ENTER DATA CREATE (YD%NSLCOMM)
  !$ACC UPDATE DEVICE (YD%NSLCOMM)
  !$ACC ENTER DATA ATTACH (YD%NSLCOMM)
ENDIF

LLSLCOMM = ALLOCATED (YD%LSLCOMM)
IF (LLSLCOMM) THEN
  !$ACC ENTER DATA CREATE (YD%LSLCOMM)
  !$ACC UPDATE DEVICE (YD%LSLCOMM)
  !$ACC ENTER DATA ATTACH (YD%LSLCOMM)
ENDIF


















LNSLMAP = ALLOCATED (YD%NSLMAP)
IF (LNSLMAP) THEN
  !$ACC ENTER DATA CREATE (YD%NSLMAP)
  !$ACC UPDATE DEVICE (YD%NSLMAP)
  !$ACC ENTER DATA ATTACH (YD%NSLMAP)
ENDIF

LNSLCORE = ALLOCATED (YD%NSLCORE)
IF (LNSLCORE) THEN
  !$ACC ENTER DATA CREATE (YD%NSLCORE)
  !$ACC UPDATE DEVICE (YD%NSLCORE)
  !$ACC ENTER DATA ATTACH (YD%NSLCORE)
ENDIF

LLSLCORE = ALLOCATED (YD%LSLCORE)
IF (LLSLCORE) THEN
  !$ACC ENTER DATA CREATE (YD%LSLCORE)
  !$ACC UPDATE DEVICE (YD%LSLCORE)
  !$ACC ENTER DATA ATTACH (YD%LSLCORE)
ENDIF






















LNLOENG = ALLOCATED (YD%NLOENG)
IF (LNLOENG) THEN
  !$ACC ENTER DATA CREATE (YD%NLOENG)
  !$ACC UPDATE DEVICE (YD%NLOENG)
  !$ACC ENTER DATA ATTACH (YD%NLOENG)
ENDIF


LNSTALAT = ALLOCATED (YD%NSTALAT)
IF (LNSTALAT) THEN
  !$ACC ENTER DATA CREATE (YD%NSTALAT)
  !$ACC UPDATE DEVICE (YD%NSTALAT)
  !$ACC ENTER DATA ATTACH (YD%NSTALAT)
ENDIF

LNADDR = ALLOCATED (YD%NADDR)
IF (LNADDR) THEN
  !$ACC ENTER DATA CREATE (YD%NADDR)
  !$ACC UPDATE DEVICE (YD%NADDR)
  !$ACC ENTER DATA ATTACH (YD%NADDR)
ENDIF

LNOFFLEV = ALLOCATED (YD%NOFFLEV)
IF (LNOFFLEV) THEN
  !$ACC ENTER DATA CREATE (YD%NOFFLEV)
  !$ACC UPDATE DEVICE (YD%NOFFLEV)
  !$ACC ENTER DATA ATTACH (YD%NOFFLEV)
ENDIF

LRLSDEPI = ALLOCATED (YD%RLSDEPI)
IF (LRLSDEPI) THEN
  !$ACC ENTER DATA CREATE (YD%RLSDEPI)
  !$ACC UPDATE DEVICE (YD%RLSDEPI)
  !$ACC ENTER DATA ATTACH (YD%RLSDEPI)
ENDIF

LNSLEXTPOLFISTA = ALLOCATED (YD%NSLEXTPOLFISTA)
IF (LNSLEXTPOLFISTA) THEN
  !$ACC ENTER DATA CREATE (YD%NSLEXTPOLFISTA)
  !$ACC UPDATE DEVICE (YD%NSLEXTPOLFISTA)
  !$ACC ENTER DATA ATTACH (YD%NSLEXTPOLFISTA)
ENDIF

LNSLEXTPOLIJPTA = ALLOCATED (YD%NSLEXTPOLIJPTA)
IF (LNSLEXTPOLIJPTA) THEN
  !$ACC ENTER DATA CREATE (YD%NSLEXTPOLIJPTA)
  !$ACC UPDATE DEVICE (YD%NSLEXTPOLIJPTA)
  !$ACC ENTER DATA ATTACH (YD%NSLEXTPOLIJPTA)
ENDIF

LNSLEXTPOLIPTA = ALLOCATED (YD%NSLEXTPOLIPTA)
IF (LNSLEXTPOLIPTA) THEN
  !$ACC ENTER DATA CREATE (YD%NSLEXTPOLIPTA)
  !$ACC UPDATE DEVICE (YD%NSLEXTPOLIPTA)
  !$ACC ENTER DATA ATTACH (YD%NSLEXTPOLIPTA)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_SL_STRUCT (YD)

IMPLICIT NONE
TYPE (SL_STRUCT), TARGET :: YD
LOGICAL :: LDIST1GP, LLCOMPLAT, LLSLCOMM, LLSLCORE, LNADDR, LNLATGLO, LNLOENG, LNOFFLEV, LNSLCOMM, LNSLCORE
LOGICAL :: LNSLEXT, LNSLEXTPOLFISTA, LNSLEXTPOLIJPTA, LNSLEXTPOLIPTA, LNSLMAP, LNSLOFF, LNSLONL, LNSLPTSEAST, LNSLPTSWEST, LNSLRECVPOS
LOGICAL :: LNSLRECVPTR, LNSLSENDPOS, LNSLSENDPTR, LNSLSTA, LNSTALAT, LRLSDEPI



































































END SUBROUTINE

     

SUBROUTINE CRC64_SL_STRUCT (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (SL_STRUCT), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LDIST1GP, LLCOMPLAT, LLSLCOMM, LLSLCORE, LNADDR, LNLATGLO, LNLOENG, LNOFFLEV, LNSLCOMM, LNSLCORE
LOGICAL :: LNSLEXT, LNSLEXTPOLFISTA, LNSLEXTPOLIJPTA, LNSLEXTPOLIPTA, LNSLMAP, LNSLOFF, LNSLONL, LNSLPTSEAST, LNSLPTSWEST, LNSLRECVPOS
LOGICAL :: LNSLRECVPTR, LNSLSENDPOS, LNSLSENDPTR, LNSLSTA, LNSTALAT, LRLSDEPI
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CVER), CDPATH//'%CVER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLGROUP), CDPATH//'%NSLGROUP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLSTA), CDPATH//'%NSLSTA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLONL), CDPATH//'%NSLONL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLOFF), CDPATH//'%NSLOFF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLPTSWEST), CDPATH//'%NSLPTSWEST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLPTSEAST), CDPATH//'%NSLPTSEAST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLEXT), CDPATH//'%NSLEXT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCOMPLAT), CDPATH//'%LCOMPLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLATGLO), CDPATH//'%NLATGLO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%DIST1GP), CDPATH//'%DIST1GP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLSENDPOS), CDPATH//'%NSLSENDPOS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLRECVPOS), CDPATH//'%NSLRECVPOS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLSENDPTR), CDPATH//'%NSLSENDPTR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLRECVPTR), CDPATH//'%NSLRECVPTR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLCOMM), CDPATH//'%NSLCOMM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSLCOMM), CDPATH//'%LSLCOMM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NASLB1), CDPATH//'%NASLB1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NASLMASK), CDPATH//'%NASLMASK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NASLB1_TRUE), CDPATH//'%NASLB1_TRUE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLPAD), CDPATH//'%NSLPAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSLT_ARRAYS_INIT), CDPATH//'%LSLT_ARRAYS_INIT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSLONDEM), CDPATH//'%LSLONDEM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSLONDEM_ACTIVE), CDPATH//'%LSLONDEM_ACTIVE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NUNUSEDHALO), CDPATH//'%NUNUSEDHALO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%DISTUNUSEDHALO), CDPATH//'%DISTUNUSEDHALO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLPROCS), CDPATH//'%NSLPROCS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLRPT), CDPATH//'%NSLRPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLSPT), CDPATH//'%NSLSPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLWIDEN), CDPATH//'%NSLWIDEN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLWIDES), CDPATH//'%NSLWIDES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLWIDEE), CDPATH//'%NSLWIDEE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLWIDEW), CDPATH//'%NSLWIDEW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLWIDE), CDPATH//'%NSLWIDE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLMAP), CDPATH//'%NSLMAP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLCORE), CDPATH//'%NSLCORE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSLCORE), CDPATH//'%LSLCORE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGLG), CDPATH//'%NDGLG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDLON), CDPATH//'%NDLON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGSAG), CDPATH//'%NDGSAG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGENG), CDPATH//'%NDGENG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGSAL), CDPATH//'%NDGSAL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGENL), CDPATH//'%NDGENL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGSAH), CDPATH//'%NDGSAH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGENH), CDPATH//'%NDGENH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NGPTOT), CDPATH//'%NGPTOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGUXL), CDPATH//'%NDGUXL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDLUNG), CDPATH//'%NDLUNG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDLUXG), CDPATH//'%NDLUXG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGUNG), CDPATH//'%NDGUNG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGUXG), CDPATH//'%NDGUXG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDSUR1), CDPATH//'%NDSUR1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDLSUR), CDPATH//'%NDLSUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDGSUR), CDPATH//'%NDGSUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPTRFLOFF), CDPATH//'%NPTRFLOFF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NFRSTLOFF), CDPATH//'%NFRSTLOFF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MYFRSTACTLAT), CDPATH//'%MYFRSTACTLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MYLSTACTLAT), CDPATH//'%MYLSTACTLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLOENG), CDPATH//'%NLOENG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPROC), CDPATH//'%NPROC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSTALAT), CDPATH//'%NSTALAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NADDR), CDPATH//'%NADDR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NOFFLEV), CDPATH//'%NOFFLEV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RLSDEPI), CDPATH//'%RLSDEPI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLEXTPOLFISTA), CDPATH//'%NSLEXTPOLFISTA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLEXTPOLIJPTA), CDPATH//'%NSLEXTPOLIJPTA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSLEXTPOLIPTA), CDPATH//'%NSLEXTPOLIPTA'

END SUBROUTINE

SUBROUTINE WIPE_SL_STRUCT (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (SL_STRUCT), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LDIST1GP, LLCOMPLAT, LLSLCOMM, LLSLCORE, LNADDR, LNLATGLO, LNLOENG, LNOFFLEV, LNSLCOMM, LNSLCORE
LOGICAL :: LNSLEXT, LNSLEXTPOLFISTA, LNSLEXTPOLIJPTA, LNSLEXTPOLIPTA, LNSLMAP, LNSLOFF, LNSLONL, LNSLPTSEAST, LNSLPTSWEST, LNSLRECVPOS
LOGICAL :: LNSLRECVPTR, LNSLSENDPOS, LNSLSENDPTR, LNSLSTA, LNSTALAT, LRLSDEPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF


LNSLSTA = ALLOCATED (YD%NSLSTA)
IF (LNSLSTA) THEN
  !$ACC EXIT DATA DETACH (YD%NSLSTA)
  !$ACC EXIT DATA DETACH (YD%NSLSTA)
ENDIF

LNSLONL = ALLOCATED (YD%NSLONL)
IF (LNSLONL) THEN
  !$ACC EXIT DATA DETACH (YD%NSLONL)
  !$ACC EXIT DATA DETACH (YD%NSLONL)
ENDIF

LNSLOFF = ALLOCATED (YD%NSLOFF)
IF (LNSLOFF) THEN
  !$ACC EXIT DATA DETACH (YD%NSLOFF)
  !$ACC EXIT DATA DETACH (YD%NSLOFF)
ENDIF

LNSLPTSWEST = ALLOCATED (YD%NSLPTSWEST)
IF (LNSLPTSWEST) THEN
  !$ACC EXIT DATA DETACH (YD%NSLPTSWEST)
  !$ACC EXIT DATA DETACH (YD%NSLPTSWEST)
ENDIF

LNSLPTSEAST = ALLOCATED (YD%NSLPTSEAST)
IF (LNSLPTSEAST) THEN
  !$ACC EXIT DATA DETACH (YD%NSLPTSEAST)
  !$ACC EXIT DATA DETACH (YD%NSLPTSEAST)
ENDIF

LNSLEXT = ALLOCATED (YD%NSLEXT)
IF (LNSLEXT) THEN
  !$ACC EXIT DATA DETACH (YD%NSLEXT)
  !$ACC EXIT DATA DETACH (YD%NSLEXT)
ENDIF

LLCOMPLAT = ALLOCATED (YD%LCOMPLAT)
IF (LLCOMPLAT) THEN
  !$ACC EXIT DATA DETACH (YD%LCOMPLAT)
  !$ACC EXIT DATA DETACH (YD%LCOMPLAT)
ENDIF

LNLATGLO = ALLOCATED (YD%NLATGLO)
IF (LNLATGLO) THEN
  !$ACC EXIT DATA DETACH (YD%NLATGLO)
  !$ACC EXIT DATA DETACH (YD%NLATGLO)
ENDIF

LDIST1GP = ALLOCATED (YD%DIST1GP)
IF (LDIST1GP) THEN
  !$ACC EXIT DATA DETACH (YD%DIST1GP)
  !$ACC EXIT DATA DETACH (YD%DIST1GP)
ENDIF

LNSLSENDPOS = ALLOCATED (YD%NSLSENDPOS)
IF (LNSLSENDPOS) THEN
  !$ACC EXIT DATA DETACH (YD%NSLSENDPOS)
  !$ACC EXIT DATA DETACH (YD%NSLSENDPOS)
ENDIF

LNSLRECVPOS = ALLOCATED (YD%NSLRECVPOS)
IF (LNSLRECVPOS) THEN
  !$ACC EXIT DATA DETACH (YD%NSLRECVPOS)
  !$ACC EXIT DATA DETACH (YD%NSLRECVPOS)
ENDIF

LNSLSENDPTR = ALLOCATED (YD%NSLSENDPTR)
IF (LNSLSENDPTR) THEN
  !$ACC EXIT DATA DETACH (YD%NSLSENDPTR)
  !$ACC EXIT DATA DETACH (YD%NSLSENDPTR)
ENDIF

LNSLRECVPTR = ALLOCATED (YD%NSLRECVPTR)
IF (LNSLRECVPTR) THEN
  !$ACC EXIT DATA DETACH (YD%NSLRECVPTR)
  !$ACC EXIT DATA DETACH (YD%NSLRECVPTR)
ENDIF

LNSLCOMM = ALLOCATED (YD%NSLCOMM)
IF (LNSLCOMM) THEN
  !$ACC EXIT DATA DETACH (YD%NSLCOMM)
  !$ACC EXIT DATA DETACH (YD%NSLCOMM)
ENDIF

LLSLCOMM = ALLOCATED (YD%LSLCOMM)
IF (LLSLCOMM) THEN
  !$ACC EXIT DATA DETACH (YD%LSLCOMM)
  !$ACC EXIT DATA DETACH (YD%LSLCOMM)
ENDIF


















LNSLMAP = ALLOCATED (YD%NSLMAP)
IF (LNSLMAP) THEN
  !$ACC EXIT DATA DETACH (YD%NSLMAP)
  !$ACC EXIT DATA DETACH (YD%NSLMAP)
ENDIF

LNSLCORE = ALLOCATED (YD%NSLCORE)
IF (LNSLCORE) THEN
  !$ACC EXIT DATA DETACH (YD%NSLCORE)
  !$ACC EXIT DATA DETACH (YD%NSLCORE)
ENDIF

LLSLCORE = ALLOCATED (YD%LSLCORE)
IF (LLSLCORE) THEN
  !$ACC EXIT DATA DETACH (YD%LSLCORE)
  !$ACC EXIT DATA DETACH (YD%LSLCORE)
ENDIF






















LNLOENG = ALLOCATED (YD%NLOENG)
IF (LNLOENG) THEN
  !$ACC EXIT DATA DETACH (YD%NLOENG)
  !$ACC EXIT DATA DETACH (YD%NLOENG)
ENDIF


LNSTALAT = ALLOCATED (YD%NSTALAT)
IF (LNSTALAT) THEN
  !$ACC EXIT DATA DETACH (YD%NSTALAT)
  !$ACC EXIT DATA DETACH (YD%NSTALAT)
ENDIF

LNADDR = ALLOCATED (YD%NADDR)
IF (LNADDR) THEN
  !$ACC EXIT DATA DETACH (YD%NADDR)
  !$ACC EXIT DATA DETACH (YD%NADDR)
ENDIF

LNOFFLEV = ALLOCATED (YD%NOFFLEV)
IF (LNOFFLEV) THEN
  !$ACC EXIT DATA DETACH (YD%NOFFLEV)
  !$ACC EXIT DATA DETACH (YD%NOFFLEV)
ENDIF

LRLSDEPI = ALLOCATED (YD%RLSDEPI)
IF (LRLSDEPI) THEN
  !$ACC EXIT DATA DETACH (YD%RLSDEPI)
  !$ACC EXIT DATA DETACH (YD%RLSDEPI)
ENDIF

LNSLEXTPOLFISTA = ALLOCATED (YD%NSLEXTPOLFISTA)
IF (LNSLEXTPOLFISTA) THEN
  !$ACC EXIT DATA DETACH (YD%NSLEXTPOLFISTA)
  !$ACC EXIT DATA DETACH (YD%NSLEXTPOLFISTA)
ENDIF

LNSLEXTPOLIJPTA = ALLOCATED (YD%NSLEXTPOLIJPTA)
IF (LNSLEXTPOLIJPTA) THEN
  !$ACC EXIT DATA DETACH (YD%NSLEXTPOLIJPTA)
  !$ACC EXIT DATA DETACH (YD%NSLEXTPOLIJPTA)
ENDIF

LNSLEXTPOLIPTA = ALLOCATED (YD%NSLEXTPOLIPTA)
IF (LNSLEXTPOLIPTA) THEN
  !$ACC EXIT DATA DETACH (YD%NSLEXTPOLIPTA)
  !$ACC EXIT DATA DETACH (YD%NSLEXTPOLIPTA)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_SL_STRUCT (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (SL_STRUCT),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LDIST1GP, LLCOMPLAT, LLSLCOMM, LLSLCORE, LNADDR, LNLATGLO, LNLOENG, LNOFFLEV, LNSLCOMM, LNSLCORE
LOGICAL :: LNSLEXT, LNSLEXTPOLFISTA, LNSLEXTPOLIJPTA, LNSLEXTPOLIPTA, LNSLMAP, LNSLOFF, LNSLONL, LNSLPTSEAST, LNSLPTSWEST, LNSLRECVPOS
LOGICAL :: LNSLRECVPTR, LNSLSENDPOS, LNSLSENDPTR, LNSLSTA, LNSTALAT, LRLSDEPI

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%CVER) * LEN (YD%CVER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CVER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLGROUP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLGROUP'
ENDIF
KSIZE = KSIZE + ISIZE
LNSLSTA = ALLOCATED (YD%NSLSTA)
IF (LNSLSTA) THEN
  ISIZE = KIND (YD%NSLSTA) * SIZE (YD%NSLSTA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLSTA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLONL = ALLOCATED (YD%NSLONL)
IF (LNSLONL) THEN
  ISIZE = KIND (YD%NSLONL) * SIZE (YD%NSLONL)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLONL'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLOFF = ALLOCATED (YD%NSLOFF)
IF (LNSLOFF) THEN
  ISIZE = KIND (YD%NSLOFF) * SIZE (YD%NSLOFF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLOFF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLPTSWEST = ALLOCATED (YD%NSLPTSWEST)
IF (LNSLPTSWEST) THEN
  ISIZE = KIND (YD%NSLPTSWEST) * SIZE (YD%NSLPTSWEST)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLPTSWEST'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLPTSEAST = ALLOCATED (YD%NSLPTSEAST)
IF (LNSLPTSEAST) THEN
  ISIZE = KIND (YD%NSLPTSEAST) * SIZE (YD%NSLPTSEAST)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLPTSEAST'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLEXT = ALLOCATED (YD%NSLEXT)
IF (LNSLEXT) THEN
  ISIZE = KIND (YD%NSLEXT) * SIZE (YD%NSLEXT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLEXT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LLCOMPLAT = ALLOCATED (YD%LCOMPLAT)
IF (LLCOMPLAT) THEN
  ISIZE = KIND (YD%LCOMPLAT) * SIZE (YD%LCOMPLAT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%LCOMPLAT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNLATGLO = ALLOCATED (YD%NLATGLO)
IF (LNLATGLO) THEN
  ISIZE = KIND (YD%NLATGLO) * SIZE (YD%NLATGLO)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NLATGLO'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LDIST1GP = ALLOCATED (YD%DIST1GP)
IF (LDIST1GP) THEN
  ISIZE = KIND (YD%DIST1GP) * SIZE (YD%DIST1GP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%DIST1GP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLSENDPOS = ALLOCATED (YD%NSLSENDPOS)
IF (LNSLSENDPOS) THEN
  ISIZE = KIND (YD%NSLSENDPOS) * SIZE (YD%NSLSENDPOS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLSENDPOS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLRECVPOS = ALLOCATED (YD%NSLRECVPOS)
IF (LNSLRECVPOS) THEN
  ISIZE = KIND (YD%NSLRECVPOS) * SIZE (YD%NSLRECVPOS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLRECVPOS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLSENDPTR = ALLOCATED (YD%NSLSENDPTR)
IF (LNSLSENDPTR) THEN
  ISIZE = KIND (YD%NSLSENDPTR) * SIZE (YD%NSLSENDPTR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLSENDPTR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLRECVPTR = ALLOCATED (YD%NSLRECVPTR)
IF (LNSLRECVPTR) THEN
  ISIZE = KIND (YD%NSLRECVPTR) * SIZE (YD%NSLRECVPTR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLRECVPTR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLCOMM = ALLOCATED (YD%NSLCOMM)
IF (LNSLCOMM) THEN
  ISIZE = KIND (YD%NSLCOMM) * SIZE (YD%NSLCOMM)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLCOMM'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LLSLCOMM = ALLOCATED (YD%LSLCOMM)
IF (LLSLCOMM) THEN
  ISIZE = KIND (YD%LSLCOMM) * SIZE (YD%LSLCOMM)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%LSLCOMM'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%NASLB1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NASLB1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NASLMASK)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NASLMASK'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NASLB1_TRUE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NASLB1_TRUE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLPAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLPAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSLT_ARRAYS_INIT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSLT_ARRAYS_INIT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSLONDEM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSLONDEM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSLONDEM_ACTIVE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSLONDEM_ACTIVE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NUNUSEDHALO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NUNUSEDHALO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%DISTUNUSEDHALO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%DISTUNUSEDHALO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLPROCS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLPROCS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLRPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLRPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLSPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLSPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLWIDEN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLWIDEN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLWIDES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLWIDES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLWIDEE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLWIDEE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLWIDEW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLWIDEW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSLWIDE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSLWIDE'
ENDIF
KSIZE = KSIZE + ISIZE
LNSLMAP = ALLOCATED (YD%NSLMAP)
IF (LNSLMAP) THEN
  ISIZE = KIND (YD%NSLMAP) * SIZE (YD%NSLMAP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLMAP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLCORE = ALLOCATED (YD%NSLCORE)
IF (LNSLCORE) THEN
  ISIZE = KIND (YD%NSLCORE) * SIZE (YD%NSLCORE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLCORE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LLSLCORE = ALLOCATED (YD%LSLCORE)
IF (LLSLCORE) THEN
  ISIZE = KIND (YD%LSLCORE) * SIZE (YD%LSLCORE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%LSLCORE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%NDGLG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGLG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDLON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDLON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGSAG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGSAG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGENG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGENG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGSAL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGSAL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGENL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGENL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGSAH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGSAH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGENH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGENH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NGPTOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NGPTOT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGUXL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGUXL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDLUNG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDLUNG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDLUXG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDLUXG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGUNG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGUNG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGUXG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGUXG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDSUR1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDSUR1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDLSUR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDLSUR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDGSUR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDGSUR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPTRFLOFF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPTRFLOFF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NFRSTLOFF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFRSTLOFF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%MYFRSTACTLAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MYFRSTACTLAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%MYLSTACTLAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MYLSTACTLAT'
ENDIF
KSIZE = KSIZE + ISIZE
LNLOENG = ALLOCATED (YD%NLOENG)
IF (LNLOENG) THEN
  ISIZE = KIND (YD%NLOENG) * SIZE (YD%NLOENG)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NLOENG'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%NPROC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPROC'
ENDIF
KSIZE = KSIZE + ISIZE
LNSTALAT = ALLOCATED (YD%NSTALAT)
IF (LNSTALAT) THEN
  ISIZE = KIND (YD%NSTALAT) * SIZE (YD%NSTALAT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSTALAT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNADDR = ALLOCATED (YD%NADDR)
IF (LNADDR) THEN
  ISIZE = KIND (YD%NADDR) * SIZE (YD%NADDR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NADDR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNOFFLEV = ALLOCATED (YD%NOFFLEV)
IF (LNOFFLEV) THEN
  ISIZE = KIND (YD%NOFFLEV) * SIZE (YD%NOFFLEV)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NOFFLEV'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRLSDEPI = ALLOCATED (YD%RLSDEPI)
IF (LRLSDEPI) THEN
  ISIZE = KIND (YD%RLSDEPI) * SIZE (YD%RLSDEPI)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RLSDEPI'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLEXTPOLFISTA = ALLOCATED (YD%NSLEXTPOLFISTA)
IF (LNSLEXTPOLFISTA) THEN
  ISIZE = KIND (YD%NSLEXTPOLFISTA) * SIZE (YD%NSLEXTPOLFISTA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLEXTPOLFISTA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLEXTPOLIJPTA = ALLOCATED (YD%NSLEXTPOLIJPTA)
IF (LNSLEXTPOLIJPTA) THEN
  ISIZE = KIND (YD%NSLEXTPOLIJPTA) * SIZE (YD%NSLEXTPOLIJPTA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLEXTPOLIJPTA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNSLEXTPOLIPTA = ALLOCATED (YD%NSLEXTPOLIPTA)
IF (LNSLEXTPOLIPTA) THEN
  ISIZE = KIND (YD%NSLEXTPOLIPTA) * SIZE (YD%NSLEXTPOLIPTA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NSLEXTPOLIPTA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
