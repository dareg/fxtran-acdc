MODULE UTIL_TSPPT_CONFIG_MOD

USE YOMSPSDT, ONLY : TSPPT_CONFIG

INTERFACE SAVE
MODULE PROCEDURE SAVE_TSPPT_CONFIG
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TSPPT_CONFIG
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TSPPT_CONFIG
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TSPPT_CONFIG
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TSPPT_CONFIG
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TSPPT_CONFIG
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TSPPT_CONFIG
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TSPPT_CONFIG (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TSPPT_CONFIG), INTENT (IN), TARGET :: YD
LOGICAL :: LCIPATINIT_SDT, LCOPATGP_SDT, LCOPATSP_SDT, LCOPATTRUN_SDT, LLACTIVEO_SDT, LLACTIVEQ_SDT
WRITE (KLUN) YD%LSPSDT
WRITE (KLUN) YD%LRADCLR_SDT
WRITE (KLUN) YD%LSATADJ_SDT
WRITE (KLUN) YD%LSPPT1
WRITE (KLUN) YD%LSPPTGFIX
WRITE (KLUN) YD%LCLIP_SPEC_SDT
WRITE (KLUN) YD%LCLIP_GRID_SDT
WRITE (KLUN) YD%LQPERTLIMIT2
WRITE (KLUN) YD%LTAPER_BL0
WRITE (KLUN) YD%LTAPER_BLI
WRITE (KLUN) YD%LTAPER_ST0
WRITE (KLUN) YD%LTAPER_STI
WRITE (KLUN) YD%LUSESETRAN_SDT
WRITE (KLUN) YD%LRESETSEED_SDT
WRITE (KLUN) YD%LABSTIMSEED_SDT
WRITE (KLUN) YD%LWRITE_ARP
WRITE (KLUN) YD%LRDPATINIT_SDT
WRITE (KLUN) YD%LWRPATTRUN_SDT
LLACTIVEQ_SDT = ASSOCIATED (YD%LACTIVEQ_SDT)
WRITE (KLUN) LLACTIVEQ_SDT
IF (LLACTIVEQ_SDT) THEN
  WRITE (KLUN) YD%LACTIVEQ_SDT
ENDIF
LLACTIVEO_SDT = ASSOCIATED (YD%LACTIVEO_SDT)
WRITE (KLUN) LLACTIVEO_SDT
IF (LLACTIVEO_SDT) THEN
  WRITE (KLUN) YD%LACTIVEO_SDT
ENDIF
WRITE (KLUN) YD%NSCALES_SDT
WRITE (KLUN) YD%NPATFR
WRITE (KLUN) YD%RESETSEEDFRQ_SDT
WRITE (KLUN) YD%NWRPATTRUN_SDT
WRITE (KLUN) YD%NHOUR_PATTRUN
WRITE (KLUN) YD%NSTEP_PATTRUN
WRITE (KLUN) YD%NCLIP_KIND_SDT
WRITE (KLUN) YD%NQSAT_SDT
WRITE (KLUN) YD%NWN_TESTSPEC_SDT
WRITE (KLUN) YD%NWAV_TESTSPEC_SDT
WRITE (KLUN) YD%SDEV_SDT
WRITE (KLUN) YD%TAU_SDT
WRITE (KLUN) YD%XLCOR_SDT
WRITE (KLUN) YD%XWC_KAPPA_T
WRITE (KLUN) YD%XCLIPM_SDT
WRITE (KLUN) YD%XCLIP_RATIO_SDT
WRITE (KLUN) YD%XMEANRED_THICKNESS_SDT
WRITE (KLUN) YD%SDEVTOT_SDT
WRITE (KLUN) YD%XSIGMATOP
WRITE (KLUN) YD%XSIGMABOT
WRITE (KLUN) YD%XPRESSTOP_ST0
WRITE (KLUN) YD%XPRESSBOT_ST0
WRITE (KLUN) YD%XTAPER3
WRITE (KLUN) YD%XTAPER2
WRITE (KLUN) YD%XTAPER1
WRITE (KLUN) YD%XTAPER0
WRITE (KLUN) YD%XTAPER3_ST0
WRITE (KLUN) YD%XTAPER2_ST0
WRITE (KLUN) YD%XTAPER1_ST0
WRITE (KLUN) YD%XTAPER0_ST0
WRITE (KLUN) YD%XSPPTGFIXRLX
WRITE (KLUN) YD%CSPEC_SHAPE_SDT
LCIPATINIT_SDT = ASSOCIATED (YD%CIPATINIT_SDT)
WRITE (KLUN) LCIPATINIT_SDT
IF (LCIPATINIT_SDT) THEN
  WRITE (KLUN) LBOUND (YD%CIPATINIT_SDT)
  WRITE (KLUN) UBOUND (YD%CIPATINIT_SDT)
  WRITE (KLUN) YD%CIPATINIT_SDT
ENDIF
LCOPATTRUN_SDT = ASSOCIATED (YD%COPATTRUN_SDT)
WRITE (KLUN) LCOPATTRUN_SDT
IF (LCOPATTRUN_SDT) THEN
  WRITE (KLUN) LBOUND (YD%COPATTRUN_SDT)
  WRITE (KLUN) UBOUND (YD%COPATTRUN_SDT)
  WRITE (KLUN) YD%COPATTRUN_SDT
ENDIF
LCOPATSP_SDT = ASSOCIATED (YD%COPATSP_SDT)
WRITE (KLUN) LCOPATSP_SDT
IF (LCOPATSP_SDT) THEN
  WRITE (KLUN) LBOUND (YD%COPATSP_SDT)
  WRITE (KLUN) UBOUND (YD%COPATSP_SDT)
  WRITE (KLUN) YD%COPATSP_SDT
ENDIF
LCOPATGP_SDT = ASSOCIATED (YD%COPATGP_SDT)
WRITE (KLUN) LCOPATGP_SDT
IF (LCOPATGP_SDT) THEN
  WRITE (KLUN) LBOUND (YD%COPATGP_SDT)
  WRITE (KLUN) UBOUND (YD%COPATGP_SDT)
  WRITE (KLUN) YD%COPATGP_SDT
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_TSPPT_CONFIG (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TSPPT_CONFIG), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LCIPATINIT_SDT, LCOPATGP_SDT, LCOPATSP_SDT, LCOPATTRUN_SDT, LLACTIVEO_SDT, LLACTIVEQ_SDT
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
READ (KLUN) YD%LSPSDT
READ (KLUN) YD%LRADCLR_SDT
READ (KLUN) YD%LSATADJ_SDT
READ (KLUN) YD%LSPPT1
READ (KLUN) YD%LSPPTGFIX
READ (KLUN) YD%LCLIP_SPEC_SDT
READ (KLUN) YD%LCLIP_GRID_SDT
READ (KLUN) YD%LQPERTLIMIT2
READ (KLUN) YD%LTAPER_BL0
READ (KLUN) YD%LTAPER_BLI
READ (KLUN) YD%LTAPER_ST0
READ (KLUN) YD%LTAPER_STI
READ (KLUN) YD%LUSESETRAN_SDT
READ (KLUN) YD%LRESETSEED_SDT
READ (KLUN) YD%LABSTIMSEED_SDT
READ (KLUN) YD%LWRITE_ARP
READ (KLUN) YD%LRDPATINIT_SDT
READ (KLUN) YD%LWRPATTRUN_SDT
READ (KLUN) LLACTIVEQ_SDT
IF (LLACTIVEQ_SDT) THEN
  ALLOCATE (YD%LACTIVEQ_SDT)
  READ (KLUN) YD%LACTIVEQ_SDT
ELSE
  NULLIFY (YD%LACTIVEQ_SDT)
ENDIF
READ (KLUN) LLACTIVEO_SDT
IF (LLACTIVEO_SDT) THEN
  ALLOCATE (YD%LACTIVEO_SDT)
  READ (KLUN) YD%LACTIVEO_SDT
ELSE
  NULLIFY (YD%LACTIVEO_SDT)
ENDIF
READ (KLUN) YD%NSCALES_SDT
READ (KLUN) YD%NPATFR
READ (KLUN) YD%RESETSEEDFRQ_SDT
READ (KLUN) YD%NWRPATTRUN_SDT
READ (KLUN) YD%NHOUR_PATTRUN
READ (KLUN) YD%NSTEP_PATTRUN
READ (KLUN) YD%NCLIP_KIND_SDT
READ (KLUN) YD%NQSAT_SDT
READ (KLUN) YD%NWN_TESTSPEC_SDT
READ (KLUN) YD%NWAV_TESTSPEC_SDT
ALLOCATE (ZTMP2(LBOUND(YD%SDEV_SDT,1):UBOUND(YD%SDEV_SDT,1), LBOUND(YD%SDEV_SDT,2):UBOUND(YD%SDEV_SDT,2)))
READ (KLUN) ZTMP2
YD%SDEV_SDT = ZTMP2
DEALLOCATE (ZTMP2)
ALLOCATE (ZTMP1(LBOUND(YD%TAU_SDT,1):UBOUND(YD%TAU_SDT,1)))
READ (KLUN) ZTMP1
YD%TAU_SDT = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%XLCOR_SDT,1):UBOUND(YD%XLCOR_SDT,1)))
READ (KLUN) ZTMP1
YD%XLCOR_SDT = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%XWC_KAPPA_T,1):UBOUND(YD%XWC_KAPPA_T,1)))
READ (KLUN) ZTMP1
YD%XWC_KAPPA_T = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%XCLIPM_SDT,1):UBOUND(YD%XCLIPM_SDT,1)))
READ (KLUN) ZTMP1
YD%XCLIPM_SDT = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(YD%XCLIP_RATIO_SDT,1):UBOUND(YD%XCLIP_RATIO_SDT,1)))
READ (KLUN) ZTMP1
YD%XCLIP_RATIO_SDT = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) ZTMP0
YD%XMEANRED_THICKNESS_SDT = ZTMP0
ALLOCATE (ZTMP1(LBOUND(YD%SDEVTOT_SDT,1):UBOUND(YD%SDEVTOT_SDT,1)))
READ (KLUN) ZTMP1
YD%SDEVTOT_SDT = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) ZTMP0
YD%XSIGMATOP = ZTMP0
READ (KLUN) ZTMP0
YD%XSIGMABOT = ZTMP0
READ (KLUN) ZTMP0
YD%XPRESSTOP_ST0 = ZTMP0
READ (KLUN) ZTMP0
YD%XPRESSBOT_ST0 = ZTMP0
READ (KLUN) ZTMP0
YD%XTAPER3 = ZTMP0
READ (KLUN) ZTMP0
YD%XTAPER2 = ZTMP0
READ (KLUN) ZTMP0
YD%XTAPER1 = ZTMP0
READ (KLUN) ZTMP0
YD%XTAPER0 = ZTMP0
READ (KLUN) ZTMP0
YD%XTAPER3_ST0 = ZTMP0
READ (KLUN) ZTMP0
YD%XTAPER2_ST0 = ZTMP0
READ (KLUN) ZTMP0
YD%XTAPER1_ST0 = ZTMP0
READ (KLUN) ZTMP0
YD%XTAPER0_ST0 = ZTMP0
READ (KLUN) ZTMP0
YD%XSPPTGFIXRLX = ZTMP0
READ (KLUN) YD%CSPEC_SHAPE_SDT
READ (KLUN) LCIPATINIT_SDT
IF (LCIPATINIT_SDT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%CIPATINIT_SDT (IL1(1):IU1(1)))
  READ (KLUN) YD%CIPATINIT_SDT
ELSE
  NULLIFY (YD%CIPATINIT_SDT)
ENDIF
READ (KLUN) LCOPATTRUN_SDT
IF (LCOPATTRUN_SDT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%COPATTRUN_SDT (IL1(1):IU1(1)))
  READ (KLUN) YD%COPATTRUN_SDT
ELSE
  NULLIFY (YD%COPATTRUN_SDT)
ENDIF
READ (KLUN) LCOPATSP_SDT
IF (LCOPATSP_SDT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%COPATSP_SDT (IL1(1):IU1(1)))
  READ (KLUN) YD%COPATSP_SDT
ELSE
  NULLIFY (YD%COPATSP_SDT)
ENDIF
READ (KLUN) LCOPATGP_SDT
IF (LCOPATGP_SDT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%COPATGP_SDT (IL1(1):IU1(1)))
  READ (KLUN) YD%COPATGP_SDT
ELSE
  NULLIFY (YD%COPATGP_SDT)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_TSPPT_CONFIG (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TSPPT_CONFIG), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LCIPATINIT_SDT, LCOPATGP_SDT, LCOPATSP_SDT, LCOPATTRUN_SDT, LLACTIVEO_SDT, LLACTIVEQ_SDT

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF


















LLACTIVEQ_SDT = ASSOCIATED (YD%LACTIVEQ_SDT)
IF (LLACTIVEQ_SDT) THEN
  !$ACC ENTER DATA CREATE (YD%LACTIVEQ_SDT)
  !$ACC UPDATE DEVICE (YD%LACTIVEQ_SDT)
  !$ACC ENTER DATA ATTACH (YD%LACTIVEQ_SDT)
ENDIF

LLACTIVEO_SDT = ASSOCIATED (YD%LACTIVEO_SDT)
IF (LLACTIVEO_SDT) THEN
  !$ACC ENTER DATA CREATE (YD%LACTIVEO_SDT)
  !$ACC UPDATE DEVICE (YD%LACTIVEO_SDT)
  !$ACC ENTER DATA ATTACH (YD%LACTIVEO_SDT)
ENDIF

































LCIPATINIT_SDT = ASSOCIATED (YD%CIPATINIT_SDT)
IF (LCIPATINIT_SDT) THEN
  !$ACC ENTER DATA CREATE (YD%CIPATINIT_SDT)
  !$ACC UPDATE DEVICE (YD%CIPATINIT_SDT)
  !$ACC ENTER DATA ATTACH (YD%CIPATINIT_SDT)
ENDIF

LCOPATTRUN_SDT = ASSOCIATED (YD%COPATTRUN_SDT)
IF (LCOPATTRUN_SDT) THEN
  !$ACC ENTER DATA CREATE (YD%COPATTRUN_SDT)
  !$ACC UPDATE DEVICE (YD%COPATTRUN_SDT)
  !$ACC ENTER DATA ATTACH (YD%COPATTRUN_SDT)
ENDIF

LCOPATSP_SDT = ASSOCIATED (YD%COPATSP_SDT)
IF (LCOPATSP_SDT) THEN
  !$ACC ENTER DATA CREATE (YD%COPATSP_SDT)
  !$ACC UPDATE DEVICE (YD%COPATSP_SDT)
  !$ACC ENTER DATA ATTACH (YD%COPATSP_SDT)
ENDIF

LCOPATGP_SDT = ASSOCIATED (YD%COPATGP_SDT)
IF (LCOPATGP_SDT) THEN
  !$ACC ENTER DATA CREATE (YD%COPATGP_SDT)
  !$ACC UPDATE DEVICE (YD%COPATGP_SDT)
  !$ACC ENTER DATA ATTACH (YD%COPATGP_SDT)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_TSPPT_CONFIG (YD)

IMPLICIT NONE
TYPE (TSPPT_CONFIG), TARGET :: YD
LOGICAL :: LCIPATINIT_SDT, LCOPATGP_SDT, LCOPATSP_SDT, LCOPATTRUN_SDT, LLACTIVEO_SDT, LLACTIVEQ_SDT
























































END SUBROUTINE

     

SUBROUTINE CRC64_TSPPT_CONFIG (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TSPPT_CONFIG), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LCIPATINIT_SDT, LCOPATGP_SDT, LCOPATSP_SDT, LCOPATTRUN_SDT, LLACTIVEO_SDT, LLACTIVEQ_SDT
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPSDT), CDPATH//'%LSPSDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRADCLR_SDT), CDPATH//'%LRADCLR_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSATADJ_SDT), CDPATH//'%LSATADJ_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPPT1), CDPATH//'%LSPPT1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPPTGFIX), CDPATH//'%LSPPTGFIX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCLIP_SPEC_SDT), CDPATH//'%LCLIP_SPEC_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCLIP_GRID_SDT), CDPATH//'%LCLIP_GRID_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LQPERTLIMIT2), CDPATH//'%LQPERTLIMIT2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LTAPER_BL0), CDPATH//'%LTAPER_BL0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LTAPER_BLI), CDPATH//'%LTAPER_BLI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LTAPER_ST0), CDPATH//'%LTAPER_ST0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LTAPER_STI), CDPATH//'%LTAPER_STI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LUSESETRAN_SDT), CDPATH//'%LUSESETRAN_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRESETSEED_SDT), CDPATH//'%LRESETSEED_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LABSTIMSEED_SDT), CDPATH//'%LABSTIMSEED_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWRITE_ARP), CDPATH//'%LWRITE_ARP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRDPATINIT_SDT), CDPATH//'%LRDPATINIT_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWRPATTRUN_SDT), CDPATH//'%LWRPATTRUN_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LACTIVEQ_SDT), CDPATH//'%LACTIVEQ_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LACTIVEO_SDT), CDPATH//'%LACTIVEO_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSCALES_SDT), CDPATH//'%NSCALES_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPATFR), CDPATH//'%NPATFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RESETSEEDFRQ_SDT), CDPATH//'%RESETSEEDFRQ_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NWRPATTRUN_SDT), CDPATH//'%NWRPATTRUN_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NHOUR_PATTRUN), CDPATH//'%NHOUR_PATTRUN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSTEP_PATTRUN), CDPATH//'%NSTEP_PATTRUN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCLIP_KIND_SDT), CDPATH//'%NCLIP_KIND_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NQSAT_SDT), CDPATH//'%NQSAT_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NWN_TESTSPEC_SDT), CDPATH//'%NWN_TESTSPEC_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NWAV_TESTSPEC_SDT), CDPATH//'%NWAV_TESTSPEC_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SDEV_SDT), CDPATH//'%SDEV_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TAU_SDT), CDPATH//'%TAU_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XLCOR_SDT), CDPATH//'%XLCOR_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XWC_KAPPA_T), CDPATH//'%XWC_KAPPA_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCLIPM_SDT), CDPATH//'%XCLIPM_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCLIP_RATIO_SDT), CDPATH//'%XCLIP_RATIO_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XMEANRED_THICKNESS_SDT), CDPATH//'%XMEANRED_THICKNESS_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SDEVTOT_SDT), CDPATH//'%SDEVTOT_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XSIGMATOP), CDPATH//'%XSIGMATOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XSIGMABOT), CDPATH//'%XSIGMABOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XPRESSTOP_ST0), CDPATH//'%XPRESSTOP_ST0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XPRESSBOT_ST0), CDPATH//'%XPRESSBOT_ST0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XTAPER3), CDPATH//'%XTAPER3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XTAPER2), CDPATH//'%XTAPER2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XTAPER1), CDPATH//'%XTAPER1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XTAPER0), CDPATH//'%XTAPER0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XTAPER3_ST0), CDPATH//'%XTAPER3_ST0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XTAPER2_ST0), CDPATH//'%XTAPER2_ST0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XTAPER1_ST0), CDPATH//'%XTAPER1_ST0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XTAPER0_ST0), CDPATH//'%XTAPER0_ST0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XSPPTGFIXRLX), CDPATH//'%XSPPTGFIXRLX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CSPEC_SHAPE_SDT), CDPATH//'%CSPEC_SHAPE_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CIPATINIT_SDT), CDPATH//'%CIPATINIT_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%COPATTRUN_SDT), CDPATH//'%COPATTRUN_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%COPATSP_SDT), CDPATH//'%COPATSP_SDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%COPATGP_SDT), CDPATH//'%COPATGP_SDT'

END SUBROUTINE

SUBROUTINE WIPE_TSPPT_CONFIG (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TSPPT_CONFIG), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LCIPATINIT_SDT, LCOPATGP_SDT, LCOPATSP_SDT, LCOPATTRUN_SDT, LLACTIVEO_SDT, LLACTIVEQ_SDT

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF


















LLACTIVEQ_SDT = ASSOCIATED (YD%LACTIVEQ_SDT)
IF (LLACTIVEQ_SDT) THEN
  !$ACC EXIT DATA DETACH (YD%LACTIVEQ_SDT)
  !$ACC EXIT DATA DETACH (YD%LACTIVEQ_SDT)
ENDIF

LLACTIVEO_SDT = ASSOCIATED (YD%LACTIVEO_SDT)
IF (LLACTIVEO_SDT) THEN
  !$ACC EXIT DATA DETACH (YD%LACTIVEO_SDT)
  !$ACC EXIT DATA DETACH (YD%LACTIVEO_SDT)
ENDIF

































LCIPATINIT_SDT = ASSOCIATED (YD%CIPATINIT_SDT)
IF (LCIPATINIT_SDT) THEN
  !$ACC EXIT DATA DETACH (YD%CIPATINIT_SDT)
  !$ACC EXIT DATA DETACH (YD%CIPATINIT_SDT)
ENDIF

LCOPATTRUN_SDT = ASSOCIATED (YD%COPATTRUN_SDT)
IF (LCOPATTRUN_SDT) THEN
  !$ACC EXIT DATA DETACH (YD%COPATTRUN_SDT)
  !$ACC EXIT DATA DETACH (YD%COPATTRUN_SDT)
ENDIF

LCOPATSP_SDT = ASSOCIATED (YD%COPATSP_SDT)
IF (LCOPATSP_SDT) THEN
  !$ACC EXIT DATA DETACH (YD%COPATSP_SDT)
  !$ACC EXIT DATA DETACH (YD%COPATSP_SDT)
ENDIF

LCOPATGP_SDT = ASSOCIATED (YD%COPATGP_SDT)
IF (LCOPATGP_SDT) THEN
  !$ACC EXIT DATA DETACH (YD%COPATGP_SDT)
  !$ACC EXIT DATA DETACH (YD%COPATGP_SDT)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TSPPT_CONFIG (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TSPPT_CONFIG),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LCIPATINIT_SDT, LCOPATGP_SDT, LCOPATSP_SDT, LCOPATTRUN_SDT, LLACTIVEO_SDT, LLACTIVEQ_SDT

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%LSPSDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPSDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LRADCLR_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRADCLR_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSATADJ_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSATADJ_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSPPT1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPPT1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSPPTGFIX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPPTGFIX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCLIP_SPEC_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCLIP_SPEC_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCLIP_GRID_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCLIP_GRID_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LQPERTLIMIT2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LQPERTLIMIT2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LTAPER_BL0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LTAPER_BL0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LTAPER_BLI) * SIZE (YD%LTAPER_BLI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LTAPER_BLI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LTAPER_ST0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LTAPER_ST0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LTAPER_STI) * SIZE (YD%LTAPER_STI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LTAPER_STI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LUSESETRAN_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LUSESETRAN_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LRESETSEED_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRESETSEED_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LABSTIMSEED_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LABSTIMSEED_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWRITE_ARP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWRITE_ARP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LRDPATINIT_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRDPATINIT_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWRPATTRUN_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWRPATTRUN_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
LLACTIVEQ_SDT = ASSOCIATED (YD%LACTIVEQ_SDT)
IF (LLACTIVEQ_SDT) THEN
  ISIZE = KIND (YD%LACTIVEQ_SDT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%LACTIVEQ_SDT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LLACTIVEO_SDT = ASSOCIATED (YD%LACTIVEO_SDT)
IF (LLACTIVEO_SDT) THEN
  ISIZE = KIND (YD%LACTIVEO_SDT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%LACTIVEO_SDT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%NSCALES_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSCALES_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPATFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPATFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RESETSEEDFRQ_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RESETSEEDFRQ_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NWRPATTRUN_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NWRPATTRUN_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NHOUR_PATTRUN) * SIZE (YD%NHOUR_PATTRUN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NHOUR_PATTRUN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSTEP_PATTRUN) * SIZE (YD%NSTEP_PATTRUN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSTEP_PATTRUN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCLIP_KIND_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCLIP_KIND_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NQSAT_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NQSAT_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NWN_TESTSPEC_SDT) * SIZE (YD%NWN_TESTSPEC_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NWN_TESTSPEC_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NWAV_TESTSPEC_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NWAV_TESTSPEC_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%SDEV_SDT) * SIZE (YD%SDEV_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SDEV_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TAU_SDT) * SIZE (YD%TAU_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TAU_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XLCOR_SDT) * SIZE (YD%XLCOR_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XLCOR_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XWC_KAPPA_T) * SIZE (YD%XWC_KAPPA_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XWC_KAPPA_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCLIPM_SDT) * SIZE (YD%XCLIPM_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCLIPM_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCLIP_RATIO_SDT) * SIZE (YD%XCLIP_RATIO_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCLIP_RATIO_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XMEANRED_THICKNESS_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XMEANRED_THICKNESS_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%SDEVTOT_SDT) * SIZE (YD%SDEVTOT_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SDEVTOT_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XSIGMATOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XSIGMATOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XSIGMABOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XSIGMABOT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XPRESSTOP_ST0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XPRESSTOP_ST0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XPRESSBOT_ST0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XPRESSBOT_ST0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XTAPER3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XTAPER3'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XTAPER2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XTAPER2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XTAPER1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XTAPER1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XTAPER0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XTAPER0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XTAPER3_ST0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XTAPER3_ST0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XTAPER2_ST0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XTAPER2_ST0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XTAPER1_ST0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XTAPER1_ST0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XTAPER0_ST0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XTAPER0_ST0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XSPPTGFIXRLX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XSPPTGFIXRLX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CSPEC_SHAPE_SDT) * LEN (YD%CSPEC_SHAPE_SDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CSPEC_SHAPE_SDT'
ENDIF
KSIZE = KSIZE + ISIZE
LCIPATINIT_SDT = ASSOCIATED (YD%CIPATINIT_SDT)
IF (LCIPATINIT_SDT) THEN
  ISIZE = KIND (YD%CIPATINIT_SDT) * SIZE (YD%CIPATINIT_SDT) * LEN (YD%CIPATINIT_SDT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CIPATINIT_SDT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCOPATTRUN_SDT = ASSOCIATED (YD%COPATTRUN_SDT)
IF (LCOPATTRUN_SDT) THEN
  ISIZE = KIND (YD%COPATTRUN_SDT) * SIZE (YD%COPATTRUN_SDT) * LEN (YD%COPATTRUN_SDT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%COPATTRUN_SDT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCOPATSP_SDT = ASSOCIATED (YD%COPATSP_SDT)
IF (LCOPATSP_SDT) THEN
  ISIZE = KIND (YD%COPATSP_SDT) * SIZE (YD%COPATSP_SDT) * LEN (YD%COPATSP_SDT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%COPATSP_SDT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCOPATGP_SDT = ASSOCIATED (YD%COPATGP_SDT)
IF (LCOPATGP_SDT) THEN
  ISIZE = KIND (YD%COPATGP_SDT) * SIZE (YD%COPATGP_SDT) * LEN (YD%COPATGP_SDT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%COPATGP_SDT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
