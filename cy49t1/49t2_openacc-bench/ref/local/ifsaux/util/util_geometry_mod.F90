MODULE UTIL_GEOMETRY_MOD

USE TYPE_GEOMETRY, ONLY : GEOMETRY

INTERFACE SAVE
MODULE PROCEDURE SAVE_GEOMETRY
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_GEOMETRY
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_GEOMETRY
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_GEOMETRY
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_GEOMETRY
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_GEOMETRY
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_GEOMETRY
END INTERFACE


CONTAINS

SUBROUTINE SAVE_GEOMETRY (KLUN, YD)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (GEOMETRY), INTENT (IN), TARGET :: YD
LOGICAL :: LYRELBC_GEO
WRITE (KLUN) YD%LNHX_GEOM
CALL SAVE_TVERTICAL_GEOM (KLUN, YD%YRVERT_GEOM)
CALL SAVE_TSTA (KLUN, YD%YRSTA)
CALL SAVE_TLAP (KLUN, YD%YRLAP)
CALL SAVE_TCSGLEG (KLUN, YD%YRCSGLEG)
CALL SAVE_TDIM (KLUN, YD%YRDIM)
CALL SAVE_TDIMV (KLUN, YD%YRDIMV)
CALL SAVE_TMP (KLUN, YD%YRMP)
CALL SAVE_TGEM (KLUN, YD%YRGEM)
WRITE (KLUN) YD%AD_GEOM
CALL SAVE_TOROG_BLOCKED (KLUN, YD%YROROG_B)
CALL SAVE_TSPGEOM (KLUN, YD%YSPGEOM)
CALL SAVE_TVAB (KLUN, YD%YVABIO)
CALL SAVE_TEDIM (KLUN, YD%YREDIM)
CALL SAVE_TEGEO (KLUN, YD%YREGEO)
CALL SAVE_TEMMP (KLUN, YD%YREMP)
CALL SAVE_TLEP (KLUN, YD%YRELAP)
CALL SAVE_TEGSL (KLUN, YD%YREGSL)
LYRELBC_GEO = ASSOCIATED (YD%YRELBC_GEO)
WRITE (KLUN) LYRELBC_GEO
IF (LYRELBC_GEO) THEN
  CALL SAVE_TELBC_GEO (KLUN, YD%YRELBC_GEO)
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_GEOMETRY (KLUN, YD)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (GEOMETRY), INTENT (OUT), TARGET :: YD
LOGICAL :: LYRELBC_GEO
READ (KLUN) YD%LNHX_GEOM
CALL LOAD_TVERTICAL_GEOM (KLUN, YD%YRVERT_GEOM)
CALL LOAD_TSTA (KLUN, YD%YRSTA)
CALL LOAD_TLAP (KLUN, YD%YRLAP)
CALL LOAD_TCSGLEG (KLUN, YD%YRCSGLEG)
CALL LOAD_TDIM (KLUN, YD%YRDIM)
CALL LOAD_TDIMV (KLUN, YD%YRDIMV)
CALL LOAD_TMP (KLUN, YD%YRMP)
CALL LOAD_TGEM (KLUN, YD%YRGEM)
NULLIFY (YD%YRCSGEOM)
NULLIFY (YD%YRGSGEOM)
READ (KLUN) YD%AD_GEOM
NULLIFY (YD%YRCSGEOMAD)
NULLIFY (YD%YRGSGEOMAD)
CALL LOAD_TOROG_BLOCKED (KLUN, YD%YROROG_B)
CALL LOAD_TSPGEOM (KLUN, YD%YSPGEOM)
CALL LOAD_TVAB (KLUN, YD%YVABIO)
CALL LOAD_TEDIM (KLUN, YD%YREDIM)
CALL LOAD_TEGEO (KLUN, YD%YREGEO)
CALL LOAD_TEMMP (KLUN, YD%YREMP)
CALL LOAD_TLEP (KLUN, YD%YRELAP)
CALL LOAD_TEGSL (KLUN, YD%YREGSL)
READ (KLUN) LYRELBC_GEO
IF (LYRELBC_GEO) THEN
  ALLOCATE (YD%YRELBC_GEO)
  CALL LOAD_TELBC_GEO (KLUN, YD%YRELBC_GEO)
ELSE
  NULLIFY (YD%YRELBC_GEO)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_GEOMETRY (YD, LDCREATED, LDFIELDAPI)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
TYPE (GEOMETRY), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LYRELBC_GEO

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF

CALL COPY_TVERTICAL_GEOM (YD%YRVERT_GEOM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TSTA (YD%YRSTA, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TLAP (YD%YRLAP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TCSGLEG (YD%YRCSGLEG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TDIM (YD%YRDIM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TDIMV (YD%YRDIMV, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TMP (YD%YRMP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TGEM (YD%YRGEM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)


CALL COPY_TOROG_BLOCKED (YD%YROROG_B, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TSPGEOM (YD%YSPGEOM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TVAB (YD%YVABIO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TEDIM (YD%YREDIM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TEGEO (YD%YREGEO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TEMMP (YD%YREMP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TLEP (YD%YRELAP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TEGSL (YD%YREGSL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LYRELBC_GEO = ASSOCIATED (YD%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  !$ACC ENTER DATA CREATE (YD%YRELBC_GEO)
  !$ACC UPDATE DEVICE (YD%YRELBC_GEO)
  CALL COPY_TELBC_GEO (YD%YRELBC_GEO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YRELBC_GEO)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_GEOMETRY (YD)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD

IMPLICIT NONE
TYPE (GEOMETRY), TARGET :: YD
LOGICAL :: LYRELBC_GEO

CALL HOST_TVERTICAL_GEOM (YD%YRVERT_GEOM)

CALL HOST_TSTA (YD%YRSTA)

CALL HOST_TLAP (YD%YRLAP)

CALL HOST_TCSGLEG (YD%YRCSGLEG)

CALL HOST_TDIM (YD%YRDIM)

CALL HOST_TDIMV (YD%YRDIMV)

CALL HOST_TMP (YD%YRMP)

CALL HOST_TGEM (YD%YRGEM)


CALL HOST_TOROG_BLOCKED (YD%YROROG_B)

CALL HOST_TSPGEOM (YD%YSPGEOM)

CALL HOST_TVAB (YD%YVABIO)

CALL HOST_TEDIM (YD%YREDIM)

CALL HOST_TEGEO (YD%YREGEO)

CALL HOST_TEMMP (YD%YREMP)

CALL HOST_TLEP (YD%YRELAP)

CALL HOST_TEGSL (YD%YREGSL)

LYRELBC_GEO = ASSOCIATED (YD%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  CALL HOST_TELBC_GEO (YD%YRELBC_GEO)
ENDIF

END SUBROUTINE

     

SUBROUTINE CRC64_GEOMETRY (YD, KLUN, CDPATH)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (GEOMETRY), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LYRELBC_GEO
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNHX_GEOM), CDPATH//'%LNHX_GEOM'

CLIND = ''
CALL CRC64_TVERTICAL_GEOM (YD%YRVERT_GEOM, KLUN, CDPATH//'%YRVERT_GEOM'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TSTA (YD%YRSTA, KLUN, CDPATH//'%YRSTA'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TLAP (YD%YRLAP, KLUN, CDPATH//'%YRLAP'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TCSGLEG (YD%YRCSGLEG, KLUN, CDPATH//'%YRCSGLEG'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TDIM (YD%YRDIM, KLUN, CDPATH//'%YRDIM'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TDIMV (YD%YRDIMV, KLUN, CDPATH//'%YRDIMV'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TMP (YD%YRMP, KLUN, CDPATH//'%YRMP'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TGEM (YD%YRGEM, KLUN, CDPATH//'%YRGEM'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%AD_GEOM), CDPATH//'%AD_GEOM'

CLIND = ''
CALL CRC64_TOROG_BLOCKED (YD%YROROG_B, KLUN, CDPATH//'%YROROG_B'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TSPGEOM (YD%YSPGEOM, KLUN, CDPATH//'%YSPGEOM'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TVAB (YD%YVABIO, KLUN, CDPATH//'%YVABIO'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TEDIM (YD%YREDIM, KLUN, CDPATH//'%YREDIM'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TEGEO (YD%YREGEO, KLUN, CDPATH//'%YREGEO'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TEMMP (YD%YREMP, KLUN, CDPATH//'%YREMP'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TLEP (YD%YRELAP, KLUN, CDPATH//'%YRELAP'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TEGSL (YD%YREGSL, KLUN, CDPATH//'%YREGSL'//TRIM(CLIND))

LYRELBC_GEO = ASSOCIATED (YD%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  CLIND = ''
  CALL CRC64_TELBC_GEO (YD%YRELBC_GEO, KLUN, CDPATH//'%YRELBC_GEO'//TRIM(CLIND))
ENDIF

END SUBROUTINE

SUBROUTINE WIPE_GEOMETRY (YD, LDDELETED, LDFIELDAPI)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
TYPE (GEOMETRY), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LYRELBC_GEO

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

CALL WIPE_TVERTICAL_GEOM (YD%YRVERT_GEOM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TSTA (YD%YRSTA, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TLAP (YD%YRLAP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TCSGLEG (YD%YRCSGLEG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TDIM (YD%YRDIM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TDIMV (YD%YRDIMV, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TMP (YD%YRMP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TGEM (YD%YRGEM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)


CALL WIPE_TOROG_BLOCKED (YD%YROROG_B, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TSPGEOM (YD%YSPGEOM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TVAB (YD%YVABIO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TEDIM (YD%YREDIM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TEGEO (YD%YREGEO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TEMMP (YD%YREMP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TLEP (YD%YRELAP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TEGSL (YD%YREGSL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LYRELBC_GEO = ASSOCIATED (YD%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  !$ACC EXIT DATA DETACH (YD%YRELBC_GEO)
  CALL WIPE_TELBC_GEO (YD%YRELBC_GEO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YRELBC_GEO)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_GEOMETRY (YD, CDPATH, LDPRINT) RESULT (KSIZE)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
TYPE (GEOMETRY),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LYRELBC_GEO

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%LNHX_GEOM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNHX_GEOM'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
ISIZE = SIZE_TVERTICAL_GEOM (YD%YRVERT_GEOM, CLPATH//'%YRVERT_GEOM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRVERT_GEOM'
ENDIF
JSIZE = 0
ISIZE = SIZE_TSTA (YD%YRSTA, CLPATH//'%YRSTA', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRSTA'
ENDIF
JSIZE = 0
ISIZE = SIZE_TLAP (YD%YRLAP, CLPATH//'%YRLAP', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRLAP'
ENDIF
JSIZE = 0
ISIZE = SIZE_TCSGLEG (YD%YRCSGLEG, CLPATH//'%YRCSGLEG', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRCSGLEG'
ENDIF
JSIZE = 0
ISIZE = SIZE_TDIM (YD%YRDIM, CLPATH//'%YRDIM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRDIM'
ENDIF
JSIZE = 0
ISIZE = SIZE_TDIMV (YD%YRDIMV, CLPATH//'%YRDIMV', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRDIMV'
ENDIF
JSIZE = 0
ISIZE = SIZE_TMP (YD%YRMP, CLPATH//'%YRMP', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRMP'
ENDIF
JSIZE = 0
ISIZE = SIZE_TGEM (YD%YRGEM, CLPATH//'%YRGEM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRGEM'
ENDIF
ISIZE = KIND (YD%AD_GEOM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%AD_GEOM'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
ISIZE = SIZE_TOROG_BLOCKED (YD%YROROG_B, CLPATH//'%YROROG_B', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YROROG_B'
ENDIF
JSIZE = 0
ISIZE = SIZE_TSPGEOM (YD%YSPGEOM, CLPATH//'%YSPGEOM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YSPGEOM'
ENDIF
JSIZE = 0
ISIZE = SIZE_TVAB (YD%YVABIO, CLPATH//'%YVABIO', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YVABIO'
ENDIF
JSIZE = 0
ISIZE = SIZE_TEDIM (YD%YREDIM, CLPATH//'%YREDIM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREDIM'
ENDIF
JSIZE = 0
ISIZE = SIZE_TEGEO (YD%YREGEO, CLPATH//'%YREGEO', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREGEO'
ENDIF
JSIZE = 0
ISIZE = SIZE_TEMMP (YD%YREMP, CLPATH//'%YREMP', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREMP'
ENDIF
JSIZE = 0
ISIZE = SIZE_TLEP (YD%YRELAP, CLPATH//'%YRELAP', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRELAP'
ENDIF
JSIZE = 0
ISIZE = SIZE_TEGSL (YD%YREGSL, CLPATH//'%YREGSL', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREGSL'
ENDIF
LYRELBC_GEO = ASSOCIATED (YD%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  JSIZE = 0
  ISIZE = SIZE_TELBC_GEO (YD%YRELBC_GEO, CLPATH//'%YRELBC_GEO', .FALSE.)
  JSIZE = JSIZE + ISIZE
  KSIZE = KSIZE + ISIZE
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
    WRITE (*, *) TRIM (CLPATH)//'%YRELBC_GEO'
  ENDIF
ENDIF
END FUNCTION

END MODULE
