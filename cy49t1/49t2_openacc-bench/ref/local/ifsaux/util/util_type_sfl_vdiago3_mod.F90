MODULE UTIL_TYPE_SFL_VDIAGO3_MOD

USE SURFACE_FIELDS_MIX, ONLY : TYPE_SFL_VDIAGO3

INTERFACE SAVE
MODULE PROCEDURE SAVE_TYPE_SFL_VDIAGO3
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TYPE_SFL_VDIAGO3
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TYPE_SFL_VDIAGO3
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TYPE_SFL_VDIAGO3
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TYPE_SFL_VDIAGO3
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TYPE_SFL_VDIAGO3
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TYPE_SFL_VDIAGO3 (SELF, KLUN)
USE UTIL_TYPE_SURF_MTL_3D_MOD
IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO
LYDIFM = ASSOCIATED (SELF%YDIFM)
WRITE (KLUN) LYDIFM
IF (LYDIFM) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YDIFM, KLUN)
ENDIF
LYDIFT = ASSOCIATED (SELF%YDIFT)
WRITE (KLUN) LYDIFT
IF (LYDIFT) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YDIFT, KLUN)
ENDIF
LYDIFS = ASSOCIATED (SELF%YDIFS)
WRITE (KLUN) LYDIFS
IF (LYDIFS) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YDIFS, KLUN)
ENDIF
LYADVT = ASSOCIATED (SELF%YADVT)
WRITE (KLUN) LYADVT
IF (LYADVT) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YADVT, KLUN)
ENDIF
LYADVS = ASSOCIATED (SELF%YADVS)
WRITE (KLUN) LYADVS
IF (LYADVS) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YADVS, KLUN)
ENDIF
LYTRI0 = ASSOCIATED (SELF%YTRI0)
WRITE (KLUN) LYTRI0
IF (LYTRI0) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YTRI0, KLUN)
ENDIF
LYTRI1 = ASSOCIATED (SELF%YTRI1)
WRITE (KLUN) LYTRI1
IF (LYTRI1) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YTRI1, KLUN)
ENDIF
LYSWDK = ASSOCIATED (SELF%YSWDK)
WRITE (KLUN) LYSWDK
IF (LYSWDK) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YSWDK, KLUN)
ENDIF
LYZO = ASSOCIATED (SELF%YZO)
WRITE (KLUN) LYZO
IF (LYZO) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YZO, KLUN)
ENDIF
LYHO = ASSOCIATED (SELF%YHO)
WRITE (KLUN) LYHO
IF (LYHO) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YHO, KLUN)
ENDIF
LYDO = ASSOCIATED (SELF%YDO)
WRITE (KLUN) LYDO
IF (LYDO) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YDO, KLUN)
ENDIF
LYHO_INV = ASSOCIATED (SELF%YHO_INV)
WRITE (KLUN) LYHO_INV
IF (LYHO_INV) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YHO_INV, KLUN)
ENDIF
LYUOC = ASSOCIATED (SELF%YUOC)
WRITE (KLUN) LYUOC
IF (LYUOC) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YUOC, KLUN)
ENDIF
LYVOC = ASSOCIATED (SELF%YVOC)
WRITE (KLUN) LYVOC
IF (LYVOC) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YVOC, KLUN)
ENDIF
LYOTKE = ASSOCIATED (SELF%YOTKE)
WRITE (KLUN) LYOTKE
IF (LYOTKE) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (SELF%YOTKE, KLUN)
ENDIF
LYV3 = ASSOCIATED (SELF%YV3)
WRITE (KLUN) LYV3
IF (LYV3) THEN
  WRITE (KLUN) LBOUND (SELF%YV3)
  WRITE (KLUN) UBOUND (SELF%YV3)
  DO J1 = LBOUND (SELF%YV3, 1), UBOUND (SELF%YV3, 1)
    CALL SAVE_TYPE_SURF_MTL_3D (SELF%YV3 (J1), KLUN)
  ENDDO
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_TYPE_SFL_VDIAGO3 (SELF, KLUN)
USE UTIL_TYPE_SURF_MTL_3D_MOD

IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: J1
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO
READ (KLUN) LYDIFM
IF (LYDIFM) THEN
  ALLOCATE (SELF%YDIFM)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YDIFM, KLUN)
ELSE
  NULLIFY (SELF%YDIFM)
ENDIF
READ (KLUN) LYDIFT
IF (LYDIFT) THEN
  ALLOCATE (SELF%YDIFT)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YDIFT, KLUN)
ELSE
  NULLIFY (SELF%YDIFT)
ENDIF
READ (KLUN) LYDIFS
IF (LYDIFS) THEN
  ALLOCATE (SELF%YDIFS)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YDIFS, KLUN)
ELSE
  NULLIFY (SELF%YDIFS)
ENDIF
READ (KLUN) LYADVT
IF (LYADVT) THEN
  ALLOCATE (SELF%YADVT)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YADVT, KLUN)
ELSE
  NULLIFY (SELF%YADVT)
ENDIF
READ (KLUN) LYADVS
IF (LYADVS) THEN
  ALLOCATE (SELF%YADVS)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YADVS, KLUN)
ELSE
  NULLIFY (SELF%YADVS)
ENDIF
READ (KLUN) LYTRI0
IF (LYTRI0) THEN
  ALLOCATE (SELF%YTRI0)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YTRI0, KLUN)
ELSE
  NULLIFY (SELF%YTRI0)
ENDIF
READ (KLUN) LYTRI1
IF (LYTRI1) THEN
  ALLOCATE (SELF%YTRI1)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YTRI1, KLUN)
ELSE
  NULLIFY (SELF%YTRI1)
ENDIF
READ (KLUN) LYSWDK
IF (LYSWDK) THEN
  ALLOCATE (SELF%YSWDK)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YSWDK, KLUN)
ELSE
  NULLIFY (SELF%YSWDK)
ENDIF
READ (KLUN) LYZO
IF (LYZO) THEN
  ALLOCATE (SELF%YZO)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YZO, KLUN)
ELSE
  NULLIFY (SELF%YZO)
ENDIF
READ (KLUN) LYHO
IF (LYHO) THEN
  ALLOCATE (SELF%YHO)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YHO, KLUN)
ELSE
  NULLIFY (SELF%YHO)
ENDIF
READ (KLUN) LYDO
IF (LYDO) THEN
  ALLOCATE (SELF%YDO)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YDO, KLUN)
ELSE
  NULLIFY (SELF%YDO)
ENDIF
READ (KLUN) LYHO_INV
IF (LYHO_INV) THEN
  ALLOCATE (SELF%YHO_INV)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YHO_INV, KLUN)
ELSE
  NULLIFY (SELF%YHO_INV)
ENDIF
READ (KLUN) LYUOC
IF (LYUOC) THEN
  ALLOCATE (SELF%YUOC)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YUOC, KLUN)
ELSE
  NULLIFY (SELF%YUOC)
ENDIF
READ (KLUN) LYVOC
IF (LYVOC) THEN
  ALLOCATE (SELF%YVOC)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YVOC, KLUN)
ELSE
  NULLIFY (SELF%YVOC)
ENDIF
READ (KLUN) LYOTKE
IF (LYOTKE) THEN
  ALLOCATE (SELF%YOTKE)
  CALL LOAD_TYPE_SURF_MTL_3D (SELF%YOTKE, KLUN)
ELSE
  NULLIFY (SELF%YOTKE)
ENDIF
READ (KLUN) LYV3
IF (LYV3) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%YV3 (IL1(1):IU1(1)))
  DO J1 = LBOUND (SELF%YV3, 1), UBOUND (SELF%YV3, 1)
    CALL LOAD_TYPE_SURF_MTL_3D (SELF%YV3 (J1), KLUN)
  ENDDO
ELSE
  NULLIFY (SELF%YV3)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_TYPE_SFL_VDIAGO3 (SELF, LDCREATED, LDFIELDAPI)
USE UTIL_TYPE_SURF_MTL_3D_MOD
IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LYDIFM = ASSOCIATED (SELF%YDIFM)
IF (LYDIFM) THEN
  !$ACC ENTER DATA CREATE (SELF%YDIFM)
  !$ACC UPDATE DEVICE (SELF%YDIFM)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YDIFM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YDIFM)
ENDIF

LYDIFT = ASSOCIATED (SELF%YDIFT)
IF (LYDIFT) THEN
  !$ACC ENTER DATA CREATE (SELF%YDIFT)
  !$ACC UPDATE DEVICE (SELF%YDIFT)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YDIFT, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YDIFT)
ENDIF

LYDIFS = ASSOCIATED (SELF%YDIFS)
IF (LYDIFS) THEN
  !$ACC ENTER DATA CREATE (SELF%YDIFS)
  !$ACC UPDATE DEVICE (SELF%YDIFS)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YDIFS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YDIFS)
ENDIF

LYADVT = ASSOCIATED (SELF%YADVT)
IF (LYADVT) THEN
  !$ACC ENTER DATA CREATE (SELF%YADVT)
  !$ACC UPDATE DEVICE (SELF%YADVT)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YADVT, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YADVT)
ENDIF

LYADVS = ASSOCIATED (SELF%YADVS)
IF (LYADVS) THEN
  !$ACC ENTER DATA CREATE (SELF%YADVS)
  !$ACC UPDATE DEVICE (SELF%YADVS)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YADVS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YADVS)
ENDIF

LYTRI0 = ASSOCIATED (SELF%YTRI0)
IF (LYTRI0) THEN
  !$ACC ENTER DATA CREATE (SELF%YTRI0)
  !$ACC UPDATE DEVICE (SELF%YTRI0)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YTRI0, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YTRI0)
ENDIF

LYTRI1 = ASSOCIATED (SELF%YTRI1)
IF (LYTRI1) THEN
  !$ACC ENTER DATA CREATE (SELF%YTRI1)
  !$ACC UPDATE DEVICE (SELF%YTRI1)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YTRI1, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YTRI1)
ENDIF

LYSWDK = ASSOCIATED (SELF%YSWDK)
IF (LYSWDK) THEN
  !$ACC ENTER DATA CREATE (SELF%YSWDK)
  !$ACC UPDATE DEVICE (SELF%YSWDK)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YSWDK, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YSWDK)
ENDIF

LYZO = ASSOCIATED (SELF%YZO)
IF (LYZO) THEN
  !$ACC ENTER DATA CREATE (SELF%YZO)
  !$ACC UPDATE DEVICE (SELF%YZO)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YZO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YZO)
ENDIF

LYHO = ASSOCIATED (SELF%YHO)
IF (LYHO) THEN
  !$ACC ENTER DATA CREATE (SELF%YHO)
  !$ACC UPDATE DEVICE (SELF%YHO)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YHO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YHO)
ENDIF

LYDO = ASSOCIATED (SELF%YDO)
IF (LYDO) THEN
  !$ACC ENTER DATA CREATE (SELF%YDO)
  !$ACC UPDATE DEVICE (SELF%YDO)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YDO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YDO)
ENDIF

LYHO_INV = ASSOCIATED (SELF%YHO_INV)
IF (LYHO_INV) THEN
  !$ACC ENTER DATA CREATE (SELF%YHO_INV)
  !$ACC UPDATE DEVICE (SELF%YHO_INV)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YHO_INV, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YHO_INV)
ENDIF

LYUOC = ASSOCIATED (SELF%YUOC)
IF (LYUOC) THEN
  !$ACC ENTER DATA CREATE (SELF%YUOC)
  !$ACC UPDATE DEVICE (SELF%YUOC)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YUOC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YUOC)
ENDIF

LYVOC = ASSOCIATED (SELF%YVOC)
IF (LYVOC) THEN
  !$ACC ENTER DATA CREATE (SELF%YVOC)
  !$ACC UPDATE DEVICE (SELF%YVOC)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YVOC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YVOC)
ENDIF

LYOTKE = ASSOCIATED (SELF%YOTKE)
IF (LYOTKE) THEN
  !$ACC ENTER DATA CREATE (SELF%YOTKE)
  !$ACC UPDATE DEVICE (SELF%YOTKE)
  CALL COPY_TYPE_SURF_MTL_3D (SELF%YOTKE, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YOTKE)
ENDIF

LYV3 = ASSOCIATED (SELF%YV3)
IF (LYV3) THEN
  !$ACC ENTER DATA CREATE (SELF%YV3)
  !$ACC UPDATE DEVICE (SELF%YV3)
  DO J1 = LBOUND (SELF%YV3, 1), UBOUND (SELF%YV3, 1)
    CALL COPY_TYPE_SURF_MTL_3D (SELF%YV3 (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%YV3)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_TYPE_SFL_VDIAGO3 (SELF)
USE UTIL_TYPE_SURF_MTL_3D_MOD

IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), TARGET :: SELF
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO
LYDIFM = ASSOCIATED (SELF%YDIFM)
IF (LYDIFM) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YDIFM)
ENDIF

LYDIFT = ASSOCIATED (SELF%YDIFT)
IF (LYDIFT) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YDIFT)
ENDIF

LYDIFS = ASSOCIATED (SELF%YDIFS)
IF (LYDIFS) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YDIFS)
ENDIF

LYADVT = ASSOCIATED (SELF%YADVT)
IF (LYADVT) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YADVT)
ENDIF

LYADVS = ASSOCIATED (SELF%YADVS)
IF (LYADVS) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YADVS)
ENDIF

LYTRI0 = ASSOCIATED (SELF%YTRI0)
IF (LYTRI0) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YTRI0)
ENDIF

LYTRI1 = ASSOCIATED (SELF%YTRI1)
IF (LYTRI1) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YTRI1)
ENDIF

LYSWDK = ASSOCIATED (SELF%YSWDK)
IF (LYSWDK) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YSWDK)
ENDIF

LYZO = ASSOCIATED (SELF%YZO)
IF (LYZO) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YZO)
ENDIF

LYHO = ASSOCIATED (SELF%YHO)
IF (LYHO) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YHO)
ENDIF

LYDO = ASSOCIATED (SELF%YDO)
IF (LYDO) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YDO)
ENDIF

LYHO_INV = ASSOCIATED (SELF%YHO_INV)
IF (LYHO_INV) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YHO_INV)
ENDIF

LYUOC = ASSOCIATED (SELF%YUOC)
IF (LYUOC) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YUOC)
ENDIF

LYVOC = ASSOCIATED (SELF%YVOC)
IF (LYVOC) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YVOC)
ENDIF

LYOTKE = ASSOCIATED (SELF%YOTKE)
IF (LYOTKE) THEN
  CALL HOST_TYPE_SURF_MTL_3D (SELF%YOTKE)
ENDIF

LYV3 = ASSOCIATED (SELF%YV3)
IF (LYV3) THEN
  DO J1 = LBOUND (SELF%YV3, 1), UBOUND (SELF%YV3, 1)
    CALL HOST_TYPE_SURF_MTL_3D (SELF%YV3 (J1))
  ENDDO
ENDIF

END SUBROUTINE

     

SUBROUTINE CRC64_TYPE_SFL_VDIAGO3 (SELF, KLUN, CDPATH)
USE UTIL_TYPE_SURF_MTL_3D_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO
LYDIFM = ASSOCIATED (SELF%YDIFM)
IF (LYDIFM) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YDIFM, KLUN, CDPATH//'%YDIFM'//TRIM(CLIND))
ENDIF

LYDIFT = ASSOCIATED (SELF%YDIFT)
IF (LYDIFT) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YDIFT, KLUN, CDPATH//'%YDIFT'//TRIM(CLIND))
ENDIF

LYDIFS = ASSOCIATED (SELF%YDIFS)
IF (LYDIFS) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YDIFS, KLUN, CDPATH//'%YDIFS'//TRIM(CLIND))
ENDIF

LYADVT = ASSOCIATED (SELF%YADVT)
IF (LYADVT) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YADVT, KLUN, CDPATH//'%YADVT'//TRIM(CLIND))
ENDIF

LYADVS = ASSOCIATED (SELF%YADVS)
IF (LYADVS) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YADVS, KLUN, CDPATH//'%YADVS'//TRIM(CLIND))
ENDIF

LYTRI0 = ASSOCIATED (SELF%YTRI0)
IF (LYTRI0) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YTRI0, KLUN, CDPATH//'%YTRI0'//TRIM(CLIND))
ENDIF

LYTRI1 = ASSOCIATED (SELF%YTRI1)
IF (LYTRI1) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YTRI1, KLUN, CDPATH//'%YTRI1'//TRIM(CLIND))
ENDIF

LYSWDK = ASSOCIATED (SELF%YSWDK)
IF (LYSWDK) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YSWDK, KLUN, CDPATH//'%YSWDK'//TRIM(CLIND))
ENDIF

LYZO = ASSOCIATED (SELF%YZO)
IF (LYZO) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YZO, KLUN, CDPATH//'%YZO'//TRIM(CLIND))
ENDIF

LYHO = ASSOCIATED (SELF%YHO)
IF (LYHO) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YHO, KLUN, CDPATH//'%YHO'//TRIM(CLIND))
ENDIF

LYDO = ASSOCIATED (SELF%YDO)
IF (LYDO) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YDO, KLUN, CDPATH//'%YDO'//TRIM(CLIND))
ENDIF

LYHO_INV = ASSOCIATED (SELF%YHO_INV)
IF (LYHO_INV) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YHO_INV, KLUN, CDPATH//'%YHO_INV'//TRIM(CLIND))
ENDIF

LYUOC = ASSOCIATED (SELF%YUOC)
IF (LYUOC) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YUOC, KLUN, CDPATH//'%YUOC'//TRIM(CLIND))
ENDIF

LYVOC = ASSOCIATED (SELF%YVOC)
IF (LYVOC) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YVOC, KLUN, CDPATH//'%YVOC'//TRIM(CLIND))
ENDIF

LYOTKE = ASSOCIATED (SELF%YOTKE)
IF (LYOTKE) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (SELF%YOTKE, KLUN, CDPATH//'%YOTKE'//TRIM(CLIND))
ENDIF

LYV3 = ASSOCIATED (SELF%YV3)
IF (LYV3) THEN
  DO J1 = LBOUND (SELF%YV3, 1), UBOUND (SELF%YV3, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_SURF_MTL_3D (SELF%YV3 (J1), KLUN, CDPATH//'%YV3'//TRIM(CLIND))
  ENDDO
ENDIF

END SUBROUTINE

SUBROUTINE WIPE_TYPE_SFL_VDIAGO3 (SELF, LDDELETED, LDFIELDAPI)
USE UTIL_TYPE_SURF_MTL_3D_MOD
IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LYDIFM = ASSOCIATED (SELF%YDIFM)
IF (LYDIFM) THEN
  !$ACC EXIT DATA DETACH (SELF%YDIFM)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YDIFM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YDIFM)
ENDIF

LYDIFT = ASSOCIATED (SELF%YDIFT)
IF (LYDIFT) THEN
  !$ACC EXIT DATA DETACH (SELF%YDIFT)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YDIFT, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YDIFT)
ENDIF

LYDIFS = ASSOCIATED (SELF%YDIFS)
IF (LYDIFS) THEN
  !$ACC EXIT DATA DETACH (SELF%YDIFS)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YDIFS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YDIFS)
ENDIF

LYADVT = ASSOCIATED (SELF%YADVT)
IF (LYADVT) THEN
  !$ACC EXIT DATA DETACH (SELF%YADVT)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YADVT, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YADVT)
ENDIF

LYADVS = ASSOCIATED (SELF%YADVS)
IF (LYADVS) THEN
  !$ACC EXIT DATA DETACH (SELF%YADVS)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YADVS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YADVS)
ENDIF

LYTRI0 = ASSOCIATED (SELF%YTRI0)
IF (LYTRI0) THEN
  !$ACC EXIT DATA DETACH (SELF%YTRI0)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YTRI0, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YTRI0)
ENDIF

LYTRI1 = ASSOCIATED (SELF%YTRI1)
IF (LYTRI1) THEN
  !$ACC EXIT DATA DETACH (SELF%YTRI1)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YTRI1, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YTRI1)
ENDIF

LYSWDK = ASSOCIATED (SELF%YSWDK)
IF (LYSWDK) THEN
  !$ACC EXIT DATA DETACH (SELF%YSWDK)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YSWDK, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YSWDK)
ENDIF

LYZO = ASSOCIATED (SELF%YZO)
IF (LYZO) THEN
  !$ACC EXIT DATA DETACH (SELF%YZO)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YZO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YZO)
ENDIF

LYHO = ASSOCIATED (SELF%YHO)
IF (LYHO) THEN
  !$ACC EXIT DATA DETACH (SELF%YHO)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YHO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YHO)
ENDIF

LYDO = ASSOCIATED (SELF%YDO)
IF (LYDO) THEN
  !$ACC EXIT DATA DETACH (SELF%YDO)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YDO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YDO)
ENDIF

LYHO_INV = ASSOCIATED (SELF%YHO_INV)
IF (LYHO_INV) THEN
  !$ACC EXIT DATA DETACH (SELF%YHO_INV)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YHO_INV, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YHO_INV)
ENDIF

LYUOC = ASSOCIATED (SELF%YUOC)
IF (LYUOC) THEN
  !$ACC EXIT DATA DETACH (SELF%YUOC)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YUOC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YUOC)
ENDIF

LYVOC = ASSOCIATED (SELF%YVOC)
IF (LYVOC) THEN
  !$ACC EXIT DATA DETACH (SELF%YVOC)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YVOC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YVOC)
ENDIF

LYOTKE = ASSOCIATED (SELF%YOTKE)
IF (LYOTKE) THEN
  !$ACC EXIT DATA DETACH (SELF%YOTKE)
  CALL WIPE_TYPE_SURF_MTL_3D (SELF%YOTKE, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (SELF%YOTKE)
ENDIF

LYV3 = ASSOCIATED (SELF%YV3)
IF (LYV3) THEN
  !$ACC EXIT DATA DETACH (SELF%YV3)
  DO J1 = LBOUND (SELF%YV3, 1), UBOUND (SELF%YV3, 1)
    CALL WIPE_TYPE_SURF_MTL_3D (SELF%YV3 (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (SELF%YV3)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE



END MODULE
