MODULE UTIL_TYPE_SFL_VDIAGO3_MOD

USE SURFACE_FIELDS_MIX, ONLY : TYPE_SFL_VDIAGO3

INTERFACE SAVE
MODULE PROCEDURE SAVE_TYPE_SFL_VDIAGO3
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TYPE_SFL_VDIAGO3
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TYPE_SFL_VDIAGO3
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TYPE_SFL_VDIAGO3
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TYPE_SFL_VDIAGO3
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TYPE_SFL_VDIAGO3
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TYPE_SFL_VDIAGO3 (KLUN, YD)
USE UTIL_TYPE_SURF_MTL_3D_MOD
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TYPE_SFL_VDIAGO3), INTENT (IN), TARGET :: YD
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO
LYDIFM = ASSOCIATED (YD%YDIFM)
WRITE (KLUN) LYDIFM
IF (LYDIFM) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YDIFM)
ENDIF
LYDIFT = ASSOCIATED (YD%YDIFT)
WRITE (KLUN) LYDIFT
IF (LYDIFT) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YDIFT)
ENDIF
LYDIFS = ASSOCIATED (YD%YDIFS)
WRITE (KLUN) LYDIFS
IF (LYDIFS) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YDIFS)
ENDIF
LYADVT = ASSOCIATED (YD%YADVT)
WRITE (KLUN) LYADVT
IF (LYADVT) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YADVT)
ENDIF
LYADVS = ASSOCIATED (YD%YADVS)
WRITE (KLUN) LYADVS
IF (LYADVS) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YADVS)
ENDIF
LYTRI0 = ASSOCIATED (YD%YTRI0)
WRITE (KLUN) LYTRI0
IF (LYTRI0) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YTRI0)
ENDIF
LYTRI1 = ASSOCIATED (YD%YTRI1)
WRITE (KLUN) LYTRI1
IF (LYTRI1) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YTRI1)
ENDIF
LYSWDK = ASSOCIATED (YD%YSWDK)
WRITE (KLUN) LYSWDK
IF (LYSWDK) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YSWDK)
ENDIF
LYZO = ASSOCIATED (YD%YZO)
WRITE (KLUN) LYZO
IF (LYZO) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YZO)
ENDIF
LYHO = ASSOCIATED (YD%YHO)
WRITE (KLUN) LYHO
IF (LYHO) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YHO)
ENDIF
LYDO = ASSOCIATED (YD%YDO)
WRITE (KLUN) LYDO
IF (LYDO) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YDO)
ENDIF
LYHO_INV = ASSOCIATED (YD%YHO_INV)
WRITE (KLUN) LYHO_INV
IF (LYHO_INV) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YHO_INV)
ENDIF
LYUOC = ASSOCIATED (YD%YUOC)
WRITE (KLUN) LYUOC
IF (LYUOC) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YUOC)
ENDIF
LYVOC = ASSOCIATED (YD%YVOC)
WRITE (KLUN) LYVOC
IF (LYVOC) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YVOC)
ENDIF
LYOTKE = ASSOCIATED (YD%YOTKE)
WRITE (KLUN) LYOTKE
IF (LYOTKE) THEN
  CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YOTKE)
ENDIF
LYV3 = ASSOCIATED (YD%YV3)
WRITE (KLUN) LYV3
IF (LYV3) THEN
  WRITE (KLUN) LBOUND (YD%YV3)
  WRITE (KLUN) UBOUND (YD%YV3)
  DO J1 = LBOUND (YD%YV3, 1), UBOUND (YD%YV3, 1)
    CALL SAVE_TYPE_SURF_MTL_3D (KLUN, YD%YV3 (J1))
  ENDDO
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_TYPE_SFL_VDIAGO3 (KLUN, YD)
USE UTIL_TYPE_SURF_MTL_3D_MOD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TYPE_SFL_VDIAGO3), INTENT (OUT), TARGET :: YD
INTEGER :: J1
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO
READ (KLUN) LYDIFM
IF (LYDIFM) THEN
  ALLOCATE (YD%YDIFM)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YDIFM)
ELSE
  NULLIFY (YD%YDIFM)
ENDIF
READ (KLUN) LYDIFT
IF (LYDIFT) THEN
  ALLOCATE (YD%YDIFT)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YDIFT)
ELSE
  NULLIFY (YD%YDIFT)
ENDIF
READ (KLUN) LYDIFS
IF (LYDIFS) THEN
  ALLOCATE (YD%YDIFS)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YDIFS)
ELSE
  NULLIFY (YD%YDIFS)
ENDIF
READ (KLUN) LYADVT
IF (LYADVT) THEN
  ALLOCATE (YD%YADVT)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YADVT)
ELSE
  NULLIFY (YD%YADVT)
ENDIF
READ (KLUN) LYADVS
IF (LYADVS) THEN
  ALLOCATE (YD%YADVS)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YADVS)
ELSE
  NULLIFY (YD%YADVS)
ENDIF
READ (KLUN) LYTRI0
IF (LYTRI0) THEN
  ALLOCATE (YD%YTRI0)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YTRI0)
ELSE
  NULLIFY (YD%YTRI0)
ENDIF
READ (KLUN) LYTRI1
IF (LYTRI1) THEN
  ALLOCATE (YD%YTRI1)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YTRI1)
ELSE
  NULLIFY (YD%YTRI1)
ENDIF
READ (KLUN) LYSWDK
IF (LYSWDK) THEN
  ALLOCATE (YD%YSWDK)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YSWDK)
ELSE
  NULLIFY (YD%YSWDK)
ENDIF
READ (KLUN) LYZO
IF (LYZO) THEN
  ALLOCATE (YD%YZO)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YZO)
ELSE
  NULLIFY (YD%YZO)
ENDIF
READ (KLUN) LYHO
IF (LYHO) THEN
  ALLOCATE (YD%YHO)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YHO)
ELSE
  NULLIFY (YD%YHO)
ENDIF
READ (KLUN) LYDO
IF (LYDO) THEN
  ALLOCATE (YD%YDO)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YDO)
ELSE
  NULLIFY (YD%YDO)
ENDIF
READ (KLUN) LYHO_INV
IF (LYHO_INV) THEN
  ALLOCATE (YD%YHO_INV)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YHO_INV)
ELSE
  NULLIFY (YD%YHO_INV)
ENDIF
READ (KLUN) LYUOC
IF (LYUOC) THEN
  ALLOCATE (YD%YUOC)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YUOC)
ELSE
  NULLIFY (YD%YUOC)
ENDIF
READ (KLUN) LYVOC
IF (LYVOC) THEN
  ALLOCATE (YD%YVOC)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YVOC)
ELSE
  NULLIFY (YD%YVOC)
ENDIF
READ (KLUN) LYOTKE
IF (LYOTKE) THEN
  ALLOCATE (YD%YOTKE)
  CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YOTKE)
ELSE
  NULLIFY (YD%YOTKE)
ENDIF
READ (KLUN) LYV3
IF (LYV3) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%YV3 (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%YV3, 1), UBOUND (YD%YV3, 1)
    CALL LOAD_TYPE_SURF_MTL_3D (KLUN, YD%YV3 (J1))
  ENDDO
ELSE
  NULLIFY (YD%YV3)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_TYPE_SFL_VDIAGO3 (YD, LDCREATED, LDFIELDAPI)
USE UTIL_TYPE_SURF_MTL_3D_MOD
IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
LYDIFM = ASSOCIATED (YD%YDIFM)
IF (LYDIFM) THEN
  !$ACC ENTER DATA CREATE (YD%YDIFM)
  !$ACC UPDATE DEVICE (YD%YDIFM)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YDIFM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YDIFM)
ENDIF

LYDIFT = ASSOCIATED (YD%YDIFT)
IF (LYDIFT) THEN
  !$ACC ENTER DATA CREATE (YD%YDIFT)
  !$ACC UPDATE DEVICE (YD%YDIFT)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YDIFT, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YDIFT)
ENDIF

LYDIFS = ASSOCIATED (YD%YDIFS)
IF (LYDIFS) THEN
  !$ACC ENTER DATA CREATE (YD%YDIFS)
  !$ACC UPDATE DEVICE (YD%YDIFS)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YDIFS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YDIFS)
ENDIF

LYADVT = ASSOCIATED (YD%YADVT)
IF (LYADVT) THEN
  !$ACC ENTER DATA CREATE (YD%YADVT)
  !$ACC UPDATE DEVICE (YD%YADVT)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YADVT, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YADVT)
ENDIF

LYADVS = ASSOCIATED (YD%YADVS)
IF (LYADVS) THEN
  !$ACC ENTER DATA CREATE (YD%YADVS)
  !$ACC UPDATE DEVICE (YD%YADVS)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YADVS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YADVS)
ENDIF

LYTRI0 = ASSOCIATED (YD%YTRI0)
IF (LYTRI0) THEN
  !$ACC ENTER DATA CREATE (YD%YTRI0)
  !$ACC UPDATE DEVICE (YD%YTRI0)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YTRI0, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YTRI0)
ENDIF

LYTRI1 = ASSOCIATED (YD%YTRI1)
IF (LYTRI1) THEN
  !$ACC ENTER DATA CREATE (YD%YTRI1)
  !$ACC UPDATE DEVICE (YD%YTRI1)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YTRI1, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YTRI1)
ENDIF

LYSWDK = ASSOCIATED (YD%YSWDK)
IF (LYSWDK) THEN
  !$ACC ENTER DATA CREATE (YD%YSWDK)
  !$ACC UPDATE DEVICE (YD%YSWDK)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YSWDK, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YSWDK)
ENDIF

LYZO = ASSOCIATED (YD%YZO)
IF (LYZO) THEN
  !$ACC ENTER DATA CREATE (YD%YZO)
  !$ACC UPDATE DEVICE (YD%YZO)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YZO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YZO)
ENDIF

LYHO = ASSOCIATED (YD%YHO)
IF (LYHO) THEN
  !$ACC ENTER DATA CREATE (YD%YHO)
  !$ACC UPDATE DEVICE (YD%YHO)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YHO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YHO)
ENDIF

LYDO = ASSOCIATED (YD%YDO)
IF (LYDO) THEN
  !$ACC ENTER DATA CREATE (YD%YDO)
  !$ACC UPDATE DEVICE (YD%YDO)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YDO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YDO)
ENDIF

LYHO_INV = ASSOCIATED (YD%YHO_INV)
IF (LYHO_INV) THEN
  !$ACC ENTER DATA CREATE (YD%YHO_INV)
  !$ACC UPDATE DEVICE (YD%YHO_INV)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YHO_INV, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YHO_INV)
ENDIF

LYUOC = ASSOCIATED (YD%YUOC)
IF (LYUOC) THEN
  !$ACC ENTER DATA CREATE (YD%YUOC)
  !$ACC UPDATE DEVICE (YD%YUOC)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YUOC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YUOC)
ENDIF

LYVOC = ASSOCIATED (YD%YVOC)
IF (LYVOC) THEN
  !$ACC ENTER DATA CREATE (YD%YVOC)
  !$ACC UPDATE DEVICE (YD%YVOC)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YVOC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YVOC)
ENDIF

LYOTKE = ASSOCIATED (YD%YOTKE)
IF (LYOTKE) THEN
  !$ACC ENTER DATA CREATE (YD%YOTKE)
  !$ACC UPDATE DEVICE (YD%YOTKE)
  CALL COPY_TYPE_SURF_MTL_3D (YD%YOTKE, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%YOTKE)
ENDIF

LYV3 = ASSOCIATED (YD%YV3)
IF (LYV3) THEN
  !$ACC ENTER DATA CREATE (YD%YV3)
  !$ACC UPDATE DEVICE (YD%YV3)
  DO J1 = LBOUND (YD%YV3, 1), UBOUND (YD%YV3, 1)
    CALL COPY_TYPE_SURF_MTL_3D (YD%YV3 (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%YV3)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_TYPE_SFL_VDIAGO3 (YD)
USE UTIL_TYPE_SURF_MTL_3D_MOD

IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), TARGET :: YD
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO
LYDIFM = ASSOCIATED (YD%YDIFM)
IF (LYDIFM) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YDIFM)
ENDIF

LYDIFT = ASSOCIATED (YD%YDIFT)
IF (LYDIFT) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YDIFT)
ENDIF

LYDIFS = ASSOCIATED (YD%YDIFS)
IF (LYDIFS) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YDIFS)
ENDIF

LYADVT = ASSOCIATED (YD%YADVT)
IF (LYADVT) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YADVT)
ENDIF

LYADVS = ASSOCIATED (YD%YADVS)
IF (LYADVS) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YADVS)
ENDIF

LYTRI0 = ASSOCIATED (YD%YTRI0)
IF (LYTRI0) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YTRI0)
ENDIF

LYTRI1 = ASSOCIATED (YD%YTRI1)
IF (LYTRI1) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YTRI1)
ENDIF

LYSWDK = ASSOCIATED (YD%YSWDK)
IF (LYSWDK) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YSWDK)
ENDIF

LYZO = ASSOCIATED (YD%YZO)
IF (LYZO) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YZO)
ENDIF

LYHO = ASSOCIATED (YD%YHO)
IF (LYHO) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YHO)
ENDIF

LYDO = ASSOCIATED (YD%YDO)
IF (LYDO) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YDO)
ENDIF

LYHO_INV = ASSOCIATED (YD%YHO_INV)
IF (LYHO_INV) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YHO_INV)
ENDIF

LYUOC = ASSOCIATED (YD%YUOC)
IF (LYUOC) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YUOC)
ENDIF

LYVOC = ASSOCIATED (YD%YVOC)
IF (LYVOC) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YVOC)
ENDIF

LYOTKE = ASSOCIATED (YD%YOTKE)
IF (LYOTKE) THEN
  CALL HOST_TYPE_SURF_MTL_3D (YD%YOTKE)
ENDIF

LYV3 = ASSOCIATED (YD%YV3)
IF (LYV3) THEN
  DO J1 = LBOUND (YD%YV3, 1), UBOUND (YD%YV3, 1)
    CALL HOST_TYPE_SURF_MTL_3D (YD%YV3 (J1))
  ENDDO
ENDIF

END SUBROUTINE

     

SUBROUTINE CRC64_TYPE_SFL_VDIAGO3 (YD, KLUN, CDPATH)
USE UTIL_TYPE_SURF_MTL_3D_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO
LYDIFM = ASSOCIATED (YD%YDIFM)
IF (LYDIFM) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YDIFM, KLUN, CDPATH//'%YDIFM'//TRIM(CLIND))
ENDIF

LYDIFT = ASSOCIATED (YD%YDIFT)
IF (LYDIFT) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YDIFT, KLUN, CDPATH//'%YDIFT'//TRIM(CLIND))
ENDIF

LYDIFS = ASSOCIATED (YD%YDIFS)
IF (LYDIFS) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YDIFS, KLUN, CDPATH//'%YDIFS'//TRIM(CLIND))
ENDIF

LYADVT = ASSOCIATED (YD%YADVT)
IF (LYADVT) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YADVT, KLUN, CDPATH//'%YADVT'//TRIM(CLIND))
ENDIF

LYADVS = ASSOCIATED (YD%YADVS)
IF (LYADVS) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YADVS, KLUN, CDPATH//'%YADVS'//TRIM(CLIND))
ENDIF

LYTRI0 = ASSOCIATED (YD%YTRI0)
IF (LYTRI0) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YTRI0, KLUN, CDPATH//'%YTRI0'//TRIM(CLIND))
ENDIF

LYTRI1 = ASSOCIATED (YD%YTRI1)
IF (LYTRI1) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YTRI1, KLUN, CDPATH//'%YTRI1'//TRIM(CLIND))
ENDIF

LYSWDK = ASSOCIATED (YD%YSWDK)
IF (LYSWDK) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YSWDK, KLUN, CDPATH//'%YSWDK'//TRIM(CLIND))
ENDIF

LYZO = ASSOCIATED (YD%YZO)
IF (LYZO) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YZO, KLUN, CDPATH//'%YZO'//TRIM(CLIND))
ENDIF

LYHO = ASSOCIATED (YD%YHO)
IF (LYHO) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YHO, KLUN, CDPATH//'%YHO'//TRIM(CLIND))
ENDIF

LYDO = ASSOCIATED (YD%YDO)
IF (LYDO) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YDO, KLUN, CDPATH//'%YDO'//TRIM(CLIND))
ENDIF

LYHO_INV = ASSOCIATED (YD%YHO_INV)
IF (LYHO_INV) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YHO_INV, KLUN, CDPATH//'%YHO_INV'//TRIM(CLIND))
ENDIF

LYUOC = ASSOCIATED (YD%YUOC)
IF (LYUOC) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YUOC, KLUN, CDPATH//'%YUOC'//TRIM(CLIND))
ENDIF

LYVOC = ASSOCIATED (YD%YVOC)
IF (LYVOC) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YVOC, KLUN, CDPATH//'%YVOC'//TRIM(CLIND))
ENDIF

LYOTKE = ASSOCIATED (YD%YOTKE)
IF (LYOTKE) THEN
  CLIND = ''
  CALL CRC64_TYPE_SURF_MTL_3D (YD%YOTKE, KLUN, CDPATH//'%YOTKE'//TRIM(CLIND))
ENDIF

LYV3 = ASSOCIATED (YD%YV3)
IF (LYV3) THEN
  DO J1 = LBOUND (YD%YV3, 1), UBOUND (YD%YV3, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_SURF_MTL_3D (YD%YV3 (J1), KLUN, CDPATH//'%YV3'//TRIM(CLIND))
  ENDDO
ENDIF

END SUBROUTINE

SUBROUTINE WIPE_TYPE_SFL_VDIAGO3 (YD, LDDELETED, LDFIELDAPI)
USE UTIL_TYPE_SURF_MTL_3D_MOD
IMPLICIT NONE
TYPE (TYPE_SFL_VDIAGO3), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LYADVS, LYADVT, LYDIFM, LYDIFS, LYDIFT, LYDO, LYHO, LYHO_INV, LYOTKE, LYSWDK
LOGICAL :: LYTRI0, LYTRI1, LYUOC, LYV3, LYVOC, LYZO

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LYDIFM = ASSOCIATED (YD%YDIFM)
IF (LYDIFM) THEN
  !$ACC EXIT DATA DETACH (YD%YDIFM)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YDIFM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YDIFM)
ENDIF

LYDIFT = ASSOCIATED (YD%YDIFT)
IF (LYDIFT) THEN
  !$ACC EXIT DATA DETACH (YD%YDIFT)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YDIFT, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YDIFT)
ENDIF

LYDIFS = ASSOCIATED (YD%YDIFS)
IF (LYDIFS) THEN
  !$ACC EXIT DATA DETACH (YD%YDIFS)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YDIFS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YDIFS)
ENDIF

LYADVT = ASSOCIATED (YD%YADVT)
IF (LYADVT) THEN
  !$ACC EXIT DATA DETACH (YD%YADVT)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YADVT, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YADVT)
ENDIF

LYADVS = ASSOCIATED (YD%YADVS)
IF (LYADVS) THEN
  !$ACC EXIT DATA DETACH (YD%YADVS)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YADVS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YADVS)
ENDIF

LYTRI0 = ASSOCIATED (YD%YTRI0)
IF (LYTRI0) THEN
  !$ACC EXIT DATA DETACH (YD%YTRI0)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YTRI0, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YTRI0)
ENDIF

LYTRI1 = ASSOCIATED (YD%YTRI1)
IF (LYTRI1) THEN
  !$ACC EXIT DATA DETACH (YD%YTRI1)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YTRI1, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YTRI1)
ENDIF

LYSWDK = ASSOCIATED (YD%YSWDK)
IF (LYSWDK) THEN
  !$ACC EXIT DATA DETACH (YD%YSWDK)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YSWDK, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YSWDK)
ENDIF

LYZO = ASSOCIATED (YD%YZO)
IF (LYZO) THEN
  !$ACC EXIT DATA DETACH (YD%YZO)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YZO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YZO)
ENDIF

LYHO = ASSOCIATED (YD%YHO)
IF (LYHO) THEN
  !$ACC EXIT DATA DETACH (YD%YHO)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YHO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YHO)
ENDIF

LYDO = ASSOCIATED (YD%YDO)
IF (LYDO) THEN
  !$ACC EXIT DATA DETACH (YD%YDO)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YDO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YDO)
ENDIF

LYHO_INV = ASSOCIATED (YD%YHO_INV)
IF (LYHO_INV) THEN
  !$ACC EXIT DATA DETACH (YD%YHO_INV)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YHO_INV, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YHO_INV)
ENDIF

LYUOC = ASSOCIATED (YD%YUOC)
IF (LYUOC) THEN
  !$ACC EXIT DATA DETACH (YD%YUOC)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YUOC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YUOC)
ENDIF

LYVOC = ASSOCIATED (YD%YVOC)
IF (LYVOC) THEN
  !$ACC EXIT DATA DETACH (YD%YVOC)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YVOC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YVOC)
ENDIF

LYOTKE = ASSOCIATED (YD%YOTKE)
IF (LYOTKE) THEN
  !$ACC EXIT DATA DETACH (YD%YOTKE)
  CALL WIPE_TYPE_SURF_MTL_3D (YD%YOTKE, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%YOTKE)
ENDIF

LYV3 = ASSOCIATED (YD%YV3)
IF (LYV3) THEN
  !$ACC EXIT DATA DETACH (YD%YV3)
  DO J1 = LBOUND (YD%YV3, 1), UBOUND (YD%YV3, 1)
    CALL WIPE_TYPE_SURF_MTL_3D (YD%YV3 (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%YV3)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE



END MODULE
