MODULE UTIL_SURFACE_VIEW_GROUP_VARSF_MOD

USE SURFACE_VIEWS_DIAGNOSTIC_MODULE, ONLY : SURFACE_VIEW_GROUP_VARSF



INTERFACE COPY
MODULE PROCEDURE COPY_SURFACE_VIEW_GROUP_VARSF
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_SURFACE_VIEW_GROUP_VARSF
END INTERFACE

     

INTERFACE WIPE
MODULE PROCEDURE WIPE_SURFACE_VIEW_GROUP_VARSF
END INTERFACE



CONTAINS





SUBROUTINE COPY_SURFACE_VIEW_GROUP_VARSF (YD, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
USE UTIL_SURFACE_VARIABLE_GROUP_VARSF_MOD
IMPLICIT NONE
TYPE (SURFACE_VIEW_GROUP_VARSF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LF_AERDEP, LF_AERLTS, LF_AERSCC, LF_ALBF, LF_ALBSF, LF_ALNID, LF_ALNIP, LF_ALUVD, LF_ALUVP, LF_CGPP
LOGICAL :: LF_CHEMDDFLX, LF_CHEMDV, LF_CHEMFLXO, LF_CHEMWDFLX, LF_CI, LF_CLK, LF_CO2TYP, LF_CREC, LF_CUR, LF_CVH
LOGICAL :: LF_CVL, LF_DL, LF_DMSO, LF_DSF, LF_EMIS2D, LF_EMIS2DAUX, LF_EMISF, LF_FCA1, LF_FCA2, LF_FP1
LOGICAL :: LF_FWET, LF_GETRL, LF_GROUP, LF_LAIH, LF_LAIL, LF_LAN, LF_LSM, LF_LZ0H, LF_NUDM, LF_SDFOR
LOGICAL :: LF_SIG, LF_SO2DD, LF_SOTY, LF_SSS, LF_SST, LF_TVH, LF_TVL, LF_UCUR, LF_URBF, LF_VCUR
LOGICAL :: LF_VEG, LF_VRLAN, LF_VRLDI, LF_Z0F, LF_Z0RLF, LPCHEMDDFLX, LPCHEMDV, LPCHEMFLXO, LPCHEMWDFLX, LPEMIS2D
LOGICAL :: LPEMIS2DAUX, LVARIABLE_GROUP

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
LVARIABLE_GROUP = ASSOCIATED (YD%VARIABLE_GROUP)
IF (LVARIABLE_GROUP) THEN
  !$ACC ENTER DATA CREATE (YD%VARIABLE_GROUP)
  !$ACC UPDATE DEVICE (YD%VARIABLE_GROUP)
  CALL COPY_SURFACE_VARIABLE_GROUP_VARSF (YD%VARIABLE_GROUP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (YD%VARIABLE_GROUP)
ENDIF

LF_Z0F = ASSOCIATED (YD%F_Z0F)
IF (LF_Z0F .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_Z0F)
  !$ACC ENTER DATA ATTACH (YD%F_Z0F)
ENDIF

LF_ALBF = ASSOCIATED (YD%F_ALBF)
IF (LF_ALBF .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_ALBF)
  !$ACC ENTER DATA ATTACH (YD%F_ALBF)
ENDIF

LF_EMISF = ASSOCIATED (YD%F_EMISF)
IF (LF_EMISF .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_EMISF)
  !$ACC ENTER DATA ATTACH (YD%F_EMISF)
ENDIF

LF_GETRL = ASSOCIATED (YD%F_GETRL)
IF (LF_GETRL .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_GETRL)
  !$ACC ENTER DATA ATTACH (YD%F_GETRL)
ENDIF

LF_LSM = ASSOCIATED (YD%F_LSM)
IF (LF_LSM .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_LSM)
  !$ACC ENTER DATA ATTACH (YD%F_LSM)
ENDIF

LF_VEG = ASSOCIATED (YD%F_VEG)
IF (LF_VEG .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_VEG)
  !$ACC ENTER DATA ATTACH (YD%F_VEG)
ENDIF

LF_VRLAN = ASSOCIATED (YD%F_VRLAN)
IF (LF_VRLAN .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_VRLAN)
  !$ACC ENTER DATA ATTACH (YD%F_VRLAN)
ENDIF

LF_VRLDI = ASSOCIATED (YD%F_VRLDI)
IF (LF_VRLDI .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_VRLDI)
  !$ACC ENTER DATA ATTACH (YD%F_VRLDI)
ENDIF

LF_SIG = ASSOCIATED (YD%F_SIG)
IF (LF_SIG .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_SIG)
  !$ACC ENTER DATA ATTACH (YD%F_SIG)
ENDIF

LF_ALBSF = ASSOCIATED (YD%F_ALBSF)
IF (LF_ALBSF .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_ALBSF)
  !$ACC ENTER DATA ATTACH (YD%F_ALBSF)
ENDIF

LF_LAN = ASSOCIATED (YD%F_LAN)
IF (LF_LAN .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_LAN)
  !$ACC ENTER DATA ATTACH (YD%F_LAN)
ENDIF

LF_SST = ASSOCIATED (YD%F_SST)
IF (LF_SST .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_SST)
  !$ACC ENTER DATA ATTACH (YD%F_SST)
ENDIF

LF_SSS = ASSOCIATED (YD%F_SSS)
IF (LF_SSS .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_SSS)
  !$ACC ENTER DATA ATTACH (YD%F_SSS)
ENDIF

LF_LZ0H = ASSOCIATED (YD%F_LZ0H)
IF (LF_LZ0H .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_LZ0H)
  !$ACC ENTER DATA ATTACH (YD%F_LZ0H)
ENDIF

LF_CVL = ASSOCIATED (YD%F_CVL)
IF (LF_CVL .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CVL)
  !$ACC ENTER DATA ATTACH (YD%F_CVL)
ENDIF

LF_CO2TYP = ASSOCIATED (YD%F_CO2TYP)
IF (LF_CO2TYP .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CO2TYP)
  !$ACC ENTER DATA ATTACH (YD%F_CO2TYP)
ENDIF

LF_CVH = ASSOCIATED (YD%F_CVH)
IF (LF_CVH .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CVH)
  !$ACC ENTER DATA ATTACH (YD%F_CVH)
ENDIF

LF_CUR = ASSOCIATED (YD%F_CUR)
IF (LF_CUR .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CUR)
  !$ACC ENTER DATA ATTACH (YD%F_CUR)
ENDIF

LF_TVL = ASSOCIATED (YD%F_TVL)
IF (LF_TVL .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_TVL)
  !$ACC ENTER DATA ATTACH (YD%F_TVL)
ENDIF

LF_TVH = ASSOCIATED (YD%F_TVH)
IF (LF_TVH .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_TVH)
  !$ACC ENTER DATA ATTACH (YD%F_TVH)
ENDIF

LF_LAIL = ASSOCIATED (YD%F_LAIL)
IF (LF_LAIL .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_LAIL)
  !$ACC ENTER DATA ATTACH (YD%F_LAIL)
ENDIF

LF_LAIH = ASSOCIATED (YD%F_LAIH)
IF (LF_LAIH .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_LAIH)
  !$ACC ENTER DATA ATTACH (YD%F_LAIH)
ENDIF

LF_FWET = ASSOCIATED (YD%F_FWET)
IF (LF_FWET .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_FWET)
  !$ACC ENTER DATA ATTACH (YD%F_FWET)
ENDIF

LF_SOTY = ASSOCIATED (YD%F_SOTY)
IF (LF_SOTY .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_SOTY)
  !$ACC ENTER DATA ATTACH (YD%F_SOTY)
ENDIF

LF_CLK = ASSOCIATED (YD%F_CLK)
IF (LF_CLK .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CLK)
  !$ACC ENTER DATA ATTACH (YD%F_CLK)
ENDIF

LF_DL = ASSOCIATED (YD%F_DL)
IF (LF_DL .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_DL)
  !$ACC ENTER DATA ATTACH (YD%F_DL)
ENDIF

LF_CI = ASSOCIATED (YD%F_CI)
IF (LF_CI .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CI)
  !$ACC ENTER DATA ATTACH (YD%F_CI)
ENDIF

LF_UCUR = ASSOCIATED (YD%F_UCUR)
IF (LF_UCUR .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_UCUR)
  !$ACC ENTER DATA ATTACH (YD%F_UCUR)
ENDIF

LF_VCUR = ASSOCIATED (YD%F_VCUR)
IF (LF_VCUR .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_VCUR)
  !$ACC ENTER DATA ATTACH (YD%F_VCUR)
ENDIF

LF_Z0RLF = ASSOCIATED (YD%F_Z0RLF)
IF (LF_Z0RLF .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_Z0RLF)
  !$ACC ENTER DATA ATTACH (YD%F_Z0RLF)
ENDIF

LF_CGPP = ASSOCIATED (YD%F_CGPP)
IF (LF_CGPP .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CGPP)
  !$ACC ENTER DATA ATTACH (YD%F_CGPP)
ENDIF

LF_CREC = ASSOCIATED (YD%F_CREC)
IF (LF_CREC .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_CREC)
  !$ACC ENTER DATA ATTACH (YD%F_CREC)
ENDIF

LF_SDFOR = ASSOCIATED (YD%F_SDFOR)
IF (LF_SDFOR .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_SDFOR)
  !$ACC ENTER DATA ATTACH (YD%F_SDFOR)
ENDIF

LF_ALUVP = ASSOCIATED (YD%F_ALUVP)
IF (LF_ALUVP .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_ALUVP)
  !$ACC ENTER DATA ATTACH (YD%F_ALUVP)
ENDIF

LF_ALUVD = ASSOCIATED (YD%F_ALUVD)
IF (LF_ALUVD .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_ALUVD)
  !$ACC ENTER DATA ATTACH (YD%F_ALUVD)
ENDIF

LF_ALNIP = ASSOCIATED (YD%F_ALNIP)
IF (LF_ALNIP .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_ALNIP)
  !$ACC ENTER DATA ATTACH (YD%F_ALNIP)
ENDIF

LF_ALNID = ASSOCIATED (YD%F_ALNID)
IF (LF_ALNID .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_ALNID)
  !$ACC ENTER DATA ATTACH (YD%F_ALNID)
ENDIF

LF_FP1 = ASSOCIATED (YD%F_FP1)
IF (LF_FP1 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_FP1)
  !$ACC ENTER DATA ATTACH (YD%F_FP1)
ENDIF

LF_SO2DD = ASSOCIATED (YD%F_SO2DD)
IF (LF_SO2DD .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_SO2DD)
  !$ACC ENTER DATA ATTACH (YD%F_SO2DD)
ENDIF

LF_DMSO = ASSOCIATED (YD%F_DMSO)
IF (LF_DMSO .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_DMSO)
  !$ACC ENTER DATA ATTACH (YD%F_DMSO)
ENDIF

LF_URBF = ASSOCIATED (YD%F_URBF)
IF (LF_URBF .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_URBF)
  !$ACC ENTER DATA ATTACH (YD%F_URBF)
ENDIF

LF_FCA1 = ASSOCIATED (YD%F_FCA1)
IF (LF_FCA1 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_FCA1)
  !$ACC ENTER DATA ATTACH (YD%F_FCA1)
ENDIF

LF_FCA2 = ASSOCIATED (YD%F_FCA2)
IF (LF_FCA2 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_FCA2)
  !$ACC ENTER DATA ATTACH (YD%F_FCA2)
ENDIF

LF_AERDEP = ASSOCIATED (YD%F_AERDEP)
IF (LF_AERDEP .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_AERDEP)
  !$ACC ENTER DATA ATTACH (YD%F_AERDEP)
ENDIF

LF_AERLTS = ASSOCIATED (YD%F_AERLTS)
IF (LF_AERLTS .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_AERLTS)
  !$ACC ENTER DATA ATTACH (YD%F_AERLTS)
ENDIF

LF_AERSCC = ASSOCIATED (YD%F_AERSCC)
IF (LF_AERSCC .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_AERSCC)
  !$ACC ENTER DATA ATTACH (YD%F_AERSCC)
ENDIF

LF_DSF = ASSOCIATED (YD%F_DSF)
IF (LF_DSF .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_DSF)
  !$ACC ENTER DATA ATTACH (YD%F_DSF)
ENDIF

LF_NUDM = ASSOCIATED (YD%F_NUDM)
IF (LF_NUDM .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_2RB (YD%F_NUDM)
  !$ACC ENTER DATA ATTACH (YD%F_NUDM)
ENDIF

LF_GROUP = ASSOCIATED (YD%F_GROUP)
IF (LF_GROUP .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (YD%F_GROUP)
  !$ACC ENTER DATA ATTACH (YD%F_GROUP)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_SURFACE_VIEW_GROUP_VARSF (YD)
USE FIELD_UTIL_MODULE
USE UTIL_SURFACE_VARIABLE_GROUP_VARSF_MOD

IMPLICIT NONE
TYPE (SURFACE_VIEW_GROUP_VARSF), TARGET :: YD
INTEGER :: J1
LOGICAL :: LF_AERDEP, LF_AERLTS, LF_AERSCC, LF_ALBF, LF_ALBSF, LF_ALNID, LF_ALNIP, LF_ALUVD, LF_ALUVP, LF_CGPP
LOGICAL :: LF_CHEMDDFLX, LF_CHEMDV, LF_CHEMFLXO, LF_CHEMWDFLX, LF_CI, LF_CLK, LF_CO2TYP, LF_CREC, LF_CUR, LF_CVH
LOGICAL :: LF_CVL, LF_DL, LF_DMSO, LF_DSF, LF_EMIS2D, LF_EMIS2DAUX, LF_EMISF, LF_FCA1, LF_FCA2, LF_FP1
LOGICAL :: LF_FWET, LF_GETRL, LF_GROUP, LF_LAIH, LF_LAIL, LF_LAN, LF_LSM, LF_LZ0H, LF_NUDM, LF_SDFOR
LOGICAL :: LF_SIG, LF_SO2DD, LF_SOTY, LF_SSS, LF_SST, LF_TVH, LF_TVL, LF_UCUR, LF_URBF, LF_VCUR
LOGICAL :: LF_VEG, LF_VRLAN, LF_VRLDI, LF_Z0F, LF_Z0RLF, LPCHEMDDFLX, LPCHEMDV, LPCHEMFLXO, LPCHEMWDFLX, LPEMIS2D
LOGICAL :: LPEMIS2DAUX, LVARIABLE_GROUP
LPCHEMFLXO = ALLOCATED (YD%PCHEMFLXO)
IF (LPCHEMFLXO) THEN
  DO J1 = LBOUND (YD%PCHEMFLXO, 1), UBOUND (YD%PCHEMFLXO, 1)
    CALL HOST_FIELD_2RB_VIEW (YD%PCHEMFLXO (J1))
  ENDDO
ENDIF

LPCHEMWDFLX = ALLOCATED (YD%PCHEMWDFLX)
IF (LPCHEMWDFLX) THEN
  DO J1 = LBOUND (YD%PCHEMWDFLX, 1), UBOUND (YD%PCHEMWDFLX, 1)
    CALL HOST_FIELD_2RB_VIEW (YD%PCHEMWDFLX (J1))
  ENDDO
ENDIF

LPCHEMDDFLX = ALLOCATED (YD%PCHEMDDFLX)
IF (LPCHEMDDFLX) THEN
  DO J1 = LBOUND (YD%PCHEMDDFLX, 1), UBOUND (YD%PCHEMDDFLX, 1)
    CALL HOST_FIELD_2RB_VIEW (YD%PCHEMDDFLX (J1))
  ENDDO
ENDIF

LPCHEMDV = ALLOCATED (YD%PCHEMDV)
IF (LPCHEMDV) THEN
  DO J1 = LBOUND (YD%PCHEMDV, 1), UBOUND (YD%PCHEMDV, 1)
    CALL HOST_FIELD_2RB_VIEW (YD%PCHEMDV (J1))
  ENDDO
ENDIF

LPEMIS2D = ALLOCATED (YD%PEMIS2D)
IF (LPEMIS2D) THEN
  DO J1 = LBOUND (YD%PEMIS2D, 1), UBOUND (YD%PEMIS2D, 1)
    CALL HOST_FIELD_2RB_VIEW (YD%PEMIS2D (J1))
  ENDDO
ENDIF

LPEMIS2DAUX = ALLOCATED (YD%PEMIS2DAUX)
IF (LPEMIS2DAUX) THEN
  DO J1 = LBOUND (YD%PEMIS2DAUX, 1), UBOUND (YD%PEMIS2DAUX, 1)
    CALL HOST_FIELD_2RB_VIEW (YD%PEMIS2DAUX (J1))
  ENDDO
ENDIF

LVARIABLE_GROUP = ASSOCIATED (YD%VARIABLE_GROUP)
IF (LVARIABLE_GROUP) THEN
  CALL HOST_SURFACE_VARIABLE_GROUP_VARSF (YD%VARIABLE_GROUP)
ENDIF

LF_Z0F = ASSOCIATED (YD%F_Z0F)
IF (LF_Z0F) THEN
  CALL HOST_FIELD_2RB (YD%F_Z0F)
ENDIF

LF_ALBF = ASSOCIATED (YD%F_ALBF)
IF (LF_ALBF) THEN
  CALL HOST_FIELD_2RB (YD%F_ALBF)
ENDIF

LF_EMISF = ASSOCIATED (YD%F_EMISF)
IF (LF_EMISF) THEN
  CALL HOST_FIELD_2RB (YD%F_EMISF)
ENDIF

LF_GETRL = ASSOCIATED (YD%F_GETRL)
IF (LF_GETRL) THEN
  CALL HOST_FIELD_2RB (YD%F_GETRL)
ENDIF

LF_LSM = ASSOCIATED (YD%F_LSM)
IF (LF_LSM) THEN
  CALL HOST_FIELD_2RB (YD%F_LSM)
ENDIF

LF_VEG = ASSOCIATED (YD%F_VEG)
IF (LF_VEG) THEN
  CALL HOST_FIELD_2RB (YD%F_VEG)
ENDIF

LF_VRLAN = ASSOCIATED (YD%F_VRLAN)
IF (LF_VRLAN) THEN
  CALL HOST_FIELD_2RB (YD%F_VRLAN)
ENDIF

LF_VRLDI = ASSOCIATED (YD%F_VRLDI)
IF (LF_VRLDI) THEN
  CALL HOST_FIELD_2RB (YD%F_VRLDI)
ENDIF

LF_SIG = ASSOCIATED (YD%F_SIG)
IF (LF_SIG) THEN
  CALL HOST_FIELD_2RB (YD%F_SIG)
ENDIF

LF_ALBSF = ASSOCIATED (YD%F_ALBSF)
IF (LF_ALBSF) THEN
  CALL HOST_FIELD_2RB (YD%F_ALBSF)
ENDIF

LF_LAN = ASSOCIATED (YD%F_LAN)
IF (LF_LAN) THEN
  CALL HOST_FIELD_2RB (YD%F_LAN)
ENDIF

LF_SST = ASSOCIATED (YD%F_SST)
IF (LF_SST) THEN
  CALL HOST_FIELD_2RB (YD%F_SST)
ENDIF

LF_SSS = ASSOCIATED (YD%F_SSS)
IF (LF_SSS) THEN
  CALL HOST_FIELD_2RB (YD%F_SSS)
ENDIF

LF_LZ0H = ASSOCIATED (YD%F_LZ0H)
IF (LF_LZ0H) THEN
  CALL HOST_FIELD_2RB (YD%F_LZ0H)
ENDIF

LF_CVL = ASSOCIATED (YD%F_CVL)
IF (LF_CVL) THEN
  CALL HOST_FIELD_2RB (YD%F_CVL)
ENDIF

LF_CO2TYP = ASSOCIATED (YD%F_CO2TYP)
IF (LF_CO2TYP) THEN
  CALL HOST_FIELD_2RB (YD%F_CO2TYP)
ENDIF

LF_CVH = ASSOCIATED (YD%F_CVH)
IF (LF_CVH) THEN
  CALL HOST_FIELD_2RB (YD%F_CVH)
ENDIF

LF_CUR = ASSOCIATED (YD%F_CUR)
IF (LF_CUR) THEN
  CALL HOST_FIELD_2RB (YD%F_CUR)
ENDIF

LF_TVL = ASSOCIATED (YD%F_TVL)
IF (LF_TVL) THEN
  CALL HOST_FIELD_2RB (YD%F_TVL)
ENDIF

LF_TVH = ASSOCIATED (YD%F_TVH)
IF (LF_TVH) THEN
  CALL HOST_FIELD_2RB (YD%F_TVH)
ENDIF

LF_LAIL = ASSOCIATED (YD%F_LAIL)
IF (LF_LAIL) THEN
  CALL HOST_FIELD_2RB (YD%F_LAIL)
ENDIF

LF_LAIH = ASSOCIATED (YD%F_LAIH)
IF (LF_LAIH) THEN
  CALL HOST_FIELD_2RB (YD%F_LAIH)
ENDIF

LF_FWET = ASSOCIATED (YD%F_FWET)
IF (LF_FWET) THEN
  CALL HOST_FIELD_2RB (YD%F_FWET)
ENDIF

LF_SOTY = ASSOCIATED (YD%F_SOTY)
IF (LF_SOTY) THEN
  CALL HOST_FIELD_2RB (YD%F_SOTY)
ENDIF

LF_CLK = ASSOCIATED (YD%F_CLK)
IF (LF_CLK) THEN
  CALL HOST_FIELD_2RB (YD%F_CLK)
ENDIF

LF_DL = ASSOCIATED (YD%F_DL)
IF (LF_DL) THEN
  CALL HOST_FIELD_2RB (YD%F_DL)
ENDIF

LF_CI = ASSOCIATED (YD%F_CI)
IF (LF_CI) THEN
  CALL HOST_FIELD_2RB (YD%F_CI)
ENDIF

LF_UCUR = ASSOCIATED (YD%F_UCUR)
IF (LF_UCUR) THEN
  CALL HOST_FIELD_2RB (YD%F_UCUR)
ENDIF

LF_VCUR = ASSOCIATED (YD%F_VCUR)
IF (LF_VCUR) THEN
  CALL HOST_FIELD_2RB (YD%F_VCUR)
ENDIF

LF_Z0RLF = ASSOCIATED (YD%F_Z0RLF)
IF (LF_Z0RLF) THEN
  CALL HOST_FIELD_2RB (YD%F_Z0RLF)
ENDIF

LF_CGPP = ASSOCIATED (YD%F_CGPP)
IF (LF_CGPP) THEN
  CALL HOST_FIELD_2RB (YD%F_CGPP)
ENDIF

LF_CREC = ASSOCIATED (YD%F_CREC)
IF (LF_CREC) THEN
  CALL HOST_FIELD_2RB (YD%F_CREC)
ENDIF

LF_SDFOR = ASSOCIATED (YD%F_SDFOR)
IF (LF_SDFOR) THEN
  CALL HOST_FIELD_2RB (YD%F_SDFOR)
ENDIF

LF_ALUVP = ASSOCIATED (YD%F_ALUVP)
IF (LF_ALUVP) THEN
  CALL HOST_FIELD_2RB (YD%F_ALUVP)
ENDIF

LF_ALUVD = ASSOCIATED (YD%F_ALUVD)
IF (LF_ALUVD) THEN
  CALL HOST_FIELD_2RB (YD%F_ALUVD)
ENDIF

LF_ALNIP = ASSOCIATED (YD%F_ALNIP)
IF (LF_ALNIP) THEN
  CALL HOST_FIELD_2RB (YD%F_ALNIP)
ENDIF

LF_ALNID = ASSOCIATED (YD%F_ALNID)
IF (LF_ALNID) THEN
  CALL HOST_FIELD_2RB (YD%F_ALNID)
ENDIF

LF_FP1 = ASSOCIATED (YD%F_FP1)
IF (LF_FP1) THEN
  CALL HOST_FIELD_2RB (YD%F_FP1)
ENDIF

LF_SO2DD = ASSOCIATED (YD%F_SO2DD)
IF (LF_SO2DD) THEN
  CALL HOST_FIELD_2RB (YD%F_SO2DD)
ENDIF

LF_DMSO = ASSOCIATED (YD%F_DMSO)
IF (LF_DMSO) THEN
  CALL HOST_FIELD_2RB (YD%F_DMSO)
ENDIF

LF_URBF = ASSOCIATED (YD%F_URBF)
IF (LF_URBF) THEN
  CALL HOST_FIELD_2RB (YD%F_URBF)
ENDIF

LF_FCA1 = ASSOCIATED (YD%F_FCA1)
IF (LF_FCA1) THEN
  CALL HOST_FIELD_2RB (YD%F_FCA1)
ENDIF

LF_FCA2 = ASSOCIATED (YD%F_FCA2)
IF (LF_FCA2) THEN
  CALL HOST_FIELD_2RB (YD%F_FCA2)
ENDIF

LF_AERDEP = ASSOCIATED (YD%F_AERDEP)
IF (LF_AERDEP) THEN
  CALL HOST_FIELD_2RB (YD%F_AERDEP)
ENDIF

LF_AERLTS = ASSOCIATED (YD%F_AERLTS)
IF (LF_AERLTS) THEN
  CALL HOST_FIELD_2RB (YD%F_AERLTS)
ENDIF

LF_AERSCC = ASSOCIATED (YD%F_AERSCC)
IF (LF_AERSCC) THEN
  CALL HOST_FIELD_2RB (YD%F_AERSCC)
ENDIF

LF_DSF = ASSOCIATED (YD%F_DSF)
IF (LF_DSF) THEN
  CALL HOST_FIELD_2RB (YD%F_DSF)
ENDIF

LF_CHEMFLXO = ALLOCATED (YD%F_CHEMFLXO)
IF (LF_CHEMFLXO) THEN
  DO J1 = LBOUND (YD%F_CHEMFLXO, 1), UBOUND (YD%F_CHEMFLXO, 1)
    CALL HOST_FIELD_2RB_PTR (YD%F_CHEMFLXO (J1))
  ENDDO
ENDIF

LF_CHEMWDFLX = ALLOCATED (YD%F_CHEMWDFLX)
IF (LF_CHEMWDFLX) THEN
  DO J1 = LBOUND (YD%F_CHEMWDFLX, 1), UBOUND (YD%F_CHEMWDFLX, 1)
    CALL HOST_FIELD_2RB_PTR (YD%F_CHEMWDFLX (J1))
  ENDDO
ENDIF

LF_CHEMDDFLX = ALLOCATED (YD%F_CHEMDDFLX)
IF (LF_CHEMDDFLX) THEN
  DO J1 = LBOUND (YD%F_CHEMDDFLX, 1), UBOUND (YD%F_CHEMDDFLX, 1)
    CALL HOST_FIELD_2RB_PTR (YD%F_CHEMDDFLX (J1))
  ENDDO
ENDIF

LF_CHEMDV = ALLOCATED (YD%F_CHEMDV)
IF (LF_CHEMDV) THEN
  DO J1 = LBOUND (YD%F_CHEMDV, 1), UBOUND (YD%F_CHEMDV, 1)
    CALL HOST_FIELD_2RB_PTR (YD%F_CHEMDV (J1))
  ENDDO
ENDIF

LF_NUDM = ASSOCIATED (YD%F_NUDM)
IF (LF_NUDM) THEN
  CALL HOST_FIELD_2RB (YD%F_NUDM)
ENDIF

LF_EMIS2D = ALLOCATED (YD%F_EMIS2D)
IF (LF_EMIS2D) THEN
  DO J1 = LBOUND (YD%F_EMIS2D, 1), UBOUND (YD%F_EMIS2D, 1)
    CALL HOST_FIELD_2RB_PTR (YD%F_EMIS2D (J1))
  ENDDO
ENDIF

LF_EMIS2DAUX = ALLOCATED (YD%F_EMIS2DAUX)
IF (LF_EMIS2DAUX) THEN
  DO J1 = LBOUND (YD%F_EMIS2DAUX, 1), UBOUND (YD%F_EMIS2DAUX, 1)
    CALL HOST_FIELD_2RB_PTR (YD%F_EMIS2DAUX (J1))
  ENDDO
ENDIF

LF_GROUP = ASSOCIATED (YD%F_GROUP)
IF (LF_GROUP) THEN
  CALL HOST_FIELD_3RB (YD%F_GROUP)
ENDIF

END SUBROUTINE

     



SUBROUTINE WIPE_SURFACE_VIEW_GROUP_VARSF (YD, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
USE UTIL_SURFACE_VARIABLE_GROUP_VARSF_MOD
IMPLICIT NONE
TYPE (SURFACE_VIEW_GROUP_VARSF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LF_AERDEP, LF_AERLTS, LF_AERSCC, LF_ALBF, LF_ALBSF, LF_ALNID, LF_ALNIP, LF_ALUVD, LF_ALUVP, LF_CGPP
LOGICAL :: LF_CHEMDDFLX, LF_CHEMDV, LF_CHEMFLXO, LF_CHEMWDFLX, LF_CI, LF_CLK, LF_CO2TYP, LF_CREC, LF_CUR, LF_CVH
LOGICAL :: LF_CVL, LF_DL, LF_DMSO, LF_DSF, LF_EMIS2D, LF_EMIS2DAUX, LF_EMISF, LF_FCA1, LF_FCA2, LF_FP1
LOGICAL :: LF_FWET, LF_GETRL, LF_GROUP, LF_LAIH, LF_LAIL, LF_LAN, LF_LSM, LF_LZ0H, LF_NUDM, LF_SDFOR
LOGICAL :: LF_SIG, LF_SO2DD, LF_SOTY, LF_SSS, LF_SST, LF_TVH, LF_TVL, LF_UCUR, LF_URBF, LF_VCUR
LOGICAL :: LF_VEG, LF_VRLAN, LF_VRLDI, LF_Z0F, LF_Z0RLF, LPCHEMDDFLX, LPCHEMDV, LPCHEMFLXO, LPCHEMWDFLX, LPEMIS2D
LOGICAL :: LPEMIS2DAUX, LVARIABLE_GROUP

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LVARIABLE_GROUP = ASSOCIATED (YD%VARIABLE_GROUP)
IF (LVARIABLE_GROUP) THEN
  !$ACC EXIT DATA DETACH (YD%VARIABLE_GROUP)
  CALL WIPE_SURFACE_VARIABLE_GROUP_VARSF (YD%VARIABLE_GROUP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DETACH (YD%VARIABLE_GROUP)
ENDIF

LF_Z0F = ASSOCIATED (YD%F_Z0F)
IF (LF_Z0F .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_Z0F)
ENDIF

LF_ALBF = ASSOCIATED (YD%F_ALBF)
IF (LF_ALBF .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_ALBF)
ENDIF

LF_EMISF = ASSOCIATED (YD%F_EMISF)
IF (LF_EMISF .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_EMISF)
ENDIF

LF_GETRL = ASSOCIATED (YD%F_GETRL)
IF (LF_GETRL .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_GETRL)
ENDIF

LF_LSM = ASSOCIATED (YD%F_LSM)
IF (LF_LSM .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_LSM)
ENDIF

LF_VEG = ASSOCIATED (YD%F_VEG)
IF (LF_VEG .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_VEG)
ENDIF

LF_VRLAN = ASSOCIATED (YD%F_VRLAN)
IF (LF_VRLAN .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_VRLAN)
ENDIF

LF_VRLDI = ASSOCIATED (YD%F_VRLDI)
IF (LF_VRLDI .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_VRLDI)
ENDIF

LF_SIG = ASSOCIATED (YD%F_SIG)
IF (LF_SIG .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_SIG)
ENDIF

LF_ALBSF = ASSOCIATED (YD%F_ALBSF)
IF (LF_ALBSF .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_ALBSF)
ENDIF

LF_LAN = ASSOCIATED (YD%F_LAN)
IF (LF_LAN .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_LAN)
ENDIF

LF_SST = ASSOCIATED (YD%F_SST)
IF (LF_SST .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_SST)
ENDIF

LF_SSS = ASSOCIATED (YD%F_SSS)
IF (LF_SSS .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_SSS)
ENDIF

LF_LZ0H = ASSOCIATED (YD%F_LZ0H)
IF (LF_LZ0H .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_LZ0H)
ENDIF

LF_CVL = ASSOCIATED (YD%F_CVL)
IF (LF_CVL .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CVL)
ENDIF

LF_CO2TYP = ASSOCIATED (YD%F_CO2TYP)
IF (LF_CO2TYP .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CO2TYP)
ENDIF

LF_CVH = ASSOCIATED (YD%F_CVH)
IF (LF_CVH .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CVH)
ENDIF

LF_CUR = ASSOCIATED (YD%F_CUR)
IF (LF_CUR .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CUR)
ENDIF

LF_TVL = ASSOCIATED (YD%F_TVL)
IF (LF_TVL .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_TVL)
ENDIF

LF_TVH = ASSOCIATED (YD%F_TVH)
IF (LF_TVH .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_TVH)
ENDIF

LF_LAIL = ASSOCIATED (YD%F_LAIL)
IF (LF_LAIL .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_LAIL)
ENDIF

LF_LAIH = ASSOCIATED (YD%F_LAIH)
IF (LF_LAIH .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_LAIH)
ENDIF

LF_FWET = ASSOCIATED (YD%F_FWET)
IF (LF_FWET .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_FWET)
ENDIF

LF_SOTY = ASSOCIATED (YD%F_SOTY)
IF (LF_SOTY .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_SOTY)
ENDIF

LF_CLK = ASSOCIATED (YD%F_CLK)
IF (LF_CLK .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CLK)
ENDIF

LF_DL = ASSOCIATED (YD%F_DL)
IF (LF_DL .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_DL)
ENDIF

LF_CI = ASSOCIATED (YD%F_CI)
IF (LF_CI .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CI)
ENDIF

LF_UCUR = ASSOCIATED (YD%F_UCUR)
IF (LF_UCUR .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_UCUR)
ENDIF

LF_VCUR = ASSOCIATED (YD%F_VCUR)
IF (LF_VCUR .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_VCUR)
ENDIF

LF_Z0RLF = ASSOCIATED (YD%F_Z0RLF)
IF (LF_Z0RLF .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_Z0RLF)
ENDIF

LF_CGPP = ASSOCIATED (YD%F_CGPP)
IF (LF_CGPP .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CGPP)
ENDIF

LF_CREC = ASSOCIATED (YD%F_CREC)
IF (LF_CREC .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_CREC)
ENDIF

LF_SDFOR = ASSOCIATED (YD%F_SDFOR)
IF (LF_SDFOR .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_SDFOR)
ENDIF

LF_ALUVP = ASSOCIATED (YD%F_ALUVP)
IF (LF_ALUVP .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_ALUVP)
ENDIF

LF_ALUVD = ASSOCIATED (YD%F_ALUVD)
IF (LF_ALUVD .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_ALUVD)
ENDIF

LF_ALNIP = ASSOCIATED (YD%F_ALNIP)
IF (LF_ALNIP .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_ALNIP)
ENDIF

LF_ALNID = ASSOCIATED (YD%F_ALNID)
IF (LF_ALNID .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_ALNID)
ENDIF

LF_FP1 = ASSOCIATED (YD%F_FP1)
IF (LF_FP1 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_FP1)
ENDIF

LF_SO2DD = ASSOCIATED (YD%F_SO2DD)
IF (LF_SO2DD .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_SO2DD)
ENDIF

LF_DMSO = ASSOCIATED (YD%F_DMSO)
IF (LF_DMSO .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_DMSO)
ENDIF

LF_URBF = ASSOCIATED (YD%F_URBF)
IF (LF_URBF .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_URBF)
ENDIF

LF_FCA1 = ASSOCIATED (YD%F_FCA1)
IF (LF_FCA1 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_FCA1)
ENDIF

LF_FCA2 = ASSOCIATED (YD%F_FCA2)
IF (LF_FCA2 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_FCA2)
ENDIF

LF_AERDEP = ASSOCIATED (YD%F_AERDEP)
IF (LF_AERDEP .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_AERDEP)
ENDIF

LF_AERLTS = ASSOCIATED (YD%F_AERLTS)
IF (LF_AERLTS .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_AERLTS)
ENDIF

LF_AERSCC = ASSOCIATED (YD%F_AERSCC)
IF (LF_AERSCC .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_AERSCC)
ENDIF

LF_DSF = ASSOCIATED (YD%F_DSF)
IF (LF_DSF .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_DSF)
ENDIF

LF_NUDM = ASSOCIATED (YD%F_NUDM)
IF (LF_NUDM .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_2RB (YD%F_NUDM)
ENDIF

LF_GROUP = ASSOCIATED (YD%F_GROUP)
IF (LF_GROUP .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_3RB (YD%F_GROUP)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE



END MODULE
