MODULE UTIL_VARIABLE_4RD_MOD

USE VARIABLE_MODULE, ONLY : VARIABLE_4RD



INTERFACE COPY
MODULE PROCEDURE COPY_VARIABLE_4RD
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_VARIABLE_4RD
END INTERFACE

INTERFACE LEGACY
MODULE PROCEDURE LEGACY_VARIABLE_4RD
END INTERFACE
     
INTERFACE CRC64
MODULE PROCEDURE CRC64_VARIABLE_4RD
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_VARIABLE_4RD
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_VARIABLE_4RD
END INTERFACE


CONTAINS





SUBROUTINE COPY_VARIABLE_4RD (YD, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, COPY_VARIABLE_BASE
IMPLICIT NONE
TYPE (VARIABLE_4RD), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
YLSUPER => YD
CALL COPY_VARIABLE_BASE (YLSUPER, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
LFT0 = ASSOCIATED (YD%FT0)
IF (LFT0 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (YD%FT0)
  !$ACC ENTER DATA ATTACH (YD%FT0)
ENDIF

LFT1 = ASSOCIATED (YD%FT1)
IF (LFT1 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (YD%FT1)
  !$ACC ENTER DATA ATTACH (YD%FT1)
ENDIF

LFT9 = ASSOCIATED (YD%FT9)
IF (LFT9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (YD%FT9)
  !$ACC ENTER DATA ATTACH (YD%FT9)
ENDIF

LFPH9 = ASSOCIATED (YD%FPH9)
IF (LFPH9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (YD%FPH9)
  !$ACC ENTER DATA ATTACH (YD%FPH9)
ENDIF

LFDL = ASSOCIATED (YD%FDL)
IF (LFDL .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (YD%FDL)
  !$ACC ENTER DATA ATTACH (YD%FDL)
ENDIF

LFDM = ASSOCIATED (YD%FDM)
IF (LFDM .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (YD%FDM)
  !$ACC ENTER DATA ATTACH (YD%FDM)
ENDIF

LFDL9 = ASSOCIATED (YD%FDL9)
IF (LFDL9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (YD%FDL9)
  !$ACC ENTER DATA ATTACH (YD%FDL9)
ENDIF

LFDM9 = ASSOCIATED (YD%FDM9)
IF (LFDM9 .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (YD%FDM9)
  !$ACC ENTER DATA ATTACH (YD%FDM9)
ENDIF

LFPC_PH = ASSOCIATED (YD%FPC_PH)
IF (LFPC_PH .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_4RD (YD%FPC_PH)
  !$ACC ENTER DATA ATTACH (YD%FPC_PH)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_VARIABLE_4RD (YD)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, HOST_VARIABLE_BASE

IMPLICIT NONE
TYPE (VARIABLE_4RD), TARGET :: YD
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
YLSUPER => YD
CALL HOST_VARIABLE_BASE (YLSUPER)
LFT0 = ASSOCIATED (YD%FT0)
IF (LFT0) THEN
  CALL HOST_FIELD_4RD (YD%FT0)
ENDIF

LFT1 = ASSOCIATED (YD%FT1)
IF (LFT1) THEN
  CALL HOST_FIELD_4RD (YD%FT1)
ENDIF

LFT9 = ASSOCIATED (YD%FT9)
IF (LFT9) THEN
  CALL HOST_FIELD_4RD (YD%FT9)
ENDIF

LFPH9 = ASSOCIATED (YD%FPH9)
IF (LFPH9) THEN
  CALL HOST_FIELD_4RD (YD%FPH9)
ENDIF

LFDL = ASSOCIATED (YD%FDL)
IF (LFDL) THEN
  CALL HOST_FIELD_4RD (YD%FDL)
ENDIF

LFDM = ASSOCIATED (YD%FDM)
IF (LFDM) THEN
  CALL HOST_FIELD_4RD (YD%FDM)
ENDIF

LFDL9 = ASSOCIATED (YD%FDL9)
IF (LFDL9) THEN
  CALL HOST_FIELD_4RD (YD%FDL9)
ENDIF

LFDM9 = ASSOCIATED (YD%FDM9)
IF (LFDM9) THEN
  CALL HOST_FIELD_4RD (YD%FDM9)
ENDIF

LFPC_PH = ASSOCIATED (YD%FPC_PH)
IF (LFPC_PH) THEN
  CALL HOST_FIELD_4RD (YD%FPC_PH)
ENDIF

END SUBROUTINE

SUBROUTINE LEGACY_VARIABLE_4RD (YD, KADDRL, KADDRU, KDIR)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, LEGACY_VARIABLE_BASE

IMPLICIT NONE
TYPE (VARIABLE_4RD), TARGET :: YD
INTEGER*8, INTENT (IN) :: KADDRL
INTEGER*8, INTENT (IN) :: KADDRU
INTEGER, INTENT (IN) :: KDIR
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
YLSUPER => YD
CALL LEGACY_VARIABLE_BASE (YLSUPER, KADDRL, KADDRU, KDIR=KDIR)
LFT0 = ASSOCIATED (YD%FT0)
IF (LFT0) THEN
  CALL LEGACY_FIELD_4RD (YD%FT0, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFT1 = ASSOCIATED (YD%FT1)
IF (LFT1) THEN
  CALL LEGACY_FIELD_4RD (YD%FT1, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFT9 = ASSOCIATED (YD%FT9)
IF (LFT9) THEN
  CALL LEGACY_FIELD_4RD (YD%FT9, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFPH9 = ASSOCIATED (YD%FPH9)
IF (LFPH9) THEN
  CALL LEGACY_FIELD_4RD (YD%FPH9, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFDL = ASSOCIATED (YD%FDL)
IF (LFDL) THEN
  CALL LEGACY_FIELD_4RD (YD%FDL, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFDM = ASSOCIATED (YD%FDM)
IF (LFDM) THEN
  CALL LEGACY_FIELD_4RD (YD%FDM, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFDL9 = ASSOCIATED (YD%FDL9)
IF (LFDL9) THEN
  CALL LEGACY_FIELD_4RD (YD%FDL9, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFDM9 = ASSOCIATED (YD%FDM9)
IF (LFDM9) THEN
  CALL LEGACY_FIELD_4RD (YD%FDM9, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

LFPC_PH = ASSOCIATED (YD%FPC_PH)
IF (LFPC_PH) THEN
  CALL LEGACY_FIELD_4RD (YD%FPC_PH, KADDRL, KADDRU, KDIR=KDIR)
ENDIF

END SUBROUTINE     

SUBROUTINE CRC64_VARIABLE_4RD (YD, KLUN, CDPATH)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, CRC64_VARIABLE_BASE
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (VARIABLE_4RD), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9
YLSUPER => YD
CALL CRC64_VARIABLE_BASE (YLSUPER, KLUN, CDPATH)
LFT0 = ASSOCIATED (YD%FT0)
IF (LFT0) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') YD%FT0%CRC64 (), CDPATH//'%FT0'//TRIM(CLIND)
ENDIF

LFT1 = ASSOCIATED (YD%FT1)
IF (LFT1) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') YD%FT1%CRC64 (), CDPATH//'%FT1'//TRIM(CLIND)
ENDIF

LFT9 = ASSOCIATED (YD%FT9)
IF (LFT9) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') YD%FT9%CRC64 (), CDPATH//'%FT9'//TRIM(CLIND)
ENDIF

LFPH9 = ASSOCIATED (YD%FPH9)
IF (LFPH9) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') YD%FPH9%CRC64 (), CDPATH//'%FPH9'//TRIM(CLIND)
ENDIF

LFDL = ASSOCIATED (YD%FDL)
IF (LFDL) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') YD%FDL%CRC64 (), CDPATH//'%FDL'//TRIM(CLIND)
ENDIF

LFDM = ASSOCIATED (YD%FDM)
IF (LFDM) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') YD%FDM%CRC64 (), CDPATH//'%FDM'//TRIM(CLIND)
ENDIF

LFDL9 = ASSOCIATED (YD%FDL9)
IF (LFDL9) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') YD%FDL9%CRC64 (), CDPATH//'%FDL9'//TRIM(CLIND)
ENDIF

LFDM9 = ASSOCIATED (YD%FDM9)
IF (LFDM9) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') YD%FDM9%CRC64 (), CDPATH//'%FDM9'//TRIM(CLIND)
ENDIF

LFPC_PH = ASSOCIATED (YD%FPC_PH)
IF (LFPC_PH) THEN
  CLIND = ''
  WRITE (KLUN, '(Z16.16," ",A)') YD%FPC_PH%CRC64 (), CDPATH//'%FPC_PH'//TRIM(CLIND)
ENDIF

END SUBROUTINE

SUBROUTINE WIPE_VARIABLE_4RD (YD, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, WIPE_VARIABLE_BASE
IMPLICIT NONE
TYPE (VARIABLE_4RD), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
YLSUPER => YD
CALL WIPE_VARIABLE_BASE (YLSUPER, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
LFT0 = ASSOCIATED (YD%FT0)
IF (LFT0 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (YD%FT0)
ENDIF

LFT1 = ASSOCIATED (YD%FT1)
IF (LFT1 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (YD%FT1)
ENDIF

LFT9 = ASSOCIATED (YD%FT9)
IF (LFT9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (YD%FT9)
ENDIF

LFPH9 = ASSOCIATED (YD%FPH9)
IF (LFPH9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (YD%FPH9)
ENDIF

LFDL = ASSOCIATED (YD%FDL)
IF (LFDL .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (YD%FDL)
ENDIF

LFDM = ASSOCIATED (YD%FDM)
IF (LFDM .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (YD%FDM)
ENDIF

LFDL9 = ASSOCIATED (YD%FDL9)
IF (LFDL9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (YD%FDL9)
ENDIF

LFDM9 = ASSOCIATED (YD%FDM9)
IF (LFDM9 .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (YD%FDM9)
ENDIF

LFPC_PH = ASSOCIATED (YD%FPC_PH)
IF (LFPC_PH .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_4RD (YD%FPC_PH)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_VARIABLE_4RD (YD, CDPATH, LDPRINT) RESULT (KSIZE)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_BASE_MOD, ONLY : VARIABLE_BASE, SIZE_VARIABLE_BASE
IMPLICIT NONE
TYPE (VARIABLE_4RD),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
CLASS (VARIABLE_BASE), POINTER :: YLSUPER
LOGICAL :: LFDL, LFDL9, LFDM, LFDM9, LFPC_PH, LFPH9, LFT0, LFT1, LFT9

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
YLSUPER => YD
KSIZE = KSIZE + SIZE_VARIABLE_BASE (YLSUPER, CLPATH, LLPRINT)
END FUNCTION

END MODULE
