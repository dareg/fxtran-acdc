MODULE UTIL_TRIP_MOD

USE YOMRIP, ONLY : TRIP

INTERFACE SAVE
MODULE PROCEDURE SAVE_TRIP
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TRIP
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TRIP
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TRIP
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TRIP
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TRIP
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TRIP
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TRIP (KLUN, YD)
USE UTIL_REGLATLON_FIELD_MOD
USE UTIL_TEAERC_MACC_MOD
USE UTIL_TEAERC_TEGEN_MOD
USE UTIL_TECMIP_MOD
USE UTIL_TEOZOC_MOD
USE UTIL_TRADGHG_MOD
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TRIP), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%NSTART
WRITE (KLUN) YD%NSTOP
WRITE (KLUN) YD%CSTOP
WRITE (KLUN) YD%NSTADD
WRITE (KLUN) YD%NSTASS
WRITE (KLUN) YD%NFOST
WRITE (KLUN) YD%RSTATI
WRITE (KLUN) YD%RTIMTR
WRITE (KLUN) YD%RHGMT
WRITE (KLUN) YD%REQTIM
WRITE (KLUN) YD%RSOVR
WRITE (KLUN) YD%RDEASO
WRITE (KLUN) YD%RDECLI
WRITE (KLUN) YD%RWSOVR
WRITE (KLUN) YD%RIP0
WRITE (KLUN) YD%RCODEC
WRITE (KLUN) YD%RSIDEC
WRITE (KLUN) YD%RCOVSR
WRITE (KLUN) YD%RSIVSR
WRITE (KLUN) YD%RCODECN
WRITE (KLUN) YD%RSIDECN
WRITE (KLUN) YD%RCOVSRN
WRITE (KLUN) YD%RSIVSRN
WRITE (KLUN) YD%RCODECF
WRITE (KLUN) YD%RSIDECF
WRITE (KLUN) YD%RCOVSRF
WRITE (KLUN) YD%RSIVSRF
WRITE (KLUN) YD%TSTEP
WRITE (KLUN) YD%TDT
WRITE (KLUN) YD%RDTSA
WRITE (KLUN) YD%RDTSA2
WRITE (KLUN) YD%RDTS62
WRITE (KLUN) YD%RDTS22
WRITE (KLUN) YD%RTDT
WRITE (KLUN) YD%RDECLU
WRITE (KLUN) YD%RTMOLT
WRITE (KLUN) YD%RJUSMP
WRITE (KLUN) YD%RLUNDI
WRITE (KLUN) YD%RIP0LU
WRITE (KLUN) YD%RCODECLU
WRITE (KLUN) YD%RSIDECLU
WRITE (KLUN) YD%RCOVSRLU
WRITE (KLUN) YD%RSIVSRLU
CALL SAVE_TEOZOC (KLUN, YD%YREOZOC)
CALL SAVE_TECMIP (KLUN, YD%YRECMIP)
CALL SAVE_TRADGHG (KLUN, YD%YRERADGHG)
CALL SAVE_TEAERC_TEGEN (KLUN, YD%YREAERC_TEGEN)
CALL SAVE_TEAERC_MACC (KLUN, YD%YREAERC_MACC)
CALL SAVE_REGLATLON_FIELD (KLUN, YD%RAERSO4)
WRITE (KLUN) YD%JPORDT
WRITE (KLUN) YD%GCOEFS_ASCENSION_DROITE
WRITE (KLUN) YD%GCOEFS_DECLINAISON
WRITE (KLUN) YD%GCOEFS_DISTANCE
WRITE (KLUN) YD%GTDEBUT
WRITE (KLUN) YD%GTFIN
WRITE (KLUN) YD%NINTT_MOON
WRITE (KLUN) YD%NINTT_SUN
WRITE (KLUN) YD%CGSOLEC_SUN
WRITE (KLUN) YD%CGSOLEC_MOON
END SUBROUTINE

SUBROUTINE LOAD_TRIP (KLUN, YD)
USE UTIL_REGLATLON_FIELD_MOD
USE UTIL_TEAERC_MACC_MOD
USE UTIL_TEAERC_TEGEN_MOD
USE UTIL_TECMIP_MOD
USE UTIL_TEOZOC_MOD
USE UTIL_TRADGHG_MOD
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TRIP), INTENT (OUT), TARGET :: YD
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) YD%NSTART
READ (KLUN) YD%NSTOP
READ (KLUN) YD%CSTOP
READ (KLUN) YD%NSTADD
READ (KLUN) YD%NSTASS
READ (KLUN) YD%NFOST
READ (KLUN) ZTMP0
YD%RSTATI = ZTMP0
READ (KLUN) YD%RTIMTR
READ (KLUN) ZTMP0
YD%RHGMT = ZTMP0
READ (KLUN) ZTMP0
YD%REQTIM = ZTMP0
READ (KLUN) ZTMP0
YD%RSOVR = ZTMP0
READ (KLUN) ZTMP0
YD%RDEASO = ZTMP0
READ (KLUN) ZTMP0
YD%RDECLI = ZTMP0
READ (KLUN) ZTMP0
YD%RWSOVR = ZTMP0
READ (KLUN) ZTMP0
YD%RIP0 = ZTMP0
READ (KLUN) ZTMP0
YD%RCODEC = ZTMP0
READ (KLUN) ZTMP0
YD%RSIDEC = ZTMP0
READ (KLUN) ZTMP0
YD%RCOVSR = ZTMP0
READ (KLUN) ZTMP0
YD%RSIVSR = ZTMP0
READ (KLUN) ZTMP0
YD%RCODECN = ZTMP0
READ (KLUN) ZTMP0
YD%RSIDECN = ZTMP0
READ (KLUN) ZTMP0
YD%RCOVSRN = ZTMP0
READ (KLUN) ZTMP0
YD%RSIVSRN = ZTMP0
READ (KLUN) ZTMP0
YD%RCODECF = ZTMP0
READ (KLUN) ZTMP0
YD%RSIDECF = ZTMP0
READ (KLUN) ZTMP0
YD%RCOVSRF = ZTMP0
READ (KLUN) ZTMP0
YD%RSIVSRF = ZTMP0
READ (KLUN) ZTMP0
YD%TSTEP = ZTMP0
READ (KLUN) ZTMP0
YD%TDT = ZTMP0
READ (KLUN) ZTMP0
YD%RDTSA = ZTMP0
READ (KLUN) ZTMP0
YD%RDTSA2 = ZTMP0
READ (KLUN) ZTMP0
YD%RDTS62 = ZTMP0
READ (KLUN) ZTMP0
YD%RDTS22 = ZTMP0
READ (KLUN) ZTMP0
YD%RTDT = ZTMP0
READ (KLUN) ZTMP0
YD%RDECLU = ZTMP0
READ (KLUN) ZTMP0
YD%RTMOLT = ZTMP0
READ (KLUN) YD%RJUSMP
READ (KLUN) ZTMP0
YD%RLUNDI = ZTMP0
READ (KLUN) ZTMP0
YD%RIP0LU = ZTMP0
READ (KLUN) ZTMP0
YD%RCODECLU = ZTMP0
READ (KLUN) ZTMP0
YD%RSIDECLU = ZTMP0
READ (KLUN) ZTMP0
YD%RCOVSRLU = ZTMP0
READ (KLUN) ZTMP0
YD%RSIVSRLU = ZTMP0
CALL LOAD_TEOZOC (KLUN, YD%YREOZOC)
CALL LOAD_TECMIP (KLUN, YD%YRECMIP)
CALL LOAD_TRADGHG (KLUN, YD%YRERADGHG)
CALL LOAD_TEAERC_TEGEN (KLUN, YD%YREAERC_TEGEN)
CALL LOAD_TEAERC_MACC (KLUN, YD%YREAERC_MACC)
CALL LOAD_REGLATLON_FIELD (KLUN, YD%RAERSO4)
READ (KLUN) YD%JPORDT
READ (KLUN) YD%GCOEFS_ASCENSION_DROITE
READ (KLUN) YD%GCOEFS_DECLINAISON
READ (KLUN) YD%GCOEFS_DISTANCE
READ (KLUN) YD%GTDEBUT
READ (KLUN) YD%GTFIN
READ (KLUN) YD%NINTT_MOON
READ (KLUN) YD%NINTT_SUN
READ (KLUN) YD%CGSOLEC_SUN
READ (KLUN) YD%CGSOLEC_MOON
END SUBROUTINE


SUBROUTINE COPY_TRIP (YD, LDCREATED, LDFIELDAPI)
USE UTIL_REGLATLON_FIELD_MOD
USE UTIL_TEAERC_MACC_MOD
USE UTIL_TEAERC_TEGEN_MOD
USE UTIL_TECMIP_MOD
USE UTIL_TEOZOC_MOD
USE UTIL_TRADGHG_MOD
IMPLICIT NONE
TYPE (TRIP), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF











































CALL COPY_TEOZOC (YD%YREOZOC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TECMIP (YD%YRECMIP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TRADGHG (YD%YRERADGHG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TEAERC_TEGEN (YD%YREAERC_TEGEN, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TEAERC_MACC (YD%YREAERC_MACC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_REGLATLON_FIELD (YD%RAERSO4, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)











END SUBROUTINE

SUBROUTINE HOST_TRIP (YD)
USE UTIL_REGLATLON_FIELD_MOD
USE UTIL_TEAERC_MACC_MOD
USE UTIL_TEAERC_TEGEN_MOD
USE UTIL_TECMIP_MOD
USE UTIL_TEOZOC_MOD
USE UTIL_TRADGHG_MOD

IMPLICIT NONE
TYPE (TRIP), TARGET :: YD












































CALL HOST_TEOZOC (YD%YREOZOC)

CALL HOST_TECMIP (YD%YRECMIP)

CALL HOST_TRADGHG (YD%YRERADGHG)

CALL HOST_TEAERC_TEGEN (YD%YREAERC_TEGEN)

CALL HOST_TEAERC_MACC (YD%YREAERC_MACC)

CALL HOST_REGLATLON_FIELD (YD%RAERSO4)











END SUBROUTINE

     

SUBROUTINE CRC64_TRIP (YD, KLUN, CDPATH)
USE UTIL_REGLATLON_FIELD_MOD
USE UTIL_TEAERC_MACC_MOD
USE UTIL_TEAERC_TEGEN_MOD
USE UTIL_TECMIP_MOD
USE UTIL_TEOZOC_MOD
USE UTIL_TRADGHG_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TRIP), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSTART), CDPATH//'%NSTART'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSTOP), CDPATH//'%NSTOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CSTOP), CDPATH//'%CSTOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSTADD), CDPATH//'%NSTADD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSTASS), CDPATH//'%NSTASS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NFOST), CDPATH//'%NFOST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSTATI), CDPATH//'%RSTATI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RTIMTR), CDPATH//'%RTIMTR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RHGMT), CDPATH//'%RHGMT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%REQTIM), CDPATH//'%REQTIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSOVR), CDPATH//'%RSOVR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDEASO), CDPATH//'%RDEASO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDECLI), CDPATH//'%RDECLI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RWSOVR), CDPATH//'%RWSOVR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RIP0), CDPATH//'%RIP0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCODEC), CDPATH//'%RCODEC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIDEC), CDPATH//'%RSIDEC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCOVSR), CDPATH//'%RCOVSR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIVSR), CDPATH//'%RSIVSR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCODECN), CDPATH//'%RCODECN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIDECN), CDPATH//'%RSIDECN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCOVSRN), CDPATH//'%RCOVSRN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIVSRN), CDPATH//'%RSIVSRN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCODECF), CDPATH//'%RCODECF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIDECF), CDPATH//'%RSIDECF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCOVSRF), CDPATH//'%RCOVSRF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIVSRF), CDPATH//'%RSIVSRF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TSTEP), CDPATH//'%TSTEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TDT), CDPATH//'%TDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDTSA), CDPATH//'%RDTSA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDTSA2), CDPATH//'%RDTSA2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDTS62), CDPATH//'%RDTS62'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDTS22), CDPATH//'%RDTS22'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RTDT), CDPATH//'%RTDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RDECLU), CDPATH//'%RDECLU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RTMOLT), CDPATH//'%RTMOLT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RJUSMP), CDPATH//'%RJUSMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RLUNDI), CDPATH//'%RLUNDI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RIP0LU), CDPATH//'%RIP0LU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCODECLU), CDPATH//'%RCODECLU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIDECLU), CDPATH//'%RSIDECLU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCOVSRLU), CDPATH//'%RCOVSRLU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIVSRLU), CDPATH//'%RSIVSRLU'

CLIND = ''
CALL CRC64_TEOZOC (YD%YREOZOC, KLUN, CDPATH//'%YREOZOC'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TECMIP (YD%YRECMIP, KLUN, CDPATH//'%YRECMIP'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TRADGHG (YD%YRERADGHG, KLUN, CDPATH//'%YRERADGHG'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TEAERC_TEGEN (YD%YREAERC_TEGEN, KLUN, CDPATH//'%YREAERC_TEGEN'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TEAERC_MACC (YD%YREAERC_MACC, KLUN, CDPATH//'%YREAERC_MACC'//TRIM(CLIND))

CLIND = ''
CALL CRC64_REGLATLON_FIELD (YD%RAERSO4, KLUN, CDPATH//'%RAERSO4'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%JPORDT), CDPATH//'%JPORDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GCOEFS_ASCENSION_DROITE), CDPATH//'%GCOEFS_ASCENSION_DROITE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GCOEFS_DECLINAISON), CDPATH//'%GCOEFS_DECLINAISON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GCOEFS_DISTANCE), CDPATH//'%GCOEFS_DISTANCE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GTDEBUT), CDPATH//'%GTDEBUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GTFIN), CDPATH//'%GTFIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NINTT_MOON), CDPATH//'%NINTT_MOON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NINTT_SUN), CDPATH//'%NINTT_SUN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CGSOLEC_SUN), CDPATH//'%CGSOLEC_SUN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CGSOLEC_MOON), CDPATH//'%CGSOLEC_MOON'

END SUBROUTINE

SUBROUTINE WIPE_TRIP (YD, LDDELETED, LDFIELDAPI)
USE UTIL_REGLATLON_FIELD_MOD
USE UTIL_TEAERC_MACC_MOD
USE UTIL_TEAERC_TEGEN_MOD
USE UTIL_TECMIP_MOD
USE UTIL_TEOZOC_MOD
USE UTIL_TRADGHG_MOD
IMPLICIT NONE
TYPE (TRIP), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF











































CALL WIPE_TEOZOC (YD%YREOZOC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TECMIP (YD%YRECMIP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TRADGHG (YD%YRERADGHG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TEAERC_TEGEN (YD%YREAERC_TEGEN, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TEAERC_MACC (YD%YREAERC_MACC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_REGLATLON_FIELD (YD%RAERSO4, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)











LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TRIP (YD, CDPATH, LDPRINT) RESULT (KSIZE)
USE UTIL_REGLATLON_FIELD_MOD
USE UTIL_TEAERC_MACC_MOD
USE UTIL_TEAERC_TEGEN_MOD
USE UTIL_TECMIP_MOD
USE UTIL_TEOZOC_MOD
USE UTIL_TRADGHG_MOD
IMPLICIT NONE
TYPE (TRIP),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%NSTART)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSTART'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSTOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSTOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CSTOP) * LEN (YD%CSTOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CSTOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSTADD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSTADD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSTASS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSTASS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NFOST)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFOST'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSTATI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSTATI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTIMTR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTIMTR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RHGMT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RHGMT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%REQTIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%REQTIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSOVR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSOVR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDEASO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDEASO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDECLI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDECLI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RWSOVR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RWSOVR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RIP0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RIP0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCODEC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCODEC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIDEC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIDEC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCOVSR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCOVSR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIVSR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIVSR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCODECN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCODECN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIDECN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIDECN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCOVSRN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCOVSRN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIVSRN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIVSRN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCODECF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCODECF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIDECF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIDECF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCOVSRF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCOVSRF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIVSRF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIVSRF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TSTEP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TSTEP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDTSA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDTSA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDTSA2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDTSA2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDTS62)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDTS62'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDTS22)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDTS22'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RDECLU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDECLU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTMOLT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTMOLT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RJUSMP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RJUSMP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RLUNDI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RLUNDI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RIP0LU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RIP0LU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCODECLU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCODECLU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIDECLU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIDECLU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCOVSRLU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCOVSRLU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIVSRLU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIVSRLU'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
ISIZE = SIZE_TEOZOC (YD%YREOZOC, CLPATH//'%YREOZOC', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREOZOC'
ENDIF
JSIZE = 0
ISIZE = SIZE_TECMIP (YD%YRECMIP, CLPATH//'%YRECMIP', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRECMIP'
ENDIF
JSIZE = 0
ISIZE = SIZE_TRADGHG (YD%YRERADGHG, CLPATH//'%YRERADGHG', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRERADGHG'
ENDIF
JSIZE = 0
ISIZE = SIZE_TEAERC_TEGEN (YD%YREAERC_TEGEN, CLPATH//'%YREAERC_TEGEN', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREAERC_TEGEN'
ENDIF
JSIZE = 0
ISIZE = SIZE_TEAERC_MACC (YD%YREAERC_MACC, CLPATH//'%YREAERC_MACC', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREAERC_MACC'
ENDIF
JSIZE = 0
ISIZE = SIZE_REGLATLON_FIELD (YD%RAERSO4, CLPATH//'%RAERSO4', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAERSO4'
ENDIF
ISIZE = KIND (YD%JPORDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%JPORDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%GCOEFS_ASCENSION_DROITE) * SIZE (YD%GCOEFS_ASCENSION_DROITE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%GCOEFS_ASCENSION_DROITE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%GCOEFS_DECLINAISON) * SIZE (YD%GCOEFS_DECLINAISON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%GCOEFS_DECLINAISON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%GCOEFS_DISTANCE) * SIZE (YD%GCOEFS_DISTANCE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%GCOEFS_DISTANCE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%GTDEBUT) * SIZE (YD%GTDEBUT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%GTDEBUT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%GTFIN) * SIZE (YD%GTFIN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%GTFIN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NINTT_MOON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NINTT_MOON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NINTT_SUN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NINTT_SUN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CGSOLEC_SUN) * LEN (YD%CGSOLEC_SUN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CGSOLEC_SUN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CGSOLEC_MOON) * LEN (YD%CGSOLEC_MOON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CGSOLEC_MOON'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
