MODULE UTIL_TSTOPH_MOD

USE STOPH_MIX, ONLY : TSTOPH

INTERFACE SAVE
MODULE PROCEDURE SAVE_TSTOPH
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TSTOPH
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TSTOPH
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TSTOPH
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TSTOPH
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TSTOPH
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TSTOPH
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TSTOPH (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TSTOPH), INTENT (IN), TARGET :: YD
LOGICAL :: LALPHA_STO, LALPHA_STO_T, LGPSTREAM, LGPTEMP, LGPTOTDISS, LGPTOTDISS_SMOOTH, LGPVELPOT, LGPVORTGRAD, LMCELL, LNIMRAN
LOGICAL :: LONEMINALPHA_NFRSPBS, LONEMINALPHA_NFRSPBS_T, LRSMOOTH, LRSTOPHCA, LRVP_MUL, LRVP_MULFACT, LRVP_MULFACT_T, LRVP_MUL_T, LRWGHT, LSPDP
LOGICAL :: LSPG_AMP, LSPG_AMP_T, LSPSTREAM, LSPSTREAM_FORC, LSPTEMP, LSPTEMP_FORC, LSPVELPOT, LSPVELPOT_FORC, LSQRTCORR, LTAPER_FACT
LRSTOPHCA = ALLOCATED (YD%RSTOPHCA)
WRITE (KLUN) LRSTOPHCA
IF (LRSTOPHCA) THEN
  WRITE (KLUN) LBOUND (YD%RSTOPHCA)
  WRITE (KLUN) UBOUND (YD%RSTOPHCA)
  WRITE (KLUN) YD%RSTOPHCA
ENDIF
LSQRTCORR = ALLOCATED (YD%SQRTCORR)
WRITE (KLUN) LSQRTCORR
IF (LSQRTCORR) THEN
  WRITE (KLUN) LBOUND (YD%SQRTCORR)
  WRITE (KLUN) UBOUND (YD%SQRTCORR)
  WRITE (KLUN) YD%SQRTCORR
ENDIF
LSPSTREAM = ALLOCATED (YD%SPSTREAM)
WRITE (KLUN) LSPSTREAM
IF (LSPSTREAM) THEN
  WRITE (KLUN) LBOUND (YD%SPSTREAM)
  WRITE (KLUN) UBOUND (YD%SPSTREAM)
  WRITE (KLUN) YD%SPSTREAM
ENDIF
LSPVELPOT = ALLOCATED (YD%SPVELPOT)
WRITE (KLUN) LSPVELPOT
IF (LSPVELPOT) THEN
  WRITE (KLUN) LBOUND (YD%SPVELPOT)
  WRITE (KLUN) UBOUND (YD%SPVELPOT)
  WRITE (KLUN) YD%SPVELPOT
ENDIF
LSPSTREAM_FORC = ALLOCATED (YD%SPSTREAM_FORC)
WRITE (KLUN) LSPSTREAM_FORC
IF (LSPSTREAM_FORC) THEN
  WRITE (KLUN) LBOUND (YD%SPSTREAM_FORC)
  WRITE (KLUN) UBOUND (YD%SPSTREAM_FORC)
  WRITE (KLUN) YD%SPSTREAM_FORC
ENDIF
LSPVELPOT_FORC = ALLOCATED (YD%SPVELPOT_FORC)
WRITE (KLUN) LSPVELPOT_FORC
IF (LSPVELPOT_FORC) THEN
  WRITE (KLUN) LBOUND (YD%SPVELPOT_FORC)
  WRITE (KLUN) UBOUND (YD%SPVELPOT_FORC)
  WRITE (KLUN) YD%SPVELPOT_FORC
ENDIF
LSPG_AMP = ALLOCATED (YD%SPG_AMP)
WRITE (KLUN) LSPG_AMP
IF (LSPG_AMP) THEN
  WRITE (KLUN) LBOUND (YD%SPG_AMP)
  WRITE (KLUN) UBOUND (YD%SPG_AMP)
  WRITE (KLUN) YD%SPG_AMP
ENDIF
LALPHA_STO = ALLOCATED (YD%ALPHA_STO)
WRITE (KLUN) LALPHA_STO
IF (LALPHA_STO) THEN
  WRITE (KLUN) LBOUND (YD%ALPHA_STO)
  WRITE (KLUN) UBOUND (YD%ALPHA_STO)
  WRITE (KLUN) YD%ALPHA_STO
ENDIF
LONEMINALPHA_NFRSPBS = ALLOCATED (YD%ONEMINALPHA_NFRSPBS)
WRITE (KLUN) LONEMINALPHA_NFRSPBS
IF (LONEMINALPHA_NFRSPBS) THEN
  WRITE (KLUN) LBOUND (YD%ONEMINALPHA_NFRSPBS)
  WRITE (KLUN) UBOUND (YD%ONEMINALPHA_NFRSPBS)
  WRITE (KLUN) YD%ONEMINALPHA_NFRSPBS
ENDIF
LRSMOOTH = ALLOCATED (YD%RSMOOTH)
WRITE (KLUN) LRSMOOTH
IF (LRSMOOTH) THEN
  WRITE (KLUN) LBOUND (YD%RSMOOTH)
  WRITE (KLUN) UBOUND (YD%RSMOOTH)
  WRITE (KLUN) YD%RSMOOTH
ENDIF
LGPSTREAM = ALLOCATED (YD%GPSTREAM)
WRITE (KLUN) LGPSTREAM
IF (LGPSTREAM) THEN
  WRITE (KLUN) LBOUND (YD%GPSTREAM)
  WRITE (KLUN) UBOUND (YD%GPSTREAM)
  WRITE (KLUN) YD%GPSTREAM
ENDIF
LGPVELPOT = ALLOCATED (YD%GPVELPOT)
WRITE (KLUN) LGPVELPOT
IF (LGPVELPOT) THEN
  WRITE (KLUN) LBOUND (YD%GPVELPOT)
  WRITE (KLUN) UBOUND (YD%GPVELPOT)
  WRITE (KLUN) YD%GPVELPOT
ENDIF
LGPTOTDISS = ALLOCATED (YD%GPTOTDISS)
WRITE (KLUN) LGPTOTDISS
IF (LGPTOTDISS) THEN
  WRITE (KLUN) LBOUND (YD%GPTOTDISS)
  WRITE (KLUN) UBOUND (YD%GPTOTDISS)
  WRITE (KLUN) YD%GPTOTDISS
ENDIF
LGPTOTDISS_SMOOTH = ALLOCATED (YD%GPTOTDISS_SMOOTH)
WRITE (KLUN) LGPTOTDISS_SMOOTH
IF (LGPTOTDISS_SMOOTH) THEN
  WRITE (KLUN) LBOUND (YD%GPTOTDISS_SMOOTH)
  WRITE (KLUN) UBOUND (YD%GPTOTDISS_SMOOTH)
  WRITE (KLUN) YD%GPTOTDISS_SMOOTH
ENDIF
LGPVORTGRAD = ALLOCATED (YD%GPVORTGRAD)
WRITE (KLUN) LGPVORTGRAD
IF (LGPVORTGRAD) THEN
  WRITE (KLUN) LBOUND (YD%GPVORTGRAD)
  WRITE (KLUN) UBOUND (YD%GPVORTGRAD)
  WRITE (KLUN) YD%GPVORTGRAD
ENDIF
LMCELL = ALLOCATED (YD%MCELL)
WRITE (KLUN) LMCELL
IF (LMCELL) THEN
  WRITE (KLUN) LBOUND (YD%MCELL)
  WRITE (KLUN) UBOUND (YD%MCELL)
  WRITE (KLUN) YD%MCELL
ENDIF
LRWGHT = ALLOCATED (YD%RWGHT)
WRITE (KLUN) LRWGHT
IF (LRWGHT) THEN
  WRITE (KLUN) LBOUND (YD%RWGHT)
  WRITE (KLUN) UBOUND (YD%RWGHT)
  WRITE (KLUN) YD%RWGHT
ENDIF
WRITE (KLUN) YD%NFRSTOPH_SPBS
WRITE (KLUN) YD%NFRSTOPH_SPBS_PAT
WRITE (KLUN) YD%NFRSTOPH_VC
WRITE (KLUN) YD%NFORCESTART
WRITE (KLUN) YD%NFORCEEND
WRITE (KLUN) YD%NSTOCHOPT
WRITE (KLUN) YD%ALPHA_DEEP_CONV
WRITE (KLUN) YD%ALPHA_SHAL_CONV
WRITE (KLUN) YD%SLDISSFAC
WRITE (KLUN) YD%RATIO_BACKSCAT
WRITE (KLUN) YD%RSPBS_TAU
WRITE (KLUN) YD%RATIO_BACKSCAT_CON2NUM
WRITE (KLUN) YD%REXPONENT
WRITE (KLUN) YD%VC_CON
WRITE (KLUN) YD%RFLUX_DET_CLIP
WRITE (KLUN) YD%BIHARM
WRITE (KLUN) YD%RSMOOTHSCALE
WRITE (KLUN) YD%RSIGMA2_EPS
WRITE (KLUN) YD%INCUT
WRITE (KLUN) YD%AMAGSTOPH_CASBS
WRITE (KLUN) YD%ADLATSTOPH_CA
WRITE (KLUN) YD%ADLONSTOPH_CA
WRITE (KLUN) YD%LSTOPH_SPBS
WRITE (KLUN) YD%LSTOPH_SPBS_FAST
WRITE (KLUN) YD%LEXTRAFIELDS
WRITE (KLUN) YD%LSTOPH_JBCOR
WRITE (KLUN) YD%LSTOPH_UNCORR
WRITE (KLUN) YD%LSTOPH_UNIFORM
WRITE (KLUN) YD%LSTOPH_SPBS_VORT
WRITE (KLUN) YD%LSTOPH_RVP
WRITE (KLUN) YD%LSTOPH_RVPOLD
WRITE (KLUN) YD%LSTOPH_TAPER
WRITE (KLUN) YD%LSTOPH_INI
WRITE (KLUN) YD%LSTOPH_CASBS
WRITE (KLUN) YD%LVORTCON
WRITE (KLUN) YD%LFORCENL
WRITE (KLUN) YD%LSTOPH_VARALPHA
WRITE (KLUN) YD%LSTOPH_GAUSS
WRITE (KLUN) YD%LSPBS_DISSGW
WRITE (KLUN) YD%LSPBS_DISSNUM
WRITE (KLUN) YD%LSPBS_DISSCU
WRITE (KLUN) YD%LSPBS_DISSNUM_CT
WRITE (KLUN) YD%LSPBSNORM
WRITE (KLUN) YD%LSPBSDISS
LSPDP = ALLOCATED (YD%SPDP)
WRITE (KLUN) LSPDP
IF (LSPDP) THEN
  WRITE (KLUN) LBOUND (YD%SPDP)
  WRITE (KLUN) UBOUND (YD%SPDP)
  WRITE (KLUN) YD%SPDP
ENDIF
LNIMRAN = ALLOCATED (YD%NIMRAN)
WRITE (KLUN) LNIMRAN
IF (LNIMRAN) THEN
  WRITE (KLUN) LBOUND (YD%NIMRAN)
  WRITE (KLUN) UBOUND (YD%NIMRAN)
  WRITE (KLUN) YD%NIMRAN
ENDIF
WRITE (KLUN) YD%NSMAXSPBS
WRITE (KLUN) YD%RVP_MULMIN
WRITE (KLUN) YD%RVP_MULMAX
WRITE (KLUN) YD%RVP_MULEXP
WRITE (KLUN) YD%RVP_MULNSMAX
LRVP_MULFACT = ALLOCATED (YD%RVP_MULFACT)
WRITE (KLUN) LRVP_MULFACT
IF (LRVP_MULFACT) THEN
  WRITE (KLUN) LBOUND (YD%RVP_MULFACT)
  WRITE (KLUN) UBOUND (YD%RVP_MULFACT)
  WRITE (KLUN) YD%RVP_MULFACT
ENDIF
WRITE (KLUN) YD%RVP_MUL_A
WRITE (KLUN) YD%RVP_MUL_B
WRITE (KLUN) YD%RVP_MUL_C
WRITE (KLUN) YD%RVP_MUL_D
WRITE (KLUN) YD%RVP_MUL_1
WRITE (KLUN) YD%RVP_MUL_2
LRVP_MUL = ALLOCATED (YD%RVP_MUL)
WRITE (KLUN) LRVP_MUL
IF (LRVP_MUL) THEN
  WRITE (KLUN) LBOUND (YD%RVP_MUL)
  WRITE (KLUN) UBOUND (YD%RVP_MUL)
  WRITE (KLUN) YD%RVP_MUL
ENDIF
WRITE (KLUN) YD%TAPER_SIGMATOP
WRITE (KLUN) YD%TAPER_SIGMABOT
WRITE (KLUN) YD%TAPER0
WRITE (KLUN) YD%TAPER1
WRITE (KLUN) YD%TAPER2
WRITE (KLUN) YD%TAPER3
LTAPER_FACT = ALLOCATED (YD%TAPER_FACT)
WRITE (KLUN) LTAPER_FACT
IF (LTAPER_FACT) THEN
  WRITE (KLUN) LBOUND (YD%TAPER_FACT)
  WRITE (KLUN) UBOUND (YD%TAPER_FACT)
  WRITE (KLUN) YD%TAPER_FACT
ENDIF
WRITE (KLUN) YD%LSTOPH_SPBS_T
WRITE (KLUN) YD%REXPONENT_T
WRITE (KLUN) YD%RATIO_APE2KE
LSPTEMP = ALLOCATED (YD%SPTEMP)
WRITE (KLUN) LSPTEMP
IF (LSPTEMP) THEN
  WRITE (KLUN) LBOUND (YD%SPTEMP)
  WRITE (KLUN) UBOUND (YD%SPTEMP)
  WRITE (KLUN) YD%SPTEMP
ENDIF
LSPTEMP_FORC = ALLOCATED (YD%SPTEMP_FORC)
WRITE (KLUN) LSPTEMP_FORC
IF (LSPTEMP_FORC) THEN
  WRITE (KLUN) LBOUND (YD%SPTEMP_FORC)
  WRITE (KLUN) UBOUND (YD%SPTEMP_FORC)
  WRITE (KLUN) YD%SPTEMP_FORC
ENDIF
LSPG_AMP_T = ALLOCATED (YD%SPG_AMP_T)
WRITE (KLUN) LSPG_AMP_T
IF (LSPG_AMP_T) THEN
  WRITE (KLUN) LBOUND (YD%SPG_AMP_T)
  WRITE (KLUN) UBOUND (YD%SPG_AMP_T)
  WRITE (KLUN) YD%SPG_AMP_T
ENDIF
LALPHA_STO_T = ALLOCATED (YD%ALPHA_STO_T)
WRITE (KLUN) LALPHA_STO_T
IF (LALPHA_STO_T) THEN
  WRITE (KLUN) LBOUND (YD%ALPHA_STO_T)
  WRITE (KLUN) UBOUND (YD%ALPHA_STO_T)
  WRITE (KLUN) YD%ALPHA_STO_T
ENDIF
LONEMINALPHA_NFRSPBS_T = ALLOCATED (YD%ONEMINALPHA_NFRSPBS_T)
WRITE (KLUN) LONEMINALPHA_NFRSPBS_T
IF (LONEMINALPHA_NFRSPBS_T) THEN
  WRITE (KLUN) LBOUND (YD%ONEMINALPHA_NFRSPBS_T)
  WRITE (KLUN) UBOUND (YD%ONEMINALPHA_NFRSPBS_T)
  WRITE (KLUN) YD%ONEMINALPHA_NFRSPBS_T
ENDIF
LGPTEMP = ALLOCATED (YD%GPTEMP)
WRITE (KLUN) LGPTEMP
IF (LGPTEMP) THEN
  WRITE (KLUN) LBOUND (YD%GPTEMP)
  WRITE (KLUN) UBOUND (YD%GPTEMP)
  WRITE (KLUN) YD%GPTEMP
ENDIF
WRITE (KLUN) YD%RVP_MULMIN_T
WRITE (KLUN) YD%RVP_MULMAX_T
WRITE (KLUN) YD%RVP_MULEXP_T
WRITE (KLUN) YD%RVP_MULNSMAX_T
LRVP_MULFACT_T = ALLOCATED (YD%RVP_MULFACT_T)
WRITE (KLUN) LRVP_MULFACT_T
IF (LRVP_MULFACT_T) THEN
  WRITE (KLUN) LBOUND (YD%RVP_MULFACT_T)
  WRITE (KLUN) UBOUND (YD%RVP_MULFACT_T)
  WRITE (KLUN) YD%RVP_MULFACT_T
ENDIF
WRITE (KLUN) YD%RVP_MUL_A_T
WRITE (KLUN) YD%RVP_MUL_B_T
WRITE (KLUN) YD%RVP_MUL_C_T
WRITE (KLUN) YD%RVP_MUL_D_T
WRITE (KLUN) YD%RVP_MUL_1_T
WRITE (KLUN) YD%RVP_MUL_2_T
LRVP_MUL_T = ALLOCATED (YD%RVP_MUL_T)
WRITE (KLUN) LRVP_MUL_T
IF (LRVP_MUL_T) THEN
  WRITE (KLUN) LBOUND (YD%RVP_MUL_T)
  WRITE (KLUN) UBOUND (YD%RVP_MUL_T)
  WRITE (KLUN) YD%RVP_MUL_T
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_TSTOPH (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TSTOPH), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2), IL3(3), IU3(3)
LOGICAL :: LALPHA_STO, LALPHA_STO_T, LGPSTREAM, LGPTEMP, LGPTOTDISS, LGPTOTDISS_SMOOTH, LGPVELPOT, LGPVORTGRAD, LMCELL, LNIMRAN
LOGICAL :: LONEMINALPHA_NFRSPBS, LONEMINALPHA_NFRSPBS_T, LRSMOOTH, LRSTOPHCA, LRVP_MUL, LRVP_MULFACT, LRVP_MULFACT_T, LRVP_MUL_T, LRWGHT, LSPDP
LOGICAL :: LSPG_AMP, LSPG_AMP_T, LSPSTREAM, LSPSTREAM_FORC, LSPTEMP, LSPTEMP_FORC, LSPVELPOT, LSPVELPOT_FORC, LSQRTCORR, LTAPER_FACT
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
READ (KLUN) LRSTOPHCA
IF (LRSTOPHCA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RSTOPHCA (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RSTOPHCA,1):UBOUND(YD%RSTOPHCA,1)))
  READ (KLUN) ZTMP1
  YD%RSTOPHCA = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSQRTCORR
IF (LSQRTCORR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SQRTCORR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SQRTCORR,1):UBOUND(YD%SQRTCORR,1), LBOUND(YD%SQRTCORR,2):UBOUND(YD%SQRTCORR,2)))
  READ (KLUN) ZTMP2
  YD%SQRTCORR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPSTREAM
IF (LSPSTREAM) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPSTREAM (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPSTREAM,1):UBOUND(YD%SPSTREAM,1), LBOUND(YD%SPSTREAM,2):UBOUND(YD%SPSTREAM,2)))
  READ (KLUN) ZTMP2
  YD%SPSTREAM = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPVELPOT
IF (LSPVELPOT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPVELPOT (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPVELPOT,1):UBOUND(YD%SPVELPOT,1), LBOUND(YD%SPVELPOT,2):UBOUND(YD%SPVELPOT,2)))
  READ (KLUN) ZTMP2
  YD%SPVELPOT = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPSTREAM_FORC
IF (LSPSTREAM_FORC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPSTREAM_FORC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPSTREAM_FORC,1):UBOUND(YD%SPSTREAM_FORC,1), LBOUND(YD%SPSTREAM_FORC,2):UBOUND(YD%SPSTREAM_FORC,2)))
  READ (KLUN) ZTMP2
  YD%SPSTREAM_FORC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPVELPOT_FORC
IF (LSPVELPOT_FORC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPVELPOT_FORC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPVELPOT_FORC,1):UBOUND(YD%SPVELPOT_FORC,1), LBOUND(YD%SPVELPOT_FORC,2):UBOUND(YD%SPVELPOT_FORC,2)))
  READ (KLUN) ZTMP2
  YD%SPVELPOT_FORC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPG_AMP
IF (LSPG_AMP) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%SPG_AMP (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%SPG_AMP,1):UBOUND(YD%SPG_AMP,1)))
  READ (KLUN) ZTMP1
  YD%SPG_AMP = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LALPHA_STO
IF (LALPHA_STO) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%ALPHA_STO (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%ALPHA_STO,1):UBOUND(YD%ALPHA_STO,1)))
  READ (KLUN) ZTMP1
  YD%ALPHA_STO = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LONEMINALPHA_NFRSPBS
IF (LONEMINALPHA_NFRSPBS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%ONEMINALPHA_NFRSPBS (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%ONEMINALPHA_NFRSPBS,1):UBOUND(YD%ONEMINALPHA_NFRSPBS,1)))
  READ (KLUN) ZTMP1
  YD%ONEMINALPHA_NFRSPBS = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRSMOOTH
IF (LRSMOOTH) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RSMOOTH (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RSMOOTH,1):UBOUND(YD%RSMOOTH,1)))
  READ (KLUN) ZTMP1
  YD%RSMOOTH = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LGPSTREAM
IF (LGPSTREAM) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%GPSTREAM (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%GPSTREAM,1):UBOUND(YD%GPSTREAM,1), LBOUND(YD%GPSTREAM,2):UBOUND(YD%GPSTREAM,2), LBOUND(YD%GPSTREAM,3):UBOUND(YD%GPSTREAM,3)))
  READ (KLUN) ZTMP3
  YD%GPSTREAM = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGPVELPOT
IF (LGPVELPOT) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%GPVELPOT (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%GPVELPOT,1):UBOUND(YD%GPVELPOT,1), LBOUND(YD%GPVELPOT,2):UBOUND(YD%GPVELPOT,2), LBOUND(YD%GPVELPOT,3):UBOUND(YD%GPVELPOT,3)))
  READ (KLUN) ZTMP3
  YD%GPVELPOT = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGPTOTDISS
IF (LGPTOTDISS) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%GPTOTDISS (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%GPTOTDISS,1):UBOUND(YD%GPTOTDISS,1), LBOUND(YD%GPTOTDISS,2):UBOUND(YD%GPTOTDISS,2), LBOUND(YD%GPTOTDISS,3):UBOUND(YD%GPTOTDISS,3)))
  READ (KLUN) ZTMP3
  YD%GPTOTDISS = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGPTOTDISS_SMOOTH
IF (LGPTOTDISS_SMOOTH) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%GPTOTDISS_SMOOTH (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%GPTOTDISS_SMOOTH,1):UBOUND(YD%GPTOTDISS_SMOOTH,1), LBOUND(YD%GPTOTDISS_SMOOTH,2):UBOUND(YD%GPTOTDISS_SMOOTH,2), LBOUND(YD%GPTOTDISS_SMOOTH,3):UBOUND(YD%GPTOTDISS_SMOOTH,3)))
  READ (KLUN) ZTMP3
  YD%GPTOTDISS_SMOOTH = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGPVORTGRAD
IF (LGPVORTGRAD) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%GPVORTGRAD (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%GPVORTGRAD,1):UBOUND(YD%GPVORTGRAD,1), LBOUND(YD%GPVORTGRAD,2):UBOUND(YD%GPVORTGRAD,2), LBOUND(YD%GPVORTGRAD,3):UBOUND(YD%GPVORTGRAD,3)))
  READ (KLUN) ZTMP3
  YD%GPVORTGRAD = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LMCELL
IF (LMCELL) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%MCELL (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%MCELL
ENDIF
READ (KLUN) LRWGHT
IF (LRWGHT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%RWGHT (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%RWGHT,1):UBOUND(YD%RWGHT,1), LBOUND(YD%RWGHT,2):UBOUND(YD%RWGHT,2)))
  READ (KLUN) ZTMP2
  YD%RWGHT = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) YD%NFRSTOPH_SPBS
READ (KLUN) YD%NFRSTOPH_SPBS_PAT
READ (KLUN) YD%NFRSTOPH_VC
READ (KLUN) YD%NFORCESTART
READ (KLUN) YD%NFORCEEND
READ (KLUN) YD%NSTOCHOPT
READ (KLUN) ZTMP0
YD%ALPHA_DEEP_CONV = ZTMP0
READ (KLUN) ZTMP0
YD%ALPHA_SHAL_CONV = ZTMP0
READ (KLUN) ZTMP0
YD%SLDISSFAC = ZTMP0
READ (KLUN) ZTMP0
YD%RATIO_BACKSCAT = ZTMP0
READ (KLUN) ZTMP0
YD%RSPBS_TAU = ZTMP0
READ (KLUN) ZTMP0
YD%RATIO_BACKSCAT_CON2NUM = ZTMP0
READ (KLUN) ZTMP0
YD%REXPONENT = ZTMP0
READ (KLUN) ZTMP0
YD%VC_CON = ZTMP0
READ (KLUN) ZTMP0
YD%RFLUX_DET_CLIP = ZTMP0
READ (KLUN) ZTMP0
YD%BIHARM = ZTMP0
READ (KLUN) ZTMP0
YD%RSMOOTHSCALE = ZTMP0
READ (KLUN) ZTMP0
YD%RSIGMA2_EPS = ZTMP0
READ (KLUN) YD%INCUT
READ (KLUN) ZTMP0
YD%AMAGSTOPH_CASBS = ZTMP0
READ (KLUN) ZTMP0
YD%ADLATSTOPH_CA = ZTMP0
READ (KLUN) ZTMP0
YD%ADLONSTOPH_CA = ZTMP0
READ (KLUN) YD%LSTOPH_SPBS
READ (KLUN) YD%LSTOPH_SPBS_FAST
READ (KLUN) YD%LEXTRAFIELDS
READ (KLUN) YD%LSTOPH_JBCOR
READ (KLUN) YD%LSTOPH_UNCORR
READ (KLUN) YD%LSTOPH_UNIFORM
READ (KLUN) YD%LSTOPH_SPBS_VORT
READ (KLUN) YD%LSTOPH_RVP
READ (KLUN) YD%LSTOPH_RVPOLD
READ (KLUN) YD%LSTOPH_TAPER
READ (KLUN) YD%LSTOPH_INI
READ (KLUN) YD%LSTOPH_CASBS
READ (KLUN) YD%LVORTCON
READ (KLUN) YD%LFORCENL
READ (KLUN) YD%LSTOPH_VARALPHA
READ (KLUN) YD%LSTOPH_GAUSS
READ (KLUN) YD%LSPBS_DISSGW
READ (KLUN) YD%LSPBS_DISSNUM
READ (KLUN) YD%LSPBS_DISSCU
READ (KLUN) YD%LSPBS_DISSNUM_CT
READ (KLUN) YD%LSPBSNORM
READ (KLUN) YD%LSPBSDISS
READ (KLUN) LSPDP
IF (LSPDP) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%SPDP (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%SPDP,1):UBOUND(YD%SPDP,1)))
  READ (KLUN) ZTMP1
  YD%SPDP = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LNIMRAN
IF (LNIMRAN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%NIMRAN (IL1(1):IU1(1)))
  READ (KLUN) YD%NIMRAN
ENDIF
READ (KLUN) YD%NSMAXSPBS
READ (KLUN) ZTMP0
YD%RVP_MULMIN = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MULMAX = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MULEXP = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MULNSMAX = ZTMP0
READ (KLUN) LRVP_MULFACT
IF (LRVP_MULFACT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RVP_MULFACT (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RVP_MULFACT,1):UBOUND(YD%RVP_MULFACT,1)))
  READ (KLUN) ZTMP1
  YD%RVP_MULFACT = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) ZTMP0
YD%RVP_MUL_A = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_B = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_C = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_D = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_1 = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_2 = ZTMP0
READ (KLUN) LRVP_MUL
IF (LRVP_MUL) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RVP_MUL (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RVP_MUL,1):UBOUND(YD%RVP_MUL,1)))
  READ (KLUN) ZTMP1
  YD%RVP_MUL = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) ZTMP0
YD%TAPER_SIGMATOP = ZTMP0
READ (KLUN) ZTMP0
YD%TAPER_SIGMABOT = ZTMP0
READ (KLUN) ZTMP0
YD%TAPER0 = ZTMP0
READ (KLUN) ZTMP0
YD%TAPER1 = ZTMP0
READ (KLUN) ZTMP0
YD%TAPER2 = ZTMP0
READ (KLUN) ZTMP0
YD%TAPER3 = ZTMP0
READ (KLUN) LTAPER_FACT
IF (LTAPER_FACT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%TAPER_FACT (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%TAPER_FACT,1):UBOUND(YD%TAPER_FACT,1)))
  READ (KLUN) ZTMP1
  YD%TAPER_FACT = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) YD%LSTOPH_SPBS_T
READ (KLUN) ZTMP0
YD%REXPONENT_T = ZTMP0
READ (KLUN) ZTMP0
YD%RATIO_APE2KE = ZTMP0
READ (KLUN) LSPTEMP
IF (LSPTEMP) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTEMP (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTEMP,1):UBOUND(YD%SPTEMP,1), LBOUND(YD%SPTEMP,2):UBOUND(YD%SPTEMP,2)))
  READ (KLUN) ZTMP2
  YD%SPTEMP = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTEMP_FORC
IF (LSPTEMP_FORC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SPTEMP_FORC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SPTEMP_FORC,1):UBOUND(YD%SPTEMP_FORC,1), LBOUND(YD%SPTEMP_FORC,2):UBOUND(YD%SPTEMP_FORC,2)))
  READ (KLUN) ZTMP2
  YD%SPTEMP_FORC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPG_AMP_T
IF (LSPG_AMP_T) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%SPG_AMP_T (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%SPG_AMP_T,1):UBOUND(YD%SPG_AMP_T,1)))
  READ (KLUN) ZTMP1
  YD%SPG_AMP_T = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LALPHA_STO_T
IF (LALPHA_STO_T) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%ALPHA_STO_T (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%ALPHA_STO_T,1):UBOUND(YD%ALPHA_STO_T,1)))
  READ (KLUN) ZTMP1
  YD%ALPHA_STO_T = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LONEMINALPHA_NFRSPBS_T
IF (LONEMINALPHA_NFRSPBS_T) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%ONEMINALPHA_NFRSPBS_T (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%ONEMINALPHA_NFRSPBS_T,1):UBOUND(YD%ONEMINALPHA_NFRSPBS_T,1)))
  READ (KLUN) ZTMP1
  YD%ONEMINALPHA_NFRSPBS_T = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LGPTEMP
IF (LGPTEMP) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%GPTEMP (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%GPTEMP,1):UBOUND(YD%GPTEMP,1), LBOUND(YD%GPTEMP,2):UBOUND(YD%GPTEMP,2), LBOUND(YD%GPTEMP,3):UBOUND(YD%GPTEMP,3)))
  READ (KLUN) ZTMP3
  YD%GPTEMP = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) ZTMP0
YD%RVP_MULMIN_T = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MULMAX_T = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MULEXP_T = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MULNSMAX_T = ZTMP0
READ (KLUN) LRVP_MULFACT_T
IF (LRVP_MULFACT_T) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RVP_MULFACT_T (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RVP_MULFACT_T,1):UBOUND(YD%RVP_MULFACT_T,1)))
  READ (KLUN) ZTMP1
  YD%RVP_MULFACT_T = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) ZTMP0
YD%RVP_MUL_A_T = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_B_T = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_C_T = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_D_T = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_1_T = ZTMP0
READ (KLUN) ZTMP0
YD%RVP_MUL_2_T = ZTMP0
READ (KLUN) LRVP_MUL_T
IF (LRVP_MUL_T) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RVP_MUL_T (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RVP_MUL_T,1):UBOUND(YD%RVP_MUL_T,1)))
  READ (KLUN) ZTMP1
  YD%RVP_MUL_T = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_TSTOPH (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TSTOPH), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LALPHA_STO, LALPHA_STO_T, LGPSTREAM, LGPTEMP, LGPTOTDISS, LGPTOTDISS_SMOOTH, LGPVELPOT, LGPVORTGRAD, LMCELL, LNIMRAN
LOGICAL :: LONEMINALPHA_NFRSPBS, LONEMINALPHA_NFRSPBS_T, LRSMOOTH, LRSTOPHCA, LRVP_MUL, LRVP_MULFACT, LRVP_MULFACT_T, LRVP_MUL_T, LRWGHT, LSPDP
LOGICAL :: LSPG_AMP, LSPG_AMP_T, LSPSTREAM, LSPSTREAM_FORC, LSPTEMP, LSPTEMP_FORC, LSPVELPOT, LSPVELPOT_FORC, LSQRTCORR, LTAPER_FACT

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
LRSTOPHCA = ALLOCATED (YD%RSTOPHCA)
IF (LRSTOPHCA) THEN
  !$ACC ENTER DATA CREATE (YD%RSTOPHCA)
  !$ACC UPDATE DEVICE (YD%RSTOPHCA)
  !$ACC ENTER DATA ATTACH (YD%RSTOPHCA)
ENDIF

LSQRTCORR = ALLOCATED (YD%SQRTCORR)
IF (LSQRTCORR) THEN
  !$ACC ENTER DATA CREATE (YD%SQRTCORR)
  !$ACC UPDATE DEVICE (YD%SQRTCORR)
  !$ACC ENTER DATA ATTACH (YD%SQRTCORR)
ENDIF

LSPSTREAM = ALLOCATED (YD%SPSTREAM)
IF (LSPSTREAM) THEN
  !$ACC ENTER DATA CREATE (YD%SPSTREAM)
  !$ACC UPDATE DEVICE (YD%SPSTREAM)
  !$ACC ENTER DATA ATTACH (YD%SPSTREAM)
ENDIF

LSPVELPOT = ALLOCATED (YD%SPVELPOT)
IF (LSPVELPOT) THEN
  !$ACC ENTER DATA CREATE (YD%SPVELPOT)
  !$ACC UPDATE DEVICE (YD%SPVELPOT)
  !$ACC ENTER DATA ATTACH (YD%SPVELPOT)
ENDIF

LSPSTREAM_FORC = ALLOCATED (YD%SPSTREAM_FORC)
IF (LSPSTREAM_FORC) THEN
  !$ACC ENTER DATA CREATE (YD%SPSTREAM_FORC)
  !$ACC UPDATE DEVICE (YD%SPSTREAM_FORC)
  !$ACC ENTER DATA ATTACH (YD%SPSTREAM_FORC)
ENDIF

LSPVELPOT_FORC = ALLOCATED (YD%SPVELPOT_FORC)
IF (LSPVELPOT_FORC) THEN
  !$ACC ENTER DATA CREATE (YD%SPVELPOT_FORC)
  !$ACC UPDATE DEVICE (YD%SPVELPOT_FORC)
  !$ACC ENTER DATA ATTACH (YD%SPVELPOT_FORC)
ENDIF

LSPG_AMP = ALLOCATED (YD%SPG_AMP)
IF (LSPG_AMP) THEN
  !$ACC ENTER DATA CREATE (YD%SPG_AMP)
  !$ACC UPDATE DEVICE (YD%SPG_AMP)
  !$ACC ENTER DATA ATTACH (YD%SPG_AMP)
ENDIF

LALPHA_STO = ALLOCATED (YD%ALPHA_STO)
IF (LALPHA_STO) THEN
  !$ACC ENTER DATA CREATE (YD%ALPHA_STO)
  !$ACC UPDATE DEVICE (YD%ALPHA_STO)
  !$ACC ENTER DATA ATTACH (YD%ALPHA_STO)
ENDIF

LONEMINALPHA_NFRSPBS = ALLOCATED (YD%ONEMINALPHA_NFRSPBS)
IF (LONEMINALPHA_NFRSPBS) THEN
  !$ACC ENTER DATA CREATE (YD%ONEMINALPHA_NFRSPBS)
  !$ACC UPDATE DEVICE (YD%ONEMINALPHA_NFRSPBS)
  !$ACC ENTER DATA ATTACH (YD%ONEMINALPHA_NFRSPBS)
ENDIF

LRSMOOTH = ALLOCATED (YD%RSMOOTH)
IF (LRSMOOTH) THEN
  !$ACC ENTER DATA CREATE (YD%RSMOOTH)
  !$ACC UPDATE DEVICE (YD%RSMOOTH)
  !$ACC ENTER DATA ATTACH (YD%RSMOOTH)
ENDIF

LGPSTREAM = ALLOCATED (YD%GPSTREAM)
IF (LGPSTREAM) THEN
  !$ACC ENTER DATA CREATE (YD%GPSTREAM)
  !$ACC UPDATE DEVICE (YD%GPSTREAM)
  !$ACC ENTER DATA ATTACH (YD%GPSTREAM)
ENDIF

LGPVELPOT = ALLOCATED (YD%GPVELPOT)
IF (LGPVELPOT) THEN
  !$ACC ENTER DATA CREATE (YD%GPVELPOT)
  !$ACC UPDATE DEVICE (YD%GPVELPOT)
  !$ACC ENTER DATA ATTACH (YD%GPVELPOT)
ENDIF

LGPTOTDISS = ALLOCATED (YD%GPTOTDISS)
IF (LGPTOTDISS) THEN
  !$ACC ENTER DATA CREATE (YD%GPTOTDISS)
  !$ACC UPDATE DEVICE (YD%GPTOTDISS)
  !$ACC ENTER DATA ATTACH (YD%GPTOTDISS)
ENDIF

LGPTOTDISS_SMOOTH = ALLOCATED (YD%GPTOTDISS_SMOOTH)
IF (LGPTOTDISS_SMOOTH) THEN
  !$ACC ENTER DATA CREATE (YD%GPTOTDISS_SMOOTH)
  !$ACC UPDATE DEVICE (YD%GPTOTDISS_SMOOTH)
  !$ACC ENTER DATA ATTACH (YD%GPTOTDISS_SMOOTH)
ENDIF

LGPVORTGRAD = ALLOCATED (YD%GPVORTGRAD)
IF (LGPVORTGRAD) THEN
  !$ACC ENTER DATA CREATE (YD%GPVORTGRAD)
  !$ACC UPDATE DEVICE (YD%GPVORTGRAD)
  !$ACC ENTER DATA ATTACH (YD%GPVORTGRAD)
ENDIF

LMCELL = ALLOCATED (YD%MCELL)
IF (LMCELL) THEN
  !$ACC ENTER DATA CREATE (YD%MCELL)
  !$ACC UPDATE DEVICE (YD%MCELL)
  !$ACC ENTER DATA ATTACH (YD%MCELL)
ENDIF

LRWGHT = ALLOCATED (YD%RWGHT)
IF (LRWGHT) THEN
  !$ACC ENTER DATA CREATE (YD%RWGHT)
  !$ACC UPDATE DEVICE (YD%RWGHT)
  !$ACC ENTER DATA ATTACH (YD%RWGHT)
ENDIF













































LSPDP = ALLOCATED (YD%SPDP)
IF (LSPDP) THEN
  !$ACC ENTER DATA CREATE (YD%SPDP)
  !$ACC UPDATE DEVICE (YD%SPDP)
  !$ACC ENTER DATA ATTACH (YD%SPDP)
ENDIF

LNIMRAN = ALLOCATED (YD%NIMRAN)
IF (LNIMRAN) THEN
  !$ACC ENTER DATA CREATE (YD%NIMRAN)
  !$ACC UPDATE DEVICE (YD%NIMRAN)
  !$ACC ENTER DATA ATTACH (YD%NIMRAN)
ENDIF






LRVP_MULFACT = ALLOCATED (YD%RVP_MULFACT)
IF (LRVP_MULFACT) THEN
  !$ACC ENTER DATA CREATE (YD%RVP_MULFACT)
  !$ACC UPDATE DEVICE (YD%RVP_MULFACT)
  !$ACC ENTER DATA ATTACH (YD%RVP_MULFACT)
ENDIF







LRVP_MUL = ALLOCATED (YD%RVP_MUL)
IF (LRVP_MUL) THEN
  !$ACC ENTER DATA CREATE (YD%RVP_MUL)
  !$ACC UPDATE DEVICE (YD%RVP_MUL)
  !$ACC ENTER DATA ATTACH (YD%RVP_MUL)
ENDIF







LTAPER_FACT = ALLOCATED (YD%TAPER_FACT)
IF (LTAPER_FACT) THEN
  !$ACC ENTER DATA CREATE (YD%TAPER_FACT)
  !$ACC UPDATE DEVICE (YD%TAPER_FACT)
  !$ACC ENTER DATA ATTACH (YD%TAPER_FACT)
ENDIF




LSPTEMP = ALLOCATED (YD%SPTEMP)
IF (LSPTEMP) THEN
  !$ACC ENTER DATA CREATE (YD%SPTEMP)
  !$ACC UPDATE DEVICE (YD%SPTEMP)
  !$ACC ENTER DATA ATTACH (YD%SPTEMP)
ENDIF

LSPTEMP_FORC = ALLOCATED (YD%SPTEMP_FORC)
IF (LSPTEMP_FORC) THEN
  !$ACC ENTER DATA CREATE (YD%SPTEMP_FORC)
  !$ACC UPDATE DEVICE (YD%SPTEMP_FORC)
  !$ACC ENTER DATA ATTACH (YD%SPTEMP_FORC)
ENDIF

LSPG_AMP_T = ALLOCATED (YD%SPG_AMP_T)
IF (LSPG_AMP_T) THEN
  !$ACC ENTER DATA CREATE (YD%SPG_AMP_T)
  !$ACC UPDATE DEVICE (YD%SPG_AMP_T)
  !$ACC ENTER DATA ATTACH (YD%SPG_AMP_T)
ENDIF

LALPHA_STO_T = ALLOCATED (YD%ALPHA_STO_T)
IF (LALPHA_STO_T) THEN
  !$ACC ENTER DATA CREATE (YD%ALPHA_STO_T)
  !$ACC UPDATE DEVICE (YD%ALPHA_STO_T)
  !$ACC ENTER DATA ATTACH (YD%ALPHA_STO_T)
ENDIF

LONEMINALPHA_NFRSPBS_T = ALLOCATED (YD%ONEMINALPHA_NFRSPBS_T)
IF (LONEMINALPHA_NFRSPBS_T) THEN
  !$ACC ENTER DATA CREATE (YD%ONEMINALPHA_NFRSPBS_T)
  !$ACC UPDATE DEVICE (YD%ONEMINALPHA_NFRSPBS_T)
  !$ACC ENTER DATA ATTACH (YD%ONEMINALPHA_NFRSPBS_T)
ENDIF

LGPTEMP = ALLOCATED (YD%GPTEMP)
IF (LGPTEMP) THEN
  !$ACC ENTER DATA CREATE (YD%GPTEMP)
  !$ACC UPDATE DEVICE (YD%GPTEMP)
  !$ACC ENTER DATA ATTACH (YD%GPTEMP)
ENDIF





LRVP_MULFACT_T = ALLOCATED (YD%RVP_MULFACT_T)
IF (LRVP_MULFACT_T) THEN
  !$ACC ENTER DATA CREATE (YD%RVP_MULFACT_T)
  !$ACC UPDATE DEVICE (YD%RVP_MULFACT_T)
  !$ACC ENTER DATA ATTACH (YD%RVP_MULFACT_T)
ENDIF







LRVP_MUL_T = ALLOCATED (YD%RVP_MUL_T)
IF (LRVP_MUL_T) THEN
  !$ACC ENTER DATA CREATE (YD%RVP_MUL_T)
  !$ACC UPDATE DEVICE (YD%RVP_MUL_T)
  !$ACC ENTER DATA ATTACH (YD%RVP_MUL_T)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_TSTOPH (YD)

IMPLICIT NONE
TYPE (TSTOPH), TARGET :: YD
LOGICAL :: LALPHA_STO, LALPHA_STO_T, LGPSTREAM, LGPTEMP, LGPTOTDISS, LGPTOTDISS_SMOOTH, LGPVELPOT, LGPVORTGRAD, LMCELL, LNIMRAN
LOGICAL :: LONEMINALPHA_NFRSPBS, LONEMINALPHA_NFRSPBS_T, LRSMOOTH, LRSTOPHCA, LRVP_MUL, LRVP_MULFACT, LRVP_MULFACT_T, LRVP_MUL_T, LRWGHT, LSPDP
LOGICAL :: LSPG_AMP, LSPG_AMP_T, LSPSTREAM, LSPSTREAM_FORC, LSPTEMP, LSPTEMP_FORC, LSPVELPOT, LSPVELPOT_FORC, LSQRTCORR, LTAPER_FACT








































































































END SUBROUTINE

     

SUBROUTINE CRC64_TSTOPH (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TSTOPH), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LALPHA_STO, LALPHA_STO_T, LGPSTREAM, LGPTEMP, LGPTOTDISS, LGPTOTDISS_SMOOTH, LGPVELPOT, LGPVORTGRAD, LMCELL, LNIMRAN
LOGICAL :: LONEMINALPHA_NFRSPBS, LONEMINALPHA_NFRSPBS_T, LRSMOOTH, LRSTOPHCA, LRVP_MUL, LRVP_MULFACT, LRVP_MULFACT_T, LRVP_MUL_T, LRWGHT, LSPDP
LOGICAL :: LSPG_AMP, LSPG_AMP_T, LSPSTREAM, LSPSTREAM_FORC, LSPTEMP, LSPTEMP_FORC, LSPVELPOT, LSPVELPOT_FORC, LSQRTCORR, LTAPER_FACT
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSTOPHCA), CDPATH//'%RSTOPHCA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SQRTCORR), CDPATH//'%SQRTCORR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPSTREAM), CDPATH//'%SPSTREAM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPVELPOT), CDPATH//'%SPVELPOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPSTREAM_FORC), CDPATH//'%SPSTREAM_FORC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPVELPOT_FORC), CDPATH//'%SPVELPOT_FORC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPG_AMP), CDPATH//'%SPG_AMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ALPHA_STO), CDPATH//'%ALPHA_STO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ONEMINALPHA_NFRSPBS), CDPATH//'%ONEMINALPHA_NFRSPBS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSMOOTH), CDPATH//'%RSMOOTH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GPSTREAM), CDPATH//'%GPSTREAM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GPVELPOT), CDPATH//'%GPVELPOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GPTOTDISS), CDPATH//'%GPTOTDISS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GPTOTDISS_SMOOTH), CDPATH//'%GPTOTDISS_SMOOTH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GPVORTGRAD), CDPATH//'%GPVORTGRAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%MCELL), CDPATH//'%MCELL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RWGHT), CDPATH//'%RWGHT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NFRSTOPH_SPBS), CDPATH//'%NFRSTOPH_SPBS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NFRSTOPH_SPBS_PAT), CDPATH//'%NFRSTOPH_SPBS_PAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NFRSTOPH_VC), CDPATH//'%NFRSTOPH_VC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NFORCESTART), CDPATH//'%NFORCESTART'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NFORCEEND), CDPATH//'%NFORCEEND'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSTOCHOPT), CDPATH//'%NSTOCHOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ALPHA_DEEP_CONV), CDPATH//'%ALPHA_DEEP_CONV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ALPHA_SHAL_CONV), CDPATH//'%ALPHA_SHAL_CONV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SLDISSFAC), CDPATH//'%SLDISSFAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RATIO_BACKSCAT), CDPATH//'%RATIO_BACKSCAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSPBS_TAU), CDPATH//'%RSPBS_TAU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RATIO_BACKSCAT_CON2NUM), CDPATH//'%RATIO_BACKSCAT_CON2NUM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%REXPONENT), CDPATH//'%REXPONENT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%VC_CON), CDPATH//'%VC_CON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RFLUX_DET_CLIP), CDPATH//'%RFLUX_DET_CLIP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%BIHARM), CDPATH//'%BIHARM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSMOOTHSCALE), CDPATH//'%RSMOOTHSCALE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIGMA2_EPS), CDPATH//'%RSIGMA2_EPS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%INCUT), CDPATH//'%INCUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%AMAGSTOPH_CASBS), CDPATH//'%AMAGSTOPH_CASBS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ADLATSTOPH_CA), CDPATH//'%ADLATSTOPH_CA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ADLONSTOPH_CA), CDPATH//'%ADLONSTOPH_CA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_SPBS), CDPATH//'%LSTOPH_SPBS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_SPBS_FAST), CDPATH//'%LSTOPH_SPBS_FAST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LEXTRAFIELDS), CDPATH//'%LEXTRAFIELDS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_JBCOR), CDPATH//'%LSTOPH_JBCOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_UNCORR), CDPATH//'%LSTOPH_UNCORR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_UNIFORM), CDPATH//'%LSTOPH_UNIFORM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_SPBS_VORT), CDPATH//'%LSTOPH_SPBS_VORT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_RVP), CDPATH//'%LSTOPH_RVP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_RVPOLD), CDPATH//'%LSTOPH_RVPOLD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_TAPER), CDPATH//'%LSTOPH_TAPER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_INI), CDPATH//'%LSTOPH_INI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_CASBS), CDPATH//'%LSTOPH_CASBS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LVORTCON), CDPATH//'%LVORTCON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LFORCENL), CDPATH//'%LFORCENL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_VARALPHA), CDPATH//'%LSTOPH_VARALPHA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_GAUSS), CDPATH//'%LSTOPH_GAUSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPBS_DISSGW), CDPATH//'%LSPBS_DISSGW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPBS_DISSNUM), CDPATH//'%LSPBS_DISSNUM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPBS_DISSCU), CDPATH//'%LSPBS_DISSCU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPBS_DISSNUM_CT), CDPATH//'%LSPBS_DISSNUM_CT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPBSNORM), CDPATH//'%LSPBSNORM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSPBSDISS), CDPATH//'%LSPBSDISS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPDP), CDPATH//'%SPDP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NIMRAN), CDPATH//'%NIMRAN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSMAXSPBS), CDPATH//'%NSMAXSPBS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULMIN), CDPATH//'%RVP_MULMIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULMAX), CDPATH//'%RVP_MULMAX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULEXP), CDPATH//'%RVP_MULEXP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULNSMAX), CDPATH//'%RVP_MULNSMAX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULFACT), CDPATH//'%RVP_MULFACT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_A), CDPATH//'%RVP_MUL_A'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_B), CDPATH//'%RVP_MUL_B'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_C), CDPATH//'%RVP_MUL_C'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_D), CDPATH//'%RVP_MUL_D'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_1), CDPATH//'%RVP_MUL_1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_2), CDPATH//'%RVP_MUL_2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL), CDPATH//'%RVP_MUL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TAPER_SIGMATOP), CDPATH//'%TAPER_SIGMATOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TAPER_SIGMABOT), CDPATH//'%TAPER_SIGMABOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TAPER0), CDPATH//'%TAPER0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TAPER1), CDPATH//'%TAPER1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TAPER2), CDPATH//'%TAPER2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TAPER3), CDPATH//'%TAPER3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TAPER_FACT), CDPATH//'%TAPER_FACT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSTOPH_SPBS_T), CDPATH//'%LSTOPH_SPBS_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%REXPONENT_T), CDPATH//'%REXPONENT_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RATIO_APE2KE), CDPATH//'%RATIO_APE2KE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTEMP), CDPATH//'%SPTEMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPTEMP_FORC), CDPATH//'%SPTEMP_FORC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SPG_AMP_T), CDPATH//'%SPG_AMP_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ALPHA_STO_T), CDPATH//'%ALPHA_STO_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ONEMINALPHA_NFRSPBS_T), CDPATH//'%ONEMINALPHA_NFRSPBS_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%GPTEMP), CDPATH//'%GPTEMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULMIN_T), CDPATH//'%RVP_MULMIN_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULMAX_T), CDPATH//'%RVP_MULMAX_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULEXP_T), CDPATH//'%RVP_MULEXP_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULNSMAX_T), CDPATH//'%RVP_MULNSMAX_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MULFACT_T), CDPATH//'%RVP_MULFACT_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_A_T), CDPATH//'%RVP_MUL_A_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_B_T), CDPATH//'%RVP_MUL_B_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_C_T), CDPATH//'%RVP_MUL_C_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_D_T), CDPATH//'%RVP_MUL_D_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_1_T), CDPATH//'%RVP_MUL_1_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_2_T), CDPATH//'%RVP_MUL_2_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVP_MUL_T), CDPATH//'%RVP_MUL_T'

END SUBROUTINE

SUBROUTINE WIPE_TSTOPH (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TSTOPH), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LALPHA_STO, LALPHA_STO_T, LGPSTREAM, LGPTEMP, LGPTOTDISS, LGPTOTDISS_SMOOTH, LGPVELPOT, LGPVORTGRAD, LMCELL, LNIMRAN
LOGICAL :: LONEMINALPHA_NFRSPBS, LONEMINALPHA_NFRSPBS_T, LRSMOOTH, LRSTOPHCA, LRVP_MUL, LRVP_MULFACT, LRVP_MULFACT_T, LRVP_MUL_T, LRWGHT, LSPDP
LOGICAL :: LSPG_AMP, LSPG_AMP_T, LSPSTREAM, LSPSTREAM_FORC, LSPTEMP, LSPTEMP_FORC, LSPVELPOT, LSPVELPOT_FORC, LSQRTCORR, LTAPER_FACT

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LRSTOPHCA = ALLOCATED (YD%RSTOPHCA)
IF (LRSTOPHCA) THEN
  !$ACC EXIT DATA DETACH (YD%RSTOPHCA)
  !$ACC EXIT DATA DETACH (YD%RSTOPHCA)
ENDIF

LSQRTCORR = ALLOCATED (YD%SQRTCORR)
IF (LSQRTCORR) THEN
  !$ACC EXIT DATA DETACH (YD%SQRTCORR)
  !$ACC EXIT DATA DETACH (YD%SQRTCORR)
ENDIF

LSPSTREAM = ALLOCATED (YD%SPSTREAM)
IF (LSPSTREAM) THEN
  !$ACC EXIT DATA DETACH (YD%SPSTREAM)
  !$ACC EXIT DATA DETACH (YD%SPSTREAM)
ENDIF

LSPVELPOT = ALLOCATED (YD%SPVELPOT)
IF (LSPVELPOT) THEN
  !$ACC EXIT DATA DETACH (YD%SPVELPOT)
  !$ACC EXIT DATA DETACH (YD%SPVELPOT)
ENDIF

LSPSTREAM_FORC = ALLOCATED (YD%SPSTREAM_FORC)
IF (LSPSTREAM_FORC) THEN
  !$ACC EXIT DATA DETACH (YD%SPSTREAM_FORC)
  !$ACC EXIT DATA DETACH (YD%SPSTREAM_FORC)
ENDIF

LSPVELPOT_FORC = ALLOCATED (YD%SPVELPOT_FORC)
IF (LSPVELPOT_FORC) THEN
  !$ACC EXIT DATA DETACH (YD%SPVELPOT_FORC)
  !$ACC EXIT DATA DETACH (YD%SPVELPOT_FORC)
ENDIF

LSPG_AMP = ALLOCATED (YD%SPG_AMP)
IF (LSPG_AMP) THEN
  !$ACC EXIT DATA DETACH (YD%SPG_AMP)
  !$ACC EXIT DATA DETACH (YD%SPG_AMP)
ENDIF

LALPHA_STO = ALLOCATED (YD%ALPHA_STO)
IF (LALPHA_STO) THEN
  !$ACC EXIT DATA DETACH (YD%ALPHA_STO)
  !$ACC EXIT DATA DETACH (YD%ALPHA_STO)
ENDIF

LONEMINALPHA_NFRSPBS = ALLOCATED (YD%ONEMINALPHA_NFRSPBS)
IF (LONEMINALPHA_NFRSPBS) THEN
  !$ACC EXIT DATA DETACH (YD%ONEMINALPHA_NFRSPBS)
  !$ACC EXIT DATA DETACH (YD%ONEMINALPHA_NFRSPBS)
ENDIF

LRSMOOTH = ALLOCATED (YD%RSMOOTH)
IF (LRSMOOTH) THEN
  !$ACC EXIT DATA DETACH (YD%RSMOOTH)
  !$ACC EXIT DATA DETACH (YD%RSMOOTH)
ENDIF

LGPSTREAM = ALLOCATED (YD%GPSTREAM)
IF (LGPSTREAM) THEN
  !$ACC EXIT DATA DETACH (YD%GPSTREAM)
  !$ACC EXIT DATA DETACH (YD%GPSTREAM)
ENDIF

LGPVELPOT = ALLOCATED (YD%GPVELPOT)
IF (LGPVELPOT) THEN
  !$ACC EXIT DATA DETACH (YD%GPVELPOT)
  !$ACC EXIT DATA DETACH (YD%GPVELPOT)
ENDIF

LGPTOTDISS = ALLOCATED (YD%GPTOTDISS)
IF (LGPTOTDISS) THEN
  !$ACC EXIT DATA DETACH (YD%GPTOTDISS)
  !$ACC EXIT DATA DETACH (YD%GPTOTDISS)
ENDIF

LGPTOTDISS_SMOOTH = ALLOCATED (YD%GPTOTDISS_SMOOTH)
IF (LGPTOTDISS_SMOOTH) THEN
  !$ACC EXIT DATA DETACH (YD%GPTOTDISS_SMOOTH)
  !$ACC EXIT DATA DETACH (YD%GPTOTDISS_SMOOTH)
ENDIF

LGPVORTGRAD = ALLOCATED (YD%GPVORTGRAD)
IF (LGPVORTGRAD) THEN
  !$ACC EXIT DATA DETACH (YD%GPVORTGRAD)
  !$ACC EXIT DATA DETACH (YD%GPVORTGRAD)
ENDIF

LMCELL = ALLOCATED (YD%MCELL)
IF (LMCELL) THEN
  !$ACC EXIT DATA DETACH (YD%MCELL)
  !$ACC EXIT DATA DETACH (YD%MCELL)
ENDIF

LRWGHT = ALLOCATED (YD%RWGHT)
IF (LRWGHT) THEN
  !$ACC EXIT DATA DETACH (YD%RWGHT)
  !$ACC EXIT DATA DETACH (YD%RWGHT)
ENDIF













































LSPDP = ALLOCATED (YD%SPDP)
IF (LSPDP) THEN
  !$ACC EXIT DATA DETACH (YD%SPDP)
  !$ACC EXIT DATA DETACH (YD%SPDP)
ENDIF

LNIMRAN = ALLOCATED (YD%NIMRAN)
IF (LNIMRAN) THEN
  !$ACC EXIT DATA DETACH (YD%NIMRAN)
  !$ACC EXIT DATA DETACH (YD%NIMRAN)
ENDIF






LRVP_MULFACT = ALLOCATED (YD%RVP_MULFACT)
IF (LRVP_MULFACT) THEN
  !$ACC EXIT DATA DETACH (YD%RVP_MULFACT)
  !$ACC EXIT DATA DETACH (YD%RVP_MULFACT)
ENDIF







LRVP_MUL = ALLOCATED (YD%RVP_MUL)
IF (LRVP_MUL) THEN
  !$ACC EXIT DATA DETACH (YD%RVP_MUL)
  !$ACC EXIT DATA DETACH (YD%RVP_MUL)
ENDIF







LTAPER_FACT = ALLOCATED (YD%TAPER_FACT)
IF (LTAPER_FACT) THEN
  !$ACC EXIT DATA DETACH (YD%TAPER_FACT)
  !$ACC EXIT DATA DETACH (YD%TAPER_FACT)
ENDIF




LSPTEMP = ALLOCATED (YD%SPTEMP)
IF (LSPTEMP) THEN
  !$ACC EXIT DATA DETACH (YD%SPTEMP)
  !$ACC EXIT DATA DETACH (YD%SPTEMP)
ENDIF

LSPTEMP_FORC = ALLOCATED (YD%SPTEMP_FORC)
IF (LSPTEMP_FORC) THEN
  !$ACC EXIT DATA DETACH (YD%SPTEMP_FORC)
  !$ACC EXIT DATA DETACH (YD%SPTEMP_FORC)
ENDIF

LSPG_AMP_T = ALLOCATED (YD%SPG_AMP_T)
IF (LSPG_AMP_T) THEN
  !$ACC EXIT DATA DETACH (YD%SPG_AMP_T)
  !$ACC EXIT DATA DETACH (YD%SPG_AMP_T)
ENDIF

LALPHA_STO_T = ALLOCATED (YD%ALPHA_STO_T)
IF (LALPHA_STO_T) THEN
  !$ACC EXIT DATA DETACH (YD%ALPHA_STO_T)
  !$ACC EXIT DATA DETACH (YD%ALPHA_STO_T)
ENDIF

LONEMINALPHA_NFRSPBS_T = ALLOCATED (YD%ONEMINALPHA_NFRSPBS_T)
IF (LONEMINALPHA_NFRSPBS_T) THEN
  !$ACC EXIT DATA DETACH (YD%ONEMINALPHA_NFRSPBS_T)
  !$ACC EXIT DATA DETACH (YD%ONEMINALPHA_NFRSPBS_T)
ENDIF

LGPTEMP = ALLOCATED (YD%GPTEMP)
IF (LGPTEMP) THEN
  !$ACC EXIT DATA DETACH (YD%GPTEMP)
  !$ACC EXIT DATA DETACH (YD%GPTEMP)
ENDIF





LRVP_MULFACT_T = ALLOCATED (YD%RVP_MULFACT_T)
IF (LRVP_MULFACT_T) THEN
  !$ACC EXIT DATA DETACH (YD%RVP_MULFACT_T)
  !$ACC EXIT DATA DETACH (YD%RVP_MULFACT_T)
ENDIF







LRVP_MUL_T = ALLOCATED (YD%RVP_MUL_T)
IF (LRVP_MUL_T) THEN
  !$ACC EXIT DATA DETACH (YD%RVP_MUL_T)
  !$ACC EXIT DATA DETACH (YD%RVP_MUL_T)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TSTOPH (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TSTOPH),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LALPHA_STO, LALPHA_STO_T, LGPSTREAM, LGPTEMP, LGPTOTDISS, LGPTOTDISS_SMOOTH, LGPVELPOT, LGPVORTGRAD, LMCELL, LNIMRAN
LOGICAL :: LONEMINALPHA_NFRSPBS, LONEMINALPHA_NFRSPBS_T, LRSMOOTH, LRSTOPHCA, LRVP_MUL, LRVP_MULFACT, LRVP_MULFACT_T, LRVP_MUL_T, LRWGHT, LSPDP
LOGICAL :: LSPG_AMP, LSPG_AMP_T, LSPSTREAM, LSPSTREAM_FORC, LSPTEMP, LSPTEMP_FORC, LSPVELPOT, LSPVELPOT_FORC, LSQRTCORR, LTAPER_FACT

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LRSTOPHCA = ALLOCATED (YD%RSTOPHCA)
IF (LRSTOPHCA) THEN
  ISIZE = KIND (YD%RSTOPHCA) * SIZE (YD%RSTOPHCA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RSTOPHCA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSQRTCORR = ALLOCATED (YD%SQRTCORR)
IF (LSQRTCORR) THEN
  ISIZE = KIND (YD%SQRTCORR) * SIZE (YD%SQRTCORR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SQRTCORR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPSTREAM = ALLOCATED (YD%SPSTREAM)
IF (LSPSTREAM) THEN
  ISIZE = KIND (YD%SPSTREAM) * SIZE (YD%SPSTREAM)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPSTREAM'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPVELPOT = ALLOCATED (YD%SPVELPOT)
IF (LSPVELPOT) THEN
  ISIZE = KIND (YD%SPVELPOT) * SIZE (YD%SPVELPOT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPVELPOT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPSTREAM_FORC = ALLOCATED (YD%SPSTREAM_FORC)
IF (LSPSTREAM_FORC) THEN
  ISIZE = KIND (YD%SPSTREAM_FORC) * SIZE (YD%SPSTREAM_FORC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPSTREAM_FORC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPVELPOT_FORC = ALLOCATED (YD%SPVELPOT_FORC)
IF (LSPVELPOT_FORC) THEN
  ISIZE = KIND (YD%SPVELPOT_FORC) * SIZE (YD%SPVELPOT_FORC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPVELPOT_FORC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPG_AMP = ALLOCATED (YD%SPG_AMP)
IF (LSPG_AMP) THEN
  ISIZE = KIND (YD%SPG_AMP) * SIZE (YD%SPG_AMP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPG_AMP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LALPHA_STO = ALLOCATED (YD%ALPHA_STO)
IF (LALPHA_STO) THEN
  ISIZE = KIND (YD%ALPHA_STO) * SIZE (YD%ALPHA_STO)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%ALPHA_STO'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LONEMINALPHA_NFRSPBS = ALLOCATED (YD%ONEMINALPHA_NFRSPBS)
IF (LONEMINALPHA_NFRSPBS) THEN
  ISIZE = KIND (YD%ONEMINALPHA_NFRSPBS) * SIZE (YD%ONEMINALPHA_NFRSPBS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%ONEMINALPHA_NFRSPBS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRSMOOTH = ALLOCATED (YD%RSMOOTH)
IF (LRSMOOTH) THEN
  ISIZE = KIND (YD%RSMOOTH) * SIZE (YD%RSMOOTH)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RSMOOTH'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGPSTREAM = ALLOCATED (YD%GPSTREAM)
IF (LGPSTREAM) THEN
  ISIZE = KIND (YD%GPSTREAM) * SIZE (YD%GPSTREAM)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GPSTREAM'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGPVELPOT = ALLOCATED (YD%GPVELPOT)
IF (LGPVELPOT) THEN
  ISIZE = KIND (YD%GPVELPOT) * SIZE (YD%GPVELPOT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GPVELPOT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGPTOTDISS = ALLOCATED (YD%GPTOTDISS)
IF (LGPTOTDISS) THEN
  ISIZE = KIND (YD%GPTOTDISS) * SIZE (YD%GPTOTDISS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GPTOTDISS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGPTOTDISS_SMOOTH = ALLOCATED (YD%GPTOTDISS_SMOOTH)
IF (LGPTOTDISS_SMOOTH) THEN
  ISIZE = KIND (YD%GPTOTDISS_SMOOTH) * SIZE (YD%GPTOTDISS_SMOOTH)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GPTOTDISS_SMOOTH'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGPVORTGRAD = ALLOCATED (YD%GPVORTGRAD)
IF (LGPVORTGRAD) THEN
  ISIZE = KIND (YD%GPVORTGRAD) * SIZE (YD%GPVORTGRAD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GPVORTGRAD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMCELL = ALLOCATED (YD%MCELL)
IF (LMCELL) THEN
  ISIZE = KIND (YD%MCELL) * SIZE (YD%MCELL)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MCELL'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRWGHT = ALLOCATED (YD%RWGHT)
IF (LRWGHT) THEN
  ISIZE = KIND (YD%RWGHT) * SIZE (YD%RWGHT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RWGHT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%NFRSTOPH_SPBS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFRSTOPH_SPBS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NFRSTOPH_SPBS_PAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFRSTOPH_SPBS_PAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NFRSTOPH_VC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFRSTOPH_VC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NFORCESTART)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFORCESTART'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NFORCEEND)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFORCEEND'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSTOCHOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSTOCHOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ALPHA_DEEP_CONV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ALPHA_DEEP_CONV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ALPHA_SHAL_CONV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ALPHA_SHAL_CONV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%SLDISSFAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SLDISSFAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RATIO_BACKSCAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RATIO_BACKSCAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSPBS_TAU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSPBS_TAU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RATIO_BACKSCAT_CON2NUM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RATIO_BACKSCAT_CON2NUM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%REXPONENT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%REXPONENT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%VC_CON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%VC_CON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RFLUX_DET_CLIP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RFLUX_DET_CLIP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%BIHARM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%BIHARM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSMOOTHSCALE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSMOOTHSCALE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIGMA2_EPS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIGMA2_EPS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%INCUT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%INCUT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%AMAGSTOPH_CASBS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%AMAGSTOPH_CASBS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ADLATSTOPH_CA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ADLATSTOPH_CA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ADLONSTOPH_CA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ADLONSTOPH_CA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_SPBS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_SPBS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_SPBS_FAST)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_SPBS_FAST'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LEXTRAFIELDS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LEXTRAFIELDS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_JBCOR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_JBCOR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_UNCORR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_UNCORR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_UNIFORM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_UNIFORM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_SPBS_VORT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_SPBS_VORT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_RVP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_RVP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_RVPOLD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_RVPOLD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_TAPER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_TAPER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_INI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_INI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_CASBS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_CASBS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LVORTCON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVORTCON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LFORCENL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LFORCENL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_VARALPHA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_VARALPHA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSTOPH_GAUSS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_GAUSS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSPBS_DISSGW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPBS_DISSGW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSPBS_DISSNUM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPBS_DISSNUM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSPBS_DISSCU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPBS_DISSCU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSPBS_DISSNUM_CT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPBS_DISSNUM_CT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSPBSNORM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPBSNORM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSPBSDISS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSPBSDISS'
ENDIF
KSIZE = KSIZE + ISIZE
LSPDP = ALLOCATED (YD%SPDP)
IF (LSPDP) THEN
  ISIZE = KIND (YD%SPDP) * SIZE (YD%SPDP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPDP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNIMRAN = ALLOCATED (YD%NIMRAN)
IF (LNIMRAN) THEN
  ISIZE = KIND (YD%NIMRAN) * SIZE (YD%NIMRAN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NIMRAN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%NSMAXSPBS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSMAXSPBS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MULMIN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MULMIN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MULMAX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MULMAX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MULEXP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MULEXP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MULNSMAX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MULNSMAX'
ENDIF
KSIZE = KSIZE + ISIZE
LRVP_MULFACT = ALLOCATED (YD%RVP_MULFACT)
IF (LRVP_MULFACT) THEN
  ISIZE = KIND (YD%RVP_MULFACT) * SIZE (YD%RVP_MULFACT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RVP_MULFACT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%RVP_MUL_A)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_A'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_B)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_B'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_C)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_C'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_D)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_D'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_2'
ENDIF
KSIZE = KSIZE + ISIZE
LRVP_MUL = ALLOCATED (YD%RVP_MUL)
IF (LRVP_MUL) THEN
  ISIZE = KIND (YD%RVP_MUL) * SIZE (YD%RVP_MUL)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%TAPER_SIGMATOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TAPER_SIGMATOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TAPER_SIGMABOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TAPER_SIGMABOT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TAPER0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TAPER0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TAPER1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TAPER1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TAPER2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TAPER2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TAPER3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TAPER3'
ENDIF
KSIZE = KSIZE + ISIZE
LTAPER_FACT = ALLOCATED (YD%TAPER_FACT)
IF (LTAPER_FACT) THEN
  ISIZE = KIND (YD%TAPER_FACT) * SIZE (YD%TAPER_FACT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TAPER_FACT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%LSTOPH_SPBS_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSTOPH_SPBS_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%REXPONENT_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%REXPONENT_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RATIO_APE2KE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RATIO_APE2KE'
ENDIF
KSIZE = KSIZE + ISIZE
LSPTEMP = ALLOCATED (YD%SPTEMP)
IF (LSPTEMP) THEN
  ISIZE = KIND (YD%SPTEMP) * SIZE (YD%SPTEMP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTEMP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTEMP_FORC = ALLOCATED (YD%SPTEMP_FORC)
IF (LSPTEMP_FORC) THEN
  ISIZE = KIND (YD%SPTEMP_FORC) * SIZE (YD%SPTEMP_FORC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTEMP_FORC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPG_AMP_T = ALLOCATED (YD%SPG_AMP_T)
IF (LSPG_AMP_T) THEN
  ISIZE = KIND (YD%SPG_AMP_T) * SIZE (YD%SPG_AMP_T)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPG_AMP_T'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LALPHA_STO_T = ALLOCATED (YD%ALPHA_STO_T)
IF (LALPHA_STO_T) THEN
  ISIZE = KIND (YD%ALPHA_STO_T) * SIZE (YD%ALPHA_STO_T)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%ALPHA_STO_T'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LONEMINALPHA_NFRSPBS_T = ALLOCATED (YD%ONEMINALPHA_NFRSPBS_T)
IF (LONEMINALPHA_NFRSPBS_T) THEN
  ISIZE = KIND (YD%ONEMINALPHA_NFRSPBS_T) * SIZE (YD%ONEMINALPHA_NFRSPBS_T)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%ONEMINALPHA_NFRSPBS_T'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGPTEMP = ALLOCATED (YD%GPTEMP)
IF (LGPTEMP) THEN
  ISIZE = KIND (YD%GPTEMP) * SIZE (YD%GPTEMP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GPTEMP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%RVP_MULMIN_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MULMIN_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MULMAX_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MULMAX_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MULEXP_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MULEXP_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MULNSMAX_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MULNSMAX_T'
ENDIF
KSIZE = KSIZE + ISIZE
LRVP_MULFACT_T = ALLOCATED (YD%RVP_MULFACT_T)
IF (LRVP_MULFACT_T) THEN
  ISIZE = KIND (YD%RVP_MULFACT_T) * SIZE (YD%RVP_MULFACT_T)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RVP_MULFACT_T'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%RVP_MUL_A_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_A_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_B_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_B_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_C_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_C_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_D_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_D_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_1_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_1_T'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVP_MUL_2_T)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_2_T'
ENDIF
KSIZE = KSIZE + ISIZE
LRVP_MUL_T = ALLOCATED (YD%RVP_MUL_T)
IF (LRVP_MUL_T) THEN
  ISIZE = KIND (YD%RVP_MUL_T) * SIZE (YD%RVP_MUL_T)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RVP_MUL_T'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
