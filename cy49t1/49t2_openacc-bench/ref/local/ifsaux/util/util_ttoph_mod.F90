MODULE UTIL_TTOPH_MOD

USE YOMTOPH, ONLY : TTOPH

INTERFACE SAVE
MODULE PROCEDURE SAVE_TTOPH
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TTOPH
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TTOPH
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TTOPH
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TTOPH
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TTOPH
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TTOPH
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TTOPH (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TTOPH), INTENT (IN), TARGET :: YD
LOGICAL :: LRMESOQ, LRMESOT, LRMESOU, LRQREL, LRTREL, LRUREL, LRVREL
LRMESOU = ALLOCATED (YD%RMESOU)
WRITE (KLUN) LRMESOU
IF (LRMESOU) THEN
  WRITE (KLUN) LBOUND (YD%RMESOU)
  WRITE (KLUN) UBOUND (YD%RMESOU)
  WRITE (KLUN) YD%RMESOU
ENDIF
LRMESOT = ALLOCATED (YD%RMESOT)
WRITE (KLUN) LRMESOT
IF (LRMESOT) THEN
  WRITE (KLUN) LBOUND (YD%RMESOT)
  WRITE (KLUN) UBOUND (YD%RMESOT)
  WRITE (KLUN) YD%RMESOT
ENDIF
LRMESOQ = ALLOCATED (YD%RMESOQ)
WRITE (KLUN) LRMESOQ
IF (LRMESOQ) THEN
  WRITE (KLUN) LBOUND (YD%RMESOQ)
  WRITE (KLUN) UBOUND (YD%RMESOQ)
  WRITE (KLUN) YD%RMESOQ
ENDIF
LRUREL = ALLOCATED (YD%RUREL)
WRITE (KLUN) LRUREL
IF (LRUREL) THEN
  WRITE (KLUN) LBOUND (YD%RUREL)
  WRITE (KLUN) UBOUND (YD%RUREL)
  WRITE (KLUN) YD%RUREL
ENDIF
LRVREL = ALLOCATED (YD%RVREL)
WRITE (KLUN) LRVREL
IF (LRVREL) THEN
  WRITE (KLUN) LBOUND (YD%RVREL)
  WRITE (KLUN) UBOUND (YD%RVREL)
  WRITE (KLUN) YD%RVREL
ENDIF
LRTREL = ALLOCATED (YD%RTREL)
WRITE (KLUN) LRTREL
IF (LRTREL) THEN
  WRITE (KLUN) LBOUND (YD%RTREL)
  WRITE (KLUN) UBOUND (YD%RTREL)
  WRITE (KLUN) YD%RTREL
ENDIF
LRQREL = ALLOCATED (YD%RQREL)
WRITE (KLUN) LRQREL
IF (LRQREL) THEN
  WRITE (KLUN) LBOUND (YD%RQREL)
  WRITE (KLUN) UBOUND (YD%RQREL)
  WRITE (KLUN) YD%RQREL
ENDIF
WRITE (KLUN) YD%RFMESOQ
WRITE (KLUN) YD%NTQSAT
WRITE (KLUN) YD%NTDIFU
WRITE (KLUN) YD%NTCOEF
WRITE (KLUN) YD%NTDRAG
WRITE (KLUN) YD%NTCVIM
WRITE (KLUN) YD%NT850
WRITE (KLUN) YD%NT950
WRITE (KLUN) YD%NTPLUI
WRITE (KLUN) YD%NTRADI
WRITE (KLUN) YD%NTNEBU
WRITE (KLUN) YD%NTOZON
WRITE (KLUN) YD%NTDRME
WRITE (KLUN) YD%NTCOET
WRITE (KLUN) YD%NTAJUC
WRITE (KLUN) YD%NTRELAXT
WRITE (KLUN) YD%NTRELAXQ
WRITE (KLUN) YD%NTRELAXU
WRITE (KLUN) YD%CHEM_HPSC_NTOP
WRITE (KLUN) YD%CHEM_HPSC_NBOT
WRITE (KLUN) YD%CHEM_HOXF_NBOT
WRITE (KLUN) YD%CHEM_ELEM_NTOP
WRITE (KLUN) YD%CHEM_RELA_NIV
WRITE (KLUN) YD%CHEM_NO_NIV
WRITE (KLUN) YD%ETQSAT
WRITE (KLUN) YD%ETDIFU
WRITE (KLUN) YD%ETCOEF
WRITE (KLUN) YD%ETDRAG
WRITE (KLUN) YD%ETCVIM
WRITE (KLUN) YD%ET850
WRITE (KLUN) YD%ET950
WRITE (KLUN) YD%ETPLUI
WRITE (KLUN) YD%ETRADI
WRITE (KLUN) YD%ETNEBU
WRITE (KLUN) YD%ETOZON
WRITE (KLUN) YD%ETDRME
WRITE (KLUN) YD%ETCOET
WRITE (KLUN) YD%ETAJUC
WRITE (KLUN) YD%ETRELAXT
WRITE (KLUN) YD%ETRELAXQ
WRITE (KLUN) YD%ETRELAXU
WRITE (KLUN) YD%XDRMUK
WRITE (KLUN) YD%XDRMUX
WRITE (KLUN) YD%XDRMUP
WRITE (KLUN) YD%XDRMTK
WRITE (KLUN) YD%XDRMTX
WRITE (KLUN) YD%XDRMTP
WRITE (KLUN) YD%XDRMQK
WRITE (KLUN) YD%XDRMQP
WRITE (KLUN) YD%XDRMQX
WRITE (KLUN) YD%RCLX
WRITE (KLUN) YD%TPSCLIM
WRITE (KLUN) YD%ETELEM
WRITE (KLUN) YD%ETRELA
WRITE (KLUN) YD%ETPSCT
WRITE (KLUN) YD%ETPSCB
WRITE (KLUN) YD%ETHOXF
WRITE (KLUN) YD%ETCHEMNO
END SUBROUTINE

SUBROUTINE LOAD_TTOPH (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TTOPH), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LRMESOQ, LRMESOT, LRMESOU, LRQREL, LRTREL, LRUREL, LRVREL
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) LRMESOU
IF (LRMESOU) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RMESOU (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RMESOU,1):UBOUND(YD%RMESOU,1)))
  READ (KLUN) ZTMP1
  YD%RMESOU = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRMESOT
IF (LRMESOT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RMESOT (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RMESOT,1):UBOUND(YD%RMESOT,1)))
  READ (KLUN) ZTMP1
  YD%RMESOT = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRMESOQ
IF (LRMESOQ) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RMESOQ (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RMESOQ,1):UBOUND(YD%RMESOQ,1)))
  READ (KLUN) ZTMP1
  YD%RMESOQ = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRUREL
IF (LRUREL) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RUREL (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RUREL,1):UBOUND(YD%RUREL,1)))
  READ (KLUN) ZTMP1
  YD%RUREL = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRVREL
IF (LRVREL) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RVREL (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RVREL,1):UBOUND(YD%RVREL,1)))
  READ (KLUN) ZTMP1
  YD%RVREL = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRTREL
IF (LRTREL) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RTREL (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RTREL,1):UBOUND(YD%RTREL,1)))
  READ (KLUN) ZTMP1
  YD%RTREL = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRQREL
IF (LRQREL) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RQREL (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RQREL,1):UBOUND(YD%RQREL,1)))
  READ (KLUN) ZTMP1
  YD%RQREL = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) ZTMP0
YD%RFMESOQ = ZTMP0
READ (KLUN) YD%NTQSAT
READ (KLUN) YD%NTDIFU
READ (KLUN) YD%NTCOEF
READ (KLUN) YD%NTDRAG
READ (KLUN) YD%NTCVIM
READ (KLUN) YD%NT850
READ (KLUN) YD%NT950
READ (KLUN) YD%NTPLUI
READ (KLUN) YD%NTRADI
READ (KLUN) YD%NTNEBU
READ (KLUN) YD%NTOZON
READ (KLUN) YD%NTDRME
READ (KLUN) YD%NTCOET
READ (KLUN) YD%NTAJUC
READ (KLUN) YD%NTRELAXT
READ (KLUN) YD%NTRELAXQ
READ (KLUN) YD%NTRELAXU
READ (KLUN) YD%CHEM_HPSC_NTOP
READ (KLUN) YD%CHEM_HPSC_NBOT
READ (KLUN) YD%CHEM_HOXF_NBOT
READ (KLUN) YD%CHEM_ELEM_NTOP
READ (KLUN) YD%CHEM_RELA_NIV
READ (KLUN) YD%CHEM_NO_NIV
READ (KLUN) ZTMP0
YD%ETQSAT = ZTMP0
READ (KLUN) ZTMP0
YD%ETDIFU = ZTMP0
READ (KLUN) ZTMP0
YD%ETCOEF = ZTMP0
READ (KLUN) ZTMP0
YD%ETDRAG = ZTMP0
READ (KLUN) ZTMP0
YD%ETCVIM = ZTMP0
READ (KLUN) ZTMP0
YD%ET850 = ZTMP0
READ (KLUN) ZTMP0
YD%ET950 = ZTMP0
READ (KLUN) ZTMP0
YD%ETPLUI = ZTMP0
READ (KLUN) ZTMP0
YD%ETRADI = ZTMP0
READ (KLUN) ZTMP0
YD%ETNEBU = ZTMP0
READ (KLUN) ZTMP0
YD%ETOZON = ZTMP0
READ (KLUN) ZTMP0
YD%ETDRME = ZTMP0
READ (KLUN) ZTMP0
YD%ETCOET = ZTMP0
READ (KLUN) ZTMP0
YD%ETAJUC = ZTMP0
READ (KLUN) ZTMP0
YD%ETRELAXT = ZTMP0
READ (KLUN) ZTMP0
YD%ETRELAXQ = ZTMP0
READ (KLUN) ZTMP0
YD%ETRELAXU = ZTMP0
READ (KLUN) ZTMP0
YD%XDRMUK = ZTMP0
READ (KLUN) ZTMP0
YD%XDRMUX = ZTMP0
READ (KLUN) ZTMP0
YD%XDRMUP = ZTMP0
READ (KLUN) ZTMP0
YD%XDRMTK = ZTMP0
READ (KLUN) ZTMP0
YD%XDRMTX = ZTMP0
READ (KLUN) ZTMP0
YD%XDRMTP = ZTMP0
READ (KLUN) ZTMP0
YD%XDRMQK = ZTMP0
READ (KLUN) ZTMP0
YD%XDRMQP = ZTMP0
READ (KLUN) ZTMP0
YD%XDRMQX = ZTMP0
READ (KLUN) ZTMP0
YD%RCLX = ZTMP0
READ (KLUN) ZTMP0
YD%TPSCLIM = ZTMP0
READ (KLUN) ZTMP0
YD%ETELEM = ZTMP0
READ (KLUN) ZTMP0
YD%ETRELA = ZTMP0
READ (KLUN) ZTMP0
YD%ETPSCT = ZTMP0
READ (KLUN) ZTMP0
YD%ETPSCB = ZTMP0
READ (KLUN) ZTMP0
YD%ETHOXF = ZTMP0
READ (KLUN) ZTMP0
YD%ETCHEMNO = ZTMP0
END SUBROUTINE


SUBROUTINE COPY_TTOPH (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TTOPH), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRMESOQ, LRMESOT, LRMESOU, LRQREL, LRTREL, LRUREL, LRVREL

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
LRMESOU = ALLOCATED (YD%RMESOU)
IF (LRMESOU) THEN
  !$ACC ENTER DATA CREATE (YD%RMESOU)
  !$ACC UPDATE DEVICE (YD%RMESOU)
  !$ACC ENTER DATA ATTACH (YD%RMESOU)
ENDIF

LRMESOT = ALLOCATED (YD%RMESOT)
IF (LRMESOT) THEN
  !$ACC ENTER DATA CREATE (YD%RMESOT)
  !$ACC UPDATE DEVICE (YD%RMESOT)
  !$ACC ENTER DATA ATTACH (YD%RMESOT)
ENDIF

LRMESOQ = ALLOCATED (YD%RMESOQ)
IF (LRMESOQ) THEN
  !$ACC ENTER DATA CREATE (YD%RMESOQ)
  !$ACC UPDATE DEVICE (YD%RMESOQ)
  !$ACC ENTER DATA ATTACH (YD%RMESOQ)
ENDIF

LRUREL = ALLOCATED (YD%RUREL)
IF (LRUREL) THEN
  !$ACC ENTER DATA CREATE (YD%RUREL)
  !$ACC UPDATE DEVICE (YD%RUREL)
  !$ACC ENTER DATA ATTACH (YD%RUREL)
ENDIF

LRVREL = ALLOCATED (YD%RVREL)
IF (LRVREL) THEN
  !$ACC ENTER DATA CREATE (YD%RVREL)
  !$ACC UPDATE DEVICE (YD%RVREL)
  !$ACC ENTER DATA ATTACH (YD%RVREL)
ENDIF

LRTREL = ALLOCATED (YD%RTREL)
IF (LRTREL) THEN
  !$ACC ENTER DATA CREATE (YD%RTREL)
  !$ACC UPDATE DEVICE (YD%RTREL)
  !$ACC ENTER DATA ATTACH (YD%RTREL)
ENDIF

LRQREL = ALLOCATED (YD%RQREL)
IF (LRQREL) THEN
  !$ACC ENTER DATA CREATE (YD%RQREL)
  !$ACC UPDATE DEVICE (YD%RQREL)
  !$ACC ENTER DATA ATTACH (YD%RQREL)
ENDIF



























































END SUBROUTINE

SUBROUTINE HOST_TTOPH (YD)

IMPLICIT NONE
TYPE (TTOPH), TARGET :: YD
LOGICAL :: LRMESOQ, LRMESOT, LRMESOU, LRQREL, LRTREL, LRUREL, LRVREL

































































END SUBROUTINE

     

SUBROUTINE CRC64_TTOPH (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TTOPH), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LRMESOQ, LRMESOT, LRMESOU, LRQREL, LRTREL, LRUREL, LRVREL
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RMESOU), CDPATH//'%RMESOU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RMESOT), CDPATH//'%RMESOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RMESOQ), CDPATH//'%RMESOQ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RUREL), CDPATH//'%RUREL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVREL), CDPATH//'%RVREL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RTREL), CDPATH//'%RTREL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RQREL), CDPATH//'%RQREL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RFMESOQ), CDPATH//'%RFMESOQ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTQSAT), CDPATH//'%NTQSAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTDIFU), CDPATH//'%NTDIFU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTCOEF), CDPATH//'%NTCOEF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTDRAG), CDPATH//'%NTDRAG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTCVIM), CDPATH//'%NTCVIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NT850), CDPATH//'%NT850'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NT950), CDPATH//'%NT950'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTPLUI), CDPATH//'%NTPLUI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTRADI), CDPATH//'%NTRADI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTNEBU), CDPATH//'%NTNEBU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTOZON), CDPATH//'%NTOZON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTDRME), CDPATH//'%NTDRME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTCOET), CDPATH//'%NTCOET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTAJUC), CDPATH//'%NTAJUC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTRELAXT), CDPATH//'%NTRELAXT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTRELAXQ), CDPATH//'%NTRELAXQ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTRELAXU), CDPATH//'%NTRELAXU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CHEM_HPSC_NTOP), CDPATH//'%CHEM_HPSC_NTOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CHEM_HPSC_NBOT), CDPATH//'%CHEM_HPSC_NBOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CHEM_HOXF_NBOT), CDPATH//'%CHEM_HOXF_NBOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CHEM_ELEM_NTOP), CDPATH//'%CHEM_ELEM_NTOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CHEM_RELA_NIV), CDPATH//'%CHEM_RELA_NIV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CHEM_NO_NIV), CDPATH//'%CHEM_NO_NIV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETQSAT), CDPATH//'%ETQSAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETDIFU), CDPATH//'%ETDIFU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETCOEF), CDPATH//'%ETCOEF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETDRAG), CDPATH//'%ETDRAG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETCVIM), CDPATH//'%ETCVIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ET850), CDPATH//'%ET850'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ET950), CDPATH//'%ET950'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETPLUI), CDPATH//'%ETPLUI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETRADI), CDPATH//'%ETRADI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETNEBU), CDPATH//'%ETNEBU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETOZON), CDPATH//'%ETOZON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETDRME), CDPATH//'%ETDRME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETCOET), CDPATH//'%ETCOET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETAJUC), CDPATH//'%ETAJUC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETRELAXT), CDPATH//'%ETRELAXT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETRELAXQ), CDPATH//'%ETRELAXQ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETRELAXU), CDPATH//'%ETRELAXU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDRMUK), CDPATH//'%XDRMUK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDRMUX), CDPATH//'%XDRMUX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDRMUP), CDPATH//'%XDRMUP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDRMTK), CDPATH//'%XDRMTK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDRMTX), CDPATH//'%XDRMTX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDRMTP), CDPATH//'%XDRMTP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDRMQK), CDPATH//'%XDRMQK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDRMQP), CDPATH//'%XDRMQP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDRMQX), CDPATH//'%XDRMQX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCLX), CDPATH//'%RCLX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TPSCLIM), CDPATH//'%TPSCLIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETELEM), CDPATH//'%ETELEM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETRELA), CDPATH//'%ETRELA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETPSCT), CDPATH//'%ETPSCT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETPSCB), CDPATH//'%ETPSCB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETHOXF), CDPATH//'%ETHOXF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ETCHEMNO), CDPATH//'%ETCHEMNO'

END SUBROUTINE

SUBROUTINE WIPE_TTOPH (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TTOPH), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRMESOQ, LRMESOT, LRMESOU, LRQREL, LRTREL, LRUREL, LRVREL

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LRMESOU = ALLOCATED (YD%RMESOU)
IF (LRMESOU) THEN
  !$ACC EXIT DATA DETACH (YD%RMESOU)
  !$ACC EXIT DATA DETACH (YD%RMESOU)
ENDIF

LRMESOT = ALLOCATED (YD%RMESOT)
IF (LRMESOT) THEN
  !$ACC EXIT DATA DETACH (YD%RMESOT)
  !$ACC EXIT DATA DETACH (YD%RMESOT)
ENDIF

LRMESOQ = ALLOCATED (YD%RMESOQ)
IF (LRMESOQ) THEN
  !$ACC EXIT DATA DETACH (YD%RMESOQ)
  !$ACC EXIT DATA DETACH (YD%RMESOQ)
ENDIF

LRUREL = ALLOCATED (YD%RUREL)
IF (LRUREL) THEN
  !$ACC EXIT DATA DETACH (YD%RUREL)
  !$ACC EXIT DATA DETACH (YD%RUREL)
ENDIF

LRVREL = ALLOCATED (YD%RVREL)
IF (LRVREL) THEN
  !$ACC EXIT DATA DETACH (YD%RVREL)
  !$ACC EXIT DATA DETACH (YD%RVREL)
ENDIF

LRTREL = ALLOCATED (YD%RTREL)
IF (LRTREL) THEN
  !$ACC EXIT DATA DETACH (YD%RTREL)
  !$ACC EXIT DATA DETACH (YD%RTREL)
ENDIF

LRQREL = ALLOCATED (YD%RQREL)
IF (LRQREL) THEN
  !$ACC EXIT DATA DETACH (YD%RQREL)
  !$ACC EXIT DATA DETACH (YD%RQREL)
ENDIF



























































LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TTOPH (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TTOPH),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LRMESOQ, LRMESOT, LRMESOU, LRQREL, LRTREL, LRUREL, LRVREL

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LRMESOU = ALLOCATED (YD%RMESOU)
IF (LRMESOU) THEN
  ISIZE = KIND (YD%RMESOU) * SIZE (YD%RMESOU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RMESOU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRMESOT = ALLOCATED (YD%RMESOT)
IF (LRMESOT) THEN
  ISIZE = KIND (YD%RMESOT) * SIZE (YD%RMESOT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RMESOT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRMESOQ = ALLOCATED (YD%RMESOQ)
IF (LRMESOQ) THEN
  ISIZE = KIND (YD%RMESOQ) * SIZE (YD%RMESOQ)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RMESOQ'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRUREL = ALLOCATED (YD%RUREL)
IF (LRUREL) THEN
  ISIZE = KIND (YD%RUREL) * SIZE (YD%RUREL)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RUREL'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRVREL = ALLOCATED (YD%RVREL)
IF (LRVREL) THEN
  ISIZE = KIND (YD%RVREL) * SIZE (YD%RVREL)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RVREL'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRTREL = ALLOCATED (YD%RTREL)
IF (LRTREL) THEN
  ISIZE = KIND (YD%RTREL) * SIZE (YD%RTREL)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RTREL'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRQREL = ALLOCATED (YD%RQREL)
IF (LRQREL) THEN
  ISIZE = KIND (YD%RQREL) * SIZE (YD%RQREL)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RQREL'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%RFMESOQ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RFMESOQ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTQSAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTQSAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTDIFU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTDIFU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTCOEF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTCOEF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTDRAG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTDRAG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTCVIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTCVIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NT850)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NT850'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NT950)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NT950'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTPLUI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTPLUI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTRADI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTRADI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTNEBU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTNEBU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTOZON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTOZON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTDRME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTDRME'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTCOET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTCOET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTAJUC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTAJUC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTRELAXT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTRELAXT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTRELAXQ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTRELAXQ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTRELAXU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTRELAXU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CHEM_HPSC_NTOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHEM_HPSC_NTOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CHEM_HPSC_NBOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHEM_HPSC_NBOT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CHEM_HOXF_NBOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHEM_HOXF_NBOT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CHEM_ELEM_NTOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHEM_ELEM_NTOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CHEM_RELA_NIV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHEM_RELA_NIV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CHEM_NO_NIV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHEM_NO_NIV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETQSAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETQSAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETDIFU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETDIFU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETCOEF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETCOEF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETDRAG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETDRAG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETCVIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETCVIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ET850)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ET850'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ET950)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ET950'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETPLUI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETPLUI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETRADI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETRADI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETNEBU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETNEBU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETOZON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETOZON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETDRME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETDRME'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETCOET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETCOET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETAJUC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETAJUC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETRELAXT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETRELAXT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETRELAXQ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETRELAXQ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETRELAXU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETRELAXU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDRMUK)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDRMUK'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDRMUX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDRMUX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDRMUP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDRMUP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDRMTK)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDRMTK'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDRMTX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDRMTX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDRMTP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDRMTP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDRMQK)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDRMQK'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDRMQP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDRMQP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDRMQX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDRMQX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCLX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCLX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TPSCLIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TPSCLIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETELEM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETELEM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETRELA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETRELA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETPSCT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETPSCT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETPSCB)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETPSCB'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETHOXF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETHOXF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ETCHEMNO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ETCHEMNO'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
