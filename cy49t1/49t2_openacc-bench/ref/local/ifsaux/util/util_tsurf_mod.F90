MODULE UTIL_TSURF_MOD

USE SURFACE_FIELDS_MIX, ONLY : TSURF

INTERFACE SAVE
MODULE PROCEDURE SAVE_TSURF
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TSURF
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TSURF
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TSURF
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TSURF
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TSURF
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TSURF (KLUN, YD)
USE UTIL_TYPE_SFL_CANRI_MOD
USE UTIL_TYPE_SFL_CLS_MOD
USE UTIL_TYPE_SFL_COMM_MOD
USE UTIL_TYPE_SFL_EXTRP_MOD
USE UTIL_TYPE_SFL_LAKEB_MOD
USE UTIL_TYPE_SFL_OCE_MOD
USE UTIL_TYPE_SFL_OML_MOD
USE UTIL_TYPE_SFL_RESVR_MOD
USE UTIL_TYPE_SFL_SATSIM_MOD
USE UTIL_TYPE_SFL_SFLUX_MOD
USE UTIL_TYPE_SFL_SFORC_MOD
USE UTIL_TYPE_SFL_SNOWG_MOD
USE UTIL_TYPE_SFL_SOILB_MOD
USE UTIL_TYPE_SFL_VARSF_MOD
USE UTIL_TYPE_SFL_VCLIA_MOD
USE UTIL_TYPE_SFL_VCLIH_MOD
USE UTIL_TYPE_SFL_VCLIK_MOD
USE UTIL_TYPE_SFL_VCLIN_MOD
USE UTIL_TYPE_SFL_VCLIP_MOD
USE UTIL_TYPE_SFL_VCLIV_MOD
USE UTIL_TYPE_SFL_VCLIX_MOD
USE UTIL_TYPE_SFL_VDIAGO2_MOD
USE UTIL_TYPE_SFL_VDIAGO3_MOD
USE UTIL_TYPE_SFL_VDIAG_MOD
USE UTIL_TYPE_SFL_VEXTR2_MOD
USE UTIL_TYPE_SFL_VEXTRA_MOD
USE UTIL_TYPE_SFL_VEXTRDI_MOD
USE UTIL_TYPE_SFL_VO3ABC_MOD
USE UTIL_TYPE_SFL_VPRECIP2_MOD
USE UTIL_TYPE_SFL_VPRECIP_MOD
USE UTIL_TYPE_SFL_WAM_MOD
USE UTIL_TYPE_SFL_WAVES_MOD
USE UTIL_TYPE_SFL_XTRP2_MOD
USE UTIL_TYPE_SURF_GEN_MOD
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TSURF), INTENT (IN), TARGET :: YD
LOGICAL :: LSD_DI, LSD_OC, LSD_PF, LSD_SFL, LSD_SFO, LSD_SM, LSD_V2, LSD_V3, LSD_VA, LSD_VC
LOGICAL :: LSD_VD, LSD_VF, LSD_VH, LSD_VK, LSD_VN, LSD_VP, LSD_VV, LSD_VX, LSD_WS, LSD_WW
LOGICAL :: LSD_X2, LSD_XA, LSD_XP, LSD_XP2, LSD_XR, LSP_CI, LSP_CL, LSP_EP, LSP_OM, LSP_RR
LOGICAL :: LSP_SB, LSP_SG, LSP_SL, LSP_X2, LSTORE_ARRAY
WRITE (KLUN) YD%NSURF
WRITE (KLUN) YD%NSURFL
WRITE (KLUN) YD%NDIMSURF
WRITE (KLUN) YD%NDIMSURFL
WRITE (KLUN) YD%NPROGSURF
WRITE (KLUN) YD%NPROGSURFL
LSTORE_ARRAY = ALLOCATED (YD%STORE_ARRAY)
WRITE (KLUN) LSTORE_ARRAY
IF (LSTORE_ARRAY) THEN
  WRITE (KLUN) LBOUND (YD%STORE_ARRAY)
  WRITE (KLUN) UBOUND (YD%STORE_ARRAY)
  WRITE (KLUN) YD%STORE_ARRAY
ENDIF
CALL SAVE_TYPE_SFL_COMM (KLUN, YD%YDUPD)
LSP_SB = ALLOCATED (YD%SP_SB)
WRITE (KLUN) LSP_SB
IF (LSP_SB) THEN
  WRITE (KLUN) LBOUND (YD%SP_SB)
  WRITE (KLUN) UBOUND (YD%SP_SB)
  WRITE (KLUN) YD%SP_SB
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSP_SBD)
CALL SAVE_TYPE_SFL_SOILB (KLUN, YD%YSP_SB)
LSP_SG = ALLOCATED (YD%SP_SG)
WRITE (KLUN) LSP_SG
IF (LSP_SG) THEN
  WRITE (KLUN) LBOUND (YD%SP_SG)
  WRITE (KLUN) UBOUND (YD%SP_SG)
  WRITE (KLUN) YD%SP_SG
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSP_SGD)
CALL SAVE_TYPE_SFL_SNOWG (KLUN, YD%YSP_SG)
LSP_SL = ALLOCATED (YD%SP_SL)
WRITE (KLUN) LSP_SL
IF (LSP_SL) THEN
  WRITE (KLUN) LBOUND (YD%SP_SL)
  WRITE (KLUN) UBOUND (YD%SP_SL)
  WRITE (KLUN) YD%SP_SL
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSP_SLD)
CALL SAVE_TYPE_SFL_LAKEB (KLUN, YD%YSP_SL)
LSP_RR = ALLOCATED (YD%SP_RR)
WRITE (KLUN) LSP_RR
IF (LSP_RR) THEN
  WRITE (KLUN) LBOUND (YD%SP_RR)
  WRITE (KLUN) UBOUND (YD%SP_RR)
  WRITE (KLUN) YD%SP_RR
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSP_RRD)
CALL SAVE_TYPE_SFL_RESVR (KLUN, YD%YSP_RR)
LSP_CL = ALLOCATED (YD%SP_CL)
WRITE (KLUN) LSP_CL
IF (LSP_CL) THEN
  WRITE (KLUN) LBOUND (YD%SP_CL)
  WRITE (KLUN) UBOUND (YD%SP_CL)
  WRITE (KLUN) YD%SP_CL
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSP_CLD)
CALL SAVE_TYPE_SFL_CLS (KLUN, YD%YSP_CL)
LSP_OM = ALLOCATED (YD%SP_OM)
WRITE (KLUN) LSP_OM
IF (LSP_OM) THEN
  WRITE (KLUN) LBOUND (YD%SP_OM)
  WRITE (KLUN) UBOUND (YD%SP_OM)
  WRITE (KLUN) YD%SP_OM
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSP_OMD)
CALL SAVE_TYPE_SFL_OML (KLUN, YD%YSP_OM)
LSP_EP = ALLOCATED (YD%SP_EP)
WRITE (KLUN) LSP_EP
IF (LSP_EP) THEN
  WRITE (KLUN) LBOUND (YD%SP_EP)
  WRITE (KLUN) UBOUND (YD%SP_EP)
  WRITE (KLUN) YD%SP_EP
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSP_EPD)
CALL SAVE_TYPE_SFL_EXTRP (KLUN, YD%YSP_EP)
LSP_X2 = ALLOCATED (YD%SP_X2)
WRITE (KLUN) LSP_X2
IF (LSP_X2) THEN
  WRITE (KLUN) LBOUND (YD%SP_X2)
  WRITE (KLUN) UBOUND (YD%SP_X2)
  WRITE (KLUN) YD%SP_X2
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSP_X2D)
CALL SAVE_TYPE_SFL_XTRP2 (KLUN, YD%YSP_X2)
LSP_CI = ALLOCATED (YD%SP_CI)
WRITE (KLUN) LSP_CI
IF (LSP_CI) THEN
  WRITE (KLUN) LBOUND (YD%SP_CI)
  WRITE (KLUN) UBOUND (YD%SP_CI)
  WRITE (KLUN) YD%SP_CI
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSP_CID)
CALL SAVE_TYPE_SFL_CANRI (KLUN, YD%YSP_CI)
LSD_XP = ALLOCATED (YD%SD_XP)
WRITE (KLUN) LSD_XP
IF (LSD_XP) THEN
  WRITE (KLUN) LBOUND (YD%SD_XP)
  WRITE (KLUN) UBOUND (YD%SD_XP)
  WRITE (KLUN) YD%SD_XP
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_XPD)
CALL SAVE_TYPE_SFL_VPRECIP (KLUN, YD%YSD_XP)
LSD_XP2 = ALLOCATED (YD%SD_XP2)
WRITE (KLUN) LSD_XP2
IF (LSD_XP2) THEN
  WRITE (KLUN) LBOUND (YD%SD_XP2)
  WRITE (KLUN) UBOUND (YD%SD_XP2)
  WRITE (KLUN) YD%SD_XP2
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_XP2D)
CALL SAVE_TYPE_SFL_VPRECIP2 (KLUN, YD%YSD_XP2)
LSD_VF = ALLOCATED (YD%SD_VF)
WRITE (KLUN) LSD_VF
IF (LSD_VF) THEN
  WRITE (KLUN) LBOUND (YD%SD_VF)
  WRITE (KLUN) UBOUND (YD%SD_VF)
  WRITE (KLUN) YD%SD_VF
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VFD)
CALL SAVE_TYPE_SFL_VARSF (KLUN, YD%YSD_VF)
LSD_VP = ALLOCATED (YD%SD_VP)
WRITE (KLUN) LSD_VP
IF (LSD_VP) THEN
  WRITE (KLUN) LBOUND (YD%SD_VP)
  WRITE (KLUN) UBOUND (YD%SD_VP)
  WRITE (KLUN) YD%SD_VP
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VPD)
CALL SAVE_TYPE_SFL_VCLIP (KLUN, YD%YSD_VP)
LSD_VV = ALLOCATED (YD%SD_VV)
WRITE (KLUN) LSD_VV
IF (LSD_VV) THEN
  WRITE (KLUN) LBOUND (YD%SD_VV)
  WRITE (KLUN) UBOUND (YD%SD_VV)
  WRITE (KLUN) YD%SD_VV
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VVD)
CALL SAVE_TYPE_SFL_VCLIV (KLUN, YD%YSD_VV)
LSD_VN = ALLOCATED (YD%SD_VN)
WRITE (KLUN) LSD_VN
IF (LSD_VN) THEN
  WRITE (KLUN) LBOUND (YD%SD_VN)
  WRITE (KLUN) UBOUND (YD%SD_VN)
  WRITE (KLUN) YD%SD_VN
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VND)
CALL SAVE_TYPE_SFL_VCLIN (KLUN, YD%YSD_VN)
LSD_VH = ALLOCATED (YD%SD_VH)
WRITE (KLUN) LSD_VH
IF (LSD_VH) THEN
  WRITE (KLUN) LBOUND (YD%SD_VH)
  WRITE (KLUN) UBOUND (YD%SD_VH)
  WRITE (KLUN) YD%SD_VH
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VHD)
CALL SAVE_TYPE_SFL_VCLIH (KLUN, YD%YSD_VH)
LSD_VK = ALLOCATED (YD%SD_VK)
WRITE (KLUN) LSD_VK
IF (LSD_VK) THEN
  WRITE (KLUN) LBOUND (YD%SD_VK)
  WRITE (KLUN) UBOUND (YD%SD_VK)
  WRITE (KLUN) YD%SD_VK
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VKD)
CALL SAVE_TYPE_SFL_VCLIK (KLUN, YD%YSD_VK)
LSD_VA = ALLOCATED (YD%SD_VA)
WRITE (KLUN) LSD_VA
IF (LSD_VA) THEN
  WRITE (KLUN) LBOUND (YD%SD_VA)
  WRITE (KLUN) UBOUND (YD%SD_VA)
  WRITE (KLUN) YD%SD_VA
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VAD)
CALL SAVE_TYPE_SFL_VCLIA (KLUN, YD%YSD_VA)
LSD_VC = ALLOCATED (YD%SD_VC)
WRITE (KLUN) LSD_VC
IF (LSD_VC) THEN
  WRITE (KLUN) LBOUND (YD%SD_VC)
  WRITE (KLUN) UBOUND (YD%SD_VC)
  WRITE (KLUN) YD%SD_VC
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VCD)
CALL SAVE_TYPE_SFL_VO3ABC (KLUN, YD%YSD_VC)
LSD_V2 = ALLOCATED (YD%SD_V2)
WRITE (KLUN) LSD_V2
IF (LSD_V2) THEN
  WRITE (KLUN) LBOUND (YD%SD_V2)
  WRITE (KLUN) UBOUND (YD%SD_V2)
  WRITE (KLUN) YD%SD_V2
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_V2D)
CALL SAVE_TYPE_SFL_VDIAGO2 (KLUN, YD%YSD_V2)
LSD_V3 = ALLOCATED (YD%SD_V3)
WRITE (KLUN) LSD_V3
IF (LSD_V3) THEN
  WRITE (KLUN) LBOUND (YD%SD_V3)
  WRITE (KLUN) UBOUND (YD%SD_V3)
  WRITE (KLUN) YD%SD_V3
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_V3D)
CALL SAVE_TYPE_SFL_VDIAGO3 (KLUN, YD%YSD_V3)
LSD_VD = ALLOCATED (YD%SD_VD)
WRITE (KLUN) LSD_VD
IF (LSD_VD) THEN
  WRITE (KLUN) LBOUND (YD%SD_VD)
  WRITE (KLUN) UBOUND (YD%SD_VD)
  WRITE (KLUN) YD%SD_VD
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VDD)
CALL SAVE_TYPE_SFL_VDIAG (KLUN, YD%YSD_VD)
LSD_SM = ALLOCATED (YD%SD_SM)
WRITE (KLUN) LSD_SM
IF (LSD_SM) THEN
  WRITE (KLUN) LBOUND (YD%SD_SM)
  WRITE (KLUN) UBOUND (YD%SD_SM)
  WRITE (KLUN) YD%SD_SM
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_SMD)
CALL SAVE_TYPE_SFL_SATSIM (KLUN, YD%YSD_SM)
LSD_WS = ALLOCATED (YD%SD_WS)
WRITE (KLUN) LSD_WS
IF (LSD_WS) THEN
  WRITE (KLUN) LBOUND (YD%SD_WS)
  WRITE (KLUN) UBOUND (YD%SD_WS)
  WRITE (KLUN) YD%SD_WS
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_WSD)
CALL SAVE_TYPE_SFL_WAVES (KLUN, YD%YSD_WS)
LSD_WW = ALLOCATED (YD%SD_WW)
WRITE (KLUN) LSD_WW
IF (LSD_WW) THEN
  WRITE (KLUN) LBOUND (YD%SD_WW)
  WRITE (KLUN) UBOUND (YD%SD_WW)
  WRITE (KLUN) YD%SD_WW
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_WWD)
CALL SAVE_TYPE_SFL_WAM (KLUN, YD%YSD_WW)
LSD_VX = ALLOCATED (YD%SD_VX)
WRITE (KLUN) LSD_VX
IF (LSD_VX) THEN
  WRITE (KLUN) LBOUND (YD%SD_VX)
  WRITE (KLUN) UBOUND (YD%SD_VX)
  WRITE (KLUN) YD%SD_VX
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_VXD)
CALL SAVE_TYPE_SFL_VCLIX (KLUN, YD%YSD_VX)
LSD_XA = ALLOCATED (YD%SD_XA)
WRITE (KLUN) LSD_XA
IF (LSD_XA) THEN
  WRITE (KLUN) LBOUND (YD%SD_XA)
  WRITE (KLUN) UBOUND (YD%SD_XA)
  WRITE (KLUN) YD%SD_XA
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_XAD)
CALL SAVE_TYPE_SFL_VEXTRA (KLUN, YD%YSD_XA)
LSD_DI = ALLOCATED (YD%SD_DI)
WRITE (KLUN) LSD_DI
IF (LSD_DI) THEN
  WRITE (KLUN) LBOUND (YD%SD_DI)
  WRITE (KLUN) UBOUND (YD%SD_DI)
  WRITE (KLUN) YD%SD_DI
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_DID)
CALL SAVE_TYPE_SFL_VEXTRDI (KLUN, YD%YSD_DI)
LSD_XR = ALLOCATED (YD%SD_XR)
WRITE (KLUN) LSD_XR
IF (LSD_XR) THEN
  WRITE (KLUN) LBOUND (YD%SD_XR)
  WRITE (KLUN) UBOUND (YD%SD_XR)
  WRITE (KLUN) YD%SD_XR
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_XRD)
CALL SAVE_TYPE_SFL_VEXTRA (KLUN, YD%YSD_XR)
LSD_X2 = ALLOCATED (YD%SD_X2)
WRITE (KLUN) LSD_X2
IF (LSD_X2) THEN
  WRITE (KLUN) LBOUND (YD%SD_X2)
  WRITE (KLUN) UBOUND (YD%SD_X2)
  WRITE (KLUN) YD%SD_X2
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_X2D)
CALL SAVE_TYPE_SFL_VEXTR2 (KLUN, YD%YSD_X2)
LSD_SFL = ALLOCATED (YD%SD_SFL)
WRITE (KLUN) LSD_SFL
IF (LSD_SFL) THEN
  WRITE (KLUN) LBOUND (YD%SD_SFL)
  WRITE (KLUN) UBOUND (YD%SD_SFL)
  WRITE (KLUN) YD%SD_SFL
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_SFLD)
CALL SAVE_TYPE_SFL_SFLUX (KLUN, YD%YSD_SFL)
LSD_SFO = ALLOCATED (YD%SD_SFO)
WRITE (KLUN) LSD_SFO
IF (LSD_SFO) THEN
  WRITE (KLUN) LBOUND (YD%SD_SFO)
  WRITE (KLUN) UBOUND (YD%SD_SFO)
  WRITE (KLUN) YD%SD_SFO
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_SFOD)
CALL SAVE_TYPE_SFL_SFORC (KLUN, YD%YSD_SFO)
LSD_PF = ALLOCATED (YD%SD_PF)
WRITE (KLUN) LSD_PF
IF (LSD_PF) THEN
  WRITE (KLUN) LBOUND (YD%SD_PF)
  WRITE (KLUN) UBOUND (YD%SD_PF)
  WRITE (KLUN) YD%SD_PF
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_PFD)
CALL SAVE_TYPE_SFL_VEXTRA (KLUN, YD%YSD_PF)
LSD_OC = ALLOCATED (YD%SD_OC)
WRITE (KLUN) LSD_OC
IF (LSD_OC) THEN
  WRITE (KLUN) LBOUND (YD%SD_OC)
  WRITE (KLUN) UBOUND (YD%SD_OC)
  WRITE (KLUN) YD%SD_OC
ENDIF
CALL SAVE_TYPE_SURF_GEN (KLUN, YD%YSD_OCD)
CALL SAVE_TYPE_SFL_OCE (KLUN, YD%YSD_OC)
WRITE (KLUN) YD%NGP5_OOPS
WRITE (KLUN) YD%NTRAJ_CST_OOPS
END SUBROUTINE

SUBROUTINE LOAD_TSURF (KLUN, YD)
USE UTIL_TYPE_SFL_CANRI_MOD
USE UTIL_TYPE_SFL_CLS_MOD
USE UTIL_TYPE_SFL_COMM_MOD
USE UTIL_TYPE_SFL_EXTRP_MOD
USE UTIL_TYPE_SFL_LAKEB_MOD
USE UTIL_TYPE_SFL_OCE_MOD
USE UTIL_TYPE_SFL_OML_MOD
USE UTIL_TYPE_SFL_RESVR_MOD
USE UTIL_TYPE_SFL_SATSIM_MOD
USE UTIL_TYPE_SFL_SFLUX_MOD
USE UTIL_TYPE_SFL_SFORC_MOD
USE UTIL_TYPE_SFL_SNOWG_MOD
USE UTIL_TYPE_SFL_SOILB_MOD
USE UTIL_TYPE_SFL_VARSF_MOD
USE UTIL_TYPE_SFL_VCLIA_MOD
USE UTIL_TYPE_SFL_VCLIH_MOD
USE UTIL_TYPE_SFL_VCLIK_MOD
USE UTIL_TYPE_SFL_VCLIN_MOD
USE UTIL_TYPE_SFL_VCLIP_MOD
USE UTIL_TYPE_SFL_VCLIV_MOD
USE UTIL_TYPE_SFL_VCLIX_MOD
USE UTIL_TYPE_SFL_VDIAGO2_MOD
USE UTIL_TYPE_SFL_VDIAGO3_MOD
USE UTIL_TYPE_SFL_VDIAG_MOD
USE UTIL_TYPE_SFL_VEXTR2_MOD
USE UTIL_TYPE_SFL_VEXTRA_MOD
USE UTIL_TYPE_SFL_VEXTRDI_MOD
USE UTIL_TYPE_SFL_VO3ABC_MOD
USE UTIL_TYPE_SFL_VPRECIP2_MOD
USE UTIL_TYPE_SFL_VPRECIP_MOD
USE UTIL_TYPE_SFL_WAM_MOD
USE UTIL_TYPE_SFL_WAVES_MOD
USE UTIL_TYPE_SFL_XTRP2_MOD
USE UTIL_TYPE_SURF_GEN_MOD
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TSURF), INTENT (OUT), TARGET :: YD
INTEGER :: IL3(3), IU3(3), IL4(4), IU4(4)
LOGICAL :: LSD_DI, LSD_OC, LSD_PF, LSD_SFL, LSD_SFO, LSD_SM, LSD_V2, LSD_V3, LSD_VA, LSD_VC
LOGICAL :: LSD_VD, LSD_VF, LSD_VH, LSD_VK, LSD_VN, LSD_VP, LSD_VV, LSD_VX, LSD_WS, LSD_WW
LOGICAL :: LSD_X2, LSD_XA, LSD_XP, LSD_XP2, LSD_XR, LSP_CI, LSP_CL, LSP_EP, LSP_OM, LSP_RR
LOGICAL :: LSP_SB, LSP_SG, LSP_SL, LSP_X2, LSTORE_ARRAY
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP4 (:,:,:,:)
READ (KLUN) YD%NSURF
READ (KLUN) YD%NSURFL
READ (KLUN) YD%NDIMSURF
READ (KLUN) YD%NDIMSURFL
READ (KLUN) YD%NPROGSURF
READ (KLUN) YD%NPROGSURFL
READ (KLUN) LSTORE_ARRAY
IF (LSTORE_ARRAY) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%STORE_ARRAY (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%STORE_ARRAY,1):UBOUND(YD%STORE_ARRAY,1), LBOUND(YD%STORE_ARRAY,2):UBOUND(YD%STORE_ARRAY,2), LBOUND(YD%STORE_ARRAY,3):UBOUND(YD%STORE_ARRAY,3)))
  READ (KLUN) ZTMP3
  YD%STORE_ARRAY = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SFL_COMM (KLUN, YD%YDUPD)
READ (KLUN) LSP_SB
IF (LSP_SB) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SP_SB (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SP_SB,1):UBOUND(YD%SP_SB,1), LBOUND(YD%SP_SB,2):UBOUND(YD%SP_SB,2), LBOUND(YD%SP_SB,3):UBOUND(YD%SP_SB,3), LBOUND(YD%SP_SB,4):UBOUND(YD%SP_SB,4)))
  READ (KLUN) ZTMP4
  YD%SP_SB = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSP_SBD)
CALL LOAD_TYPE_SFL_SOILB (KLUN, YD%YSP_SB)
READ (KLUN) LSP_SG
IF (LSP_SG) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SP_SG (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SP_SG,1):UBOUND(YD%SP_SG,1), LBOUND(YD%SP_SG,2):UBOUND(YD%SP_SG,2), LBOUND(YD%SP_SG,3):UBOUND(YD%SP_SG,3), LBOUND(YD%SP_SG,4):UBOUND(YD%SP_SG,4)))
  READ (KLUN) ZTMP4
  YD%SP_SG = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSP_SGD)
CALL LOAD_TYPE_SFL_SNOWG (KLUN, YD%YSP_SG)
READ (KLUN) LSP_SL
IF (LSP_SL) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SP_SL (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SP_SL,1):UBOUND(YD%SP_SL,1), LBOUND(YD%SP_SL,2):UBOUND(YD%SP_SL,2), LBOUND(YD%SP_SL,3):UBOUND(YD%SP_SL,3)))
  READ (KLUN) ZTMP3
  YD%SP_SL = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSP_SLD)
CALL LOAD_TYPE_SFL_LAKEB (KLUN, YD%YSP_SL)
READ (KLUN) LSP_RR
IF (LSP_RR) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SP_RR (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SP_RR,1):UBOUND(YD%SP_RR,1), LBOUND(YD%SP_RR,2):UBOUND(YD%SP_RR,2), LBOUND(YD%SP_RR,3):UBOUND(YD%SP_RR,3)))
  READ (KLUN) ZTMP3
  YD%SP_RR = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSP_RRD)
CALL LOAD_TYPE_SFL_RESVR (KLUN, YD%YSP_RR)
READ (KLUN) LSP_CL
IF (LSP_CL) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SP_CL (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SP_CL,1):UBOUND(YD%SP_CL,1), LBOUND(YD%SP_CL,2):UBOUND(YD%SP_CL,2), LBOUND(YD%SP_CL,3):UBOUND(YD%SP_CL,3)))
  READ (KLUN) ZTMP3
  YD%SP_CL = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSP_CLD)
CALL LOAD_TYPE_SFL_CLS (KLUN, YD%YSP_CL)
READ (KLUN) LSP_OM
IF (LSP_OM) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SP_OM (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SP_OM,1):UBOUND(YD%SP_OM,1), LBOUND(YD%SP_OM,2):UBOUND(YD%SP_OM,2), LBOUND(YD%SP_OM,3):UBOUND(YD%SP_OM,3), LBOUND(YD%SP_OM,4):UBOUND(YD%SP_OM,4)))
  READ (KLUN) ZTMP4
  YD%SP_OM = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSP_OMD)
CALL LOAD_TYPE_SFL_OML (KLUN, YD%YSP_OM)
READ (KLUN) LSP_EP
IF (LSP_EP) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SP_EP (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SP_EP,1):UBOUND(YD%SP_EP,1), LBOUND(YD%SP_EP,2):UBOUND(YD%SP_EP,2), LBOUND(YD%SP_EP,3):UBOUND(YD%SP_EP,3), LBOUND(YD%SP_EP,4):UBOUND(YD%SP_EP,4)))
  READ (KLUN) ZTMP4
  YD%SP_EP = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSP_EPD)
CALL LOAD_TYPE_SFL_EXTRP (KLUN, YD%YSP_EP)
READ (KLUN) LSP_X2
IF (LSP_X2) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SP_X2 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SP_X2,1):UBOUND(YD%SP_X2,1), LBOUND(YD%SP_X2,2):UBOUND(YD%SP_X2,2), LBOUND(YD%SP_X2,3):UBOUND(YD%SP_X2,3)))
  READ (KLUN) ZTMP3
  YD%SP_X2 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSP_X2D)
CALL LOAD_TYPE_SFL_XTRP2 (KLUN, YD%YSP_X2)
READ (KLUN) LSP_CI
IF (LSP_CI) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SP_CI (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SP_CI,1):UBOUND(YD%SP_CI,1), LBOUND(YD%SP_CI,2):UBOUND(YD%SP_CI,2), LBOUND(YD%SP_CI,3):UBOUND(YD%SP_CI,3)))
  READ (KLUN) ZTMP3
  YD%SP_CI = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSP_CID)
CALL LOAD_TYPE_SFL_CANRI (KLUN, YD%YSP_CI)
READ (KLUN) LSD_XP
IF (LSD_XP) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SD_XP (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SD_XP,1):UBOUND(YD%SD_XP,1), LBOUND(YD%SD_XP,2):UBOUND(YD%SD_XP,2), LBOUND(YD%SD_XP,3):UBOUND(YD%SD_XP,3), LBOUND(YD%SD_XP,4):UBOUND(YD%SD_XP,4)))
  READ (KLUN) ZTMP4
  YD%SD_XP = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_XPD)
CALL LOAD_TYPE_SFL_VPRECIP (KLUN, YD%YSD_XP)
READ (KLUN) LSD_XP2
IF (LSD_XP2) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SD_XP2 (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SD_XP2,1):UBOUND(YD%SD_XP2,1), LBOUND(YD%SD_XP2,2):UBOUND(YD%SD_XP2,2), LBOUND(YD%SD_XP2,3):UBOUND(YD%SD_XP2,3), LBOUND(YD%SD_XP2,4):UBOUND(YD%SD_XP2,4)))
  READ (KLUN) ZTMP4
  YD%SD_XP2 = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_XP2D)
CALL LOAD_TYPE_SFL_VPRECIP2 (KLUN, YD%YSD_XP2)
READ (KLUN) LSD_VF
IF (LSD_VF) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VF (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VF,1):UBOUND(YD%SD_VF,1), LBOUND(YD%SD_VF,2):UBOUND(YD%SD_VF,2), LBOUND(YD%SD_VF,3):UBOUND(YD%SD_VF,3)))
  READ (KLUN) ZTMP3
  YD%SD_VF = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VFD)
CALL LOAD_TYPE_SFL_VARSF (KLUN, YD%YSD_VF)
READ (KLUN) LSD_VP
IF (LSD_VP) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VP (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VP,1):UBOUND(YD%SD_VP,1), LBOUND(YD%SD_VP,2):UBOUND(YD%SD_VP,2), LBOUND(YD%SD_VP,3):UBOUND(YD%SD_VP,3)))
  READ (KLUN) ZTMP3
  YD%SD_VP = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VPD)
CALL LOAD_TYPE_SFL_VCLIP (KLUN, YD%YSD_VP)
READ (KLUN) LSD_VV
IF (LSD_VV) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VV (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VV,1):UBOUND(YD%SD_VV,1), LBOUND(YD%SD_VV,2):UBOUND(YD%SD_VV,2), LBOUND(YD%SD_VV,3):UBOUND(YD%SD_VV,3)))
  READ (KLUN) ZTMP3
  YD%SD_VV = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VVD)
CALL LOAD_TYPE_SFL_VCLIV (KLUN, YD%YSD_VV)
READ (KLUN) LSD_VN
IF (LSD_VN) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VN (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VN,1):UBOUND(YD%SD_VN,1), LBOUND(YD%SD_VN,2):UBOUND(YD%SD_VN,2), LBOUND(YD%SD_VN,3):UBOUND(YD%SD_VN,3)))
  READ (KLUN) ZTMP3
  YD%SD_VN = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VND)
CALL LOAD_TYPE_SFL_VCLIN (KLUN, YD%YSD_VN)
READ (KLUN) LSD_VH
IF (LSD_VH) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VH (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VH,1):UBOUND(YD%SD_VH,1), LBOUND(YD%SD_VH,2):UBOUND(YD%SD_VH,2), LBOUND(YD%SD_VH,3):UBOUND(YD%SD_VH,3)))
  READ (KLUN) ZTMP3
  YD%SD_VH = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VHD)
CALL LOAD_TYPE_SFL_VCLIH (KLUN, YD%YSD_VH)
READ (KLUN) LSD_VK
IF (LSD_VK) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VK (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VK,1):UBOUND(YD%SD_VK,1), LBOUND(YD%SD_VK,2):UBOUND(YD%SD_VK,2), LBOUND(YD%SD_VK,3):UBOUND(YD%SD_VK,3)))
  READ (KLUN) ZTMP3
  YD%SD_VK = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VKD)
CALL LOAD_TYPE_SFL_VCLIK (KLUN, YD%YSD_VK)
READ (KLUN) LSD_VA
IF (LSD_VA) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VA (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VA,1):UBOUND(YD%SD_VA,1), LBOUND(YD%SD_VA,2):UBOUND(YD%SD_VA,2), LBOUND(YD%SD_VA,3):UBOUND(YD%SD_VA,3)))
  READ (KLUN) ZTMP3
  YD%SD_VA = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VAD)
CALL LOAD_TYPE_SFL_VCLIA (KLUN, YD%YSD_VA)
READ (KLUN) LSD_VC
IF (LSD_VC) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VC (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VC,1):UBOUND(YD%SD_VC,1), LBOUND(YD%SD_VC,2):UBOUND(YD%SD_VC,2), LBOUND(YD%SD_VC,3):UBOUND(YD%SD_VC,3)))
  READ (KLUN) ZTMP3
  YD%SD_VC = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VCD)
CALL LOAD_TYPE_SFL_VO3ABC (KLUN, YD%YSD_VC)
READ (KLUN) LSD_V2
IF (LSD_V2) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_V2 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_V2,1):UBOUND(YD%SD_V2,1), LBOUND(YD%SD_V2,2):UBOUND(YD%SD_V2,2), LBOUND(YD%SD_V2,3):UBOUND(YD%SD_V2,3)))
  READ (KLUN) ZTMP3
  YD%SD_V2 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_V2D)
CALL LOAD_TYPE_SFL_VDIAGO2 (KLUN, YD%YSD_V2)
READ (KLUN) LSD_V3
IF (LSD_V3) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SD_V3 (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SD_V3,1):UBOUND(YD%SD_V3,1), LBOUND(YD%SD_V3,2):UBOUND(YD%SD_V3,2), LBOUND(YD%SD_V3,3):UBOUND(YD%SD_V3,3), LBOUND(YD%SD_V3,4):UBOUND(YD%SD_V3,4)))
  READ (KLUN) ZTMP4
  YD%SD_V3 = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_V3D)
CALL LOAD_TYPE_SFL_VDIAGO3 (KLUN, YD%YSD_V3)
READ (KLUN) LSD_VD
IF (LSD_VD) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VD (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VD,1):UBOUND(YD%SD_VD,1), LBOUND(YD%SD_VD,2):UBOUND(YD%SD_VD,2), LBOUND(YD%SD_VD,3):UBOUND(YD%SD_VD,3)))
  READ (KLUN) ZTMP3
  YD%SD_VD = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VDD)
CALL LOAD_TYPE_SFL_VDIAG (KLUN, YD%YSD_VD)
READ (KLUN) LSD_SM
IF (LSD_SM) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SD_SM (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SD_SM,1):UBOUND(YD%SD_SM,1), LBOUND(YD%SD_SM,2):UBOUND(YD%SD_SM,2), LBOUND(YD%SD_SM,3):UBOUND(YD%SD_SM,3), LBOUND(YD%SD_SM,4):UBOUND(YD%SD_SM,4)))
  READ (KLUN) ZTMP4
  YD%SD_SM = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_SMD)
CALL LOAD_TYPE_SFL_SATSIM (KLUN, YD%YSD_SM)
READ (KLUN) LSD_WS
IF (LSD_WS) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_WS (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_WS,1):UBOUND(YD%SD_WS,1), LBOUND(YD%SD_WS,2):UBOUND(YD%SD_WS,2), LBOUND(YD%SD_WS,3):UBOUND(YD%SD_WS,3)))
  READ (KLUN) ZTMP3
  YD%SD_WS = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_WSD)
CALL LOAD_TYPE_SFL_WAVES (KLUN, YD%YSD_WS)
READ (KLUN) LSD_WW
IF (LSD_WW) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_WW (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_WW,1):UBOUND(YD%SD_WW,1), LBOUND(YD%SD_WW,2):UBOUND(YD%SD_WW,2), LBOUND(YD%SD_WW,3):UBOUND(YD%SD_WW,3)))
  READ (KLUN) ZTMP3
  YD%SD_WW = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_WWD)
CALL LOAD_TYPE_SFL_WAM (KLUN, YD%YSD_WW)
READ (KLUN) LSD_VX
IF (LSD_VX) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_VX (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_VX,1):UBOUND(YD%SD_VX,1), LBOUND(YD%SD_VX,2):UBOUND(YD%SD_VX,2), LBOUND(YD%SD_VX,3):UBOUND(YD%SD_VX,3)))
  READ (KLUN) ZTMP3
  YD%SD_VX = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_VXD)
CALL LOAD_TYPE_SFL_VCLIX (KLUN, YD%YSD_VX)
READ (KLUN) LSD_XA
IF (LSD_XA) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SD_XA (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SD_XA,1):UBOUND(YD%SD_XA,1), LBOUND(YD%SD_XA,2):UBOUND(YD%SD_XA,2), LBOUND(YD%SD_XA,3):UBOUND(YD%SD_XA,3), LBOUND(YD%SD_XA,4):UBOUND(YD%SD_XA,4)))
  READ (KLUN) ZTMP4
  YD%SD_XA = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_XAD)
CALL LOAD_TYPE_SFL_VEXTRA (KLUN, YD%YSD_XA)
READ (KLUN) LSD_DI
IF (LSD_DI) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SD_DI (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SD_DI,1):UBOUND(YD%SD_DI,1), LBOUND(YD%SD_DI,2):UBOUND(YD%SD_DI,2), LBOUND(YD%SD_DI,3):UBOUND(YD%SD_DI,3), LBOUND(YD%SD_DI,4):UBOUND(YD%SD_DI,4)))
  READ (KLUN) ZTMP4
  YD%SD_DI = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_DID)
CALL LOAD_TYPE_SFL_VEXTRDI (KLUN, YD%YSD_DI)
READ (KLUN) LSD_XR
IF (LSD_XR) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SD_XR (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SD_XR,1):UBOUND(YD%SD_XR,1), LBOUND(YD%SD_XR,2):UBOUND(YD%SD_XR,2), LBOUND(YD%SD_XR,3):UBOUND(YD%SD_XR,3), LBOUND(YD%SD_XR,4):UBOUND(YD%SD_XR,4)))
  READ (KLUN) ZTMP4
  YD%SD_XR = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_XRD)
CALL LOAD_TYPE_SFL_VEXTRA (KLUN, YD%YSD_XR)
READ (KLUN) LSD_X2
IF (LSD_X2) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_X2 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_X2,1):UBOUND(YD%SD_X2,1), LBOUND(YD%SD_X2,2):UBOUND(YD%SD_X2,2), LBOUND(YD%SD_X2,3):UBOUND(YD%SD_X2,3)))
  READ (KLUN) ZTMP3
  YD%SD_X2 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_X2D)
CALL LOAD_TYPE_SFL_VEXTR2 (KLUN, YD%YSD_X2)
READ (KLUN) LSD_SFL
IF (LSD_SFL) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_SFL (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_SFL,1):UBOUND(YD%SD_SFL,1), LBOUND(YD%SD_SFL,2):UBOUND(YD%SD_SFL,2), LBOUND(YD%SD_SFL,3):UBOUND(YD%SD_SFL,3)))
  READ (KLUN) ZTMP3
  YD%SD_SFL = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_SFLD)
CALL LOAD_TYPE_SFL_SFLUX (KLUN, YD%YSD_SFL)
READ (KLUN) LSD_SFO
IF (LSD_SFO) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_SFO (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_SFO,1):UBOUND(YD%SD_SFO,1), LBOUND(YD%SD_SFO,2):UBOUND(YD%SD_SFO,2), LBOUND(YD%SD_SFO,3):UBOUND(YD%SD_SFO,3)))
  READ (KLUN) ZTMP3
  YD%SD_SFO = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_SFOD)
CALL LOAD_TYPE_SFL_SFORC (KLUN, YD%YSD_SFO)
READ (KLUN) LSD_PF
IF (LSD_PF) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%SD_PF (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%SD_PF,1):UBOUND(YD%SD_PF,1), LBOUND(YD%SD_PF,2):UBOUND(YD%SD_PF,2), LBOUND(YD%SD_PF,3):UBOUND(YD%SD_PF,3), LBOUND(YD%SD_PF,4):UBOUND(YD%SD_PF,4)))
  READ (KLUN) ZTMP4
  YD%SD_PF = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_PFD)
CALL LOAD_TYPE_SFL_VEXTRA (KLUN, YD%YSD_PF)
READ (KLUN) LSD_OC
IF (LSD_OC) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%SD_OC (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%SD_OC,1):UBOUND(YD%SD_OC,1), LBOUND(YD%SD_OC,2):UBOUND(YD%SD_OC,2), LBOUND(YD%SD_OC,3):UBOUND(YD%SD_OC,3)))
  READ (KLUN) ZTMP3
  YD%SD_OC = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
CALL LOAD_TYPE_SURF_GEN (KLUN, YD%YSD_OCD)
CALL LOAD_TYPE_SFL_OCE (KLUN, YD%YSD_OC)
READ (KLUN) YD%NGP5_OOPS
READ (KLUN) YD%NTRAJ_CST_OOPS
END SUBROUTINE


SUBROUTINE COPY_TSURF (YD, LDCREATED, LDFIELDAPI)
USE UTIL_TYPE_SFL_CANRI_MOD
USE UTIL_TYPE_SFL_CLS_MOD
USE UTIL_TYPE_SFL_COMM_MOD
USE UTIL_TYPE_SFL_EXTRP_MOD
USE UTIL_TYPE_SFL_LAKEB_MOD
USE UTIL_TYPE_SFL_OCE_MOD
USE UTIL_TYPE_SFL_OML_MOD
USE UTIL_TYPE_SFL_RESVR_MOD
USE UTIL_TYPE_SFL_SATSIM_MOD
USE UTIL_TYPE_SFL_SFLUX_MOD
USE UTIL_TYPE_SFL_SFORC_MOD
USE UTIL_TYPE_SFL_SNOWG_MOD
USE UTIL_TYPE_SFL_SOILB_MOD
USE UTIL_TYPE_SFL_VARSF_MOD
USE UTIL_TYPE_SFL_VCLIA_MOD
USE UTIL_TYPE_SFL_VCLIH_MOD
USE UTIL_TYPE_SFL_VCLIK_MOD
USE UTIL_TYPE_SFL_VCLIN_MOD
USE UTIL_TYPE_SFL_VCLIP_MOD
USE UTIL_TYPE_SFL_VCLIV_MOD
USE UTIL_TYPE_SFL_VCLIX_MOD
USE UTIL_TYPE_SFL_VDIAGO2_MOD
USE UTIL_TYPE_SFL_VDIAGO3_MOD
USE UTIL_TYPE_SFL_VDIAG_MOD
USE UTIL_TYPE_SFL_VEXTR2_MOD
USE UTIL_TYPE_SFL_VEXTRA_MOD
USE UTIL_TYPE_SFL_VEXTRDI_MOD
USE UTIL_TYPE_SFL_VO3ABC_MOD
USE UTIL_TYPE_SFL_VPRECIP2_MOD
USE UTIL_TYPE_SFL_VPRECIP_MOD
USE UTIL_TYPE_SFL_WAM_MOD
USE UTIL_TYPE_SFL_WAVES_MOD
USE UTIL_TYPE_SFL_XTRP2_MOD
USE UTIL_TYPE_SURF_GEN_MOD
IMPLICIT NONE
TYPE (TSURF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LSD_DI, LSD_OC, LSD_PF, LSD_SFL, LSD_SFO, LSD_SM, LSD_V2, LSD_V3, LSD_VA, LSD_VC
LOGICAL :: LSD_VD, LSD_VF, LSD_VH, LSD_VK, LSD_VN, LSD_VP, LSD_VV, LSD_VX, LSD_WS, LSD_WW
LOGICAL :: LSD_X2, LSD_XA, LSD_XP, LSD_XP2, LSD_XR, LSP_CI, LSP_CL, LSP_EP, LSP_OM, LSP_RR
LOGICAL :: LSP_SB, LSP_SG, LSP_SL, LSP_X2, LSTORE_ARRAY

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF






LSTORE_ARRAY = ALLOCATED (YD%STORE_ARRAY)
IF (LSTORE_ARRAY) THEN
  !$ACC ENTER DATA CREATE (YD%STORE_ARRAY)
  !$ACC UPDATE DEVICE (YD%STORE_ARRAY)
  !$ACC ENTER DATA ATTACH (YD%STORE_ARRAY)
ENDIF

CALL COPY_TYPE_SFL_COMM (YD%YDUPD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_SB = ALLOCATED (YD%SP_SB)
IF (LSP_SB) THEN
  !$ACC ENTER DATA CREATE (YD%SP_SB)
  !$ACC UPDATE DEVICE (YD%SP_SB)
  !$ACC ENTER DATA ATTACH (YD%SP_SB)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSP_SBD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_SOILB (YD%YSP_SB, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_SG = ALLOCATED (YD%SP_SG)
IF (LSP_SG) THEN
  !$ACC ENTER DATA CREATE (YD%SP_SG)
  !$ACC UPDATE DEVICE (YD%SP_SG)
  !$ACC ENTER DATA ATTACH (YD%SP_SG)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSP_SGD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_SNOWG (YD%YSP_SG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_SL = ALLOCATED (YD%SP_SL)
IF (LSP_SL) THEN
  !$ACC ENTER DATA CREATE (YD%SP_SL)
  !$ACC UPDATE DEVICE (YD%SP_SL)
  !$ACC ENTER DATA ATTACH (YD%SP_SL)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSP_SLD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_LAKEB (YD%YSP_SL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_RR = ALLOCATED (YD%SP_RR)
IF (LSP_RR) THEN
  !$ACC ENTER DATA CREATE (YD%SP_RR)
  !$ACC UPDATE DEVICE (YD%SP_RR)
  !$ACC ENTER DATA ATTACH (YD%SP_RR)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSP_RRD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_RESVR (YD%YSP_RR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_CL = ALLOCATED (YD%SP_CL)
IF (LSP_CL) THEN
  !$ACC ENTER DATA CREATE (YD%SP_CL)
  !$ACC UPDATE DEVICE (YD%SP_CL)
  !$ACC ENTER DATA ATTACH (YD%SP_CL)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSP_CLD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_CLS (YD%YSP_CL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_OM = ALLOCATED (YD%SP_OM)
IF (LSP_OM) THEN
  !$ACC ENTER DATA CREATE (YD%SP_OM)
  !$ACC UPDATE DEVICE (YD%SP_OM)
  !$ACC ENTER DATA ATTACH (YD%SP_OM)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSP_OMD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_OML (YD%YSP_OM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_EP = ALLOCATED (YD%SP_EP)
IF (LSP_EP) THEN
  !$ACC ENTER DATA CREATE (YD%SP_EP)
  !$ACC UPDATE DEVICE (YD%SP_EP)
  !$ACC ENTER DATA ATTACH (YD%SP_EP)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSP_EPD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_EXTRP (YD%YSP_EP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_X2 = ALLOCATED (YD%SP_X2)
IF (LSP_X2) THEN
  !$ACC ENTER DATA CREATE (YD%SP_X2)
  !$ACC UPDATE DEVICE (YD%SP_X2)
  !$ACC ENTER DATA ATTACH (YD%SP_X2)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSP_X2D, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_XTRP2 (YD%YSP_X2, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_CI = ALLOCATED (YD%SP_CI)
IF (LSP_CI) THEN
  !$ACC ENTER DATA CREATE (YD%SP_CI)
  !$ACC UPDATE DEVICE (YD%SP_CI)
  !$ACC ENTER DATA ATTACH (YD%SP_CI)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSP_CID, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_CANRI (YD%YSP_CI, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_XP = ALLOCATED (YD%SD_XP)
IF (LSD_XP) THEN
  !$ACC ENTER DATA CREATE (YD%SD_XP)
  !$ACC UPDATE DEVICE (YD%SD_XP)
  !$ACC ENTER DATA ATTACH (YD%SD_XP)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_XPD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VPRECIP (YD%YSD_XP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_XP2 = ALLOCATED (YD%SD_XP2)
IF (LSD_XP2) THEN
  !$ACC ENTER DATA CREATE (YD%SD_XP2)
  !$ACC UPDATE DEVICE (YD%SD_XP2)
  !$ACC ENTER DATA ATTACH (YD%SD_XP2)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_XP2D, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VPRECIP2 (YD%YSD_XP2, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VF = ALLOCATED (YD%SD_VF)
IF (LSD_VF) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VF)
  !$ACC UPDATE DEVICE (YD%SD_VF)
  !$ACC ENTER DATA ATTACH (YD%SD_VF)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VFD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VARSF (YD%YSD_VF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VP = ALLOCATED (YD%SD_VP)
IF (LSD_VP) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VP)
  !$ACC UPDATE DEVICE (YD%SD_VP)
  !$ACC ENTER DATA ATTACH (YD%SD_VP)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VPD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VCLIP (YD%YSD_VP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VV = ALLOCATED (YD%SD_VV)
IF (LSD_VV) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VV)
  !$ACC UPDATE DEVICE (YD%SD_VV)
  !$ACC ENTER DATA ATTACH (YD%SD_VV)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VVD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VCLIV (YD%YSD_VV, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VN = ALLOCATED (YD%SD_VN)
IF (LSD_VN) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VN)
  !$ACC UPDATE DEVICE (YD%SD_VN)
  !$ACC ENTER DATA ATTACH (YD%SD_VN)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VND, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VCLIN (YD%YSD_VN, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VH = ALLOCATED (YD%SD_VH)
IF (LSD_VH) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VH)
  !$ACC UPDATE DEVICE (YD%SD_VH)
  !$ACC ENTER DATA ATTACH (YD%SD_VH)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VHD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VCLIH (YD%YSD_VH, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VK = ALLOCATED (YD%SD_VK)
IF (LSD_VK) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VK)
  !$ACC UPDATE DEVICE (YD%SD_VK)
  !$ACC ENTER DATA ATTACH (YD%SD_VK)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VKD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VCLIK (YD%YSD_VK, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VA = ALLOCATED (YD%SD_VA)
IF (LSD_VA) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VA)
  !$ACC UPDATE DEVICE (YD%SD_VA)
  !$ACC ENTER DATA ATTACH (YD%SD_VA)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VAD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VCLIA (YD%YSD_VA, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VC = ALLOCATED (YD%SD_VC)
IF (LSD_VC) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VC)
  !$ACC UPDATE DEVICE (YD%SD_VC)
  !$ACC ENTER DATA ATTACH (YD%SD_VC)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VCD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VO3ABC (YD%YSD_VC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_V2 = ALLOCATED (YD%SD_V2)
IF (LSD_V2) THEN
  !$ACC ENTER DATA CREATE (YD%SD_V2)
  !$ACC UPDATE DEVICE (YD%SD_V2)
  !$ACC ENTER DATA ATTACH (YD%SD_V2)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_V2D, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VDIAGO2 (YD%YSD_V2, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_V3 = ALLOCATED (YD%SD_V3)
IF (LSD_V3) THEN
  !$ACC ENTER DATA CREATE (YD%SD_V3)
  !$ACC UPDATE DEVICE (YD%SD_V3)
  !$ACC ENTER DATA ATTACH (YD%SD_V3)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_V3D, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VDIAGO3 (YD%YSD_V3, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VD = ALLOCATED (YD%SD_VD)
IF (LSD_VD) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VD)
  !$ACC UPDATE DEVICE (YD%SD_VD)
  !$ACC ENTER DATA ATTACH (YD%SD_VD)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VDD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VDIAG (YD%YSD_VD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_SM = ALLOCATED (YD%SD_SM)
IF (LSD_SM) THEN
  !$ACC ENTER DATA CREATE (YD%SD_SM)
  !$ACC UPDATE DEVICE (YD%SD_SM)
  !$ACC ENTER DATA ATTACH (YD%SD_SM)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_SMD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_SATSIM (YD%YSD_SM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_WS = ALLOCATED (YD%SD_WS)
IF (LSD_WS) THEN
  !$ACC ENTER DATA CREATE (YD%SD_WS)
  !$ACC UPDATE DEVICE (YD%SD_WS)
  !$ACC ENTER DATA ATTACH (YD%SD_WS)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_WSD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_WAVES (YD%YSD_WS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_WW = ALLOCATED (YD%SD_WW)
IF (LSD_WW) THEN
  !$ACC ENTER DATA CREATE (YD%SD_WW)
  !$ACC UPDATE DEVICE (YD%SD_WW)
  !$ACC ENTER DATA ATTACH (YD%SD_WW)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_WWD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_WAM (YD%YSD_WW, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VX = ALLOCATED (YD%SD_VX)
IF (LSD_VX) THEN
  !$ACC ENTER DATA CREATE (YD%SD_VX)
  !$ACC UPDATE DEVICE (YD%SD_VX)
  !$ACC ENTER DATA ATTACH (YD%SD_VX)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_VXD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VCLIX (YD%YSD_VX, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_XA = ALLOCATED (YD%SD_XA)
IF (LSD_XA) THEN
  !$ACC ENTER DATA CREATE (YD%SD_XA)
  !$ACC UPDATE DEVICE (YD%SD_XA)
  !$ACC ENTER DATA ATTACH (YD%SD_XA)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_XAD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VEXTRA (YD%YSD_XA, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_DI = ALLOCATED (YD%SD_DI)
IF (LSD_DI) THEN
  !$ACC ENTER DATA CREATE (YD%SD_DI)
  !$ACC UPDATE DEVICE (YD%SD_DI)
  !$ACC ENTER DATA ATTACH (YD%SD_DI)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_DID, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VEXTRDI (YD%YSD_DI, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_XR = ALLOCATED (YD%SD_XR)
IF (LSD_XR) THEN
  !$ACC ENTER DATA CREATE (YD%SD_XR)
  !$ACC UPDATE DEVICE (YD%SD_XR)
  !$ACC ENTER DATA ATTACH (YD%SD_XR)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_XRD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VEXTRA (YD%YSD_XR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_X2 = ALLOCATED (YD%SD_X2)
IF (LSD_X2) THEN
  !$ACC ENTER DATA CREATE (YD%SD_X2)
  !$ACC UPDATE DEVICE (YD%SD_X2)
  !$ACC ENTER DATA ATTACH (YD%SD_X2)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_X2D, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VEXTR2 (YD%YSD_X2, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_SFL = ALLOCATED (YD%SD_SFL)
IF (LSD_SFL) THEN
  !$ACC ENTER DATA CREATE (YD%SD_SFL)
  !$ACC UPDATE DEVICE (YD%SD_SFL)
  !$ACC ENTER DATA ATTACH (YD%SD_SFL)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_SFLD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_SFLUX (YD%YSD_SFL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_SFO = ALLOCATED (YD%SD_SFO)
IF (LSD_SFO) THEN
  !$ACC ENTER DATA CREATE (YD%SD_SFO)
  !$ACC UPDATE DEVICE (YD%SD_SFO)
  !$ACC ENTER DATA ATTACH (YD%SD_SFO)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_SFOD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_SFORC (YD%YSD_SFO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_PF = ALLOCATED (YD%SD_PF)
IF (LSD_PF) THEN
  !$ACC ENTER DATA CREATE (YD%SD_PF)
  !$ACC UPDATE DEVICE (YD%SD_PF)
  !$ACC ENTER DATA ATTACH (YD%SD_PF)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_PFD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_VEXTRA (YD%YSD_PF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_OC = ALLOCATED (YD%SD_OC)
IF (LSD_OC) THEN
  !$ACC ENTER DATA CREATE (YD%SD_OC)
  !$ACC UPDATE DEVICE (YD%SD_OC)
  !$ACC ENTER DATA ATTACH (YD%SD_OC)
ENDIF

CALL COPY_TYPE_SURF_GEN (YD%YSD_OCD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_TYPE_SFL_OCE (YD%YSD_OC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)



END SUBROUTINE

SUBROUTINE HOST_TSURF (YD)
USE UTIL_TYPE_SFL_CANRI_MOD
USE UTIL_TYPE_SFL_CLS_MOD
USE UTIL_TYPE_SFL_COMM_MOD
USE UTIL_TYPE_SFL_EXTRP_MOD
USE UTIL_TYPE_SFL_LAKEB_MOD
USE UTIL_TYPE_SFL_OCE_MOD
USE UTIL_TYPE_SFL_OML_MOD
USE UTIL_TYPE_SFL_RESVR_MOD
USE UTIL_TYPE_SFL_SATSIM_MOD
USE UTIL_TYPE_SFL_SFLUX_MOD
USE UTIL_TYPE_SFL_SFORC_MOD
USE UTIL_TYPE_SFL_SNOWG_MOD
USE UTIL_TYPE_SFL_SOILB_MOD
USE UTIL_TYPE_SFL_VARSF_MOD
USE UTIL_TYPE_SFL_VCLIA_MOD
USE UTIL_TYPE_SFL_VCLIH_MOD
USE UTIL_TYPE_SFL_VCLIK_MOD
USE UTIL_TYPE_SFL_VCLIN_MOD
USE UTIL_TYPE_SFL_VCLIP_MOD
USE UTIL_TYPE_SFL_VCLIV_MOD
USE UTIL_TYPE_SFL_VCLIX_MOD
USE UTIL_TYPE_SFL_VDIAGO2_MOD
USE UTIL_TYPE_SFL_VDIAGO3_MOD
USE UTIL_TYPE_SFL_VDIAG_MOD
USE UTIL_TYPE_SFL_VEXTR2_MOD
USE UTIL_TYPE_SFL_VEXTRA_MOD
USE UTIL_TYPE_SFL_VEXTRDI_MOD
USE UTIL_TYPE_SFL_VO3ABC_MOD
USE UTIL_TYPE_SFL_VPRECIP2_MOD
USE UTIL_TYPE_SFL_VPRECIP_MOD
USE UTIL_TYPE_SFL_WAM_MOD
USE UTIL_TYPE_SFL_WAVES_MOD
USE UTIL_TYPE_SFL_XTRP2_MOD
USE UTIL_TYPE_SURF_GEN_MOD

IMPLICIT NONE
TYPE (TSURF), TARGET :: YD
LOGICAL :: LSD_DI, LSD_OC, LSD_PF, LSD_SFL, LSD_SFO, LSD_SM, LSD_V2, LSD_V3, LSD_VA, LSD_VC
LOGICAL :: LSD_VD, LSD_VF, LSD_VH, LSD_VK, LSD_VN, LSD_VP, LSD_VV, LSD_VX, LSD_WS, LSD_WW
LOGICAL :: LSD_X2, LSD_XA, LSD_XP, LSD_XP2, LSD_XR, LSP_CI, LSP_CL, LSP_EP, LSP_OM, LSP_RR
LOGICAL :: LSP_SB, LSP_SG, LSP_SL, LSP_X2, LSTORE_ARRAY







CALL HOST_TYPE_SFL_COMM (YD%YDUPD)


CALL HOST_TYPE_SURF_GEN (YD%YSP_SBD)

CALL HOST_TYPE_SFL_SOILB (YD%YSP_SB)


CALL HOST_TYPE_SURF_GEN (YD%YSP_SGD)

CALL HOST_TYPE_SFL_SNOWG (YD%YSP_SG)


CALL HOST_TYPE_SURF_GEN (YD%YSP_SLD)

CALL HOST_TYPE_SFL_LAKEB (YD%YSP_SL)


CALL HOST_TYPE_SURF_GEN (YD%YSP_RRD)

CALL HOST_TYPE_SFL_RESVR (YD%YSP_RR)


CALL HOST_TYPE_SURF_GEN (YD%YSP_CLD)

CALL HOST_TYPE_SFL_CLS (YD%YSP_CL)


CALL HOST_TYPE_SURF_GEN (YD%YSP_OMD)

CALL HOST_TYPE_SFL_OML (YD%YSP_OM)


CALL HOST_TYPE_SURF_GEN (YD%YSP_EPD)

CALL HOST_TYPE_SFL_EXTRP (YD%YSP_EP)


CALL HOST_TYPE_SURF_GEN (YD%YSP_X2D)

CALL HOST_TYPE_SFL_XTRP2 (YD%YSP_X2)


CALL HOST_TYPE_SURF_GEN (YD%YSP_CID)

CALL HOST_TYPE_SFL_CANRI (YD%YSP_CI)


CALL HOST_TYPE_SURF_GEN (YD%YSD_XPD)

CALL HOST_TYPE_SFL_VPRECIP (YD%YSD_XP)


CALL HOST_TYPE_SURF_GEN (YD%YSD_XP2D)

CALL HOST_TYPE_SFL_VPRECIP2 (YD%YSD_XP2)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VFD)

CALL HOST_TYPE_SFL_VARSF (YD%YSD_VF)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VPD)

CALL HOST_TYPE_SFL_VCLIP (YD%YSD_VP)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VVD)

CALL HOST_TYPE_SFL_VCLIV (YD%YSD_VV)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VND)

CALL HOST_TYPE_SFL_VCLIN (YD%YSD_VN)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VHD)

CALL HOST_TYPE_SFL_VCLIH (YD%YSD_VH)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VKD)

CALL HOST_TYPE_SFL_VCLIK (YD%YSD_VK)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VAD)

CALL HOST_TYPE_SFL_VCLIA (YD%YSD_VA)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VCD)

CALL HOST_TYPE_SFL_VO3ABC (YD%YSD_VC)


CALL HOST_TYPE_SURF_GEN (YD%YSD_V2D)

CALL HOST_TYPE_SFL_VDIAGO2 (YD%YSD_V2)


CALL HOST_TYPE_SURF_GEN (YD%YSD_V3D)

CALL HOST_TYPE_SFL_VDIAGO3 (YD%YSD_V3)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VDD)

CALL HOST_TYPE_SFL_VDIAG (YD%YSD_VD)


CALL HOST_TYPE_SURF_GEN (YD%YSD_SMD)

CALL HOST_TYPE_SFL_SATSIM (YD%YSD_SM)


CALL HOST_TYPE_SURF_GEN (YD%YSD_WSD)

CALL HOST_TYPE_SFL_WAVES (YD%YSD_WS)


CALL HOST_TYPE_SURF_GEN (YD%YSD_WWD)

CALL HOST_TYPE_SFL_WAM (YD%YSD_WW)


CALL HOST_TYPE_SURF_GEN (YD%YSD_VXD)

CALL HOST_TYPE_SFL_VCLIX (YD%YSD_VX)


CALL HOST_TYPE_SURF_GEN (YD%YSD_XAD)

CALL HOST_TYPE_SFL_VEXTRA (YD%YSD_XA)


CALL HOST_TYPE_SURF_GEN (YD%YSD_DID)

CALL HOST_TYPE_SFL_VEXTRDI (YD%YSD_DI)


CALL HOST_TYPE_SURF_GEN (YD%YSD_XRD)

CALL HOST_TYPE_SFL_VEXTRA (YD%YSD_XR)


CALL HOST_TYPE_SURF_GEN (YD%YSD_X2D)

CALL HOST_TYPE_SFL_VEXTR2 (YD%YSD_X2)


CALL HOST_TYPE_SURF_GEN (YD%YSD_SFLD)

CALL HOST_TYPE_SFL_SFLUX (YD%YSD_SFL)


CALL HOST_TYPE_SURF_GEN (YD%YSD_SFOD)

CALL HOST_TYPE_SFL_SFORC (YD%YSD_SFO)


CALL HOST_TYPE_SURF_GEN (YD%YSD_PFD)

CALL HOST_TYPE_SFL_VEXTRA (YD%YSD_PF)


CALL HOST_TYPE_SURF_GEN (YD%YSD_OCD)

CALL HOST_TYPE_SFL_OCE (YD%YSD_OC)



END SUBROUTINE

     

SUBROUTINE CRC64_TSURF (YD, KLUN, CDPATH)
USE UTIL_TYPE_SFL_CANRI_MOD
USE UTIL_TYPE_SFL_CLS_MOD
USE UTIL_TYPE_SFL_COMM_MOD
USE UTIL_TYPE_SFL_EXTRP_MOD
USE UTIL_TYPE_SFL_LAKEB_MOD
USE UTIL_TYPE_SFL_OCE_MOD
USE UTIL_TYPE_SFL_OML_MOD
USE UTIL_TYPE_SFL_RESVR_MOD
USE UTIL_TYPE_SFL_SATSIM_MOD
USE UTIL_TYPE_SFL_SFLUX_MOD
USE UTIL_TYPE_SFL_SFORC_MOD
USE UTIL_TYPE_SFL_SNOWG_MOD
USE UTIL_TYPE_SFL_SOILB_MOD
USE UTIL_TYPE_SFL_VARSF_MOD
USE UTIL_TYPE_SFL_VCLIA_MOD
USE UTIL_TYPE_SFL_VCLIH_MOD
USE UTIL_TYPE_SFL_VCLIK_MOD
USE UTIL_TYPE_SFL_VCLIN_MOD
USE UTIL_TYPE_SFL_VCLIP_MOD
USE UTIL_TYPE_SFL_VCLIV_MOD
USE UTIL_TYPE_SFL_VCLIX_MOD
USE UTIL_TYPE_SFL_VDIAGO2_MOD
USE UTIL_TYPE_SFL_VDIAGO3_MOD
USE UTIL_TYPE_SFL_VDIAG_MOD
USE UTIL_TYPE_SFL_VEXTR2_MOD
USE UTIL_TYPE_SFL_VEXTRA_MOD
USE UTIL_TYPE_SFL_VEXTRDI_MOD
USE UTIL_TYPE_SFL_VO3ABC_MOD
USE UTIL_TYPE_SFL_VPRECIP2_MOD
USE UTIL_TYPE_SFL_VPRECIP_MOD
USE UTIL_TYPE_SFL_WAM_MOD
USE UTIL_TYPE_SFL_WAVES_MOD
USE UTIL_TYPE_SFL_XTRP2_MOD
USE UTIL_TYPE_SURF_GEN_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TSURF), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LSD_DI, LSD_OC, LSD_PF, LSD_SFL, LSD_SFO, LSD_SM, LSD_V2, LSD_V3, LSD_VA, LSD_VC
LOGICAL :: LSD_VD, LSD_VF, LSD_VH, LSD_VK, LSD_VN, LSD_VP, LSD_VV, LSD_VX, LSD_WS, LSD_WW
LOGICAL :: LSD_X2, LSD_XA, LSD_XP, LSD_XP2, LSD_XR, LSP_CI, LSP_CL, LSP_EP, LSP_OM, LSP_RR
LOGICAL :: LSP_SB, LSP_SG, LSP_SL, LSP_X2, LSTORE_ARRAY
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSURF), CDPATH//'%NSURF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSURFL), CDPATH//'%NSURFL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDIMSURF), CDPATH//'%NDIMSURF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDIMSURFL), CDPATH//'%NDIMSURFL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPROGSURF), CDPATH//'%NPROGSURF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPROGSURFL), CDPATH//'%NPROGSURFL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%STORE_ARRAY), CDPATH//'%STORE_ARRAY'

CLIND = ''
CALL CRC64_TYPE_SFL_COMM (YD%YDUPD, KLUN, CDPATH//'%YDUPD'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SP_SB), CDPATH//'%SP_SB'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSP_SBD, KLUN, CDPATH//'%YSP_SBD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_SOILB (YD%YSP_SB, KLUN, CDPATH//'%YSP_SB'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SP_SG), CDPATH//'%SP_SG'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSP_SGD, KLUN, CDPATH//'%YSP_SGD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_SNOWG (YD%YSP_SG, KLUN, CDPATH//'%YSP_SG'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SP_SL), CDPATH//'%SP_SL'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSP_SLD, KLUN, CDPATH//'%YSP_SLD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_LAKEB (YD%YSP_SL, KLUN, CDPATH//'%YSP_SL'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SP_RR), CDPATH//'%SP_RR'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSP_RRD, KLUN, CDPATH//'%YSP_RRD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_RESVR (YD%YSP_RR, KLUN, CDPATH//'%YSP_RR'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SP_CL), CDPATH//'%SP_CL'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSP_CLD, KLUN, CDPATH//'%YSP_CLD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_CLS (YD%YSP_CL, KLUN, CDPATH//'%YSP_CL'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SP_OM), CDPATH//'%SP_OM'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSP_OMD, KLUN, CDPATH//'%YSP_OMD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_OML (YD%YSP_OM, KLUN, CDPATH//'%YSP_OM'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SP_EP), CDPATH//'%SP_EP'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSP_EPD, KLUN, CDPATH//'%YSP_EPD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_EXTRP (YD%YSP_EP, KLUN, CDPATH//'%YSP_EP'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SP_X2), CDPATH//'%SP_X2'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSP_X2D, KLUN, CDPATH//'%YSP_X2D'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_XTRP2 (YD%YSP_X2, KLUN, CDPATH//'%YSP_X2'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SP_CI), CDPATH//'%SP_CI'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSP_CID, KLUN, CDPATH//'%YSP_CID'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_CANRI (YD%YSP_CI, KLUN, CDPATH//'%YSP_CI'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_XP), CDPATH//'%SD_XP'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_XPD, KLUN, CDPATH//'%YSD_XPD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VPRECIP (YD%YSD_XP, KLUN, CDPATH//'%YSD_XP'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_XP2), CDPATH//'%SD_XP2'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_XP2D, KLUN, CDPATH//'%YSD_XP2D'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VPRECIP2 (YD%YSD_XP2, KLUN, CDPATH//'%YSD_XP2'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VF), CDPATH//'%SD_VF'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VFD, KLUN, CDPATH//'%YSD_VFD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VARSF (YD%YSD_VF, KLUN, CDPATH//'%YSD_VF'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VP), CDPATH//'%SD_VP'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VPD, KLUN, CDPATH//'%YSD_VPD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VCLIP (YD%YSD_VP, KLUN, CDPATH//'%YSD_VP'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VV), CDPATH//'%SD_VV'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VVD, KLUN, CDPATH//'%YSD_VVD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VCLIV (YD%YSD_VV, KLUN, CDPATH//'%YSD_VV'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VN), CDPATH//'%SD_VN'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VND, KLUN, CDPATH//'%YSD_VND'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VCLIN (YD%YSD_VN, KLUN, CDPATH//'%YSD_VN'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VH), CDPATH//'%SD_VH'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VHD, KLUN, CDPATH//'%YSD_VHD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VCLIH (YD%YSD_VH, KLUN, CDPATH//'%YSD_VH'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VK), CDPATH//'%SD_VK'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VKD, KLUN, CDPATH//'%YSD_VKD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VCLIK (YD%YSD_VK, KLUN, CDPATH//'%YSD_VK'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VA), CDPATH//'%SD_VA'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VAD, KLUN, CDPATH//'%YSD_VAD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VCLIA (YD%YSD_VA, KLUN, CDPATH//'%YSD_VA'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VC), CDPATH//'%SD_VC'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VCD, KLUN, CDPATH//'%YSD_VCD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VO3ABC (YD%YSD_VC, KLUN, CDPATH//'%YSD_VC'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_V2), CDPATH//'%SD_V2'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_V2D, KLUN, CDPATH//'%YSD_V2D'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VDIAGO2 (YD%YSD_V2, KLUN, CDPATH//'%YSD_V2'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_V3), CDPATH//'%SD_V3'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_V3D, KLUN, CDPATH//'%YSD_V3D'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VDIAGO3 (YD%YSD_V3, KLUN, CDPATH//'%YSD_V3'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VD), CDPATH//'%SD_VD'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VDD, KLUN, CDPATH//'%YSD_VDD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VDIAG (YD%YSD_VD, KLUN, CDPATH//'%YSD_VD'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_SM), CDPATH//'%SD_SM'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_SMD, KLUN, CDPATH//'%YSD_SMD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_SATSIM (YD%YSD_SM, KLUN, CDPATH//'%YSD_SM'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_WS), CDPATH//'%SD_WS'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_WSD, KLUN, CDPATH//'%YSD_WSD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_WAVES (YD%YSD_WS, KLUN, CDPATH//'%YSD_WS'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_WW), CDPATH//'%SD_WW'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_WWD, KLUN, CDPATH//'%YSD_WWD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_WAM (YD%YSD_WW, KLUN, CDPATH//'%YSD_WW'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_VX), CDPATH//'%SD_VX'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_VXD, KLUN, CDPATH//'%YSD_VXD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VCLIX (YD%YSD_VX, KLUN, CDPATH//'%YSD_VX'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_XA), CDPATH//'%SD_XA'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_XAD, KLUN, CDPATH//'%YSD_XAD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VEXTRA (YD%YSD_XA, KLUN, CDPATH//'%YSD_XA'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_DI), CDPATH//'%SD_DI'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_DID, KLUN, CDPATH//'%YSD_DID'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VEXTRDI (YD%YSD_DI, KLUN, CDPATH//'%YSD_DI'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_XR), CDPATH//'%SD_XR'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_XRD, KLUN, CDPATH//'%YSD_XRD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VEXTRA (YD%YSD_XR, KLUN, CDPATH//'%YSD_XR'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_X2), CDPATH//'%SD_X2'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_X2D, KLUN, CDPATH//'%YSD_X2D'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VEXTR2 (YD%YSD_X2, KLUN, CDPATH//'%YSD_X2'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_SFL), CDPATH//'%SD_SFL'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_SFLD, KLUN, CDPATH//'%YSD_SFLD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_SFLUX (YD%YSD_SFL, KLUN, CDPATH//'%YSD_SFL'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_SFO), CDPATH//'%SD_SFO'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_SFOD, KLUN, CDPATH//'%YSD_SFOD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_SFORC (YD%YSD_SFO, KLUN, CDPATH//'%YSD_SFO'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_PF), CDPATH//'%SD_PF'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_PFD, KLUN, CDPATH//'%YSD_PFD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_VEXTRA (YD%YSD_PF, KLUN, CDPATH//'%YSD_PF'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SD_OC), CDPATH//'%SD_OC'

CLIND = ''
CALL CRC64_TYPE_SURF_GEN (YD%YSD_OCD, KLUN, CDPATH//'%YSD_OCD'//TRIM(CLIND))

CLIND = ''
CALL CRC64_TYPE_SFL_OCE (YD%YSD_OC, KLUN, CDPATH//'%YSD_OC'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NGP5_OOPS), CDPATH//'%NGP5_OOPS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTRAJ_CST_OOPS), CDPATH//'%NTRAJ_CST_OOPS'

END SUBROUTINE

SUBROUTINE WIPE_TSURF (YD, LDDELETED, LDFIELDAPI)
USE UTIL_TYPE_SFL_CANRI_MOD
USE UTIL_TYPE_SFL_CLS_MOD
USE UTIL_TYPE_SFL_COMM_MOD
USE UTIL_TYPE_SFL_EXTRP_MOD
USE UTIL_TYPE_SFL_LAKEB_MOD
USE UTIL_TYPE_SFL_OCE_MOD
USE UTIL_TYPE_SFL_OML_MOD
USE UTIL_TYPE_SFL_RESVR_MOD
USE UTIL_TYPE_SFL_SATSIM_MOD
USE UTIL_TYPE_SFL_SFLUX_MOD
USE UTIL_TYPE_SFL_SFORC_MOD
USE UTIL_TYPE_SFL_SNOWG_MOD
USE UTIL_TYPE_SFL_SOILB_MOD
USE UTIL_TYPE_SFL_VARSF_MOD
USE UTIL_TYPE_SFL_VCLIA_MOD
USE UTIL_TYPE_SFL_VCLIH_MOD
USE UTIL_TYPE_SFL_VCLIK_MOD
USE UTIL_TYPE_SFL_VCLIN_MOD
USE UTIL_TYPE_SFL_VCLIP_MOD
USE UTIL_TYPE_SFL_VCLIV_MOD
USE UTIL_TYPE_SFL_VCLIX_MOD
USE UTIL_TYPE_SFL_VDIAGO2_MOD
USE UTIL_TYPE_SFL_VDIAGO3_MOD
USE UTIL_TYPE_SFL_VDIAG_MOD
USE UTIL_TYPE_SFL_VEXTR2_MOD
USE UTIL_TYPE_SFL_VEXTRA_MOD
USE UTIL_TYPE_SFL_VEXTRDI_MOD
USE UTIL_TYPE_SFL_VO3ABC_MOD
USE UTIL_TYPE_SFL_VPRECIP2_MOD
USE UTIL_TYPE_SFL_VPRECIP_MOD
USE UTIL_TYPE_SFL_WAM_MOD
USE UTIL_TYPE_SFL_WAVES_MOD
USE UTIL_TYPE_SFL_XTRP2_MOD
USE UTIL_TYPE_SURF_GEN_MOD
IMPLICIT NONE
TYPE (TSURF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LSD_DI, LSD_OC, LSD_PF, LSD_SFL, LSD_SFO, LSD_SM, LSD_V2, LSD_V3, LSD_VA, LSD_VC
LOGICAL :: LSD_VD, LSD_VF, LSD_VH, LSD_VK, LSD_VN, LSD_VP, LSD_VV, LSD_VX, LSD_WS, LSD_WW
LOGICAL :: LSD_X2, LSD_XA, LSD_XP, LSD_XP2, LSD_XR, LSP_CI, LSP_CL, LSP_EP, LSP_OM, LSP_RR
LOGICAL :: LSP_SB, LSP_SG, LSP_SL, LSP_X2, LSTORE_ARRAY

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF






LSTORE_ARRAY = ALLOCATED (YD%STORE_ARRAY)
IF (LSTORE_ARRAY) THEN
  !$ACC EXIT DATA DETACH (YD%STORE_ARRAY)
  !$ACC EXIT DATA DETACH (YD%STORE_ARRAY)
ENDIF

CALL WIPE_TYPE_SFL_COMM (YD%YDUPD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_SB = ALLOCATED (YD%SP_SB)
IF (LSP_SB) THEN
  !$ACC EXIT DATA DETACH (YD%SP_SB)
  !$ACC EXIT DATA DETACH (YD%SP_SB)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSP_SBD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_SOILB (YD%YSP_SB, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_SG = ALLOCATED (YD%SP_SG)
IF (LSP_SG) THEN
  !$ACC EXIT DATA DETACH (YD%SP_SG)
  !$ACC EXIT DATA DETACH (YD%SP_SG)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSP_SGD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_SNOWG (YD%YSP_SG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_SL = ALLOCATED (YD%SP_SL)
IF (LSP_SL) THEN
  !$ACC EXIT DATA DETACH (YD%SP_SL)
  !$ACC EXIT DATA DETACH (YD%SP_SL)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSP_SLD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_LAKEB (YD%YSP_SL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_RR = ALLOCATED (YD%SP_RR)
IF (LSP_RR) THEN
  !$ACC EXIT DATA DETACH (YD%SP_RR)
  !$ACC EXIT DATA DETACH (YD%SP_RR)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSP_RRD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_RESVR (YD%YSP_RR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_CL = ALLOCATED (YD%SP_CL)
IF (LSP_CL) THEN
  !$ACC EXIT DATA DETACH (YD%SP_CL)
  !$ACC EXIT DATA DETACH (YD%SP_CL)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSP_CLD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_CLS (YD%YSP_CL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_OM = ALLOCATED (YD%SP_OM)
IF (LSP_OM) THEN
  !$ACC EXIT DATA DETACH (YD%SP_OM)
  !$ACC EXIT DATA DETACH (YD%SP_OM)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSP_OMD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_OML (YD%YSP_OM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_EP = ALLOCATED (YD%SP_EP)
IF (LSP_EP) THEN
  !$ACC EXIT DATA DETACH (YD%SP_EP)
  !$ACC EXIT DATA DETACH (YD%SP_EP)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSP_EPD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_EXTRP (YD%YSP_EP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_X2 = ALLOCATED (YD%SP_X2)
IF (LSP_X2) THEN
  !$ACC EXIT DATA DETACH (YD%SP_X2)
  !$ACC EXIT DATA DETACH (YD%SP_X2)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSP_X2D, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_XTRP2 (YD%YSP_X2, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSP_CI = ALLOCATED (YD%SP_CI)
IF (LSP_CI) THEN
  !$ACC EXIT DATA DETACH (YD%SP_CI)
  !$ACC EXIT DATA DETACH (YD%SP_CI)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSP_CID, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_CANRI (YD%YSP_CI, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_XP = ALLOCATED (YD%SD_XP)
IF (LSD_XP) THEN
  !$ACC EXIT DATA DETACH (YD%SD_XP)
  !$ACC EXIT DATA DETACH (YD%SD_XP)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_XPD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VPRECIP (YD%YSD_XP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_XP2 = ALLOCATED (YD%SD_XP2)
IF (LSD_XP2) THEN
  !$ACC EXIT DATA DETACH (YD%SD_XP2)
  !$ACC EXIT DATA DETACH (YD%SD_XP2)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_XP2D, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VPRECIP2 (YD%YSD_XP2, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VF = ALLOCATED (YD%SD_VF)
IF (LSD_VF) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VF)
  !$ACC EXIT DATA DETACH (YD%SD_VF)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VFD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VARSF (YD%YSD_VF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VP = ALLOCATED (YD%SD_VP)
IF (LSD_VP) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VP)
  !$ACC EXIT DATA DETACH (YD%SD_VP)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VPD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VCLIP (YD%YSD_VP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VV = ALLOCATED (YD%SD_VV)
IF (LSD_VV) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VV)
  !$ACC EXIT DATA DETACH (YD%SD_VV)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VVD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VCLIV (YD%YSD_VV, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VN = ALLOCATED (YD%SD_VN)
IF (LSD_VN) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VN)
  !$ACC EXIT DATA DETACH (YD%SD_VN)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VND, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VCLIN (YD%YSD_VN, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VH = ALLOCATED (YD%SD_VH)
IF (LSD_VH) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VH)
  !$ACC EXIT DATA DETACH (YD%SD_VH)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VHD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VCLIH (YD%YSD_VH, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VK = ALLOCATED (YD%SD_VK)
IF (LSD_VK) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VK)
  !$ACC EXIT DATA DETACH (YD%SD_VK)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VKD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VCLIK (YD%YSD_VK, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VA = ALLOCATED (YD%SD_VA)
IF (LSD_VA) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VA)
  !$ACC EXIT DATA DETACH (YD%SD_VA)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VAD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VCLIA (YD%YSD_VA, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VC = ALLOCATED (YD%SD_VC)
IF (LSD_VC) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VC)
  !$ACC EXIT DATA DETACH (YD%SD_VC)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VCD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VO3ABC (YD%YSD_VC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_V2 = ALLOCATED (YD%SD_V2)
IF (LSD_V2) THEN
  !$ACC EXIT DATA DETACH (YD%SD_V2)
  !$ACC EXIT DATA DETACH (YD%SD_V2)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_V2D, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VDIAGO2 (YD%YSD_V2, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_V3 = ALLOCATED (YD%SD_V3)
IF (LSD_V3) THEN
  !$ACC EXIT DATA DETACH (YD%SD_V3)
  !$ACC EXIT DATA DETACH (YD%SD_V3)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_V3D, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VDIAGO3 (YD%YSD_V3, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VD = ALLOCATED (YD%SD_VD)
IF (LSD_VD) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VD)
  !$ACC EXIT DATA DETACH (YD%SD_VD)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VDD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VDIAG (YD%YSD_VD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_SM = ALLOCATED (YD%SD_SM)
IF (LSD_SM) THEN
  !$ACC EXIT DATA DETACH (YD%SD_SM)
  !$ACC EXIT DATA DETACH (YD%SD_SM)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_SMD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_SATSIM (YD%YSD_SM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_WS = ALLOCATED (YD%SD_WS)
IF (LSD_WS) THEN
  !$ACC EXIT DATA DETACH (YD%SD_WS)
  !$ACC EXIT DATA DETACH (YD%SD_WS)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_WSD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_WAVES (YD%YSD_WS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_WW = ALLOCATED (YD%SD_WW)
IF (LSD_WW) THEN
  !$ACC EXIT DATA DETACH (YD%SD_WW)
  !$ACC EXIT DATA DETACH (YD%SD_WW)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_WWD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_WAM (YD%YSD_WW, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_VX = ALLOCATED (YD%SD_VX)
IF (LSD_VX) THEN
  !$ACC EXIT DATA DETACH (YD%SD_VX)
  !$ACC EXIT DATA DETACH (YD%SD_VX)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_VXD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VCLIX (YD%YSD_VX, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_XA = ALLOCATED (YD%SD_XA)
IF (LSD_XA) THEN
  !$ACC EXIT DATA DETACH (YD%SD_XA)
  !$ACC EXIT DATA DETACH (YD%SD_XA)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_XAD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VEXTRA (YD%YSD_XA, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_DI = ALLOCATED (YD%SD_DI)
IF (LSD_DI) THEN
  !$ACC EXIT DATA DETACH (YD%SD_DI)
  !$ACC EXIT DATA DETACH (YD%SD_DI)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_DID, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VEXTRDI (YD%YSD_DI, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_XR = ALLOCATED (YD%SD_XR)
IF (LSD_XR) THEN
  !$ACC EXIT DATA DETACH (YD%SD_XR)
  !$ACC EXIT DATA DETACH (YD%SD_XR)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_XRD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VEXTRA (YD%YSD_XR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_X2 = ALLOCATED (YD%SD_X2)
IF (LSD_X2) THEN
  !$ACC EXIT DATA DETACH (YD%SD_X2)
  !$ACC EXIT DATA DETACH (YD%SD_X2)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_X2D, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VEXTR2 (YD%YSD_X2, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_SFL = ALLOCATED (YD%SD_SFL)
IF (LSD_SFL) THEN
  !$ACC EXIT DATA DETACH (YD%SD_SFL)
  !$ACC EXIT DATA DETACH (YD%SD_SFL)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_SFLD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_SFLUX (YD%YSD_SFL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_SFO = ALLOCATED (YD%SD_SFO)
IF (LSD_SFO) THEN
  !$ACC EXIT DATA DETACH (YD%SD_SFO)
  !$ACC EXIT DATA DETACH (YD%SD_SFO)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_SFOD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_SFORC (YD%YSD_SFO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_PF = ALLOCATED (YD%SD_PF)
IF (LSD_PF) THEN
  !$ACC EXIT DATA DETACH (YD%SD_PF)
  !$ACC EXIT DATA DETACH (YD%SD_PF)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_PFD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_VEXTRA (YD%YSD_PF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LSD_OC = ALLOCATED (YD%SD_OC)
IF (LSD_OC) THEN
  !$ACC EXIT DATA DETACH (YD%SD_OC)
  !$ACC EXIT DATA DETACH (YD%SD_OC)
ENDIF

CALL WIPE_TYPE_SURF_GEN (YD%YSD_OCD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_TYPE_SFL_OCE (YD%YSD_OC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)



LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE



END MODULE
