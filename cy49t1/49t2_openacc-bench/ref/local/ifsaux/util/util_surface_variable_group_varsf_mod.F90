MODULE UTIL_SURFACE_VARIABLE_GROUP_VARSF_MOD

USE SURFACE_VARIABLES_MOD, ONLY : SURFACE_VARIABLE_GROUP_VARSF



INTERFACE COPY
MODULE PROCEDURE COPY_SURFACE_VARIABLE_GROUP_VARSF
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_SURFACE_VARIABLE_GROUP_VARSF
END INTERFACE

     

INTERFACE WIPE
MODULE PROCEDURE WIPE_SURFACE_VARIABLE_GROUP_VARSF
END INTERFACE



CONTAINS





SUBROUTINE COPY_SURFACE_VARIABLE_GROUP_VARSF (YD, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_2RB_MOD
IMPLICIT NONE
TYPE (SURFACE_VARIABLE_GROUP_VARSF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LF_GROUP, LVCHEMDDFLX, LVCHEMDV, LVCHEMFLXO, LVCHEMWDFLX, LVEMIS2D, LVEMIS2DAUX

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
CALL COPY_VARIABLE_2RB (YD%VZ0F, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VALBF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VEMISF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VGETRL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VLSM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VVEG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VVRLAN, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VVRLDI, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VSIG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VALBSF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VLAN, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VSST, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VSSS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VLZ0H, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VCVL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VCO2TYP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VCVH, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VCUR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VTVL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VTVH, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VLAIL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VLAIH, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VFWET, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VSOTY, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VCLK, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VDL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VCI, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VUCUR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VVCUR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VZ0RLF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VCGPP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VCREC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VSDFOR, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VALUVP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VALUVD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VALNIP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VALNID, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VFP1, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VSO2DD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VDMSO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VURBF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VFCA1, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VFCA2, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VAERDEP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VAERLTS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VAERSCC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL COPY_VARIABLE_2RB (YD%VDSF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LVCHEMFLXO = ALLOCATED (YD%VCHEMFLXO)
IF (LVCHEMFLXO) THEN
  !$ACC ENTER DATA CREATE (YD%VCHEMFLXO)
  !$ACC UPDATE DEVICE (YD%VCHEMFLXO)
  DO J1 = LBOUND (YD%VCHEMFLXO, 1), UBOUND (YD%VCHEMFLXO, 1)
    CALL COPY_VARIABLE_2RB (YD%VCHEMFLXO (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%VCHEMFLXO)
ENDIF

LVCHEMWDFLX = ALLOCATED (YD%VCHEMWDFLX)
IF (LVCHEMWDFLX) THEN
  !$ACC ENTER DATA CREATE (YD%VCHEMWDFLX)
  !$ACC UPDATE DEVICE (YD%VCHEMWDFLX)
  DO J1 = LBOUND (YD%VCHEMWDFLX, 1), UBOUND (YD%VCHEMWDFLX, 1)
    CALL COPY_VARIABLE_2RB (YD%VCHEMWDFLX (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%VCHEMWDFLX)
ENDIF

LVCHEMDDFLX = ALLOCATED (YD%VCHEMDDFLX)
IF (LVCHEMDDFLX) THEN
  !$ACC ENTER DATA CREATE (YD%VCHEMDDFLX)
  !$ACC UPDATE DEVICE (YD%VCHEMDDFLX)
  DO J1 = LBOUND (YD%VCHEMDDFLX, 1), UBOUND (YD%VCHEMDDFLX, 1)
    CALL COPY_VARIABLE_2RB (YD%VCHEMDDFLX (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%VCHEMDDFLX)
ENDIF

LVCHEMDV = ALLOCATED (YD%VCHEMDV)
IF (LVCHEMDV) THEN
  !$ACC ENTER DATA CREATE (YD%VCHEMDV)
  !$ACC UPDATE DEVICE (YD%VCHEMDV)
  DO J1 = LBOUND (YD%VCHEMDV, 1), UBOUND (YD%VCHEMDV, 1)
    CALL COPY_VARIABLE_2RB (YD%VCHEMDV (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%VCHEMDV)
ENDIF

CALL COPY_VARIABLE_2RB (YD%VNUDM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LVEMIS2D = ALLOCATED (YD%VEMIS2D)
IF (LVEMIS2D) THEN
  !$ACC ENTER DATA CREATE (YD%VEMIS2D)
  !$ACC UPDATE DEVICE (YD%VEMIS2D)
  DO J1 = LBOUND (YD%VEMIS2D, 1), UBOUND (YD%VEMIS2D, 1)
    CALL COPY_VARIABLE_2RB (YD%VEMIS2D (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%VEMIS2D)
ENDIF

LVEMIS2DAUX = ALLOCATED (YD%VEMIS2DAUX)
IF (LVEMIS2DAUX) THEN
  !$ACC ENTER DATA CREATE (YD%VEMIS2DAUX)
  !$ACC UPDATE DEVICE (YD%VEMIS2DAUX)
  DO J1 = LBOUND (YD%VEMIS2DAUX, 1), UBOUND (YD%VEMIS2DAUX, 1)
    CALL COPY_VARIABLE_2RB (YD%VEMIS2DAUX (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%VEMIS2DAUX)
ENDIF

LF_GROUP = ASSOCIATED (YD%F_GROUP)
IF (LF_GROUP .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (YD%F_GROUP)
  !$ACC ENTER DATA ATTACH (YD%F_GROUP)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_SURFACE_VARIABLE_GROUP_VARSF (YD)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_2RB_MOD

IMPLICIT NONE
TYPE (SURFACE_VARIABLE_GROUP_VARSF), TARGET :: YD
INTEGER :: J1
LOGICAL :: LF_GROUP, LVCHEMDDFLX, LVCHEMDV, LVCHEMFLXO, LVCHEMWDFLX, LVEMIS2D, LVEMIS2DAUX
CALL HOST_VARIABLE_2RB (YD%VZ0F)

CALL HOST_VARIABLE_2RB (YD%VALBF)

CALL HOST_VARIABLE_2RB (YD%VEMISF)

CALL HOST_VARIABLE_2RB (YD%VGETRL)

CALL HOST_VARIABLE_2RB (YD%VLSM)

CALL HOST_VARIABLE_2RB (YD%VVEG)

CALL HOST_VARIABLE_2RB (YD%VVRLAN)

CALL HOST_VARIABLE_2RB (YD%VVRLDI)

CALL HOST_VARIABLE_2RB (YD%VSIG)

CALL HOST_VARIABLE_2RB (YD%VALBSF)

CALL HOST_VARIABLE_2RB (YD%VLAN)

CALL HOST_VARIABLE_2RB (YD%VSST)

CALL HOST_VARIABLE_2RB (YD%VSSS)

CALL HOST_VARIABLE_2RB (YD%VLZ0H)

CALL HOST_VARIABLE_2RB (YD%VCVL)

CALL HOST_VARIABLE_2RB (YD%VCO2TYP)

CALL HOST_VARIABLE_2RB (YD%VCVH)

CALL HOST_VARIABLE_2RB (YD%VCUR)

CALL HOST_VARIABLE_2RB (YD%VTVL)

CALL HOST_VARIABLE_2RB (YD%VTVH)

CALL HOST_VARIABLE_2RB (YD%VLAIL)

CALL HOST_VARIABLE_2RB (YD%VLAIH)

CALL HOST_VARIABLE_2RB (YD%VFWET)

CALL HOST_VARIABLE_2RB (YD%VSOTY)

CALL HOST_VARIABLE_2RB (YD%VCLK)

CALL HOST_VARIABLE_2RB (YD%VDL)

CALL HOST_VARIABLE_2RB (YD%VCI)

CALL HOST_VARIABLE_2RB (YD%VUCUR)

CALL HOST_VARIABLE_2RB (YD%VVCUR)

CALL HOST_VARIABLE_2RB (YD%VZ0RLF)

CALL HOST_VARIABLE_2RB (YD%VCGPP)

CALL HOST_VARIABLE_2RB (YD%VCREC)

CALL HOST_VARIABLE_2RB (YD%VSDFOR)

CALL HOST_VARIABLE_2RB (YD%VALUVP)

CALL HOST_VARIABLE_2RB (YD%VALUVD)

CALL HOST_VARIABLE_2RB (YD%VALNIP)

CALL HOST_VARIABLE_2RB (YD%VALNID)

CALL HOST_VARIABLE_2RB (YD%VFP1)

CALL HOST_VARIABLE_2RB (YD%VSO2DD)

CALL HOST_VARIABLE_2RB (YD%VDMSO)

CALL HOST_VARIABLE_2RB (YD%VURBF)

CALL HOST_VARIABLE_2RB (YD%VFCA1)

CALL HOST_VARIABLE_2RB (YD%VFCA2)

CALL HOST_VARIABLE_2RB (YD%VAERDEP)

CALL HOST_VARIABLE_2RB (YD%VAERLTS)

CALL HOST_VARIABLE_2RB (YD%VAERSCC)

CALL HOST_VARIABLE_2RB (YD%VDSF)

LVCHEMFLXO = ALLOCATED (YD%VCHEMFLXO)
IF (LVCHEMFLXO) THEN
  DO J1 = LBOUND (YD%VCHEMFLXO, 1), UBOUND (YD%VCHEMFLXO, 1)
    CALL HOST_VARIABLE_2RB (YD%VCHEMFLXO (J1))
  ENDDO
ENDIF

LVCHEMWDFLX = ALLOCATED (YD%VCHEMWDFLX)
IF (LVCHEMWDFLX) THEN
  DO J1 = LBOUND (YD%VCHEMWDFLX, 1), UBOUND (YD%VCHEMWDFLX, 1)
    CALL HOST_VARIABLE_2RB (YD%VCHEMWDFLX (J1))
  ENDDO
ENDIF

LVCHEMDDFLX = ALLOCATED (YD%VCHEMDDFLX)
IF (LVCHEMDDFLX) THEN
  DO J1 = LBOUND (YD%VCHEMDDFLX, 1), UBOUND (YD%VCHEMDDFLX, 1)
    CALL HOST_VARIABLE_2RB (YD%VCHEMDDFLX (J1))
  ENDDO
ENDIF

LVCHEMDV = ALLOCATED (YD%VCHEMDV)
IF (LVCHEMDV) THEN
  DO J1 = LBOUND (YD%VCHEMDV, 1), UBOUND (YD%VCHEMDV, 1)
    CALL HOST_VARIABLE_2RB (YD%VCHEMDV (J1))
  ENDDO
ENDIF

CALL HOST_VARIABLE_2RB (YD%VNUDM)

LVEMIS2D = ALLOCATED (YD%VEMIS2D)
IF (LVEMIS2D) THEN
  DO J1 = LBOUND (YD%VEMIS2D, 1), UBOUND (YD%VEMIS2D, 1)
    CALL HOST_VARIABLE_2RB (YD%VEMIS2D (J1))
  ENDDO
ENDIF

LVEMIS2DAUX = ALLOCATED (YD%VEMIS2DAUX)
IF (LVEMIS2DAUX) THEN
  DO J1 = LBOUND (YD%VEMIS2DAUX, 1), UBOUND (YD%VEMIS2DAUX, 1)
    CALL HOST_VARIABLE_2RB (YD%VEMIS2DAUX (J1))
  ENDDO
ENDIF

LF_GROUP = ASSOCIATED (YD%F_GROUP)
IF (LF_GROUP) THEN
  CALL HOST_FIELD_3RB (YD%F_GROUP)
ENDIF

END SUBROUTINE

     



SUBROUTINE WIPE_SURFACE_VARIABLE_GROUP_VARSF (YD, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
USE UTIL_VARIABLE_2RB_MOD
IMPLICIT NONE
TYPE (SURFACE_VARIABLE_GROUP_VARSF), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LF_GROUP, LVCHEMDDFLX, LVCHEMDV, LVCHEMFLXO, LVCHEMWDFLX, LVEMIS2D, LVEMIS2DAUX

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
CALL WIPE_VARIABLE_2RB (YD%VZ0F, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VALBF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VEMISF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VGETRL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VLSM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VVEG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VVRLAN, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VVRLDI, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VSIG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VALBSF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VLAN, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VSST, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VSSS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VLZ0H, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VCVL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VCO2TYP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VCVH, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VCUR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VTVL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VTVH, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VLAIL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VLAIH, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VFWET, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VSOTY, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VCLK, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VDL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VCI, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VUCUR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VVCUR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VZ0RLF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VCGPP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VCREC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VSDFOR, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VALUVP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VALUVD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VALNIP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VALNID, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VFP1, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VSO2DD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VDMSO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VURBF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VFCA1, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VFCA2, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VAERDEP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VAERLTS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VAERSCC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL WIPE_VARIABLE_2RB (YD%VDSF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LVCHEMFLXO = ALLOCATED (YD%VCHEMFLXO)
IF (LVCHEMFLXO) THEN
  !$ACC EXIT DATA DETACH (YD%VCHEMFLXO)
  DO J1 = LBOUND (YD%VCHEMFLXO, 1), UBOUND (YD%VCHEMFLXO, 1)
    CALL WIPE_VARIABLE_2RB (YD%VCHEMFLXO (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%VCHEMFLXO)
ENDIF

LVCHEMWDFLX = ALLOCATED (YD%VCHEMWDFLX)
IF (LVCHEMWDFLX) THEN
  !$ACC EXIT DATA DETACH (YD%VCHEMWDFLX)
  DO J1 = LBOUND (YD%VCHEMWDFLX, 1), UBOUND (YD%VCHEMWDFLX, 1)
    CALL WIPE_VARIABLE_2RB (YD%VCHEMWDFLX (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%VCHEMWDFLX)
ENDIF

LVCHEMDDFLX = ALLOCATED (YD%VCHEMDDFLX)
IF (LVCHEMDDFLX) THEN
  !$ACC EXIT DATA DETACH (YD%VCHEMDDFLX)
  DO J1 = LBOUND (YD%VCHEMDDFLX, 1), UBOUND (YD%VCHEMDDFLX, 1)
    CALL WIPE_VARIABLE_2RB (YD%VCHEMDDFLX (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%VCHEMDDFLX)
ENDIF

LVCHEMDV = ALLOCATED (YD%VCHEMDV)
IF (LVCHEMDV) THEN
  !$ACC EXIT DATA DETACH (YD%VCHEMDV)
  DO J1 = LBOUND (YD%VCHEMDV, 1), UBOUND (YD%VCHEMDV, 1)
    CALL WIPE_VARIABLE_2RB (YD%VCHEMDV (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%VCHEMDV)
ENDIF

CALL WIPE_VARIABLE_2RB (YD%VNUDM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LVEMIS2D = ALLOCATED (YD%VEMIS2D)
IF (LVEMIS2D) THEN
  !$ACC EXIT DATA DETACH (YD%VEMIS2D)
  DO J1 = LBOUND (YD%VEMIS2D, 1), UBOUND (YD%VEMIS2D, 1)
    CALL WIPE_VARIABLE_2RB (YD%VEMIS2D (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%VEMIS2D)
ENDIF

LVEMIS2DAUX = ALLOCATED (YD%VEMIS2DAUX)
IF (LVEMIS2DAUX) THEN
  !$ACC EXIT DATA DETACH (YD%VEMIS2DAUX)
  DO J1 = LBOUND (YD%VEMIS2DAUX, 1), UBOUND (YD%VEMIS2DAUX, 1)
    CALL WIPE_VARIABLE_2RB (YD%VEMIS2DAUX (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%VEMIS2DAUX)
ENDIF

LF_GROUP = ASSOCIATED (YD%F_GROUP)
IF (LF_GROUP .AND. LLFIELDAPI) THEN
  CALL WIPE_FIELD_3RB (YD%F_GROUP)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE



END MODULE
