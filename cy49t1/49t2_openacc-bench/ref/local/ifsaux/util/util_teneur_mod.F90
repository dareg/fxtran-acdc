MODULE UTIL_TENEUR_MOD

USE YOENEUR, ONLY : TENEUR

INTERFACE SAVE
MODULE PROCEDURE SAVE_TENEUR
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TENEUR
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TENEUR
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TENEUR
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TENEUR
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TENEUR
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TENEUR
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TENEUR (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TENEUR), INTENT (IN), TARGET :: YD
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
WRITE (KLUN) YD%NCOU
WRITE (KLUN) YD%NBR
WRITE (KLUN) YD%NBNEURMAX
WRITE (KLUN) YD%KLEV_NN
LNBNEUR = ALLOCATED (YD%NBNEUR)
WRITE (KLUN) LNBNEUR
IF (LNBNEUR) THEN
  WRITE (KLUN) LBOUND (YD%NBNEUR)
  WRITE (KLUN) UBOUND (YD%NBNEUR)
  WRITE (KLUN) YD%NBNEUR
ENDIF
LWNELN = ALLOCATED (YD%WNELN)
WRITE (KLUN) LWNELN
IF (LWNELN) THEN
  WRITE (KLUN) LBOUND (YD%WNELN)
  WRITE (KLUN) UBOUND (YD%WNELN)
  WRITE (KLUN) YD%WNELN
ENDIF
LENTREEMOY = ALLOCATED (YD%ENTREEMOY)
WRITE (KLUN) LENTREEMOY
IF (LENTREEMOY) THEN
  WRITE (KLUN) LBOUND (YD%ENTREEMOY)
  WRITE (KLUN) UBOUND (YD%ENTREEMOY)
  WRITE (KLUN) YD%ENTREEMOY
ENDIF
LRAPIN = ALLOCATED (YD%RAPIN)
WRITE (KLUN) LRAPIN
IF (LRAPIN) THEN
  WRITE (KLUN) LBOUND (YD%RAPIN)
  WRITE (KLUN) UBOUND (YD%RAPIN)
  WRITE (KLUN) YD%RAPIN
ENDIF
LSORTIEMOY = ALLOCATED (YD%SORTIEMOY)
WRITE (KLUN) LSORTIEMOY
IF (LSORTIEMOY) THEN
  WRITE (KLUN) LBOUND (YD%SORTIEMOY)
  WRITE (KLUN) UBOUND (YD%SORTIEMOY)
  WRITE (KLUN) YD%SORTIEMOY
ENDIF
LRAPOUT = ALLOCATED (YD%RAPOUT)
WRITE (KLUN) LRAPOUT
IF (LRAPOUT) THEN
  WRITE (KLUN) LBOUND (YD%RAPOUT)
  WRITE (KLUN) UBOUND (YD%RAPOUT)
  WRITE (KLUN) YD%RAPOUT
ENDIF
LPDFSDX = ALLOCATED (YD%PDFSDX)
WRITE (KLUN) LPDFSDX
IF (LPDFSDX) THEN
  WRITE (KLUN) LBOUND (YD%PDFSDX)
  WRITE (KLUN) UBOUND (YD%PDFSDX)
  WRITE (KLUN) YD%PDFSDX
ENDIF
LAAM_NN = ALLOCATED (YD%AAM_NN)
WRITE (KLUN) LAAM_NN
IF (LAAM_NN) THEN
  WRITE (KLUN) LBOUND (YD%AAM_NN)
  WRITE (KLUN) UBOUND (YD%AAM_NN)
  WRITE (KLUN) YD%AAM_NN
ENDIF
LBBM_NN = ALLOCATED (YD%BBM_NN)
WRITE (KLUN) LBBM_NN
IF (LBBM_NN) THEN
  WRITE (KLUN) LBOUND (YD%BBM_NN)
  WRITE (KLUN) UBOUND (YD%BBM_NN)
  WRITE (KLUN) YD%BBM_NN
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_TENEUR (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TENEUR), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2), IL4(4), IU4(4)
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP4 (:,:,:,:)
READ (KLUN) YD%NCOU
READ (KLUN) YD%NBR
READ (KLUN) YD%NBNEURMAX
READ (KLUN) YD%KLEV_NN
READ (KLUN) LNBNEUR
IF (LNBNEUR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%NBNEUR (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%NBNEUR
ENDIF
READ (KLUN) LWNELN
IF (LWNELN) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%WNELN (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%WNELN,1):UBOUND(YD%WNELN,1), LBOUND(YD%WNELN,2):UBOUND(YD%WNELN,2), LBOUND(YD%WNELN,3):UBOUND(YD%WNELN,3), LBOUND(YD%WNELN,4):UBOUND(YD%WNELN,4)))
  READ (KLUN) ZTMP4
  YD%WNELN = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LENTREEMOY
IF (LENTREEMOY) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%ENTREEMOY (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%ENTREEMOY,1):UBOUND(YD%ENTREEMOY,1), LBOUND(YD%ENTREEMOY,2):UBOUND(YD%ENTREEMOY,2)))
  READ (KLUN) ZTMP2
  YD%ENTREEMOY = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRAPIN
IF (LRAPIN) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%RAPIN (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%RAPIN,1):UBOUND(YD%RAPIN,1), LBOUND(YD%RAPIN,2):UBOUND(YD%RAPIN,2)))
  READ (KLUN) ZTMP2
  YD%RAPIN = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSORTIEMOY
IF (LSORTIEMOY) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%SORTIEMOY (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%SORTIEMOY,1):UBOUND(YD%SORTIEMOY,1), LBOUND(YD%SORTIEMOY,2):UBOUND(YD%SORTIEMOY,2)))
  READ (KLUN) ZTMP2
  YD%SORTIEMOY = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRAPOUT
IF (LRAPOUT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%RAPOUT (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%RAPOUT,1):UBOUND(YD%RAPOUT,1), LBOUND(YD%RAPOUT,2):UBOUND(YD%RAPOUT,2)))
  READ (KLUN) ZTMP2
  YD%RAPOUT = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LPDFSDX
IF (LPDFSDX) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (YD%PDFSDX (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(YD%PDFSDX,1):UBOUND(YD%PDFSDX,1), LBOUND(YD%PDFSDX,2):UBOUND(YD%PDFSDX,2), LBOUND(YD%PDFSDX,3):UBOUND(YD%PDFSDX,3), LBOUND(YD%PDFSDX,4):UBOUND(YD%PDFSDX,4)))
  READ (KLUN) ZTMP4
  YD%PDFSDX = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LAAM_NN
IF (LAAM_NN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%AAM_NN (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%AAM_NN,1):UBOUND(YD%AAM_NN,1)))
  READ (KLUN) ZTMP1
  YD%AAM_NN = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LBBM_NN
IF (LBBM_NN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%BBM_NN (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%BBM_NN,1):UBOUND(YD%BBM_NN,1)))
  READ (KLUN) ZTMP1
  YD%BBM_NN = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_TENEUR (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TENEUR), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF




LNBNEUR = ALLOCATED (YD%NBNEUR)
IF (LNBNEUR) THEN
  !$ACC ENTER DATA CREATE (YD%NBNEUR)
  !$ACC UPDATE DEVICE (YD%NBNEUR)
  !$ACC ENTER DATA ATTACH (YD%NBNEUR)
ENDIF

LWNELN = ALLOCATED (YD%WNELN)
IF (LWNELN) THEN
  !$ACC ENTER DATA CREATE (YD%WNELN)
  !$ACC UPDATE DEVICE (YD%WNELN)
  !$ACC ENTER DATA ATTACH (YD%WNELN)
ENDIF

LENTREEMOY = ALLOCATED (YD%ENTREEMOY)
IF (LENTREEMOY) THEN
  !$ACC ENTER DATA CREATE (YD%ENTREEMOY)
  !$ACC UPDATE DEVICE (YD%ENTREEMOY)
  !$ACC ENTER DATA ATTACH (YD%ENTREEMOY)
ENDIF

LRAPIN = ALLOCATED (YD%RAPIN)
IF (LRAPIN) THEN
  !$ACC ENTER DATA CREATE (YD%RAPIN)
  !$ACC UPDATE DEVICE (YD%RAPIN)
  !$ACC ENTER DATA ATTACH (YD%RAPIN)
ENDIF

LSORTIEMOY = ALLOCATED (YD%SORTIEMOY)
IF (LSORTIEMOY) THEN
  !$ACC ENTER DATA CREATE (YD%SORTIEMOY)
  !$ACC UPDATE DEVICE (YD%SORTIEMOY)
  !$ACC ENTER DATA ATTACH (YD%SORTIEMOY)
ENDIF

LRAPOUT = ALLOCATED (YD%RAPOUT)
IF (LRAPOUT) THEN
  !$ACC ENTER DATA CREATE (YD%RAPOUT)
  !$ACC UPDATE DEVICE (YD%RAPOUT)
  !$ACC ENTER DATA ATTACH (YD%RAPOUT)
ENDIF

LPDFSDX = ALLOCATED (YD%PDFSDX)
IF (LPDFSDX) THEN
  !$ACC ENTER DATA CREATE (YD%PDFSDX)
  !$ACC UPDATE DEVICE (YD%PDFSDX)
  !$ACC ENTER DATA ATTACH (YD%PDFSDX)
ENDIF

LAAM_NN = ALLOCATED (YD%AAM_NN)
IF (LAAM_NN) THEN
  !$ACC ENTER DATA CREATE (YD%AAM_NN)
  !$ACC UPDATE DEVICE (YD%AAM_NN)
  !$ACC ENTER DATA ATTACH (YD%AAM_NN)
ENDIF

LBBM_NN = ALLOCATED (YD%BBM_NN)
IF (LBBM_NN) THEN
  !$ACC ENTER DATA CREATE (YD%BBM_NN)
  !$ACC UPDATE DEVICE (YD%BBM_NN)
  !$ACC ENTER DATA ATTACH (YD%BBM_NN)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_TENEUR (YD)

IMPLICIT NONE
TYPE (TENEUR), TARGET :: YD
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN













END SUBROUTINE

     

SUBROUTINE CRC64_TENEUR (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TENEUR), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCOU), CDPATH//'%NCOU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NBR), CDPATH//'%NBR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NBNEURMAX), CDPATH//'%NBNEURMAX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KLEV_NN), CDPATH//'%KLEV_NN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NBNEUR), CDPATH//'%NBNEUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%WNELN), CDPATH//'%WNELN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ENTREEMOY), CDPATH//'%ENTREEMOY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RAPIN), CDPATH//'%RAPIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SORTIEMOY), CDPATH//'%SORTIEMOY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RAPOUT), CDPATH//'%RAPOUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%PDFSDX), CDPATH//'%PDFSDX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%AAM_NN), CDPATH//'%AAM_NN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%BBM_NN), CDPATH//'%BBM_NN'

END SUBROUTINE

SUBROUTINE WIPE_TENEUR (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TENEUR), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF




LNBNEUR = ALLOCATED (YD%NBNEUR)
IF (LNBNEUR) THEN
  !$ACC EXIT DATA DETACH (YD%NBNEUR)
  !$ACC EXIT DATA DETACH (YD%NBNEUR)
ENDIF

LWNELN = ALLOCATED (YD%WNELN)
IF (LWNELN) THEN
  !$ACC EXIT DATA DETACH (YD%WNELN)
  !$ACC EXIT DATA DETACH (YD%WNELN)
ENDIF

LENTREEMOY = ALLOCATED (YD%ENTREEMOY)
IF (LENTREEMOY) THEN
  !$ACC EXIT DATA DETACH (YD%ENTREEMOY)
  !$ACC EXIT DATA DETACH (YD%ENTREEMOY)
ENDIF

LRAPIN = ALLOCATED (YD%RAPIN)
IF (LRAPIN) THEN
  !$ACC EXIT DATA DETACH (YD%RAPIN)
  !$ACC EXIT DATA DETACH (YD%RAPIN)
ENDIF

LSORTIEMOY = ALLOCATED (YD%SORTIEMOY)
IF (LSORTIEMOY) THEN
  !$ACC EXIT DATA DETACH (YD%SORTIEMOY)
  !$ACC EXIT DATA DETACH (YD%SORTIEMOY)
ENDIF

LRAPOUT = ALLOCATED (YD%RAPOUT)
IF (LRAPOUT) THEN
  !$ACC EXIT DATA DETACH (YD%RAPOUT)
  !$ACC EXIT DATA DETACH (YD%RAPOUT)
ENDIF

LPDFSDX = ALLOCATED (YD%PDFSDX)
IF (LPDFSDX) THEN
  !$ACC EXIT DATA DETACH (YD%PDFSDX)
  !$ACC EXIT DATA DETACH (YD%PDFSDX)
ENDIF

LAAM_NN = ALLOCATED (YD%AAM_NN)
IF (LAAM_NN) THEN
  !$ACC EXIT DATA DETACH (YD%AAM_NN)
  !$ACC EXIT DATA DETACH (YD%AAM_NN)
ENDIF

LBBM_NN = ALLOCATED (YD%BBM_NN)
IF (LBBM_NN) THEN
  !$ACC EXIT DATA DETACH (YD%BBM_NN)
  !$ACC EXIT DATA DETACH (YD%BBM_NN)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TENEUR (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TENEUR),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%NCOU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCOU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NBR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NBR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NBNEURMAX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NBNEURMAX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%KLEV_NN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KLEV_NN'
ENDIF
KSIZE = KSIZE + ISIZE
LNBNEUR = ALLOCATED (YD%NBNEUR)
IF (LNBNEUR) THEN
  ISIZE = KIND (YD%NBNEUR) * SIZE (YD%NBNEUR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NBNEUR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LWNELN = ALLOCATED (YD%WNELN)
IF (LWNELN) THEN
  ISIZE = KIND (YD%WNELN) * SIZE (YD%WNELN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%WNELN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LENTREEMOY = ALLOCATED (YD%ENTREEMOY)
IF (LENTREEMOY) THEN
  ISIZE = KIND (YD%ENTREEMOY) * SIZE (YD%ENTREEMOY)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%ENTREEMOY'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRAPIN = ALLOCATED (YD%RAPIN)
IF (LRAPIN) THEN
  ISIZE = KIND (YD%RAPIN) * SIZE (YD%RAPIN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RAPIN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSORTIEMOY = ALLOCATED (YD%SORTIEMOY)
IF (LSORTIEMOY) THEN
  ISIZE = KIND (YD%SORTIEMOY) * SIZE (YD%SORTIEMOY)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SORTIEMOY'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRAPOUT = ALLOCATED (YD%RAPOUT)
IF (LRAPOUT) THEN
  ISIZE = KIND (YD%RAPOUT) * SIZE (YD%RAPOUT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RAPOUT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LPDFSDX = ALLOCATED (YD%PDFSDX)
IF (LPDFSDX) THEN
  ISIZE = KIND (YD%PDFSDX) * SIZE (YD%PDFSDX)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%PDFSDX'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LAAM_NN = ALLOCATED (YD%AAM_NN)
IF (LAAM_NN) THEN
  ISIZE = KIND (YD%AAM_NN) * SIZE (YD%AAM_NN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%AAM_NN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LBBM_NN = ALLOCATED (YD%BBM_NN)
IF (LBBM_NN) THEN
  ISIZE = KIND (YD%BBM_NN) * SIZE (YD%BBM_NN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%BBM_NN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
