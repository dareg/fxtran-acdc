MODULE UTIL_TEAERATM_MOD

USE YOEAERATM, ONLY : TEAERATM

INTERFACE SAVE
MODULE PROCEDURE SAVE_TEAERATM
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TEAERATM
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TEAERATM
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TEAERATM
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TEAERATM
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TEAERATM
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TEAERATM
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TEAERATM (KLUN, YD)
USE UTIL_TYPE_AERO_DESC_MOD
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TEAERATM), INTENT (IN), TARGET :: YD
INTEGER :: J1
LOGICAL :: LYAERO_DESC
WRITE (KLUN) YD%NAERCONF
WRITE (KLUN) YD%NINIDAY
WRITE (KLUN) YD%NXT3DAER
WRITE (KLUN) YD%NDD1
WRITE (KLUN) YD%NSS1
WRITE (KLUN) YD%NBCOPTP
WRITE (KLUN) YD%NDDOPTP
WRITE (KLUN) YD%NOMOPTP
WRITE (KLUN) YD%NSSOPTP
WRITE (KLUN) YD%NSUOPTP
WRITE (KLUN) YD%NVISWL
WRITE (KLUN) YD%NTAER
WRITE (KLUN) YD%NTYPAER
WRITE (KLUN) YD%NAER_BLNUCL
WRITE (KLUN) YD%NAERSCAV
WRITE (KLUN) YD%ITLISTWAVLCPL
WRITE (KLUN) YD%RGRATE
WRITE (KLUN) YD%REPSCAER
WRITE (KLUN) YD%LAERCLIMG
WRITE (KLUN) YD%LAERCLIMZ
WRITE (KLUN) YD%LAERCLIST
WRITE (KLUN) YD%LAERDRYDP
WRITE (KLUN) YD%LAERHYGRO
WRITE (KLUN) YD%LAERLISI
WRITE (KLUN) YD%LAERNGAT
WRITE (KLUN) YD%LAERSEDIM
WRITE (KLUN) YD%LAERSURF
WRITE (KLUN) YD%LAERELVS
WRITE (KLUN) YD%LAER6SDIA
WRITE (KLUN) YD%LAERSEDIMSS
WRITE (KLUN) YD%LAERGTOP
WRITE (KLUN) YD%LAERRAD
WRITE (KLUN) YD%LAERCCN
WRITE (KLUN) YD%LAEROPT
WRITE (KLUN) YD%LAERINIT
WRITE (KLUN) YD%LAERVOL
WRITE (KLUN) YD%LAERCSTR
WRITE (KLUN) YD%LAERDIAG1
WRITE (KLUN) YD%LAERDIAG2
WRITE (KLUN) YD%LAERRRTM
WRITE (KLUN) YD%LAERUVP
WRITE (KLUN) YD%LAEREXTR
WRITE (KLUN) YD%LAERGBUD
WRITE (KLUN) YD%LAERPRNT
WRITE (KLUN) YD%LAERNITRATE
WRITE (KLUN) YD%LAERRADCPL
WRITE (KLUN) YD%LSEASALT_RH80
WRITE (KLUN) YD%LAERDUSTSOURCE
WRITE (KLUN) YD%LAERDUSTSIZEVAR
WRITE (KLUN) YD%LAERDUST_NEWBIN
WRITE (KLUN) YD%LWAVLOUT
WRITE (KLUN) YD%RSS_DRY_DIAFAC
WRITE (KLUN) YD%RSS_DRY_DENSFAC
WRITE (KLUN) YD%RSS_DRY_MASSFAC
WRITE (KLUN) YD%RSS_RH80_DIAFAC
WRITE (KLUN) YD%RSS_RH80_DENSFAC
WRITE (KLUN) YD%RSS_RH80_MASSFAC
WRITE (KLUN) YD%RAERDUST_REBOUND
LYAERO_DESC = ASSOCIATED (YD%YAERO_DESC)
WRITE (KLUN) LYAERO_DESC
IF (LYAERO_DESC) THEN
  WRITE (KLUN) LBOUND (YD%YAERO_DESC)
  WRITE (KLUN) UBOUND (YD%YAERO_DESC)
  DO J1 = LBOUND (YD%YAERO_DESC, 1), UBOUND (YD%YAERO_DESC, 1)
    CALL SAVE_TYPE_AERO_DESC (KLUN, YD%YAERO_DESC (J1))
  ENDDO
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_TEAERATM (KLUN, YD)
USE UTIL_TYPE_AERO_DESC_MOD
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TEAERATM), INTENT (OUT), TARGET :: YD
INTEGER :: J1
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LYAERO_DESC
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) YD%NAERCONF
READ (KLUN) YD%NINIDAY
READ (KLUN) YD%NXT3DAER
READ (KLUN) YD%NDD1
READ (KLUN) YD%NSS1
READ (KLUN) YD%NBCOPTP
READ (KLUN) YD%NDDOPTP
READ (KLUN) YD%NOMOPTP
READ (KLUN) YD%NSSOPTP
READ (KLUN) YD%NSUOPTP
READ (KLUN) YD%NVISWL
READ (KLUN) YD%NTAER
READ (KLUN) YD%NTYPAER
READ (KLUN) YD%NAER_BLNUCL
READ (KLUN) YD%NAERSCAV
READ (KLUN) YD%ITLISTWAVLCPL
READ (KLUN) ZTMP0
YD%RGRATE = ZTMP0
READ (KLUN) ZTMP0
YD%REPSCAER = ZTMP0
READ (KLUN) YD%LAERCLIMG
READ (KLUN) YD%LAERCLIMZ
READ (KLUN) YD%LAERCLIST
READ (KLUN) YD%LAERDRYDP
READ (KLUN) YD%LAERHYGRO
READ (KLUN) YD%LAERLISI
READ (KLUN) YD%LAERNGAT
READ (KLUN) YD%LAERSEDIM
READ (KLUN) YD%LAERSURF
READ (KLUN) YD%LAERELVS
READ (KLUN) YD%LAER6SDIA
READ (KLUN) YD%LAERSEDIMSS
READ (KLUN) YD%LAERGTOP
READ (KLUN) YD%LAERRAD
READ (KLUN) YD%LAERCCN
READ (KLUN) YD%LAEROPT
READ (KLUN) YD%LAERINIT
READ (KLUN) YD%LAERVOL
READ (KLUN) YD%LAERCSTR
READ (KLUN) YD%LAERDIAG1
READ (KLUN) YD%LAERDIAG2
READ (KLUN) YD%LAERRRTM
READ (KLUN) YD%LAERUVP
READ (KLUN) YD%LAEREXTR
READ (KLUN) YD%LAERGBUD
READ (KLUN) YD%LAERPRNT
READ (KLUN) YD%LAERNITRATE
READ (KLUN) YD%LAERRADCPL
READ (KLUN) YD%LSEASALT_RH80
READ (KLUN) YD%LAERDUSTSOURCE
READ (KLUN) YD%LAERDUSTSIZEVAR
READ (KLUN) YD%LAERDUST_NEWBIN
READ (KLUN) YD%LWAVLOUT
READ (KLUN) ZTMP0
YD%RSS_DRY_DIAFAC = ZTMP0
READ (KLUN) ZTMP0
YD%RSS_DRY_DENSFAC = ZTMP0
READ (KLUN) ZTMP0
YD%RSS_DRY_MASSFAC = ZTMP0
READ (KLUN) ZTMP0
YD%RSS_RH80_DIAFAC = ZTMP0
READ (KLUN) ZTMP0
YD%RSS_RH80_DENSFAC = ZTMP0
READ (KLUN) ZTMP0
YD%RSS_RH80_MASSFAC = ZTMP0
READ (KLUN) ZTMP0
YD%RAERDUST_REBOUND = ZTMP0
READ (KLUN) LYAERO_DESC
IF (LYAERO_DESC) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%YAERO_DESC (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%YAERO_DESC, 1), UBOUND (YD%YAERO_DESC, 1)
    CALL LOAD_TYPE_AERO_DESC (KLUN, YD%YAERO_DESC (J1))
  ENDDO
ELSE
  NULLIFY (YD%YAERO_DESC)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_TEAERATM (YD, LDCREATED, LDFIELDAPI)
USE UTIL_TYPE_AERO_DESC_MOD
IMPLICIT NONE
TYPE (TEAERATM), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LYAERO_DESC

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF


























































LYAERO_DESC = ASSOCIATED (YD%YAERO_DESC)
IF (LYAERO_DESC) THEN
  !$ACC ENTER DATA CREATE (YD%YAERO_DESC)
  !$ACC UPDATE DEVICE (YD%YAERO_DESC)
  DO J1 = LBOUND (YD%YAERO_DESC, 1), UBOUND (YD%YAERO_DESC, 1)
    CALL COPY_TYPE_AERO_DESC (YD%YAERO_DESC (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%YAERO_DESC)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_TEAERATM (YD)
USE UTIL_TYPE_AERO_DESC_MOD

IMPLICIT NONE
TYPE (TEAERATM), TARGET :: YD
INTEGER :: J1
LOGICAL :: LYAERO_DESC


























































LYAERO_DESC = ASSOCIATED (YD%YAERO_DESC)
IF (LYAERO_DESC) THEN
  DO J1 = LBOUND (YD%YAERO_DESC, 1), UBOUND (YD%YAERO_DESC, 1)
    CALL HOST_TYPE_AERO_DESC (YD%YAERO_DESC (J1))
  ENDDO
ENDIF

END SUBROUTINE

     

SUBROUTINE CRC64_TEAERATM (YD, KLUN, CDPATH)
USE UTIL_TYPE_AERO_DESC_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TEAERATM), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
INTEGER :: J1
LOGICAL :: LYAERO_DESC
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NAERCONF), CDPATH//'%NAERCONF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NINIDAY), CDPATH//'%NINIDAY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NXT3DAER), CDPATH//'%NXT3DAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDD1), CDPATH//'%NDD1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSS1), CDPATH//'%NSS1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NBCOPTP), CDPATH//'%NBCOPTP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDDOPTP), CDPATH//'%NDDOPTP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NOMOPTP), CDPATH//'%NOMOPTP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSSOPTP), CDPATH//'%NSSOPTP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSUOPTP), CDPATH//'%NSUOPTP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NVISWL), CDPATH//'%NVISWL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTAER), CDPATH//'%NTAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTYPAER), CDPATH//'%NTYPAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NAER_BLNUCL), CDPATH//'%NAER_BLNUCL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NAERSCAV), CDPATH//'%NAERSCAV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ITLISTWAVLCPL), CDPATH//'%ITLISTWAVLCPL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RGRATE), CDPATH//'%RGRATE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%REPSCAER), CDPATH//'%REPSCAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERCLIMG), CDPATH//'%LAERCLIMG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERCLIMZ), CDPATH//'%LAERCLIMZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERCLIST), CDPATH//'%LAERCLIST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERDRYDP), CDPATH//'%LAERDRYDP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERHYGRO), CDPATH//'%LAERHYGRO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERLISI), CDPATH//'%LAERLISI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERNGAT), CDPATH//'%LAERNGAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERSEDIM), CDPATH//'%LAERSEDIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERSURF), CDPATH//'%LAERSURF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERELVS), CDPATH//'%LAERELVS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAER6SDIA), CDPATH//'%LAER6SDIA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERSEDIMSS), CDPATH//'%LAERSEDIMSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERGTOP), CDPATH//'%LAERGTOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERRAD), CDPATH//'%LAERRAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERCCN), CDPATH//'%LAERCCN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAEROPT), CDPATH//'%LAEROPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERINIT), CDPATH//'%LAERINIT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERVOL), CDPATH//'%LAERVOL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERCSTR), CDPATH//'%LAERCSTR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERDIAG1), CDPATH//'%LAERDIAG1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERDIAG2), CDPATH//'%LAERDIAG2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERRRTM), CDPATH//'%LAERRRTM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERUVP), CDPATH//'%LAERUVP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAEREXTR), CDPATH//'%LAEREXTR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERGBUD), CDPATH//'%LAERGBUD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERPRNT), CDPATH//'%LAERPRNT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERNITRATE), CDPATH//'%LAERNITRATE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERRADCPL), CDPATH//'%LAERRADCPL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSEASALT_RH80), CDPATH//'%LSEASALT_RH80'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERDUSTSOURCE), CDPATH//'%LAERDUSTSOURCE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERDUSTSIZEVAR), CDPATH//'%LAERDUSTSIZEVAR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERDUST_NEWBIN), CDPATH//'%LAERDUST_NEWBIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LWAVLOUT), CDPATH//'%LWAVLOUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSS_DRY_DIAFAC), CDPATH//'%RSS_DRY_DIAFAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSS_DRY_DENSFAC), CDPATH//'%RSS_DRY_DENSFAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSS_DRY_MASSFAC), CDPATH//'%RSS_DRY_MASSFAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSS_RH80_DIAFAC), CDPATH//'%RSS_RH80_DIAFAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSS_RH80_DENSFAC), CDPATH//'%RSS_RH80_DENSFAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSS_RH80_MASSFAC), CDPATH//'%RSS_RH80_MASSFAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RAERDUST_REBOUND), CDPATH//'%RAERDUST_REBOUND'

LYAERO_DESC = ASSOCIATED (YD%YAERO_DESC)
IF (LYAERO_DESC) THEN
  DO J1 = LBOUND (YD%YAERO_DESC, 1), UBOUND (YD%YAERO_DESC, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_TYPE_AERO_DESC (YD%YAERO_DESC (J1), KLUN, CDPATH//'%YAERO_DESC'//TRIM(CLIND))
  ENDDO
ENDIF

END SUBROUTINE

SUBROUTINE WIPE_TEAERATM (YD, LDDELETED, LDFIELDAPI)
USE UTIL_TYPE_AERO_DESC_MOD
IMPLICIT NONE
TYPE (TEAERATM), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LYAERO_DESC

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF


























































LYAERO_DESC = ASSOCIATED (YD%YAERO_DESC)
IF (LYAERO_DESC) THEN
  !$ACC EXIT DATA DETACH (YD%YAERO_DESC)
  DO J1 = LBOUND (YD%YAERO_DESC, 1), UBOUND (YD%YAERO_DESC, 1)
    CALL WIPE_TYPE_AERO_DESC (YD%YAERO_DESC (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%YAERO_DESC)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TEAERATM (YD, CDPATH, LDPRINT) RESULT (KSIZE)
USE UTIL_TYPE_AERO_DESC_MOD
IMPLICIT NONE
TYPE (TEAERATM),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
INTEGER :: J1
LOGICAL :: LYAERO_DESC

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%NAERCONF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NAERCONF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NINIDAY)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NINIDAY'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NXT3DAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NXT3DAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDD1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDD1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSS1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSS1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NBCOPTP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NBCOPTP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDDOPTP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDDOPTP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NOMOPTP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NOMOPTP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSSOPTP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSSOPTP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSUOPTP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSUOPTP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NVISWL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVISWL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTYPAER) * SIZE (YD%NTYPAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTYPAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NAER_BLNUCL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NAER_BLNUCL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NAERSCAV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NAERSCAV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ITLISTWAVLCPL) * SIZE (YD%ITLISTWAVLCPL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ITLISTWAVLCPL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RGRATE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RGRATE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%REPSCAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%REPSCAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERCLIMG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERCLIMG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERCLIMZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERCLIMZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERCLIST)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERCLIST'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERDRYDP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERDRYDP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERHYGRO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERHYGRO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERLISI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERLISI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERNGAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERNGAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERSEDIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERSEDIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERSURF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERSURF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERELVS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERELVS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAER6SDIA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAER6SDIA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERSEDIMSS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERSEDIMSS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERGTOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERGTOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERRAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERRAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERCCN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERCCN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAEROPT) * SIZE (YD%LAEROPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAEROPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERINIT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERINIT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERVOL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERVOL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERCSTR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERCSTR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERDIAG1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERDIAG1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERDIAG2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERDIAG2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERRRTM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERRRTM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERUVP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERUVP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAEREXTR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAEREXTR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERGBUD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERGBUD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERPRNT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERPRNT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERNITRATE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERNITRATE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERRADCPL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERRADCPL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSEASALT_RH80)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSEASALT_RH80'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERDUSTSOURCE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERDUSTSOURCE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERDUSTSIZEVAR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERDUSTSIZEVAR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERDUST_NEWBIN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERDUST_NEWBIN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LWAVLOUT) * SIZE (YD%LWAVLOUT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWAVLOUT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSS_DRY_DIAFAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSS_DRY_DIAFAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSS_DRY_DENSFAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSS_DRY_DENSFAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSS_DRY_MASSFAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSS_DRY_MASSFAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSS_RH80_DIAFAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSS_RH80_DIAFAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSS_RH80_DENSFAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSS_RH80_DENSFAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSS_RH80_MASSFAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSS_RH80_MASSFAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RAERDUST_REBOUND)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAERDUST_REBOUND'
ENDIF
KSIZE = KSIZE + ISIZE
LYAERO_DESC = ASSOCIATED (YD%YAERO_DESC)
IF (LYAERO_DESC) THEN
  JSIZE = 0
  DO J1 = LBOUND (YD%YAERO_DESC, 1), UBOUND (YD%YAERO_DESC, 1)
    ISIZE = SIZE_TYPE_AERO_DESC (YD%YAERO_DESC (J1), CLPATH//'%YAERO_DESC', .FALSE.)
    JSIZE = JSIZE + ISIZE
    KSIZE = KSIZE + ISIZE
  ENDDO
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
    WRITE (*, *) TRIM (CLPATH)//'%YAERO_DESC'
  ENDIF
ENDIF
END FUNCTION

END MODULE
