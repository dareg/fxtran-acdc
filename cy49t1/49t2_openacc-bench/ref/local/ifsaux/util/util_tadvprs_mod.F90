MODULE UTIL_TADVPRS_MOD

USE YOMPHY0, ONLY : TADVPRS

INTERFACE SAVE
MODULE PROCEDURE SAVE_TADVPRS
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TADVPRS
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TADVPRS
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TADVPRS
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TADVPRS
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TADVPRS
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TADVPRS
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TADVPRS (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TADVPRS), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%LLMELTS
WRITE (KLUN) YD%LLFREEZ
WRITE (KLUN) YD%LLEVAPX
WRITE (KLUN) YD%ZEPS
WRITE (KLUN) YD%ZNU1
WRITE (KLUN) YD%ZNU2
WRITE (KLUN) YD%ZTAU1
WRITE (KLUN) YD%ZTAU2
WRITE (KLUN) YD%ZSIGMA1
WRITE (KLUN) YD%ZSIGMA2
WRITE (KLUN) YD%ZFVENTR1
WRITE (KLUN) YD%ZFVENTR2
WRITE (KLUN) YD%ZFVENTS1
WRITE (KLUN) YD%ZFVENTS2
WRITE (KLUN) YD%ZFVELR
WRITE (KLUN) YD%ZFVELS
WRITE (KLUN) YD%ZTMELT
WRITE (KLUN) YD%ZRHOW
WRITE (KLUN) YD%ZNRHOW
WRITE (KLUN) YD%ZDVISC
WRITE (KLUN) YD%ZSQTVIS
WRITE (KLUN) YD%ZCDARV
WRITE (KLUN) YD%ZRHOREF
WRITE (KLUN) YD%ZEXP1
WRITE (KLUN) YD%ZEXP4
WRITE (KLUN) YD%ZEXP6
WRITE (KLUN) YD%ZPREF
WRITE (KLUN) YD%ZCOEFF1
WRITE (KLUN) YD%ZCOEFF2
WRITE (KLUN) YD%ZCOEFF2B
WRITE (KLUN) YD%ZCOEFF3
WRITE (KLUN) YD%ZCOEFF4
WRITE (KLUN) YD%ZCOEFF5
WRITE (KLUN) YD%ZCOEFF6
END SUBROUTINE

SUBROUTINE LOAD_TADVPRS (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TADVPRS), INTENT (OUT), TARGET :: YD
REAL(KIND=JPRD) :: ZTMP0
READ (KLUN) YD%LLMELTS
READ (KLUN) YD%LLFREEZ
READ (KLUN) YD%LLEVAPX
READ (KLUN) ZTMP0
YD%ZEPS = ZTMP0
READ (KLUN) ZTMP0
YD%ZNU1 = ZTMP0
READ (KLUN) ZTMP0
YD%ZNU2 = ZTMP0
READ (KLUN) ZTMP0
YD%ZTAU1 = ZTMP0
READ (KLUN) ZTMP0
YD%ZTAU2 = ZTMP0
READ (KLUN) ZTMP0
YD%ZSIGMA1 = ZTMP0
READ (KLUN) ZTMP0
YD%ZSIGMA2 = ZTMP0
READ (KLUN) ZTMP0
YD%ZFVENTR1 = ZTMP0
READ (KLUN) ZTMP0
YD%ZFVENTR2 = ZTMP0
READ (KLUN) ZTMP0
YD%ZFVENTS1 = ZTMP0
READ (KLUN) ZTMP0
YD%ZFVENTS2 = ZTMP0
READ (KLUN) ZTMP0
YD%ZFVELR = ZTMP0
READ (KLUN) ZTMP0
YD%ZFVELS = ZTMP0
READ (KLUN) ZTMP0
YD%ZTMELT = ZTMP0
READ (KLUN) ZTMP0
YD%ZRHOW = ZTMP0
READ (KLUN) ZTMP0
YD%ZNRHOW = ZTMP0
READ (KLUN) ZTMP0
YD%ZDVISC = ZTMP0
READ (KLUN) ZTMP0
YD%ZSQTVIS = ZTMP0
READ (KLUN) ZTMP0
YD%ZCDARV = ZTMP0
READ (KLUN) ZTMP0
YD%ZRHOREF = ZTMP0
READ (KLUN) ZTMP0
YD%ZEXP1 = ZTMP0
READ (KLUN) ZTMP0
YD%ZEXP4 = ZTMP0
READ (KLUN) ZTMP0
YD%ZEXP6 = ZTMP0
READ (KLUN) ZTMP0
YD%ZPREF = ZTMP0
READ (KLUN) ZTMP0
YD%ZCOEFF1 = ZTMP0
READ (KLUN) ZTMP0
YD%ZCOEFF2 = ZTMP0
READ (KLUN) ZTMP0
YD%ZCOEFF2B = ZTMP0
READ (KLUN) ZTMP0
YD%ZCOEFF3 = ZTMP0
READ (KLUN) ZTMP0
YD%ZCOEFF4 = ZTMP0
READ (KLUN) ZTMP0
YD%ZCOEFF5 = ZTMP0
READ (KLUN) ZTMP0
YD%ZCOEFF6 = ZTMP0
END SUBROUTINE


SUBROUTINE COPY_TADVPRS (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TADVPRS), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF


































END SUBROUTINE

SUBROUTINE HOST_TADVPRS (YD)

IMPLICIT NONE
TYPE (TADVPRS), TARGET :: YD



































END SUBROUTINE

     

SUBROUTINE CRC64_TADVPRS (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TADVPRS), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LLMELTS), CDPATH//'%LLMELTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LLFREEZ), CDPATH//'%LLFREEZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LLEVAPX), CDPATH//'%LLEVAPX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZEPS), CDPATH//'%ZEPS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZNU1), CDPATH//'%ZNU1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZNU2), CDPATH//'%ZNU2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZTAU1), CDPATH//'%ZTAU1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZTAU2), CDPATH//'%ZTAU2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZSIGMA1), CDPATH//'%ZSIGMA1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZSIGMA2), CDPATH//'%ZSIGMA2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZFVENTR1), CDPATH//'%ZFVENTR1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZFVENTR2), CDPATH//'%ZFVENTR2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZFVENTS1), CDPATH//'%ZFVENTS1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZFVENTS2), CDPATH//'%ZFVENTS2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZFVELR), CDPATH//'%ZFVELR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZFVELS), CDPATH//'%ZFVELS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZTMELT), CDPATH//'%ZTMELT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZRHOW), CDPATH//'%ZRHOW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZNRHOW), CDPATH//'%ZNRHOW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZDVISC), CDPATH//'%ZDVISC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZSQTVIS), CDPATH//'%ZSQTVIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZCDARV), CDPATH//'%ZCDARV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZRHOREF), CDPATH//'%ZRHOREF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZEXP1), CDPATH//'%ZEXP1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZEXP4), CDPATH//'%ZEXP4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZEXP6), CDPATH//'%ZEXP6'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZPREF), CDPATH//'%ZPREF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZCOEFF1), CDPATH//'%ZCOEFF1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZCOEFF2), CDPATH//'%ZCOEFF2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZCOEFF2B), CDPATH//'%ZCOEFF2B'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZCOEFF3), CDPATH//'%ZCOEFF3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZCOEFF4), CDPATH//'%ZCOEFF4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZCOEFF5), CDPATH//'%ZCOEFF5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZCOEFF6), CDPATH//'%ZCOEFF6'

END SUBROUTINE

SUBROUTINE WIPE_TADVPRS (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TADVPRS), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF


































LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TADVPRS (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TADVPRS),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%LLMELTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LLMELTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LLFREEZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LLFREEZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LLEVAPX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LLEVAPX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZEPS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZEPS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZNU1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZNU1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZNU2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZNU2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZTAU1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZTAU1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZTAU2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZTAU2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZSIGMA1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZSIGMA1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZSIGMA2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZSIGMA2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZFVENTR1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVENTR1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZFVENTR2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVENTR2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZFVENTS1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVENTS1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZFVENTS2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVENTS2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZFVELR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVELR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZFVELS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZFVELS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZTMELT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZTMELT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZRHOW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZRHOW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZNRHOW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZNRHOW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZDVISC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZDVISC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZSQTVIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZSQTVIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZCDARV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCDARV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZRHOREF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZRHOREF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZEXP1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZEXP1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZEXP4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZEXP4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZEXP6)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZEXP6'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZPREF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZPREF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZCOEFF1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZCOEFF2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZCOEFF2B)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF2B'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZCOEFF3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF3'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZCOEFF4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZCOEFF5)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF5'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ZCOEFF6)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ZCOEFF6'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
