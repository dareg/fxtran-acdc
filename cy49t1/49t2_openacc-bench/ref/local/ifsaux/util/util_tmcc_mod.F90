MODULE UTIL_TMCC_MOD

USE YOMMCC, ONLY : TMCC

INTERFACE SAVE
MODULE PROCEDURE SAVE_TMCC
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TMCC
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TMCC
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TMCC
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TMCC
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TMCC
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TMCC
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TMCC (KLUN, YD)
USE UTIL_CPLNG_FLD_TYPE_MOD
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TMCC), INTENT (IN), TARGET :: YD
INTEGER :: J1
LOGICAL :: LCLIMR, LCLIMRAER, LCLIMRCO2, LCLIMRCOMPO, LCPLNG_FLD, LOCEANBC, LPARTMASK, LPARTSST0, LRNEMOLVLS, LRNEMOMASK
LOGICAL :: LZLAKE
WRITE (KLUN) YD%N923
WRITE (KLUN) YD%NCLIMTOT
WRITE (KLUN) YD%NCLIMR
WRITE (KLUN) YD%NCLIGC
WRITE (KLUN) YD%NCLIGC_COMPO
WRITE (KLUN) YD%NYSDMP_COMPO
WRITE (KLUN) YD%NCLIMR_COMPO
WRITE (KLUN) YD%NCLIAER
WRITE (KLUN) YD%NDIFC
WRITE (KLUN) YD%NJDCR
WRITE (KLUN) YD%NJDCR1
WRITE (KLUN) YD%NDIFC_COMPO
WRITE (KLUN) YD%NJDCR_COMPO
WRITE (KLUN) YD%NJDCR1_COMPO
WRITE (KLUN) YD%NP1
WRITE (KLUN) YD%NP2
WRITE (KLUN) YD%NPCO2_1
WRITE (KLUN) YD%NPCO2_2
WRITE (KLUN) YD%NPAER_1
WRITE (KLUN) YD%NPAER_2
WRITE (KLUN) YD%NPCOMPO_1
WRITE (KLUN) YD%NPCOMPO_2
WRITE (KLUN) YD%NUNITC
WRITE (KLUN) YD%NUNITC1
WRITE (KLUN) YD%NUNITCM
WRITE (KLUN) YD%NOACOMM
WRITE (KLUN) YD%NSSTICEOP
LCLIMRCO2 = ALLOCATED (YD%CLIMRCO2)
WRITE (KLUN) LCLIMRCO2
IF (LCLIMRCO2) THEN
  WRITE (KLUN) LBOUND (YD%CLIMRCO2)
  WRITE (KLUN) UBOUND (YD%CLIMRCO2)
  WRITE (KLUN) YD%CLIMRCO2
ENDIF
LCLIMRAER = ALLOCATED (YD%CLIMRAER)
WRITE (KLUN) LCLIMRAER
IF (LCLIMRAER) THEN
  WRITE (KLUN) LBOUND (YD%CLIMRAER)
  WRITE (KLUN) UBOUND (YD%CLIMRAER)
  WRITE (KLUN) YD%CLIMRAER
ENDIF
LCLIMRCOMPO = ALLOCATED (YD%CLIMRCOMPO)
WRITE (KLUN) LCLIMRCOMPO
IF (LCLIMRCOMPO) THEN
  WRITE (KLUN) LBOUND (YD%CLIMRCOMPO)
  WRITE (KLUN) UBOUND (YD%CLIMRCOMPO)
  WRITE (KLUN) YD%CLIMRCOMPO
ENDIF
LZLAKE = ALLOCATED (YD%ZLAKE)
WRITE (KLUN) LZLAKE
IF (LZLAKE) THEN
  WRITE (KLUN) LBOUND (YD%ZLAKE)
  WRITE (KLUN) UBOUND (YD%ZLAKE)
  WRITE (KLUN) YD%ZLAKE
ENDIF
LOCEANBC = ALLOCATED (YD%OCEANBC)
WRITE (KLUN) LOCEANBC
IF (LOCEANBC) THEN
  WRITE (KLUN) LBOUND (YD%OCEANBC)
  WRITE (KLUN) UBOUND (YD%OCEANBC)
  WRITE (KLUN) YD%OCEANBC
ENDIF
LCLIMR = ALLOCATED (YD%CLIMR)
WRITE (KLUN) LCLIMR
IF (LCLIMR) THEN
  WRITE (KLUN) LBOUND (YD%CLIMR)
  WRITE (KLUN) UBOUND (YD%CLIMR)
  WRITE (KLUN) YD%CLIMR
ENDIF
WRITE (KLUN) YD%LFIRSTUPD
WRITE (KLUN) YD%LCURR
WRITE (KLUN) YD%LGELATO
WRITE (KLUN) YD%LMCC01_MSE
WRITE (KLUN) YD%LMCC01
WRITE (KLUN) YD%LMCC02
WRITE (KLUN) YD%LMCC03
WRITE (KLUN) YD%LMCC04
WRITE (KLUN) YD%LMCC05
WRITE (KLUN) YD%LMCC06
WRITE (KLUN) YD%LMCCEC
WRITE (KLUN) YD%LMCCIEC
WRITE (KLUN) YD%LMCCIEC_COMPO
WRITE (KLUN) YD%LMCCICEIC
WRITE (KLUN) YD%LMCCDYNSEAICE
WRITE (KLUN) YD%LNEMOCOUP
WRITE (KLUN) YD%LNEMOFLUXNC
WRITE (KLUN) YD%LNEMOOUTGRB
WRITE (KLUN) YD%LCOUPINFOUT
WRITE (KLUN) YD%LNEMO1WAY
WRITE (KLUN) YD%LNEMOIFSLOG
WRITE (KLUN) YD%LNEMOSSTFREEZ
WRITE (KLUN) YD%LNEMOGRIBFLDS
WRITE (KLUN) YD%LNEMOGRIBMASK
WRITE (KLUN) YD%L2DECV2NEMO
WRITE (KLUN) YD%LMULTIYR
WRITE (KLUN) YD%LMCC_COMPO
WRITE (KLUN) YD%NFRCPL
WRITE (KLUN) YD%LNEMOLIMGET
WRITE (KLUN) YD%LNEMOLIMPUT
WRITE (KLUN) YD%LNEMOLIMALB
WRITE (KLUN) YD%LNEMOLIMTEMP
WRITE (KLUN) YD%LNEMOLIMTLVL
WRITE (KLUN) YD%LNEMOLIMTHK
WRITE (KLUN) YD%LNEMOSICOUP
WRITE (KLUN) YD%LNEMOATMFLDS
WRITE (KLUN) YD%LNEMOOCEICEMIX
WRITE (KLUN) YD%LNEMOQNSICEFILT
WRITE (KLUN) YD%LNEMOACCUMFLUX
WRITE (KLUN) YD%LNEMOGRIB3D
WRITE (KLUN) YD%NNEMO3DLEVS
LRNEMOLVLS = ALLOCATED (YD%RNEMOLVLS)
WRITE (KLUN) LRNEMOLVLS
IF (LRNEMOLVLS) THEN
  WRITE (KLUN) LBOUND (YD%RNEMOLVLS)
  WRITE (KLUN) UBOUND (YD%RNEMOLVLS)
  WRITE (KLUN) YD%RNEMOLVLS
ENDIF
LRNEMOMASK = ALLOCATED (YD%RNEMOMASK)
WRITE (KLUN) LRNEMOMASK
IF (LRNEMOMASK) THEN
  WRITE (KLUN) LBOUND (YD%RNEMOMASK)
  WRITE (KLUN) UBOUND (YD%RNEMOMASK)
  WRITE (KLUN) YD%RNEMOMASK
ENDIF
WRITE (KLUN) YD%LNEMOPARTCOUP
WRITE (KLUN) YD%LNEMOPARTMASK
WRITE (KLUN) YD%LNEMOPARTMASKFILE
WRITE (KLUN) YD%RNPARTRAMPSTART
WRITE (KLUN) YD%RNPARTRAMPLEN
WRITE (KLUN) YD%RNPARTLAT
WRITE (KLUN) YD%RNPARTLATSPREAD
LPARTSST0 = ALLOCATED (YD%PARTSST0)
WRITE (KLUN) LPARTSST0
IF (LPARTSST0) THEN
  WRITE (KLUN) LBOUND (YD%PARTSST0)
  WRITE (KLUN) UBOUND (YD%PARTSST0)
  WRITE (KLUN) YD%PARTSST0
ENDIF
LPARTMASK = ALLOCATED (YD%PARTMASK)
WRITE (KLUN) LPARTMASK
IF (LPARTMASK) THEN
  WRITE (KLUN) LBOUND (YD%PARTMASK)
  WRITE (KLUN) UBOUND (YD%PARTMASK)
  WRITE (KLUN) YD%PARTMASK
ENDIF
WRITE (KLUN) YD%CDNPARTMASKFILE
LCPLNG_FLD = ALLOCATED (YD%CPLNG_FLD)
WRITE (KLUN) LCPLNG_FLD
IF (LCPLNG_FLD) THEN
  WRITE (KLUN) LBOUND (YD%CPLNG_FLD)
  WRITE (KLUN) UBOUND (YD%CPLNG_FLD)
  DO J1 = LBOUND (YD%CPLNG_FLD, 1), UBOUND (YD%CPLNG_FLD, 1)
    CALL SAVE_CPLNG_FLD_TYPE (KLUN, YD%CPLNG_FLD (J1))
  ENDDO
ENDIF
WRITE (KLUN) YD%CPLNG_ACTIVE
WRITE (KLUN) YD%CPLNG_NUM_FIELDS
WRITE (KLUN) YD%IP_A_SST
WRITE (KLUN) YD%IP_A_ICE_FRAC
WRITE (KLUN) YD%IP_A_CURR_U
WRITE (KLUN) YD%IP_A_CURR_V
WRITE (KLUN) YD%IP_A_TAUX_OCE
WRITE (KLUN) YD%IP_A_TAUY_OCE
WRITE (KLUN) YD%IP_A_TAUX_ICE
WRITE (KLUN) YD%IP_A_TAUY_ICE
WRITE (KLUN) YD%IP_A_QS_MIX
WRITE (KLUN) YD%IP_A_QNS_MIX
WRITE (KLUN) YD%IP_A_QS_OCE
WRITE (KLUN) YD%IP_A_QNS_OCE
WRITE (KLUN) YD%IP_A_QS_ICE
WRITE (KLUN) YD%IP_A_QNS_ICE
WRITE (KLUN) YD%IP_A_PRECIP_LIQUID
WRITE (KLUN) YD%IP_A_PRECIP_SOLID
WRITE (KLUN) YD%IP_A_EVAP_TOTAL
WRITE (KLUN) YD%IP_A_EVAP_ICE
WRITE (KLUN) YD%IP_A_DQNS_DT
WRITE (KLUN) YD%IP_A_RUNOFF
WRITE (KLUN) YD%IP_A_TOTAL_CC
WRITE (KLUN) YD%IP_A_LOW_CC
WRITE (KLUN) YD%IP_A_ICE_TEMP
WRITE (KLUN) YD%IP_A_ICE_ALBEDO
WRITE (KLUN) YD%IP_A_ICE_THICKNESS
WRITE (KLUN) YD%IP_A_SNOW_THICKNESS
WRITE (KLUN) YD%IP_A_ICE_TEMP_LVLS
WRITE (KLUN) YD%IP_A_TAUX
WRITE (KLUN) YD%IP_A_TAUY
WRITE (KLUN) YD%IP_A_QS
WRITE (KLUN) YD%IP_A_QNS
WRITE (KLUN) YD%IP_A_WATER
WRITE (KLUN) YD%IP_A_SST_ATM
WRITE (KLUN) YD%IP_A_TSK_ATM
WRITE (KLUN) YD%IP_A_IST_ATM
WRITE (KLUN) YD%IP_A_2DECV_SKT
WRITE (KLUN) YD%LCOUPSIM
END SUBROUTINE

SUBROUTINE LOAD_TMCC (KLUN, YD)
USE UTIL_CPLNG_FLD_TYPE_MOD
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TMCC), INTENT (OUT), TARGET :: YD
INTEGER :: J1
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2), IL3(3), IU3(3)
LOGICAL :: LCLIMR, LCLIMRAER, LCLIMRCO2, LCLIMRCOMPO, LCPLNG_FLD, LOCEANBC, LPARTMASK, LPARTSST0, LRNEMOLVLS, LRNEMOMASK
LOGICAL :: LZLAKE
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
READ (KLUN) YD%N923
READ (KLUN) YD%NCLIMTOT
READ (KLUN) YD%NCLIMR
READ (KLUN) YD%NCLIGC
READ (KLUN) YD%NCLIGC_COMPO
READ (KLUN) YD%NYSDMP_COMPO
READ (KLUN) YD%NCLIMR_COMPO
READ (KLUN) YD%NCLIAER
READ (KLUN) YD%NDIFC
READ (KLUN) YD%NJDCR
READ (KLUN) YD%NJDCR1
READ (KLUN) YD%NDIFC_COMPO
READ (KLUN) YD%NJDCR_COMPO
READ (KLUN) YD%NJDCR1_COMPO
READ (KLUN) YD%NP1
READ (KLUN) YD%NP2
READ (KLUN) YD%NPCO2_1
READ (KLUN) YD%NPCO2_2
READ (KLUN) YD%NPAER_1
READ (KLUN) YD%NPAER_2
READ (KLUN) YD%NPCOMPO_1
READ (KLUN) YD%NPCOMPO_2
READ (KLUN) YD%NUNITC
READ (KLUN) YD%NUNITC1
READ (KLUN) YD%NUNITCM
READ (KLUN) YD%NOACOMM
READ (KLUN) YD%NSSTICEOP
READ (KLUN) LCLIMRCO2
IF (LCLIMRCO2) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%CLIMRCO2 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%CLIMRCO2,1):UBOUND(YD%CLIMRCO2,1), LBOUND(YD%CLIMRCO2,2):UBOUND(YD%CLIMRCO2,2), LBOUND(YD%CLIMRCO2,3):UBOUND(YD%CLIMRCO2,3)))
  READ (KLUN) ZTMP3
  YD%CLIMRCO2 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LCLIMRAER
IF (LCLIMRAER) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%CLIMRAER (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%CLIMRAER,1):UBOUND(YD%CLIMRAER,1), LBOUND(YD%CLIMRAER,2):UBOUND(YD%CLIMRAER,2), LBOUND(YD%CLIMRAER,3):UBOUND(YD%CLIMRAER,3)))
  READ (KLUN) ZTMP3
  YD%CLIMRAER = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LCLIMRCOMPO
IF (LCLIMRCOMPO) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%CLIMRCOMPO (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%CLIMRCOMPO,1):UBOUND(YD%CLIMRCOMPO,1), LBOUND(YD%CLIMRCOMPO,2):UBOUND(YD%CLIMRCOMPO,2), LBOUND(YD%CLIMRCOMPO,3):UBOUND(YD%CLIMRCOMPO,3)))
  READ (KLUN) ZTMP3
  YD%CLIMRCOMPO = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LZLAKE
IF (LZLAKE) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%ZLAKE (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(YD%ZLAKE,1):UBOUND(YD%ZLAKE,1), LBOUND(YD%ZLAKE,2):UBOUND(YD%ZLAKE,2), LBOUND(YD%ZLAKE,3):UBOUND(YD%ZLAKE,3)))
  READ (KLUN) ZTMP3
  YD%ZLAKE = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LOCEANBC
IF (LOCEANBC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%OCEANBC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%OCEANBC,1):UBOUND(YD%OCEANBC,1), LBOUND(YD%OCEANBC,2):UBOUND(YD%OCEANBC,2)))
  READ (KLUN) ZTMP2
  YD%OCEANBC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LCLIMR
IF (LCLIMR) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (YD%CLIMR (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  READ (KLUN) YD%CLIMR
ENDIF
READ (KLUN) YD%LFIRSTUPD
READ (KLUN) YD%LCURR
READ (KLUN) YD%LGELATO
READ (KLUN) YD%LMCC01_MSE
READ (KLUN) YD%LMCC01
READ (KLUN) YD%LMCC02
READ (KLUN) YD%LMCC03
READ (KLUN) YD%LMCC04
READ (KLUN) YD%LMCC05
READ (KLUN) YD%LMCC06
READ (KLUN) YD%LMCCEC
READ (KLUN) YD%LMCCIEC
READ (KLUN) YD%LMCCIEC_COMPO
READ (KLUN) YD%LMCCICEIC
READ (KLUN) YD%LMCCDYNSEAICE
READ (KLUN) YD%LNEMOCOUP
READ (KLUN) YD%LNEMOFLUXNC
READ (KLUN) YD%LNEMOOUTGRB
READ (KLUN) YD%LCOUPINFOUT
READ (KLUN) YD%LNEMO1WAY
READ (KLUN) YD%LNEMOIFSLOG
READ (KLUN) YD%LNEMOSSTFREEZ
READ (KLUN) YD%LNEMOGRIBFLDS
READ (KLUN) YD%LNEMOGRIBMASK
READ (KLUN) YD%L2DECV2NEMO
READ (KLUN) YD%LMULTIYR
READ (KLUN) YD%LMCC_COMPO
READ (KLUN) YD%NFRCPL
READ (KLUN) YD%LNEMOLIMGET
READ (KLUN) YD%LNEMOLIMPUT
READ (KLUN) YD%LNEMOLIMALB
READ (KLUN) YD%LNEMOLIMTEMP
READ (KLUN) YD%LNEMOLIMTLVL
READ (KLUN) YD%LNEMOLIMTHK
READ (KLUN) YD%LNEMOSICOUP
READ (KLUN) YD%LNEMOATMFLDS
READ (KLUN) YD%LNEMOOCEICEMIX
READ (KLUN) YD%LNEMOQNSICEFILT
READ (KLUN) YD%LNEMOACCUMFLUX
READ (KLUN) YD%LNEMOGRIB3D
READ (KLUN) YD%NNEMO3DLEVS
READ (KLUN) LRNEMOLVLS
IF (LRNEMOLVLS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%RNEMOLVLS (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%RNEMOLVLS,1):UBOUND(YD%RNEMOLVLS,1)))
  READ (KLUN) ZTMP1
  YD%RNEMOLVLS = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRNEMOMASK
IF (LRNEMOMASK) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%RNEMOMASK (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) YD%RNEMOMASK
ENDIF
READ (KLUN) YD%LNEMOPARTCOUP
READ (KLUN) YD%LNEMOPARTMASK
READ (KLUN) YD%LNEMOPARTMASKFILE
READ (KLUN) ZTMP0
YD%RNPARTRAMPSTART = ZTMP0
READ (KLUN) ZTMP0
YD%RNPARTRAMPLEN = ZTMP0
READ (KLUN) ZTMP0
YD%RNPARTLAT = ZTMP0
READ (KLUN) ZTMP0
YD%RNPARTLATSPREAD = ZTMP0
READ (KLUN) LPARTSST0
IF (LPARTSST0) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%PARTSST0 (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%PARTSST0,1):UBOUND(YD%PARTSST0,1)))
  READ (KLUN) ZTMP1
  YD%PARTSST0 = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LPARTMASK
IF (LPARTMASK) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%PARTMASK (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%PARTMASK,1):UBOUND(YD%PARTMASK,1)))
  READ (KLUN) ZTMP1
  YD%PARTMASK = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) YD%CDNPARTMASKFILE
READ (KLUN) LCPLNG_FLD
IF (LCPLNG_FLD) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%CPLNG_FLD (IL1(1):IU1(1)))
  DO J1 = LBOUND (YD%CPLNG_FLD, 1), UBOUND (YD%CPLNG_FLD, 1)
    CALL LOAD_CPLNG_FLD_TYPE (KLUN, YD%CPLNG_FLD (J1))
  ENDDO
ENDIF
READ (KLUN) YD%CPLNG_ACTIVE
READ (KLUN) YD%CPLNG_NUM_FIELDS
READ (KLUN) YD%IP_A_SST
READ (KLUN) YD%IP_A_ICE_FRAC
READ (KLUN) YD%IP_A_CURR_U
READ (KLUN) YD%IP_A_CURR_V
READ (KLUN) YD%IP_A_TAUX_OCE
READ (KLUN) YD%IP_A_TAUY_OCE
READ (KLUN) YD%IP_A_TAUX_ICE
READ (KLUN) YD%IP_A_TAUY_ICE
READ (KLUN) YD%IP_A_QS_MIX
READ (KLUN) YD%IP_A_QNS_MIX
READ (KLUN) YD%IP_A_QS_OCE
READ (KLUN) YD%IP_A_QNS_OCE
READ (KLUN) YD%IP_A_QS_ICE
READ (KLUN) YD%IP_A_QNS_ICE
READ (KLUN) YD%IP_A_PRECIP_LIQUID
READ (KLUN) YD%IP_A_PRECIP_SOLID
READ (KLUN) YD%IP_A_EVAP_TOTAL
READ (KLUN) YD%IP_A_EVAP_ICE
READ (KLUN) YD%IP_A_DQNS_DT
READ (KLUN) YD%IP_A_RUNOFF
READ (KLUN) YD%IP_A_TOTAL_CC
READ (KLUN) YD%IP_A_LOW_CC
READ (KLUN) YD%IP_A_ICE_TEMP
READ (KLUN) YD%IP_A_ICE_ALBEDO
READ (KLUN) YD%IP_A_ICE_THICKNESS
READ (KLUN) YD%IP_A_SNOW_THICKNESS
READ (KLUN) YD%IP_A_ICE_TEMP_LVLS
READ (KLUN) YD%IP_A_TAUX
READ (KLUN) YD%IP_A_TAUY
READ (KLUN) YD%IP_A_QS
READ (KLUN) YD%IP_A_QNS
READ (KLUN) YD%IP_A_WATER
READ (KLUN) YD%IP_A_SST_ATM
READ (KLUN) YD%IP_A_TSK_ATM
READ (KLUN) YD%IP_A_IST_ATM
READ (KLUN) YD%IP_A_2DECV_SKT
READ (KLUN) YD%LCOUPSIM
END SUBROUTINE


SUBROUTINE COPY_TMCC (YD, LDCREATED, LDFIELDAPI)
USE UTIL_CPLNG_FLD_TYPE_MOD
IMPLICIT NONE
TYPE (TMCC), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LCLIMR, LCLIMRAER, LCLIMRCO2, LCLIMRCOMPO, LCPLNG_FLD, LOCEANBC, LPARTMASK, LPARTSST0, LRNEMOLVLS, LRNEMOMASK
LOGICAL :: LZLAKE

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF



























LCLIMRCO2 = ALLOCATED (YD%CLIMRCO2)
IF (LCLIMRCO2) THEN
  !$ACC ENTER DATA CREATE (YD%CLIMRCO2)
  !$ACC UPDATE DEVICE (YD%CLIMRCO2)
  !$ACC ENTER DATA ATTACH (YD%CLIMRCO2)
ENDIF

LCLIMRAER = ALLOCATED (YD%CLIMRAER)
IF (LCLIMRAER) THEN
  !$ACC ENTER DATA CREATE (YD%CLIMRAER)
  !$ACC UPDATE DEVICE (YD%CLIMRAER)
  !$ACC ENTER DATA ATTACH (YD%CLIMRAER)
ENDIF

LCLIMRCOMPO = ALLOCATED (YD%CLIMRCOMPO)
IF (LCLIMRCOMPO) THEN
  !$ACC ENTER DATA CREATE (YD%CLIMRCOMPO)
  !$ACC UPDATE DEVICE (YD%CLIMRCOMPO)
  !$ACC ENTER DATA ATTACH (YD%CLIMRCOMPO)
ENDIF

LZLAKE = ALLOCATED (YD%ZLAKE)
IF (LZLAKE) THEN
  !$ACC ENTER DATA CREATE (YD%ZLAKE)
  !$ACC UPDATE DEVICE (YD%ZLAKE)
  !$ACC ENTER DATA ATTACH (YD%ZLAKE)
ENDIF

LOCEANBC = ALLOCATED (YD%OCEANBC)
IF (LOCEANBC) THEN
  !$ACC ENTER DATA CREATE (YD%OCEANBC)
  !$ACC UPDATE DEVICE (YD%OCEANBC)
  !$ACC ENTER DATA ATTACH (YD%OCEANBC)
ENDIF

LCLIMR = ALLOCATED (YD%CLIMR)
IF (LCLIMR) THEN
  !$ACC ENTER DATA CREATE (YD%CLIMR)
  !$ACC UPDATE DEVICE (YD%CLIMR)
  !$ACC ENTER DATA ATTACH (YD%CLIMR)
ENDIF










































LRNEMOLVLS = ALLOCATED (YD%RNEMOLVLS)
IF (LRNEMOLVLS) THEN
  !$ACC ENTER DATA CREATE (YD%RNEMOLVLS)
  !$ACC UPDATE DEVICE (YD%RNEMOLVLS)
  !$ACC ENTER DATA ATTACH (YD%RNEMOLVLS)
ENDIF

LRNEMOMASK = ALLOCATED (YD%RNEMOMASK)
IF (LRNEMOMASK) THEN
  !$ACC ENTER DATA CREATE (YD%RNEMOMASK)
  !$ACC UPDATE DEVICE (YD%RNEMOMASK)
  !$ACC ENTER DATA ATTACH (YD%RNEMOMASK)
ENDIF








LPARTSST0 = ALLOCATED (YD%PARTSST0)
IF (LPARTSST0) THEN
  !$ACC ENTER DATA CREATE (YD%PARTSST0)
  !$ACC UPDATE DEVICE (YD%PARTSST0)
  !$ACC ENTER DATA ATTACH (YD%PARTSST0)
ENDIF

LPARTMASK = ALLOCATED (YD%PARTMASK)
IF (LPARTMASK) THEN
  !$ACC ENTER DATA CREATE (YD%PARTMASK)
  !$ACC UPDATE DEVICE (YD%PARTMASK)
  !$ACC ENTER DATA ATTACH (YD%PARTMASK)
ENDIF


LCPLNG_FLD = ALLOCATED (YD%CPLNG_FLD)
IF (LCPLNG_FLD) THEN
  !$ACC ENTER DATA CREATE (YD%CPLNG_FLD)
  !$ACC UPDATE DEVICE (YD%CPLNG_FLD)
  DO J1 = LBOUND (YD%CPLNG_FLD, 1), UBOUND (YD%CPLNG_FLD, 1)
    CALL COPY_CPLNG_FLD_TYPE (YD%CPLNG_FLD (J1), LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (YD%CPLNG_FLD)
ENDIF








































END SUBROUTINE

SUBROUTINE HOST_TMCC (YD)
USE UTIL_CPLNG_FLD_TYPE_MOD

IMPLICIT NONE
TYPE (TMCC), TARGET :: YD
INTEGER :: J1
LOGICAL :: LCLIMR, LCLIMRAER, LCLIMRCO2, LCLIMRCOMPO, LCPLNG_FLD, LOCEANBC, LPARTMASK, LPARTSST0, LRNEMOLVLS, LRNEMOMASK
LOGICAL :: LZLAKE






















































































LCPLNG_FLD = ALLOCATED (YD%CPLNG_FLD)
IF (LCPLNG_FLD) THEN
  DO J1 = LBOUND (YD%CPLNG_FLD, 1), UBOUND (YD%CPLNG_FLD, 1)
    CALL HOST_CPLNG_FLD_TYPE (YD%CPLNG_FLD (J1))
  ENDDO
ENDIF








































END SUBROUTINE

     

SUBROUTINE CRC64_TMCC (YD, KLUN, CDPATH)
USE UTIL_CPLNG_FLD_TYPE_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TMCC), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
INTEGER :: J1
LOGICAL :: LCLIMR, LCLIMRAER, LCLIMRCO2, LCLIMRCOMPO, LCPLNG_FLD, LOCEANBC, LPARTMASK, LPARTSST0, LRNEMOLVLS, LRNEMOMASK
LOGICAL :: LZLAKE
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%N923), CDPATH//'%N923'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCLIMTOT), CDPATH//'%NCLIMTOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCLIMR), CDPATH//'%NCLIMR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCLIGC), CDPATH//'%NCLIGC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCLIGC_COMPO), CDPATH//'%NCLIGC_COMPO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NYSDMP_COMPO), CDPATH//'%NYSDMP_COMPO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCLIMR_COMPO), CDPATH//'%NCLIMR_COMPO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCLIAER), CDPATH//'%NCLIAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDIFC), CDPATH//'%NDIFC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NJDCR), CDPATH//'%NJDCR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NJDCR1), CDPATH//'%NJDCR1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDIFC_COMPO), CDPATH//'%NDIFC_COMPO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NJDCR_COMPO), CDPATH//'%NJDCR_COMPO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NJDCR1_COMPO), CDPATH//'%NJDCR1_COMPO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NP1), CDPATH//'%NP1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NP2), CDPATH//'%NP2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPCO2_1), CDPATH//'%NPCO2_1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPCO2_2), CDPATH//'%NPCO2_2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPAER_1), CDPATH//'%NPAER_1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPAER_2), CDPATH//'%NPAER_2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPCOMPO_1), CDPATH//'%NPCOMPO_1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPCOMPO_2), CDPATH//'%NPCOMPO_2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NUNITC), CDPATH//'%NUNITC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NUNITC1), CDPATH//'%NUNITC1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NUNITCM), CDPATH//'%NUNITCM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NOACOMM), CDPATH//'%NOACOMM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSSTICEOP), CDPATH//'%NSSTICEOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CLIMRCO2), CDPATH//'%CLIMRCO2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CLIMRAER), CDPATH//'%CLIMRAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CLIMRCOMPO), CDPATH//'%CLIMRCOMPO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ZLAKE), CDPATH//'%ZLAKE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%OCEANBC), CDPATH//'%OCEANBC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CLIMR), CDPATH//'%CLIMR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LFIRSTUPD), CDPATH//'%LFIRSTUPD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCURR), CDPATH//'%LCURR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LGELATO), CDPATH//'%LGELATO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCC01_MSE), CDPATH//'%LMCC01_MSE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCC01), CDPATH//'%LMCC01'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCC02), CDPATH//'%LMCC02'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCC03), CDPATH//'%LMCC03'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCC04), CDPATH//'%LMCC04'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCC05), CDPATH//'%LMCC05'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCC06), CDPATH//'%LMCC06'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCCEC), CDPATH//'%LMCCEC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCCIEC), CDPATH//'%LMCCIEC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCCIEC_COMPO), CDPATH//'%LMCCIEC_COMPO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCCICEIC), CDPATH//'%LMCCICEIC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCCDYNSEAICE), CDPATH//'%LMCCDYNSEAICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOCOUP), CDPATH//'%LNEMOCOUP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOFLUXNC), CDPATH//'%LNEMOFLUXNC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOOUTGRB), CDPATH//'%LNEMOOUTGRB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCOUPINFOUT), CDPATH//'%LCOUPINFOUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMO1WAY), CDPATH//'%LNEMO1WAY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOIFSLOG), CDPATH//'%LNEMOIFSLOG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOSSTFREEZ), CDPATH//'%LNEMOSSTFREEZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOGRIBFLDS), CDPATH//'%LNEMOGRIBFLDS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOGRIBMASK), CDPATH//'%LNEMOGRIBMASK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%L2DECV2NEMO), CDPATH//'%L2DECV2NEMO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMULTIYR), CDPATH//'%LMULTIYR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMCC_COMPO), CDPATH//'%LMCC_COMPO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NFRCPL), CDPATH//'%NFRCPL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOLIMGET), CDPATH//'%LNEMOLIMGET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOLIMPUT), CDPATH//'%LNEMOLIMPUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOLIMALB), CDPATH//'%LNEMOLIMALB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOLIMTEMP), CDPATH//'%LNEMOLIMTEMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOLIMTLVL), CDPATH//'%LNEMOLIMTLVL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOLIMTHK), CDPATH//'%LNEMOLIMTHK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOSICOUP), CDPATH//'%LNEMOSICOUP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOATMFLDS), CDPATH//'%LNEMOATMFLDS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOOCEICEMIX), CDPATH//'%LNEMOOCEICEMIX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOQNSICEFILT), CDPATH//'%LNEMOQNSICEFILT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOACCUMFLUX), CDPATH//'%LNEMOACCUMFLUX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOGRIB3D), CDPATH//'%LNEMOGRIB3D'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NNEMO3DLEVS), CDPATH//'%NNEMO3DLEVS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RNEMOLVLS), CDPATH//'%RNEMOLVLS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RNEMOMASK), CDPATH//'%RNEMOMASK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOPARTCOUP), CDPATH//'%LNEMOPARTCOUP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOPARTMASK), CDPATH//'%LNEMOPARTMASK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEMOPARTMASKFILE), CDPATH//'%LNEMOPARTMASKFILE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RNPARTRAMPSTART), CDPATH//'%RNPARTRAMPSTART'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RNPARTRAMPLEN), CDPATH//'%RNPARTRAMPLEN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RNPARTLAT), CDPATH//'%RNPARTLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RNPARTLATSPREAD), CDPATH//'%RNPARTLATSPREAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%PARTSST0), CDPATH//'%PARTSST0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%PARTMASK), CDPATH//'%PARTMASK'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CDNPARTMASKFILE), CDPATH//'%CDNPARTMASKFILE'

LCPLNG_FLD = ALLOCATED (YD%CPLNG_FLD)
IF (LCPLNG_FLD) THEN
  DO J1 = LBOUND (YD%CPLNG_FLD, 1), UBOUND (YD%CPLNG_FLD, 1)
    WRITE (CLIND, '("(",I0,")")') J1
    CALL CRC64_CPLNG_FLD_TYPE (YD%CPLNG_FLD (J1), KLUN, CDPATH//'%CPLNG_FLD'//TRIM(CLIND))
  ENDDO
ENDIF

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CPLNG_ACTIVE), CDPATH//'%CPLNG_ACTIVE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CPLNG_NUM_FIELDS), CDPATH//'%CPLNG_NUM_FIELDS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_SST), CDPATH//'%IP_A_SST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_ICE_FRAC), CDPATH//'%IP_A_ICE_FRAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_CURR_U), CDPATH//'%IP_A_CURR_U'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_CURR_V), CDPATH//'%IP_A_CURR_V'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_TAUX_OCE), CDPATH//'%IP_A_TAUX_OCE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_TAUY_OCE), CDPATH//'%IP_A_TAUY_OCE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_TAUX_ICE), CDPATH//'%IP_A_TAUX_ICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_TAUY_ICE), CDPATH//'%IP_A_TAUY_ICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_QS_MIX), CDPATH//'%IP_A_QS_MIX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_QNS_MIX), CDPATH//'%IP_A_QNS_MIX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_QS_OCE), CDPATH//'%IP_A_QS_OCE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_QNS_OCE), CDPATH//'%IP_A_QNS_OCE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_QS_ICE), CDPATH//'%IP_A_QS_ICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_QNS_ICE), CDPATH//'%IP_A_QNS_ICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_PRECIP_LIQUID), CDPATH//'%IP_A_PRECIP_LIQUID'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_PRECIP_SOLID), CDPATH//'%IP_A_PRECIP_SOLID'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_EVAP_TOTAL), CDPATH//'%IP_A_EVAP_TOTAL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_EVAP_ICE), CDPATH//'%IP_A_EVAP_ICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_DQNS_DT), CDPATH//'%IP_A_DQNS_DT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_RUNOFF), CDPATH//'%IP_A_RUNOFF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_TOTAL_CC), CDPATH//'%IP_A_TOTAL_CC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_LOW_CC), CDPATH//'%IP_A_LOW_CC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_ICE_TEMP), CDPATH//'%IP_A_ICE_TEMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_ICE_ALBEDO), CDPATH//'%IP_A_ICE_ALBEDO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_ICE_THICKNESS), CDPATH//'%IP_A_ICE_THICKNESS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_SNOW_THICKNESS), CDPATH//'%IP_A_SNOW_THICKNESS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_ICE_TEMP_LVLS), CDPATH//'%IP_A_ICE_TEMP_LVLS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_TAUX), CDPATH//'%IP_A_TAUX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_TAUY), CDPATH//'%IP_A_TAUY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_QS), CDPATH//'%IP_A_QS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_QNS), CDPATH//'%IP_A_QNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_WATER), CDPATH//'%IP_A_WATER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_SST_ATM), CDPATH//'%IP_A_SST_ATM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_TSK_ATM), CDPATH//'%IP_A_TSK_ATM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_IST_ATM), CDPATH//'%IP_A_IST_ATM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IP_A_2DECV_SKT), CDPATH//'%IP_A_2DECV_SKT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCOUPSIM), CDPATH//'%LCOUPSIM'

END SUBROUTINE

SUBROUTINE WIPE_TMCC (YD, LDDELETED, LDFIELDAPI)
USE UTIL_CPLNG_FLD_TYPE_MOD
IMPLICIT NONE
TYPE (TMCC), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LCLIMR, LCLIMRAER, LCLIMRCO2, LCLIMRCOMPO, LCPLNG_FLD, LOCEANBC, LPARTMASK, LPARTSST0, LRNEMOLVLS, LRNEMOMASK
LOGICAL :: LZLAKE

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF



























LCLIMRCO2 = ALLOCATED (YD%CLIMRCO2)
IF (LCLIMRCO2) THEN
  !$ACC EXIT DATA DETACH (YD%CLIMRCO2)
  !$ACC EXIT DATA DETACH (YD%CLIMRCO2)
ENDIF

LCLIMRAER = ALLOCATED (YD%CLIMRAER)
IF (LCLIMRAER) THEN
  !$ACC EXIT DATA DETACH (YD%CLIMRAER)
  !$ACC EXIT DATA DETACH (YD%CLIMRAER)
ENDIF

LCLIMRCOMPO = ALLOCATED (YD%CLIMRCOMPO)
IF (LCLIMRCOMPO) THEN
  !$ACC EXIT DATA DETACH (YD%CLIMRCOMPO)
  !$ACC EXIT DATA DETACH (YD%CLIMRCOMPO)
ENDIF

LZLAKE = ALLOCATED (YD%ZLAKE)
IF (LZLAKE) THEN
  !$ACC EXIT DATA DETACH (YD%ZLAKE)
  !$ACC EXIT DATA DETACH (YD%ZLAKE)
ENDIF

LOCEANBC = ALLOCATED (YD%OCEANBC)
IF (LOCEANBC) THEN
  !$ACC EXIT DATA DETACH (YD%OCEANBC)
  !$ACC EXIT DATA DETACH (YD%OCEANBC)
ENDIF

LCLIMR = ALLOCATED (YD%CLIMR)
IF (LCLIMR) THEN
  !$ACC EXIT DATA DETACH (YD%CLIMR)
  !$ACC EXIT DATA DETACH (YD%CLIMR)
ENDIF










































LRNEMOLVLS = ALLOCATED (YD%RNEMOLVLS)
IF (LRNEMOLVLS) THEN
  !$ACC EXIT DATA DETACH (YD%RNEMOLVLS)
  !$ACC EXIT DATA DETACH (YD%RNEMOLVLS)
ENDIF

LRNEMOMASK = ALLOCATED (YD%RNEMOMASK)
IF (LRNEMOMASK) THEN
  !$ACC EXIT DATA DETACH (YD%RNEMOMASK)
  !$ACC EXIT DATA DETACH (YD%RNEMOMASK)
ENDIF








LPARTSST0 = ALLOCATED (YD%PARTSST0)
IF (LPARTSST0) THEN
  !$ACC EXIT DATA DETACH (YD%PARTSST0)
  !$ACC EXIT DATA DETACH (YD%PARTSST0)
ENDIF

LPARTMASK = ALLOCATED (YD%PARTMASK)
IF (LPARTMASK) THEN
  !$ACC EXIT DATA DETACH (YD%PARTMASK)
  !$ACC EXIT DATA DETACH (YD%PARTMASK)
ENDIF


LCPLNG_FLD = ALLOCATED (YD%CPLNG_FLD)
IF (LCPLNG_FLD) THEN
  !$ACC EXIT DATA DETACH (YD%CPLNG_FLD)
  DO J1 = LBOUND (YD%CPLNG_FLD, 1), UBOUND (YD%CPLNG_FLD, 1)
    CALL WIPE_CPLNG_FLD_TYPE (YD%CPLNG_FLD (J1), LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC EXIT DATA DETACH (YD%CPLNG_FLD)
ENDIF








































LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TMCC (YD, CDPATH, LDPRINT) RESULT (KSIZE)
USE UTIL_CPLNG_FLD_TYPE_MOD
IMPLICIT NONE
TYPE (TMCC),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
INTEGER :: J1
LOGICAL :: LCLIMR, LCLIMRAER, LCLIMRCO2, LCLIMRCOMPO, LCPLNG_FLD, LOCEANBC, LPARTMASK, LPARTSST0, LRNEMOLVLS, LRNEMOMASK
LOGICAL :: LZLAKE

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%N923)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%N923'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCLIMTOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCLIMTOT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCLIMR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCLIMR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCLIGC) * SIZE (YD%NCLIGC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCLIGC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCLIGC_COMPO) * SIZE (YD%NCLIGC_COMPO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCLIGC_COMPO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NYSDMP_COMPO) * SIZE (YD%NYSDMP_COMPO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NYSDMP_COMPO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCLIMR_COMPO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCLIMR_COMPO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCLIAER) * SIZE (YD%NCLIAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCLIAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDIFC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDIFC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NJDCR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NJDCR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NJDCR1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NJDCR1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDIFC_COMPO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDIFC_COMPO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NJDCR_COMPO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NJDCR_COMPO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NJDCR1_COMPO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NJDCR1_COMPO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NP1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NP1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NP2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NP2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPCO2_1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPCO2_1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPCO2_2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPCO2_2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPAER_1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPAER_1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPAER_2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPAER_2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPCOMPO_1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPCOMPO_1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPCOMPO_2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPCOMPO_2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NUNITC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NUNITC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NUNITC1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NUNITC1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NUNITCM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NUNITCM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NOACOMM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NOACOMM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSSTICEOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSSTICEOP'
ENDIF
KSIZE = KSIZE + ISIZE
LCLIMRCO2 = ALLOCATED (YD%CLIMRCO2)
IF (LCLIMRCO2) THEN
  ISIZE = KIND (YD%CLIMRCO2) * SIZE (YD%CLIMRCO2)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CLIMRCO2'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCLIMRAER = ALLOCATED (YD%CLIMRAER)
IF (LCLIMRAER) THEN
  ISIZE = KIND (YD%CLIMRAER) * SIZE (YD%CLIMRAER)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CLIMRAER'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCLIMRCOMPO = ALLOCATED (YD%CLIMRCOMPO)
IF (LCLIMRCOMPO) THEN
  ISIZE = KIND (YD%CLIMRCOMPO) * SIZE (YD%CLIMRCOMPO)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CLIMRCOMPO'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LZLAKE = ALLOCATED (YD%ZLAKE)
IF (LZLAKE) THEN
  ISIZE = KIND (YD%ZLAKE) * SIZE (YD%ZLAKE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%ZLAKE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LOCEANBC = ALLOCATED (YD%OCEANBC)
IF (LOCEANBC) THEN
  ISIZE = KIND (YD%OCEANBC) * SIZE (YD%OCEANBC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%OCEANBC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCLIMR = ALLOCATED (YD%CLIMR)
IF (LCLIMR) THEN
  ISIZE = KIND (YD%CLIMR) * SIZE (YD%CLIMR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CLIMR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%LFIRSTUPD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LFIRSTUPD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCURR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCURR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LGELATO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LGELATO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCC01_MSE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCC01_MSE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCC01)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCC01'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCC02)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCC02'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCC03)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCC03'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCC04)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCC04'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCC05)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCC05'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCC06)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCC06'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCCEC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCCEC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCCIEC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCCIEC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCCIEC_COMPO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCCIEC_COMPO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCCICEIC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCCICEIC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCCDYNSEAICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCCDYNSEAICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOCOUP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOCOUP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOFLUXNC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOFLUXNC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOOUTGRB)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOOUTGRB'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCOUPINFOUT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCOUPINFOUT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMO1WAY)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMO1WAY'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOIFSLOG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOIFSLOG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOSSTFREEZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOSSTFREEZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOGRIBFLDS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOGRIBFLDS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOGRIBMASK)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOGRIBMASK'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%L2DECV2NEMO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%L2DECV2NEMO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMULTIYR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMULTIYR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMCC_COMPO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMCC_COMPO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NFRCPL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFRCPL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOLIMGET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOLIMGET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOLIMPUT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOLIMPUT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOLIMALB)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOLIMALB'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOLIMTEMP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOLIMTEMP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOLIMTLVL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOLIMTLVL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOLIMTHK)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOLIMTHK'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOSICOUP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOSICOUP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOATMFLDS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOATMFLDS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOOCEICEMIX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOOCEICEMIX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOQNSICEFILT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOQNSICEFILT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOACCUMFLUX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOACCUMFLUX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOGRIB3D)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOGRIB3D'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NNEMO3DLEVS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NNEMO3DLEVS'
ENDIF
KSIZE = KSIZE + ISIZE
LRNEMOLVLS = ALLOCATED (YD%RNEMOLVLS)
IF (LRNEMOLVLS) THEN
  ISIZE = KIND (YD%RNEMOLVLS) * SIZE (YD%RNEMOLVLS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RNEMOLVLS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRNEMOMASK = ALLOCATED (YD%RNEMOMASK)
IF (LRNEMOMASK) THEN
  ISIZE = KIND (YD%RNEMOMASK) * SIZE (YD%RNEMOMASK)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RNEMOMASK'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%LNEMOPARTCOUP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOPARTCOUP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOPARTMASK)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOPARTMASK'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEMOPARTMASKFILE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEMOPARTMASKFILE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RNPARTRAMPSTART)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNPARTRAMPSTART'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RNPARTRAMPLEN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNPARTRAMPLEN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RNPARTLAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNPARTLAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RNPARTLATSPREAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNPARTLATSPREAD'
ENDIF
KSIZE = KSIZE + ISIZE
LPARTSST0 = ALLOCATED (YD%PARTSST0)
IF (LPARTSST0) THEN
  ISIZE = KIND (YD%PARTSST0) * SIZE (YD%PARTSST0)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%PARTSST0'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LPARTMASK = ALLOCATED (YD%PARTMASK)
IF (LPARTMASK) THEN
  ISIZE = KIND (YD%PARTMASK) * SIZE (YD%PARTMASK)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%PARTMASK'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%CDNPARTMASKFILE) * LEN (YD%CDNPARTMASKFILE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CDNPARTMASKFILE'
ENDIF
KSIZE = KSIZE + ISIZE
LCPLNG_FLD = ALLOCATED (YD%CPLNG_FLD)
IF (LCPLNG_FLD) THEN
  JSIZE = 0
  DO J1 = LBOUND (YD%CPLNG_FLD, 1), UBOUND (YD%CPLNG_FLD, 1)
    ISIZE = SIZE_CPLNG_FLD_TYPE (YD%CPLNG_FLD (J1), CLPATH//'%CPLNG_FLD', .FALSE.)
    JSIZE = JSIZE + ISIZE
    KSIZE = KSIZE + ISIZE
  ENDDO
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
    WRITE (*, *) TRIM (CLPATH)//'%CPLNG_FLD'
  ENDIF
ENDIF
ISIZE = KIND (YD%CPLNG_ACTIVE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CPLNG_ACTIVE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CPLNG_NUM_FIELDS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CPLNG_NUM_FIELDS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_SST)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_SST'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_ICE_FRAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_ICE_FRAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_CURR_U)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_CURR_U'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_CURR_V)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_CURR_V'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_TAUX_OCE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_TAUX_OCE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_TAUY_OCE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_TAUY_OCE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_TAUX_ICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_TAUX_ICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_TAUY_ICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_TAUY_ICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_QS_MIX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_QS_MIX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_QNS_MIX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_QNS_MIX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_QS_OCE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_QS_OCE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_QNS_OCE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_QNS_OCE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_QS_ICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_QS_ICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_QNS_ICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_QNS_ICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_PRECIP_LIQUID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_PRECIP_LIQUID'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_PRECIP_SOLID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_PRECIP_SOLID'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_EVAP_TOTAL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_EVAP_TOTAL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_EVAP_ICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_EVAP_ICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_DQNS_DT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_DQNS_DT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_RUNOFF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_RUNOFF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_TOTAL_CC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_TOTAL_CC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_LOW_CC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_LOW_CC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_ICE_TEMP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_ICE_TEMP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_ICE_ALBEDO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_ICE_ALBEDO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_ICE_THICKNESS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_ICE_THICKNESS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_SNOW_THICKNESS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_SNOW_THICKNESS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_ICE_TEMP_LVLS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_ICE_TEMP_LVLS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_TAUX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_TAUX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_TAUY)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_TAUY'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_QS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_QS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_QNS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_QNS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_WATER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_WATER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_SST_ATM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_SST_ATM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_TSK_ATM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_TSK_ATM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_IST_ATM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_IST_ATM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IP_A_2DECV_SKT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IP_A_2DECV_SKT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCOUPSIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCOUPSIM'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
