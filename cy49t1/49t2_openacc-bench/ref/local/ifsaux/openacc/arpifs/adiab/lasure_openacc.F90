SUBROUTINE LASURE_OPENACC (YDGEOMETRY, YDEPHY, YDDYN, YDEDYN, YDPHY&
&, KST, KEND, PMAPPA, PGM, PBT, PBDT, PREDIV, YDSTACK)
!$ACC ROUTINE (LASURE_OPENACC) SEQ
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB

USE YOEPHY,ONLY:TEPHY
USE YOMPHY,ONLY:TPHY
USE YEMDYN,ONLY:TEDYN
USE YOMDYN,ONLY:TDYN
#include "stack.h"
USE STACK_MOD
USE ABOR1_ACC_MOD

IMPLICIT NONE

TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TEPHY), INTENT (IN)::YDEPHY
TYPE (TDYN), INTENT (IN)::YDDYN
TYPE (TEDYN), INTENT (IN)::YDEDYN
TYPE (TPHY), INTENT (IN)::YDPHY
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PMAPPA (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PGM (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PBT
REAL (KIND=JPRB), INTENT (OUT)::PBDT (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PREDIV (YDGEOMETRY%YRDIM%NPROMA)
TYPE(STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIM)::JROF

INTEGER (KIND=JPIM) :: JLON

JLON = KIDIA







IF (YDDYN%LSIDG) THEN

  DO JROF=KST, KEND
    PBDT (JLON)=PBT
    PREDIV (JLON)=1.0_JPRB
  ENDDO

ELSEIF (YDEDYN%LESIDG) THEN

  DO JROF=KST, KEND
    PBDT (JLON)=PBT*PMAPPA (JLON)/(PGM (JLON)*PGM (JLON))
    PREDIV (JLON)=PMAPPA (JLON)/(PGM (JLON)*PGM (JLON))
  ENDDO

ELSE

  DO JROF=KST, KEND
    PBDT (JLON)=PBT*YDGEOMETRY%YRGEM%RSTRET*YDGEOMETRY%YRGEM%RSTRET/(PGM (JLON)*PGM (JLON))
    PREDIV (JLON)=YDGEOMETRY%YRGEM%RSTRET*YDGEOMETRY%YRGEM%RSTRET/(PGM (JLON)*PGM (JLON))
  ENDDO

ENDIF





ENDSUBROUTINE LASURE_OPENACC
