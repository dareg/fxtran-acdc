SUBROUTINE GP_SPV_OPENACC (YDGEOMETRY, YDDYN, YDDYNA, YDSIMPHL, LDTL, KST, KEND, PSPT0, PSPT0L&
&, PSPT0M, PSPT9, PSPT9L, PSPT9M, PRE0, PRE0L, PRE0M, PRE9, PRE9L, PRE9M, YDSTACK)
!$ACC ROUTINE (GP_SPV_OPENACC) SEQ
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB

USE YOMDYN,ONLY:TDYN
USE YOMDYNA,ONLY:TDYNA
USE YOMSIMPHL,ONLY:TSIMPHL
#include "stack.h"
USE STACK_MOD
USE ABOR1_ACC_MOD

IMPLICIT NONE

TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TDYN), INTENT (IN)::YDDYN
TYPE (TDYNA), INTENT (IN)::YDDYNA
TYPE (TSIMPHL), INTENT (IN)::YDSIMPHL
LOGICAL, INTENT (IN)::LDTL
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PSPT0 (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT0L (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT0M (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT9 (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT9L (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT9M (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PRE0 (YDGEOMETRY%YRDIM%NPROMA, 0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PRE0L (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PRE0M (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PRE9 (YDGEOMETRY%YRDIM%NPROMA, 0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PRE9L (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PRE9M (YDGEOMETRY%YRDIM%NPROMA)
TYPE(STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIM)::JROF
LOGICAL::LLPRE9

INTEGER (KIND=JPIM) :: JLON

JLON = KIDIA







IF (.NOT.(((YDSIMPHL%LSIMPH.OR.YDDYNA%LNHDYN).AND.LDTL).OR..NOT.LDTL)) THEN
  LLPRE9=.FALSE.
ELSE
  LLPRE9=.NOT.YDDYNA%LTWOTL
ENDIF


DO JROF=KST, KEND
  PRE0 (JLON, YDGEOMETRY%YRDIMV%NFLEVG)=EXP (PSPT0 (JLON))
  PRE0L (JLON)=PSPT0L (JLON)*PRE0 (JLON, YDGEOMETRY%YRDIMV%NFLEVG)
  PRE0M (JLON)=PSPT0M (JLON)*PRE0 (JLON, YDGEOMETRY%YRDIMV%NFLEVG)
ENDDO


IF (LLPRE9) THEN

  DO JROF=KST, KEND
    PRE9 (JLON, YDGEOMETRY%YRDIMV%NFLEVG)=EXP (PSPT9 (JLON))
    PRE9L (JLON)=PSPT9L (JLON)*PRE9 (JLON, YDGEOMETRY%YRDIMV%NFLEVG)
    PRE9M (JLON)=PSPT9M (JLON)*PRE9 (JLON, YDGEOMETRY%YRDIMV%NFLEVG)
  ENDDO

ENDIF





ENDSUBROUTINE GP_SPV_OPENACC
