SUBROUTINE GPINISLB_PART3_EXPL_OPENACC (YDGEOMETRY, YDDYNA, KST, KEND, PVVEL0&
&, PZPRE0F, PB2VVEL, PB2GWF, PB2GDW, PB2GWS, PGWFT0, PGDW0, PGWS0, YDSTACK)
!$ACC ROUTINE (GPINISLB_PART3_EXPL_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB

USE GEOMETRY_MOD,ONLY:GEOMETRY
USE YOMDYNA,ONLY:TDYNA
#include "stack.h"
USE STACK_MOD
USE ABOR1_ACC_MOD

IMPLICIT NONE

TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TDYNA), INTENT (IN)::YDDYNA
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PVVEL0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PZPRE0F (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PB2VVEL (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PB2GWF (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PB2GDW (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PB2GWS (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PGWFT0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PGDW0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PGWS0 (YDGEOMETRY%YRDIM%NPROMA)
TYPE(STACK), INTENT (IN) :: YDSTACK

INTEGER (KIND=JPIM)::JLEV

INTEGER (KIND=JPIM) :: JLON

JLON = KIDIA



DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
  PB2VVEL (JLON, JLEV)=PVVEL0 (JLON, JLEV)*PZPRE0F (JLON, JLEV)
ENDDO


IF (YDDYNA%LNHDYN.AND.YDDYNA%LGWADV.AND.YDGEOMETRY%YRVERT_GEOM%YRCVER&
  &%LVERTFE.AND.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVFE_GW) THEN

  IF (.NOT.(PRESENT (PGWFT0).AND.PRESENT (PGDW0).AND.PRESENT (PGWS0)))  THEN
      CALL ABOR1_ACC (' GPINISLB 2a: missing optional input arguments!')
  ENDIF


  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
    PB2GWF (JLON, JLEV)=PGWFT0 (JLON, JLEV)
    PB2GDW (JLON, JLEV)=PGDW0 (JLON, JLEV)
  ENDDO

  PB2GWS (JLON)=PGWS0 (JLON)
ENDIF



ENDSUBROUTINE GPINISLB_PART3_EXPL_OPENACC
