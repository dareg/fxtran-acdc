MODULE UTIL_CSTURB_T_MOD

USE MODD_CTURB, ONLY : CSTURB_T

INTERFACE SAVE
MODULE PROCEDURE SAVE_CSTURB_T
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_CSTURB_T
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_CSTURB_T
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_CSTURB_T
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_CSTURB_T
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_CSTURB_T
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_CSTURB_T
END INTERFACE


CONTAINS

SUBROUTINE SAVE_CSTURB_T (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (CSTURB_T), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%XCMFS
WRITE (KLUN) YD%XCMFB
WRITE (KLUN) YD%XCPR2
WRITE (KLUN) YD%XCPR3
WRITE (KLUN) YD%XCPR4
WRITE (KLUN) YD%XCPR5
WRITE (KLUN) YD%XCET
WRITE (KLUN) YD%XCDP
WRITE (KLUN) YD%XCDD
WRITE (KLUN) YD%XCDT
WRITE (KLUN) YD%XRM17
WRITE (KLUN) YD%XLINF
WRITE (KLUN) YD%XALPSBL
WRITE (KLUN) YD%XCEP
WRITE (KLUN) YD%XA0
WRITE (KLUN) YD%XA2
WRITE (KLUN) YD%XA3
WRITE (KLUN) YD%XA5
WRITE (KLUN) YD%XCTD
WRITE (KLUN) YD%XPHI_LIM
WRITE (KLUN) YD%XSBL_O_BL
WRITE (KLUN) YD%XFTOP_O_FSURF
END SUBROUTINE

SUBROUTINE LOAD_CSTURB_T (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (CSTURB_T), INTENT (OUT), TARGET :: YD

READ (KLUN) YD%XCMFS
READ (KLUN) YD%XCMFB
READ (KLUN) YD%XCPR2
READ (KLUN) YD%XCPR3
READ (KLUN) YD%XCPR4
READ (KLUN) YD%XCPR5
READ (KLUN) YD%XCET
READ (KLUN) YD%XCDP
READ (KLUN) YD%XCDD
READ (KLUN) YD%XCDT
READ (KLUN) YD%XRM17
READ (KLUN) YD%XLINF
READ (KLUN) YD%XALPSBL
READ (KLUN) YD%XCEP
READ (KLUN) YD%XA0
READ (KLUN) YD%XA2
READ (KLUN) YD%XA3
READ (KLUN) YD%XA5
READ (KLUN) YD%XCTD
READ (KLUN) YD%XPHI_LIM
READ (KLUN) YD%XSBL_O_BL
READ (KLUN) YD%XFTOP_O_FSURF
END SUBROUTINE


SUBROUTINE COPY_CSTURB_T (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (CSTURB_T), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF






















END SUBROUTINE

SUBROUTINE HOST_CSTURB_T (YD)

IMPLICIT NONE
TYPE (CSTURB_T), TARGET :: YD























END SUBROUTINE

     

SUBROUTINE CRC64_CSTURB_T (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (CSTURB_T), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCMFS), CDPATH//'%XCMFS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCMFB), CDPATH//'%XCMFB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCPR2), CDPATH//'%XCPR2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCPR3), CDPATH//'%XCPR3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCPR4), CDPATH//'%XCPR4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCPR5), CDPATH//'%XCPR5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCET), CDPATH//'%XCET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCDP), CDPATH//'%XCDP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCDD), CDPATH//'%XCDD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCDT), CDPATH//'%XCDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XRM17), CDPATH//'%XRM17'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XLINF), CDPATH//'%XLINF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XALPSBL), CDPATH//'%XALPSBL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCEP), CDPATH//'%XCEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XA0), CDPATH//'%XA0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XA2), CDPATH//'%XA2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XA3), CDPATH//'%XA3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XA5), CDPATH//'%XA5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCTD), CDPATH//'%XCTD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XPHI_LIM), CDPATH//'%XPHI_LIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XSBL_O_BL), CDPATH//'%XSBL_O_BL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XFTOP_O_FSURF), CDPATH//'%XFTOP_O_FSURF'

END SUBROUTINE

SUBROUTINE WIPE_CSTURB_T (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (CSTURB_T), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF






















LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_CSTURB_T (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (CSTURB_T),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%XCMFS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCMFS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCMFB)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCMFB'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCPR2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCPR2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCPR3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCPR3'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCPR4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCPR4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCPR5)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCPR5'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCDP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCDP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCDD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCDD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCDT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCDT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XRM17)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XRM17'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XLINF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XLINF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XALPSBL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XALPSBL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCEP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCEP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XA0)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XA0'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XA2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XA2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XA3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XA3'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XA5)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XA5'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCTD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCTD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XPHI_LIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XPHI_LIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XSBL_O_BL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XSBL_O_BL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XFTOP_O_FSURF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XFTOP_O_FSURF'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
