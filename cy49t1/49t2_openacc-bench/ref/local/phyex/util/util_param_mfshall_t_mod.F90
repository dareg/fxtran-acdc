MODULE UTIL_PARAM_MFSHALL_T_MOD

USE MODD_PARAM_MFSHALL_n, ONLY : PARAM_MFSHALL_T

INTERFACE SAVE
MODULE PROCEDURE SAVE_PARAM_MFSHALL_T
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_PARAM_MFSHALL_T
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_PARAM_MFSHALL_T
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_PARAM_MFSHALL_T
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_PARAM_MFSHALL_T
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_PARAM_MFSHALL_T
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_PARAM_MFSHALL_T
END INTERFACE


CONTAINS

SUBROUTINE SAVE_PARAM_MFSHALL_T (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (PARAM_MFSHALL_T), INTENT (IN), TARGET :: YD

WRITE (KLUN) YD%XIMPL_MF
WRITE (KLUN) YD%CMF_UPDRAFT
WRITE (KLUN) YD%CMF_CLOUD
WRITE (KLUN) YD%LMIXUV
WRITE (KLUN) YD%LMF_FLX
WRITE (KLUN) YD%XALP_PERT
WRITE (KLUN) YD%XABUO
WRITE (KLUN) YD%XBENTR
WRITE (KLUN) YD%XBDETR
WRITE (KLUN) YD%XCMF
WRITE (KLUN) YD%XENTR_MF
WRITE (KLUN) YD%XCRAD_MF
WRITE (KLUN) YD%XENTR_DRY
WRITE (KLUN) YD%XDETR_DRY
WRITE (KLUN) YD%XDETR_LUP
WRITE (KLUN) YD%XKCF_MF
WRITE (KLUN) YD%XKRC_MF
WRITE (KLUN) YD%XTAUSIGMF
WRITE (KLUN) YD%XPRES_UV
WRITE (KLUN) YD%XALPHA_MF
WRITE (KLUN) YD%XSIGMA_MF
WRITE (KLUN) YD%XFRAC_UP_MAX
WRITE (KLUN) YD%XA1
WRITE (KLUN) YD%XB
WRITE (KLUN) YD%XC
WRITE (KLUN) YD%XBETA1
WRITE (KLUN) YD%XR
WRITE (KLUN) YD%LGZ
WRITE (KLUN) YD%XGZ
WRITE (KLUN) YD%LTHETAS_MF
WRITE (KLUN) YD%XLAMBDA_MF
END SUBROUTINE

SUBROUTINE LOAD_PARAM_MFSHALL_T (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (PARAM_MFSHALL_T), INTENT (OUT), TARGET :: YD

READ (KLUN) YD%XIMPL_MF
READ (KLUN) YD%CMF_UPDRAFT
READ (KLUN) YD%CMF_CLOUD
READ (KLUN) YD%LMIXUV
READ (KLUN) YD%LMF_FLX
READ (KLUN) YD%XALP_PERT
READ (KLUN) YD%XABUO
READ (KLUN) YD%XBENTR
READ (KLUN) YD%XBDETR
READ (KLUN) YD%XCMF
READ (KLUN) YD%XENTR_MF
READ (KLUN) YD%XCRAD_MF
READ (KLUN) YD%XENTR_DRY
READ (KLUN) YD%XDETR_DRY
READ (KLUN) YD%XDETR_LUP
READ (KLUN) YD%XKCF_MF
READ (KLUN) YD%XKRC_MF
READ (KLUN) YD%XTAUSIGMF
READ (KLUN) YD%XPRES_UV
READ (KLUN) YD%XALPHA_MF
READ (KLUN) YD%XSIGMA_MF
READ (KLUN) YD%XFRAC_UP_MAX
READ (KLUN) YD%XA1
READ (KLUN) YD%XB
READ (KLUN) YD%XC
READ (KLUN) YD%XBETA1
READ (KLUN) YD%XR
READ (KLUN) YD%LGZ
READ (KLUN) YD%XGZ
READ (KLUN) YD%LTHETAS_MF
READ (KLUN) YD%XLAMBDA_MF
END SUBROUTINE


SUBROUTINE COPY_PARAM_MFSHALL_T (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (PARAM_MFSHALL_T), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF































END SUBROUTINE

SUBROUTINE HOST_PARAM_MFSHALL_T (YD)

IMPLICIT NONE
TYPE (PARAM_MFSHALL_T), TARGET :: YD
































END SUBROUTINE

     

SUBROUTINE CRC64_PARAM_MFSHALL_T (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (PARAM_MFSHALL_T), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XIMPL_MF), CDPATH//'%XIMPL_MF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CMF_UPDRAFT), CDPATH//'%CMF_UPDRAFT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CMF_CLOUD), CDPATH//'%CMF_CLOUD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMIXUV), CDPATH//'%LMIXUV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMF_FLX), CDPATH//'%LMF_FLX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XALP_PERT), CDPATH//'%XALP_PERT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XABUO), CDPATH//'%XABUO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XBENTR), CDPATH//'%XBENTR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XBDETR), CDPATH//'%XBDETR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCMF), CDPATH//'%XCMF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XENTR_MF), CDPATH//'%XENTR_MF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XCRAD_MF), CDPATH//'%XCRAD_MF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XENTR_DRY), CDPATH//'%XENTR_DRY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDETR_DRY), CDPATH//'%XDETR_DRY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XDETR_LUP), CDPATH//'%XDETR_LUP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XKCF_MF), CDPATH//'%XKCF_MF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XKRC_MF), CDPATH//'%XKRC_MF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XTAUSIGMF), CDPATH//'%XTAUSIGMF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XPRES_UV), CDPATH//'%XPRES_UV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XALPHA_MF), CDPATH//'%XALPHA_MF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XSIGMA_MF), CDPATH//'%XSIGMA_MF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XFRAC_UP_MAX), CDPATH//'%XFRAC_UP_MAX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XA1), CDPATH//'%XA1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XB), CDPATH//'%XB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XC), CDPATH//'%XC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XBETA1), CDPATH//'%XBETA1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XR), CDPATH//'%XR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LGZ), CDPATH//'%LGZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XGZ), CDPATH//'%XGZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LTHETAS_MF), CDPATH//'%LTHETAS_MF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%XLAMBDA_MF), CDPATH//'%XLAMBDA_MF'

END SUBROUTINE

SUBROUTINE WIPE_PARAM_MFSHALL_T (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (PARAM_MFSHALL_T), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF































LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_PARAM_MFSHALL_T (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (PARAM_MFSHALL_T),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%XIMPL_MF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XIMPL_MF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CMF_UPDRAFT) * LEN (YD%CMF_UPDRAFT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CMF_UPDRAFT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CMF_CLOUD) * LEN (YD%CMF_CLOUD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CMF_CLOUD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMIXUV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMIXUV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMF_FLX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMF_FLX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XALP_PERT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XALP_PERT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XABUO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XABUO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XBENTR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XBENTR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XBDETR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XBDETR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCMF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCMF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XENTR_MF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XENTR_MF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XCRAD_MF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XCRAD_MF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XENTR_DRY)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XENTR_DRY'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDETR_DRY)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDETR_DRY'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XDETR_LUP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XDETR_LUP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XKCF_MF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XKCF_MF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XKRC_MF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XKRC_MF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XTAUSIGMF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XTAUSIGMF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XPRES_UV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XPRES_UV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XALPHA_MF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XALPHA_MF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XSIGMA_MF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XSIGMA_MF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XFRAC_UP_MAX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XFRAC_UP_MAX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XA1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XA1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XB)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XB'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XBETA1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XBETA1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LGZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LGZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XGZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XGZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LTHETAS_MF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LTHETAS_MF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%XLAMBDA_MF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XLAMBDA_MF'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
