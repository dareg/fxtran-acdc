SUBROUTINE LASURE_OPENACC (YDGEOMETRY, YDEPHY, YDDYN, YDEDYN, YDPHY&
&, KST, KEND, PMAPPA, PGM, PBT, PBDT, PREDIV, YDSTACK)
!$ACC ROUTINE (LASURE_OPENACC) SEQ
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB

USE YOEPHY,ONLY:TEPHY
USE YOMPHY,ONLY:TPHY
USE YEMDYN,ONLY:TEDYN
USE YOMDYN,ONLY:TDYN
#include "stack.h"
USE STACK_MOD
USE ABOR1_ACC_MOD

IMPLICIT NONE

TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TEPHY), INTENT (IN)::YDEPHY
TYPE (TDYN), INTENT (IN)::YDDYN
TYPE (TEDYN), INTENT (IN)::YDEDYN
TYPE (TPHY), INTENT (IN)::YDPHY
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PMAPPA (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PGM (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PBT
REAL (KIND=JPRB), INTENT (OUT)::PBDT (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PREDIV (YDGEOMETRY%YRDIM%NPROMA)
TYPE(STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIM)::JROF


JROF = KST







IF (YDDYN%LSIDG) THEN
  
  PBDT (JROF)=PBT
  PREDIV (JROF)=1.0_JPRB
  
ELSEIF (YDEDYN%LESIDG) THEN
  
  PBDT (JROF)=PBT*PMAPPA (JROF)/(PGM (JROF)*PGM (JROF))
  PREDIV (JROF)=PMAPPA (JROF)/(PGM (JROF)*PGM (JROF))
  
ELSE
  
  PBDT (JROF)=PBT*YDGEOMETRY%YRGEM%RSTRET*YDGEOMETRY%YRGEM%RSTRET/(PGM (JROF)*PGM (JROF))
  PREDIV (JROF)=YDGEOMETRY%YRGEM%RSTRET*YDGEOMETRY%YRGEM%RSTRET/(PGM (JROF)*PGM (JROF))
  
ENDIF




ENDSUBROUTINE LASURE_OPENACC
