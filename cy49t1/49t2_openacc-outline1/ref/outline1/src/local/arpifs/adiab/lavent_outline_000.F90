SUBROUTINE LAVENT_OUTLINE_000 (LDCT, LDCOND, LDSETTLST, LDNESCT, LDSETTLSV, LD2TLFF1, LDNESCV&
&, LDWSAVE, YDVARS, YDCPG_SL1, YDCPG_OPTS, YDCPG_SL2, YDCPG_TND, YDGEOMETRY, YDRIP, PDTS2&
&, YDPARAR, YDML_DYN, YDCPG_BNDS, PWRL9, PALPHA, PEVEL, KSETTLOFF, PRDELP)
USE YOMPARAR,ONLY:TPARAR
USE YOMRIP,ONLY:TRIP
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1B_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_TND_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

LOGICAL, INTENT (INOUT)::LDCT
LOGICAL, INTENT (INOUT)::LDCOND
LOGICAL, INTENT (INOUT)::LDSETTLST
LOGICAL, INTENT (INOUT)::LDNESCT
LOGICAL, INTENT (INOUT)::LDSETTLSV
LOGICAL, INTENT (IN)::LD2TLFF1
LOGICAL, INTENT (INOUT)::LDNESCV
LOGICAL, INTENT (INOUT)::LDWSAVE
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (CPG_SL1B_TYPE), INTENT (INOUT)::YDCPG_SL1
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_SL2_TYPE), INTENT (INOUT)::YDCPG_SL2
TYPE (CPG_TND_TYPE), INTENT (INOUT)::YDCPG_TND
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TRIP), INTENT (IN)::YDRIP
REAL (KIND=JPRB), INTENT (IN)::PDTS2
TYPE (TPARAR), INTENT (IN)::YDPARAR
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
REAL (KIND=JPRB), INTENT (OUT)::PWRL9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PALPHA (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PEVEL (YDGEOMETRY%YRDIM%NPROMA, 0:YDGEOMETRY%YRDIMV%NFLEVG)
INTEGER (KIND=JPIM), INTENT (OUT)::KSETTLOFF (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PRDELP (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
#include "local2cartgeov.intfb.h"
INTEGER (KIND=JPIM)::JROF
REAL (KIND=JPRB)::ZALPHA
REAL (KIND=JPRB)::ZZU
REAL (KIND=JPRB)::ZZV
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPRB)::ZWRL0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('LAVENT_OUTLINE_000', 0, ZHOOK_HANDLE)
PALPHA (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0._JPRB

IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      ZWRL0 (JROF, JLEV)=PEVEL (JROF, JLEV)*(YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH &
      &(JLEV)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH (JLEV-1))*PRDELP (JROF, JLEV)
    ENDDO

  ENDDO

ELSE

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      ZWRL0 (JROF, JLEV)=0.5_JPRB*(PEVEL (JROF, JLEV)+PEVEL (JROF, JLEV-1))*(YDGEOMETRY%YRVERT_GEOM&
      &%YRVETA%VETAH (JLEV)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH (JLEV-1))*PRDELP (JROF, JLEV)
    ENDDO

  ENDDO

ENDIF


IF (YDML_DYN%YRDYNA%LTWOTL.AND.YDML_DYN%YRDYN%LSVTSM) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
    YDCPG_SL1%WRA%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV&
    &)=ZWRL0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
  ENDDO

ENDIF


IF (YDML_DYN%YRDYNA%LTWOTL.AND.YDML_DYN%YRDYNA%LELTRA) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA

      IF (LDCOND) THEN
        ZZU=YDCPG_SL1%UF9%P (JROF, JLEV)
        ZZV=YDCPG_SL1%VF9%P (JROF, JLEV)
      ELSE
        ZZU=YDCPG_SL1%U9%P (JROF, JLEV)
        ZZV=YDCPG_SL1%V9%P (JROF, JLEV)
      ENDIF

      YDCPG_SL1%UR0%P (JROF, JLEV)=YDVARS%U%T0 (JROF, JLEV)+0.5_JPRB*ZZU+PDTS2*YDCPG_TND%TNDU (JROF, JLEV)
      YDCPG_SL1%VR0%P (JROF, JLEV)=YDVARS%V%T0 (JROF, JLEV)+0.5_JPRB*ZZV+PDTS2*YDCPG_TND%TNDV (JROF, JLEV)
    ENDDO

  ENDDO


  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
    YDCPG_SL1%WR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV&
    &)=ZWRL0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    YDCPG_SL2%URL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL1&
    &%UR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    YDCPG_SL2%VRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL1&
    &%VR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    YDCPG_SL2%WRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL1&
    &%WR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
  ENDDO


  IF (LD2TLFF1) THEN

    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
      YDCPG_SL1%UR9%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
      &=YDVARS%U%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      YDCPG_SL1%VR9%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
      &=YDVARS%V%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    ENDDO

  ENDIF

ELSEIF (YDML_DYN%YRDYNA%LTWOTL.AND.(.NOT.YDML_DYN%YRDYNA%LELTRA)) THEN

  IF (.NOT.LDCT) THEN

    IF (YDCPG_OPTS%NSTEP<=YDRIP%NFOST.OR.LDNESCT) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        YDCPG_SL1%UR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
        &=YDVARS%U%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
        YDCPG_SL1%VR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
        &=YDVARS%V%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      ENDDO


      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        YDCPG_SL2%URL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL1&
        &%UR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
        YDCPG_SL2%VRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL1&
        &%VR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      ENDDO

    ELSEIF (LDSETTLST) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
          YDCPG_SL1%UR0%P (JROF, JLEV)=2.0_JPRB*YDVARS%U%T0 (JROF, JLEV)-YDVARS%U%T9 (JROF, JLEV)
          YDCPG_SL1%VR0%P (JROF, JLEV)=2.0_JPRB*YDVARS%V%T0 (JROF, JLEV)-YDVARS%V%T9 (JROF, JLEV)
        ENDDO

      ENDDO


      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        YDCPG_SL2%URL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDVARS&
        &%U%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
        YDCPG_SL2%VRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDVARS&
        &%V%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      ENDDO

    ENDIF


    IF (YDCPG_OPTS%NSTEP<=YDRIP%NFOST.OR.LDNESCV) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        YDCPG_SL1%WR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV&
        &)=ZWRL0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
        YDCPG_SL2%WRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL1&
        &%WR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      ENDDO


      IF (YDCPG_OPTS%NSTEP==0) THEN

        IF (YDML_DYN%YRDYN%LSETTLSVF.OR.LDWSAVE) THEN
          PWRL9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
        ENDIF

      ELSEIF (LDWSAVE) THEN
        PWRL9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)=YDVARS&
        &%EDOT%T9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)
      ENDIF

    ELSEIF (LDSETTLSV) THEN

      IF (YDML_DYN%YRDYN%LSETTLSVF) THEN

        DO JLEV=1, YDML_DYN%YRDYN%NFLEVSF
          KSETTLOFF (:, JLEV)=0

          DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
            ZALPHA=0.5_JPRB*(1._JPRB-TANH (-YDML_DYN%YRDYN%RSCALE*(ZWRL0 (JROF&
            &, JLEV)*YDVARS%EDOT%T9 (JROF, JLEV)+YDML_DYN%YRDYN%RSCALEOFF)))
            YDCPG_SL1%WR0%P (JROF, JLEV)=ZWRL0 (JROF, JLEV)+ZALPHA&
            &*(ZWRL0 (JROF, JLEV)-YDVARS%EDOT%T9 (JROF, JLEV))

            IF (YDML_DYN%YRDYN%LSETTLSVF_DIFF) THEN
              PALPHA (JROF, JLEV)=1._JPRB-ZALPHA
            ENDIF


            IF (YDML_DYN%YRDYN%LSETFSTAT) THEN
              KSETTLOFF (JROF, JLEV)=KSETTLOFF (JROF, JLEV)+NINT (1.0_JPRB-ZALPHA)
            ENDIF

          ENDDO

        ENDDO


        DO JLEV=YDML_DYN%YRDYN%NFLEVSF+1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
            YDCPG_SL1%WR0%P (JROF, JLEV)=2.0_JPRB*ZWRL0 (JROF, JLEV)-YDVARS%EDOT%T9 (JROF, JLEV)
          ENDDO

        ENDDO

        PWRL9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)=YDVARS&
        &%EDOT%T9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)
      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
            YDCPG_SL1%WR0%P (JROF, JLEV)=2.0_JPRB*ZWRL0 (JROF, JLEV)-YDVARS%EDOT%T9 (JROF, JLEV)
          ENDDO

        ENDDO

      ENDIF


      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        YDCPG_SL2%WRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV&
        &)=ZWRL0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      ENDDO

    ENDIF

    YDVARS%EDOT%T9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG&
    &)=ZWRL0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ELSE

    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
      YDCPG_SL1%UR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
      &=YDVARS%U%T9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      YDCPG_SL1%VR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
      &=YDVARS%V%T9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    ENDDO


    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
      YDCPG_SL1%WR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDVARS&
      &%EDOT%T9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    ENDDO


    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
      YDCPG_SL2%URL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDVARS&
      &%U%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      YDCPG_SL2%VRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDVARS&
      &%V%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    ENDDO


    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
      YDCPG_SL2%WRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV&
      &)=ZWRL0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    ENDDO

  ENDIF


  IF (LD2TLFF1) THEN

    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
      YDCPG_SL1%UR9%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
      &=YDVARS%U%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      YDCPG_SL1%VR9%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
      &=YDVARS%V%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    ENDDO

  ENDIF

ELSE

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
    YDCPG_SL1%UR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
    &=YDVARS%U%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    YDCPG_SL1%VR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
    &=YDVARS%V%T0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
  ENDDO


  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
    YDCPG_SL1%WR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV&
    &)=ZWRL0 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    YDCPG_SL2%URL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL1&
    &%UR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    YDCPG_SL2%VRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL1&
    &%VR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    YDCPG_SL2%WRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL1&
    &%WR0%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
  ENDDO


  IF (LD2TLFF1) THEN

    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
      YDCPG_SL1%UR9%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
      &=YDVARS%U%T9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
      YDCPG_SL1%VR9%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)&
      &=YDVARS%V%T9 (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    ENDDO

  ENDIF

ENDIF


IF (YDCPG_OPTS%LAROME.AND.YDPARAR%LSQUALL) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

    DO JROF=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      YDCPG_SL1%VR0%P (JROF, JLEV)=YDCPG_SL1%VR0%P (JROF, JLEV)+YDPARAR%VSQUALL
      YDCPG_SL2%VRL (JROF, JLEV)=YDCPG_SL2%VRL (JROF, JLEV)+YDPARAR%VSQUALL
    ENDDO

  ENDDO

ENDIF


IF (YDML_DYN%YRDYN%LSLDP_RK) THEN

  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
    YDCPG_SL1%UR00%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL2&
    &%URL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    YDCPG_SL1%VR00%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL2&
    &%VRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
    YDCPG_SL1%WR00%P (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)=YDCPG_SL2&
    &%WRL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, JLEV)
  ENDDO

ENDIF


IF (YDML_DYN%YRDYN%LSLDP_CURV.OR.YDML_DYN%YRDYN%LSLDP_XYZ) THEN
  CALL LOCAL2CARTGEOV (0, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YDCPG_BNDS%KIDIA&
  &, YDCPG_BNDS%KFDIA, YDVARS%GEOMETRY%GEMU%P, YDVARS%GEOMETRY%GSQM2%P, YDVARS%GEOMETRY%GECLO&
  &%P, YDVARS%GEOMETRY%GESLO%P, YDCPG_SL1%UR0%P, YDCPG_SL1%VR0%P, YDCPG_SL1%ZR0%P)

  IF (YDML_DYN%YRDYN%LSLDP_XYZ) THEN
    CALL LOCAL2CARTGEOV (1, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YDCPG_BNDS%KIDIA&
    &, YDCPG_BNDS%KFDIA, YDVARS%GEOMETRY%GEMU%P, YDVARS%GEOMETRY%GSQM2%P, YDVARS%GEOMETRY%GECLO&
    &%P, YDVARS%GEOMETRY%GESLO%P, YDCPG_SL2%URL, YDCPG_SL2%VRL, YDCPG_SL2%ZRL)
  ENDIF


  IF (YDML_DYN%YRDYN%LSLDP_RK) THEN
    CALL LOCAL2CARTGEOV (0, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YDCPG_BNDS%KIDIA&
    &, YDCPG_BNDS%KFDIA, YDVARS%GEOMETRY%GEMU%P, YDVARS%GEOMETRY%GSQM2%P, YDVARS%GEOMETRY%GECLO&
    &%P, YDVARS%GEOMETRY%GESLO%P, YDCPG_SL1%UR00%P, YDCPG_SL1%VR00%P, YDCPG_SL1%ZR00%P)
  ENDIF

ENDIF


IF (YDML_DYN%YRDYN%LRHS_CURV.AND.LD2TLFF1) THEN
  CALL LOCAL2CARTGEOV (0, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YDCPG_BNDS%KIDIA&
  &, YDCPG_BNDS%KFDIA, YDVARS%GEOMETRY%GEMU%P, YDVARS%GEOMETRY%GSQM2%P, YDVARS%GEOMETRY%GECLO&
  &%P, YDVARS%GEOMETRY%GESLO%P, YDCPG_SL1%UR9%P, YDCPG_SL1%VR9%P, YDCPG_SL1%ZR9%P)
ENDIF

IF (LHOOK) CALL DR_HOOK ('LAVENT_OUTLINE_000', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
