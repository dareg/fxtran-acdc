SUBROUTINE CPUTQY_APLPAR_EXPL_ZDEC (PDT, PRRG, YDCPG_OPTS, PFLAG, YDMF_PHYS_BASE_STATE, YDPHY&
&, YDCPG_BNDS, PDTT1, PTENDV_ZDEC, PTENDH, PTENDU_ZDEC, PDEC, PTENDTKE, PRRGDELP, PTDCP)
USE PARKIND1,ONLY:JPIM, JPRB
USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE YOMPHY,ONLY:TPHY
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

REAL (KIND=JPRB), INTENT (IN)::PDT
REAL (KIND=JPRB), INTENT (INOUT)::PRRG
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
REAL (KIND=JPRB), INTENT (INOUT)::PFLAG
TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (TPHY), INTENT (IN)::YDPHY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
REAL (KIND=JPRB), INTENT (INOUT)::PDTT1 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDV_ZDEC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDH (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDU_ZDEC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PDEC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTENDTKE (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PRRGDELP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PTDCP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
INTEGER (KIND=JPIM)::JLON
REAL (KIND=JPRB)::ZCPF
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPRB)::ZH
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('CPUTQY_APLPAR_EXPL_ZDEC', 0, ZHOOK_HANDLE)

DO JLEV=1, YDCPG_OPTS%KFLEVG

  DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
    ZCPF=1.0_JPRB/(YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%CP (JLON, JLEV)+PDT*PTDCP (JLON, JLEV))
    ZH=YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%CP (JLON, JLEV)*YDMF_PHYS_BASE_STATE%T (JLON, JLEV)
    PDEC (JLON, JLEV)=(YDMF_PHYS_BASE_STATE%U (JLON, JLEV)*PTENDU_ZDEC (JLON, JLEV&
    &)+YDMF_PHYS_BASE_STATE%V (JLON, JLEV)*PTENDV_ZDEC (JLON, JLEV)+0.5_JPRB*PDT&
    &*((PTENDU_ZDEC (JLON, JLEV))**2+(PTENDV_ZDEC (JLON, JLEV))**2))
    PRRGDELP (JLON, JLEV)=PFLAG*PRRG*YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%DELP (JLON, JLEV)
    PDTT1 (JLON, JLEV)=PFLAG*(ZCPF*(ZH-PDT*PDEC (JLON, JLEV)+PDT*PTENDH&
    & (JLON, JLEV))-YDMF_PHYS_BASE_STATE%T (JLON, JLEV))

    IF (YDPHY%LPTKE) THEN
      PDTT1 (JLON, JLEV)=PDTT1 (JLON, JLEV)-PFLAG*ZCPF*PDT*PTENDTKE (JLON, JLEV)
    ENDIF

  ENDDO

ENDDO

IF (LHOOK) CALL DR_HOOK ('CPUTQY_APLPAR_EXPL_ZDEC', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
