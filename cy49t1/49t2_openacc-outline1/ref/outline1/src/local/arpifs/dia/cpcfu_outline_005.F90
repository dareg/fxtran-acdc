SUBROUTINE CPCFU_OUTLINE_005 (LDRESET, YDVARS, YDCPG_MISC, YDCPG_DYN0&
&, YDCPG_OPTS, YDCFU, YDCST, YDCPG_BNDS, YDRIP)
USE PARKIND1,ONLY:JPIM, JPRB
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE, CPG_MISC_TYPE
USE YOMCST,ONLY:TCST
USE YOMCFU,ONLY:TCFU
USE YOMRIP,ONLY:TRIP
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

LOGICAL, INTENT (INOUT)::LDRESET
TYPE (FIELD_VARIABLES), INTENT (IN)::YDVARS
TYPE (CPG_MISC_TYPE), INTENT (IN)::YDCPG_MISC
TYPE (CPG_DYN_TYPE), INTENT (IN)::YDCPG_DYN0
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (TCFU), INTENT (INOUT)::YDCFU
TYPE (TCST), INTENT (IN)::YDCST
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (TRIP), INTENT (IN)::YDRIP
REAL (KIND=JPRB)::ZMUL
INTEGER (KIND=JPIM)::JLON
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('CPCFU_OUTLINE_005', 0, ZHOOK_HANDLE)

IF (YDCFU%YQTOT%LACTIVE) THEN

  IF (LDRESET) THEN
    YDCFU%QTOT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  ZMUL=1._JPRB/YDCST%RG

  DO JLEV=1, YDCPG_OPTS%KFLEVG

    DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      YDCFU%QTOT (JLON)=YDCFU%QTOT (JLON)+YDVARS%Q%T0 (JLON, JLEV&
      &)*YDCPG_DYN0%XYB%DELP (JLON, JLEV)*ZMUL*YDRIP%TSTEP
    ENDDO

  ENDDO

ENDIF


IF (YDCFU%YQICE%LACTIVE) THEN

  IF (LDRESET) THEN
    YDCFU%QICE (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  ZMUL=1._JPRB/YDCST%RG

  DO JLEV=1, YDCPG_OPTS%KFLEVG

    DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      YDCFU%QICE (JLON)=YDCFU%QICE (JLON)+YDCPG_MISC%QICE (JLON, JLEV&
      &)*YDCPG_DYN0%XYB%DELP (JLON, JLEV)*ZMUL*YDRIP%TSTEP
    ENDDO

  ENDDO

ENDIF


IF (YDCFU%YQLI%LACTIVE) THEN

  IF (LDRESET) THEN
    YDCFU%QLI (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  ZMUL=1._JPRB/YDCST%RG

  DO JLEV=1, YDCPG_OPTS%KFLEVG

    DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      YDCFU%QLI (JLON)=YDCFU%QLI (JLON)+YDCPG_MISC%QLI (JLON, JLEV&
      &)*YDCPG_DYN0%XYB%DELP (JLON, JLEV)*ZMUL*YDRIP%TSTEP
    ENDDO

  ENDDO

ENDIF


IF (YDCFU%YOZONT%LACTIVE) THEN

  IF (LDRESET) THEN
    YDCFU%OZONT (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
  ENDIF

  ZMUL=1._JPRB/YDCST%RG

  DO JLEV=1, YDCPG_OPTS%KFLEVG

    DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      YDCFU%OZONT (JLON)=YDCFU%OZONT (JLON)+YDVARS%O3%T0 (JLON, JLEV&
      &)*YDCPG_DYN0%XYB%DELP (JLON, JLEV)*ZMUL*YDRIP%TSTEP
    ENDDO

  ENDDO

ENDIF

IF (LHOOK) CALL DR_HOOK ('CPCFU_OUTLINE_005', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
