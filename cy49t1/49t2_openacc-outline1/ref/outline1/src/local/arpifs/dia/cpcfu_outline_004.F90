SUBROUTINE CPCFU_OUTLINE_004 (LDNORESET, LDRESET, YDCFU, KTIME, YDMF_PHYS_OUT, YDCPG_BNDS, YDRIP)
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_OUT_TYPE
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMCFU,ONLY:TCFU
USE YOMRIP,ONLY:TRIP
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

LOGICAL, INTENT (INOUT)::LDNORESET
LOGICAL, INTENT (INOUT)::LDRESET
TYPE (TCFU), INTENT (INOUT)::YDCFU
INTEGER (KIND=JPIM), INTENT (INOUT)::KTIME
TYPE (MF_PHYS_OUT_TYPE), INTENT (IN)::YDMF_PHYS_OUT
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (TRIP), INTENT (IN)::YDRIP
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('CPCFU_OUTLINE_004', 0, ZHOOK_HANDLE)
LDNORESET=.FALSE.

IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
  YDCFU%FCL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
ENDIF

KTIME=1
YDCFU%FCL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FCL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)+YDMF_PHYS_OUT&
&%FCLL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
LDNORESET=.FALSE.
LDNORESET=.TRUE.

IF (LDRESET.AND.(.NOT.LDNORESET)) THEN
  YDCFU%FCL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=0._JPRB
ENDIF

KTIME=1
YDCFU%FCL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDCFU%FCL (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)+YDMF_PHYS_OUT&
&%FCLN (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA, 1)*YDRIP%TSTEP*REAL (KTIME, JPRB)
IF (LHOOK) CALL DR_HOOK ('CPCFU_OUTLINE_004', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
