SUBROUTINE APL_ARPEGE_RADIATION_SUNSHINE (YDMF_PHYS_SURF, YDMF_PHYS, YDMODEL, YDCPG_BNDS)
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE PARKIND1,ONLY:JPIM, JPRB
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE TYPE_MODEL,ONLY:MODEL
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
INTEGER (KIND=JPIM)::JLON
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_SUNSHINE', 0, ZHOOK_HANDLE)

DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA

  IF (YDMF_PHYS%OUT%FRSODS (JLON)>=YDMODEL%YRML_PHY_RAD%YRERDI%RSUNDUR) THEN
    YDMF_PHYS_SURF%GSD_VD%PSUND (JLON)=YDMF_PHYS_SURF%GSD_VD&
    &%PSUND (JLON)+1.0_JPRB*YDMODEL%YRML_GCONF%YRRIP%TSTEP
  ENDIF

ENDDO

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_SUNSHINE', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
