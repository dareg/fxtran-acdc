SUBROUTINE APL_ARPEGE_INIT_OUTLINE_001 (YDVARS, YDCPG_MISC, YDCPG_OPTS&
&, YDMF_PHYS_SURF, YDMF_PHYS_BASE_STATE, YDMODEL, YDCPG_BNDS, PQO3)
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE PARKIND1,ONLY:JPIM, JPRB
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE
USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE TYPE_MODEL,ONLY:MODEL
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
REAL (KIND=JPRB), INTENT (OUT)::PQO3 (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
#include "suozon.intfb.h"
#include "radozcmf.intfb.h"
INTEGER (KIND=JPIM)::JLON
REAL (KIND=JPRB)::ZEPSO3
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPRB)::ZROZ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_OUTLINE_001', 0, ZHOOK_HANDLE)

IF (YDMODEL%YRML_PHY_G%YRDPHY%NVCLIS==1) THEN
  ZEPSO3=1.E-11_JPRB

  DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
    PQO3 (JLON, 0)=1.E-9_JPRB
  ENDDO


  DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

    DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      PQO3 (JLON, JLEV)=YDCPG_MISC%KOZO (JLON, JLEV, 1)
    ENDDO

  ENDDO

ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%LO3FL.AND.(YDMODEL%YRML_PHY_RAD&
  &%YRERAD%NOZOCL==1).AND.YDMODEL%YRML_PHY_MF%YRPHY%LRAYFM) THEN

  IF (MOD (YDCPG_OPTS%NSTEP, YDMODEL%YRML_PHY_RAD%YRERAD%NRADFR)==0) THEN
    CALL RADOZCMF (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP%YREOZOC, YDCPG_BNDS&
    &%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMF_PHYS_BASE_STATE&
    &%YCPG_PHY%PREHYD, YDVARS%GEOMETRY%GEMU%T0, ZROZ)

    DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
      PQO3 (JLON, 0)=1.E-9_JPRB
    ENDDO


    DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

      DO JLON=YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA
        PQO3 (JLON, JLEV)=ZROZ (JLON, JLEV)*YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%RDELP (JLON, JLEV)
      ENDDO

    ENDDO

  ENDIF

ELSE
  CALL SUOZON (YDCPG_BNDS%KIDIA, YDCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, PQO3,.FALSE.,&
  & YDMF_PHYS_BASE_STATE%YCPG_PHY%PREHYD, YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%RDELP, YDMODEL%YRML_PHY_MF&
  &%YRPHY%LO3ABC, YDMF_PHYS_SURF%GSD_VC%PA, YDMF_PHYS_SURF%GSD_VC%PB, YDMF_PHYS_SURF%GSD_VC%PC)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_OUTLINE_001', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
