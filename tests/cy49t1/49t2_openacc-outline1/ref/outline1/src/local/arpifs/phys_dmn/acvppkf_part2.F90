SUBROUTINE ACVPPKF_PART2 (LDOCHTRANS, PRDOCP, YDCPG_OPTS, K_KCH1, D, KKICE, YDML_PHY_MF&
&, PSWLCL, PSTHES, PRCTEN, PTHT, KSPBL, PSTLCL, PRVTEN, LDTRIG1, PZUMF, PSHAL_ZCH1TENS&
&, PSTHVELCL, KSDPL, PSTHLCL, KSLCL, PSHAL_ZCH1, PT, PRC, PRI, PZZ, KCLTOPS, KCLBASS&
&, PRITEN, PSZLCL, PPABS, PTTEN, PSTHV, PRV, PSRVLCL)
USE MODEL_PHYSICS_MF_MOD,ONLY:MODEL_PHYSICS_MF_TYPE
USE MODI_SHALLOW_CONVECTION_PART2_SELECT,ONLY:SHALLOW_CONVECTION_PART2_SELECT
USE PARKIND1,ONLY:JPIM, JPRB
USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK

IMPLICIT NONE

LOGICAL, INTENT (INOUT)::LDOCHTRANS
REAL (KIND=JPRB), INTENT (INOUT)::PRDOCP
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
INTEGER (KIND=JPIM), INTENT (IN)::K_KCH1
TYPE (DIMPHYEX_T), INTENT (INOUT)::D
INTEGER (KIND=JPIM), INTENT (INOUT)::KKICE
TYPE (MODEL_PHYSICS_MF_TYPE), INTENT (IN)::YDML_PHY_MF
REAL (KIND=JPRB), INTENT (INOUT)::PSWLCL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PSTHES (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PRCTEN (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PTHT (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
INTEGER (KIND=JPIM), INTENT (INOUT)::KSPBL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PSTLCL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PRVTEN (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
LOGICAL, INTENT (INOUT)::LDTRIG1 (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PZUMF (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PSHAL_ZCH1TENS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, K_KCH1)
REAL (KIND=JPRB), INTENT (INOUT)::PSTHVELCL (YDCPG_OPTS%KLON)
INTEGER (KIND=JPIM), INTENT (INOUT)::KSDPL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PSTHLCL (YDCPG_OPTS%KLON)
INTEGER (KIND=JPIM), INTENT (INOUT)::KSLCL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PSHAL_ZCH1 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, K_KCH1)
REAL (KIND=JPRB), INTENT (INOUT)::PT (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PRC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PRI (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PZZ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
INTEGER (KIND=JPIM), INTENT (INOUT)::KCLTOPS (YDCPG_OPTS%KLON)
INTEGER (KIND=JPIM), INTENT (INOUT)::KCLBASS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PRITEN (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PSZLCL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PPABS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PTTEN (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PSTHV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PRV (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PSRVLCL (YDCPG_OPTS%KLON)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PART2', 0, ZHOOK_HANDLE)
CALL SHALLOW_CONVECTION_PART2_SELECT (YDML_PHY_MF%YRCVMNH%YRCVP_SHAL, YDML_PHY_MF%YRCVMNH%YRCVPEXT&
&, YDML_PHY_MF%YRCVMNH%YRCST_MNH, D, YDML_PHY_MF%YRCVMNH%YRNSV, YDML_PHY_MF%YRCVMNH%YRCONVPAR&
&, KKICE, YDML_PHY_MF%YRCVMNH%LSETTADJ, YDML_PHY_MF%YRCVMNH%OTADJS, PPABS, PZZ, PT, PRV, PRC&
&, PRI, LDOCHTRANS, K_KCH1, PSHAL_ZCH1, PRDOCP, PTHT, PSTHV, PSTHES, KSDPL, KSPBL, KSLCL, PSTHLCL&
&, PSTLCL, PSRVLCL, PSWLCL, PSZLCL, PSTHVELCL, LDTRIG1, PZUMF, PTTEN, PRVTEN, PRCTEN, PRITEN&
&, KCLTOPS, KCLBASS, PSHAL_ZCH1TENS, COUNT (LDTRIG1 (D%NIB:D%NIE)))
IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PART2', 1, ZHOOK_HANDLE)
ENDSUBROUTINE
