
SUBROUTINE RECMWF (YDDIMV, YDMODEL, YDCPG_OPTS, YDCPG_BNDS, KOZOCL, KMACCAERO, KAERO, PALBD&
&, PALBP, PAPRS, PAPRSF, PNEB, PQO3, PQCO2, PQCH4, PQN2O, PQNO2, PQC11, PQC12, PQC22, PQCL4&
&, PAER, PAERO, PAEROCPL, PDELP, PEMIS, PMU0M, PQ, PQSAT, PQICE, PQLIQ, PS, PRR, PLSM, PT, PTS&
&, PEMTD, PEMTU, PTRSO, PLWFC, PLWFT, PSWFC, PSWFT, PSFSWDIR, PSFSWDIF, PFSDNN, PFSDNV, PCTRSO&
&, PCEMTR, PTRSOD, PTRSODIR, PTRSODIF, PPIZA_DST, PCGA_DST, PTAUREL_DST, PAERINDS, PGELAM, PGEMU&
&, PSWDIR, PSWDIF, PMU0LU, PALB, PVRMOON, PCLDROP, YSPP_RSWINHF, YSPP_RLWINHF)
USE TYPE_MODEL,ONLY:MODEL
USE YOMDIMV,ONLY:TDIMV
USE PARKIND1,ONLY:JPIM, JPRB
USE YOMHOOK,ONLY:DR_HOOK, JPHOOK, LHOOK
USE SPP_MOD_TYPE,ONLY:APPLY_SPP, TSPP_CONFIG_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE

IMPLICIT NONE


TYPE (TDIMV), INTENT (IN)::YDDIMV
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
INTEGER (KIND=JPIM), INTENT (IN)::KOZOCL
INTEGER (KIND=JPIM), INTENT (IN)::KMACCAERO
INTEGER (KIND=JPIM), INTENT (IN)::KAERO
REAL (KIND=JPRB), INTENT (IN)::PGELAM (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PGEMU (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PALBD (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PALBP (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PAPRS (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PAPRSF (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PNEB (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQO3 (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQCO2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQCH4 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQN2O (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQNO2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQC11 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQC12 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQC22 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQCL4 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PAER (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 6)
REAL (KIND=JPRB), INTENT (IN)::PAERO (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, KAERO)
REAL (KIND=JPRB), INTENT (IN)::PAEROCPL (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD&
&%YRERAD%NTLW, MERGE (6, 0, YDMODEL%YRML_PHY_RAD%YREAERATM%LAERRADCPL))
REAL (KIND=JPRB), INTENT (IN)::PAERINDS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PDELP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PEMIS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PMU0M (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQSAT (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQICE (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PQLIQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PLSM (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PT (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN)::PPIZA_DST (YDCPG_OPTS%KLON&
&, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PCGA_DST (YDCPG_OPTS%KLON&
&, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PTAUREL_DST (YDCPG_OPTS%KLON&
&, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (OUT)::PEMTD (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PEMTU (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PTRSO (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PCTRSO (YDCPG_OPTS%KLON, 0:1)
REAL (KIND=JPRB), INTENT (OUT)::PCEMTR (YDCPG_OPTS%KLON, 0:1)
REAL (KIND=JPRB), INTENT (OUT)::PTRSOD (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (OUT)::PLWFC (YDCPG_OPTS%KLON, 0:1)
REAL (KIND=JPRB), INTENT (OUT)::PLWFT (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG, 1:YDCPG_OPTS%KTSSG+1)
REAL (KIND=JPRB), INTENT (OUT)::PSWFC (YDCPG_OPTS%KLON, 0:1)
REAL (KIND=JPRB), INTENT (OUT)::PSWFT (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG, 1:YDCPG_OPTS%KTSSG+1)
REAL (KIND=JPRB), INTENT (OUT)::PSFSWDIR (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (OUT)::PSFSWDIF (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (OUT)::PFSDNN (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (OUT)::PFSDNV (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (OUT)::PTRSODIR (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (OUT)::PTRSODIF (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB), INTENT (IN)::PS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PRR (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PSWDIR (YDCPG_OPTS%KLON, YDCPG_OPTS%KSW)
REAL (KIND=JPRB), INTENT (INOUT)::PSWDIF (YDCPG_OPTS%KLON, YDCPG_OPTS%KSW)
REAL (KIND=JPRB), INTENT (IN)::PMU0LU (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PALB (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (INOUT)::PVRMOON (YDCPG_OPTS%KLON)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PCLDROP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
TYPE (TSPP_CONFIG_TYPE), INTENT (INOUT), OPTIONAL::YSPP_RLWINHF
TYPE (TSPP_CONFIG_TYPE), INTENT (INOUT), OPTIONAL::YSPP_RSWINHF
REAL (KIND=JPRB)::ZTH (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRAER (YDCPG_OPTS%KLON, 6, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRCLC (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRMU0 (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZQIWP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZQLWP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZPQO3 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZQS (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZQ (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZCLDROP (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZNTOP (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZNBAS (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZCCNO (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZCCNL (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPFRSODC (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPFRTEDC (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZRNO2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRN2O (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRCO2 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRCH4 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRCL4 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRC22 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRC12 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZRC11 (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZPAERO (YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, KAERO)
REAL (KIND=JPRB)::ZPCDIR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPFDIF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPFDIR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFLUX_PAR_CLEAR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFLUX_PAR (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFLUX_UV (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFRTED (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZLWDERIVATIVE (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZSWDIFFUSEBAND (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB)::ZSWDIRECTBAND (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NSW)
REAL (KIND=JPRB)::ZEMIT (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFCT (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZFCS (YDCPG_OPTS%KLON, 0:YDCPG_OPTS%KFLEVG)
REAL (KIND=JPRB)::ZSUDU (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZFRSOD (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZTINCF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPARCF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZUVDF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZPARF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZRLWINHF (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZRSWINHF (YDCPG_OPTS%KLON)






REAL (KIND=JPRB)::ZEMIW (YDCPG_OPTS%KLON)
REAL (KIND=JPRB)::ZCRAE
REAL (KIND=JPRB)::ZSPECTRALEMISS (YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NLWEMISS)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE

#include "recmwf_srtm.intfb.h"
#include "recmwf_finish.intfb.h"
#include "recmwf_ecrad_post.intfb.h"
#include "recmwf_ecrad_gpu.intfb.h"
#include "recmwf_ecrad_cpu.intfb.h"
#include "recmwf_rrtm.intfb.h"
#include "recmwf_outline_002.intfb.h"
#include "recmwf_outline_001.intfb.h"
#include "recmwf_prepare.intfb.h"




IF (LHOOK) CALL DR_HOOK ('RECMWF', 0, ZHOOK_HANDLE)



ZCRAE=YDMODEL%YRML_PHY_RAD%YRERDI%RRAE*(YDMODEL%YRML_PHY_RAD%YRERDI%RRAE+2.0_JPRB)

IF (PRESENT (PCLDROP)) THEN
  
  ZCLDROP (:,:)=PCLDROP (:,:)
  
ENDIF

CALL RECMWF_PREPARE (KAERO, YDMODEL, YDCPG_OPTS, ZCRAE, YDCPG_BNDS, KOZOCL, ZRC12, PQCL4, PNEB, ZQLWP&
&, ZNBAS, ZRNO2, PEMIS, ZTH, ZRCLC, PAER, ZSPECTRALEMISS, PQO3, ZPAERO, ZRC11, PQNO2, ZNTOP, PT, PTS,&
& ZRN2O, PQN2O, PQC12, PQ, ZQIWP, ZRC22, PQCH4, PQLIQ, ZCCNL, PAPRSF, ZEMIW, PQC22, PAERO, PQSAT, PQICE&
&, PMU0M, ZRAER, PQC11, ZRMU0, ZQ, PAPRS, ZPQO3, ZRCL4, ZCCNO, ZRCO2, ZQS, PDELP, PQCO2, ZRCH4)

IF (PRESENT (YSPP_RSWINHF)) THEN
  

  IF (YSPP_RSWINHF%LPERT) THEN
    CALL APPLY_SPP (YSPP_RSWINHF, YDCPG_OPTS%KLON, YDCPG_BNDS%KIDIA, YDCPG_BNDS&
    &%KFDIA, YDMODEL%YRML_PHY_RAD%YRERAD%RSWINHF, ZRSWINHF)
  ELSE
    ZRSWINHF (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDMODEL%YRML_PHY_RAD%YRERAD%RSWINHF
  ENDIF

  
ELSE
  CALL RECMWF_OUTLINE_001 (YDCPG_OPTS, YDMODEL, YDCPG_BNDS, ZRSWINHF)
ENDIF


IF (PRESENT (YSPP_RLWINHF)) THEN
  

  IF (YSPP_RLWINHF%LPERT) THEN
    CALL APPLY_SPP (YSPP_RLWINHF, YDCPG_OPTS%KLON, YDCPG_BNDS%KIDIA, YDCPG_BNDS&
    &%KFDIA, YDMODEL%YRML_PHY_RAD%YRERAD%RLWINHF, ZRLWINHF)
  ELSE
    ZRLWINHF (YDCPG_BNDS%KIDIA:YDCPG_BNDS%KFDIA)=YDMODEL%YRML_PHY_RAD%YRERAD%RLWINHF
  ENDIF

  
ELSE
  CALL RECMWF_OUTLINE_002 (YDCPG_OPTS, YDMODEL, YDCPG_BNDS, ZRLWINHF)
ENDIF


IF (YDMODEL%YRML_PHY_RAD%YRERAD%LSRTM.AND.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN
  CALL RECMWF_SRTM (KAERO, YDDIMV, YDMODEL, YDCPG_OPTS, YDCPG_BNDS, ZSWDIRECTBAND, ZRC12, ZPFRSODC&
  &, ZPFDIR, ZFRTED, ZPCDIR, PNEB, ZQLWP, ZRNO2, PEMIS, ZTH, PGEMU, ZFRSOD, ZPAERO, ZRC11, PT, ZSWDIFFUSEBAND&
  &, PTS, ZRN2O, ZQIWP, ZRC22, ZPARCF, PSWFT, ZCCNL, ZEMIT, ZSUDU, PAPRSF, ZEMIW, PLSM, ZPFRTEDC&
  &, ZUVDF, ZFCT, ZTINCF, PGELAM, ZPFDIF, ZRAER, ZFCS, ZRMU0, PALBD, ZQ, PAPRS, PRR, ZPQO3, ZPARF&
  &, ZRCL4, ZCCNO, PALBP, ZRCO2, PLWFT, PDELP, ZRCH4, PS, ZLWDERIVATIVE)
ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%LRRTM.AND..NOT.YDMODEL%YRML_PHY_RAD&
  &%YRERAD%LSRTM.AND.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN
  CALL RECMWF_RRTM (YDCPG_OPTS, YDDIMV, YDMODEL, YDCPG_BNDS, ZEMIW, PLSM, ZRLWINHF, PPIZA_DST, ZUVDF, PAERINDS&
  &, ZFCT, ZRSWINHF, ZTINCF, PTAUREL_DST, PFSDNN, ZNBAS, ZQLWP, PEMIS, ZRAER, ZFCS, ZTH, ZRCLC, ZRMU0,&
  & ZQ, PALBD, PAPRS, ZFRSOD, PFSDNV, ZNTOP, PCGA_DST, ZPARF, ZPQO3, PT, PTS, ZCCNO, PALBP, ZQIWP, ZPARCF&
  &, PLWFT, PSFSWDIF, PSWFT, ZCCNL, ZQS, ZEMIT, PDELP, ZSUDU, PSFSWDIR, PAPRSF, ZCLDROP)
ELSEIF (.NOT.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN

  IF (YDMODEL%YRML_PHY_RAD%YRERAD%CECRADARCH=='CPU') THEN
    CALL RECMWF_ECRAD_CPU (KAERO, YDCPG_OPTS, YDMODEL, YDCPG_BNDS, ZSWDIRECTBAND, ZRC12, PLSM, ZPFRTEDC&
    &, PAEROCPL, ZPFRSODC, ZPFDIR, ZFCT, ZTINCF, ZFRTED, PGELAM, ZPCDIR, ZQLWP, ZFLUX_PAR_CLEAR, ZRNO2&
    &, ZRAER, ZFCS, ZRCLC, ZTH, ZFLUX_UV, ZRMU0, ZSPECTRALEMISS, PGEMU, ZQ, PALBD, PAPRS, ZFRSOD, ZPAERO&
    &, PRR, ZRC11, ZPQO3, PT, ZSWDIFFUSEBAND, ZRCL4, PTS, ZRN2O, ZCCNO, ZQIWP, PALBP, ZRC22, ZRCO2,&
    & PLWFT, ZFLUX_PAR, PSWFT, ZCCNL, ZEMIT, ZSUDU, PAPRSF, ZLWDERIVATIVE, PS, ZRCH4)
  ENDIF


  IF (YDMODEL%YRML_PHY_RAD%YRERAD%CECRADARCH=='GPU') THEN
    CALL RECMWF_ECRAD_GPU (KAERO, YDCPG_OPTS, YDMODEL, YDCPG_BNDS, ZSWDIRECTBAND, ZRC12, PLSM, ZPFRTEDC&
    &, PAEROCPL, ZPFRSODC, ZPFDIR, ZFCT, ZTINCF, ZFRTED, PGELAM, ZPCDIR, ZQLWP, ZFLUX_PAR_CLEAR, ZRNO2&
    &, ZRAER, ZFCS, ZRCLC, ZTH, ZFLUX_UV, ZRMU0, ZSPECTRALEMISS, PGEMU, ZQ, PALBD, PAPRS, ZFRSOD, ZPAERO&
    &, PRR, ZRC11, ZPQO3, PT, ZSWDIFFUSEBAND, ZRCL4, PTS, ZRN2O, ZCCNO, ZQIWP, PALBP, ZRC22, ZRCO2,&
    & PLWFT, ZFLUX_PAR, PSWFT, ZCCNL, ZEMIT, ZSUDU, PAPRSF, ZLWDERIVATIVE, PS, ZRCH4)
  ENDIF

  CALL RECMWF_ECRAD_POST (YDCPG_OPTS, YDCPG_BNDS, ZFRSOD, ZPFDIF, ZPFDIR)
ENDIF

CALL RECMWF_FINISH (YDCPG_OPTS, YDMODEL, YDCPG_BNDS, ZSWDIRECTBAND, PVRMOON, PTRSODIR, PTRSODIF, PEMTD&
&, PTRSO, ZPFDIR, ZFCT, PNEB, ZPFDIF, PFSDNN, PQICE, PMU0M, PTRSOD, ZFCS, PCTRSO, ZRMU0, PAER, PQO3&
&, PALBD, PAPRS, ZFRSOD, PSWFC, PSWDIR, PLWFC, PEMTU, PFSDNV, PSWDIF, PMU0LU, PT, ZSWDIFFUSEBAND, PQ&
&, PALBP, ZRCO2, PLWFT, PQLIQ, PSFSWDIF, PSWFT, PDELP, PALB, PAPRSF, PSFSWDIR, PCEMTR)



IF (LHOOK) CALL DR_HOOK ('RECMWF', 1, ZHOOK_HANDLE)
ENDSUBROUTINE RECMWF
