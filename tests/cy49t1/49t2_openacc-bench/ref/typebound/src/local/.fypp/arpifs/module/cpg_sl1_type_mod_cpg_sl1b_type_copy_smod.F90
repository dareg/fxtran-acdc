SUBMODULE (CPG_SL1_TYPE_MOD) CPG_SL1_TYPE_MOD_CPG_SL1B_TYPE_COPY_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE COPY_CPG_SL1B_TYPE (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1B_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
INTEGER :: J1
LOGICAL :: LAERAOT, LAERLISI, LAERO, LAEROCLIM, LAEROUT, LCHEM, LEDRP, LEMIS3D, LERA40, LEXT
LOGICAL :: LEZDIAG, LFORC, LF_DATA, LGFL, LGHG, LLIMA, LNOGW, LSLDIA, LUVP, LZDATA
LOGICAL :: LZVIEW

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

LZVIEW = ASSOCIATED (SELF%ZVIEW)
IF (LZVIEW) THEN
  !$ACC ENTER DATA CREATE (SELF%ZVIEW)
  !$ACC UPDATE DEVICE (SELF%ZVIEW)
  !$ACC ENTER DATA ATTACH (SELF%ZVIEW)
ENDIF

LZDATA = ASSOCIATED (SELF%ZDATA)
IF (LZDATA) THEN
  !$ACC ENTER DATA CREATE (SELF%ZDATA)
  !$ACC UPDATE DEVICE (SELF%ZDATA)
  !$ACC ENTER DATA ATTACH (SELF%ZDATA)
ENDIF

LF_DATA = ASSOCIATED (SELF%F_DATA)
IF (LF_DATA .AND. LLFIELDAPI) THEN
  CALL COPY_FIELD_3RB (SELF%F_DATA)
  !$ACC ENTER DATA ATTACH (SELF%F_DATA)
ENDIF

CALL SELF%U9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%V9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%T9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%PD9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VD9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%NHX9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%UR0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VR0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%ZR0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%WR0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%UR00%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VR00%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%ZR00%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%WR00%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%WRA%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%UR9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VR9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%DBBC9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%DPHI9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%GWS9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%U0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%V0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%T0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%PD0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VD0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%C9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%SP9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%SP0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%C0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%UP9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VP9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%TP9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%U9_SI%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%V9_SI%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%T9_SI%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%PD9_SI%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VD9_SI%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%C9_SI%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%UF9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VF9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%TF9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VDF9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%U9_NL%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%V9_NL%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%T9_NL%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%PD9_NL%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%VD9_NL%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%C9_NL%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%ZR9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%Z9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%Z0%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%ZP9%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%Q%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%I%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%L%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%IMF%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%LMF%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%LCONV%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%ICONV%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%RCONV%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%SCONV%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%IRAD%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%LRAD%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%S%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%R%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%G%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%H%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%TKE%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%TTE%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%EFB1%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%EFB2%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%EFB3%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%A%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%AMF%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%O3%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%SRC%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%MXL%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%SHTUR%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%FQTUR%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%FSTUR%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%CPF%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%SPF%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%CVGQ%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%QVA%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LGHG = ALLOCATED (SELF%GHG)
IF (LGHG) THEN
  !$ACC ENTER DATA CREATE (SELF%GHG)
  !$ACC UPDATE DEVICE (SELF%GHG)
  DO J1 = LBOUND (SELF%GHG, 1), UBOUND (SELF%GHG, 1)
    CALL SELF%GHG (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%GHG)
ENDIF

LCHEM = ALLOCATED (SELF%CHEM)
IF (LCHEM) THEN
  !$ACC ENTER DATA CREATE (SELF%CHEM)
  !$ACC UPDATE DEVICE (SELF%CHEM)
  DO J1 = LBOUND (SELF%CHEM, 1), UBOUND (SELF%CHEM, 1)
    CALL SELF%CHEM (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%CHEM)
ENDIF

LAERO = ALLOCATED (SELF%AERO)
IF (LAERO) THEN
  !$ACC ENTER DATA CREATE (SELF%AERO)
  !$ACC UPDATE DEVICE (SELF%AERO)
  DO J1 = LBOUND (SELF%AERO, 1), UBOUND (SELF%AERO, 1)
    CALL SELF%AERO (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%AERO)
ENDIF

CALL SELF%LRCH4%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LFORC = ALLOCATED (SELF%FORC)
IF (LFORC) THEN
  !$ACC ENTER DATA CREATE (SELF%FORC)
  !$ACC UPDATE DEVICE (SELF%FORC)
  DO J1 = LBOUND (SELF%FORC, 1), UBOUND (SELF%FORC, 1)
    CALL SELF%FORC (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%FORC)
ENDIF

LEZDIAG = ALLOCATED (SELF%EZDIAG)
IF (LEZDIAG) THEN
  !$ACC ENTER DATA CREATE (SELF%EZDIAG)
  !$ACC UPDATE DEVICE (SELF%EZDIAG)
  DO J1 = LBOUND (SELF%EZDIAG, 1), UBOUND (SELF%EZDIAG, 1)
    CALL SELF%EZDIAG (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%EZDIAG)
ENDIF

LERA40 = ALLOCATED (SELF%ERA40)
IF (LERA40) THEN
  !$ACC ENTER DATA CREATE (SELF%ERA40)
  !$ACC UPDATE DEVICE (SELF%ERA40)
  DO J1 = LBOUND (SELF%ERA40, 1), UBOUND (SELF%ERA40, 1)
    CALL SELF%ERA40 (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%ERA40)
ENDIF

LNOGW = ALLOCATED (SELF%NOGW)
IF (LNOGW) THEN
  !$ACC ENTER DATA CREATE (SELF%NOGW)
  !$ACC UPDATE DEVICE (SELF%NOGW)
  DO J1 = LBOUND (SELF%NOGW, 1), UBOUND (SELF%NOGW, 1)
    CALL SELF%NOGW (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%NOGW)
ENDIF

LEMIS3D = ALLOCATED (SELF%EMIS3D)
IF (LEMIS3D) THEN
  !$ACC ENTER DATA CREATE (SELF%EMIS3D)
  !$ACC UPDATE DEVICE (SELF%EMIS3D)
  DO J1 = LBOUND (SELF%EMIS3D, 1), UBOUND (SELF%EMIS3D, 1)
    CALL SELF%EMIS3D (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%EMIS3D)
ENDIF

LEDRP = ALLOCATED (SELF%EDRP)
IF (LEDRP) THEN
  !$ACC ENTER DATA CREATE (SELF%EDRP)
  !$ACC UPDATE DEVICE (SELF%EDRP)
  DO J1 = LBOUND (SELF%EDRP, 1), UBOUND (SELF%EDRP, 1)
    CALL SELF%EDRP (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%EDRP)
ENDIF

LSLDIA = ALLOCATED (SELF%SLDIA)
IF (LSLDIA) THEN
  !$ACC ENTER DATA CREATE (SELF%SLDIA)
  !$ACC UPDATE DEVICE (SELF%SLDIA)
  DO J1 = LBOUND (SELF%SLDIA, 1), UBOUND (SELF%SLDIA, 1)
    CALL SELF%SLDIA (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%SLDIA)
ENDIF

LAERAOT = ALLOCATED (SELF%AERAOT)
IF (LAERAOT) THEN
  !$ACC ENTER DATA CREATE (SELF%AERAOT)
  !$ACC UPDATE DEVICE (SELF%AERAOT)
  DO J1 = LBOUND (SELF%AERAOT, 1), UBOUND (SELF%AERAOT, 1)
    CALL SELF%AERAOT (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%AERAOT)
ENDIF

LAERLISI = ALLOCATED (SELF%AERLISI)
IF (LAERLISI) THEN
  !$ACC ENTER DATA CREATE (SELF%AERLISI)
  !$ACC UPDATE DEVICE (SELF%AERLISI)
  DO J1 = LBOUND (SELF%AERLISI, 1), UBOUND (SELF%AERLISI, 1)
    CALL SELF%AERLISI (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%AERLISI)
ENDIF

LAEROUT = ALLOCATED (SELF%AEROUT)
IF (LAEROUT) THEN
  !$ACC ENTER DATA CREATE (SELF%AEROUT)
  !$ACC UPDATE DEVICE (SELF%AEROUT)
  DO J1 = LBOUND (SELF%AEROUT, 1), UBOUND (SELF%AEROUT, 1)
    CALL SELF%AEROUT (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%AEROUT)
ENDIF

LAEROCLIM = ALLOCATED (SELF%AEROCLIM)
IF (LAEROCLIM) THEN
  !$ACC ENTER DATA CREATE (SELF%AEROCLIM)
  !$ACC UPDATE DEVICE (SELF%AEROCLIM)
  DO J1 = LBOUND (SELF%AEROCLIM, 1), UBOUND (SELF%AEROCLIM, 1)
    CALL SELF%AEROCLIM (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%AEROCLIM)
ENDIF

LUVP = ALLOCATED (SELF%UVP)
IF (LUVP) THEN
  !$ACC ENTER DATA CREATE (SELF%UVP)
  !$ACC UPDATE DEVICE (SELF%UVP)
  DO J1 = LBOUND (SELF%UVP, 1), UBOUND (SELF%UVP, 1)
    CALL SELF%UVP (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%UVP)
ENDIF

CALL SELF%PHYCTY%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%RSPEC%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%SDSAT%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%CVV%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%RKTH%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%RKTQV%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%RKTQC%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%UOM%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%UAL%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%DOM%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%DAL%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%UEN%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL SELF%UNEBH%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LLIMA = ALLOCATED (SELF%LIMA)
IF (LLIMA) THEN
  !$ACC ENTER DATA CREATE (SELF%LIMA)
  !$ACC UPDATE DEVICE (SELF%LIMA)
  DO J1 = LBOUND (SELF%LIMA, 1), UBOUND (SELF%LIMA, 1)
    CALL SELF%LIMA (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%LIMA)
ENDIF

CALL SELF%FSD%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LEXT = ALLOCATED (SELF%EXT)
IF (LEXT) THEN
  !$ACC ENTER DATA CREATE (SELF%EXT)
  !$ACC UPDATE DEVICE (SELF%EXT)
  DO J1 = LBOUND (SELF%EXT, 1), UBOUND (SELF%EXT, 1)
    CALL SELF%EXT (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%EXT)
ENDIF

LGFL = ALLOCATED (SELF%GFL)
IF (LGFL) THEN
  !$ACC ENTER DATA CREATE (SELF%GFL)
  !$ACC UPDATE DEVICE (SELF%GFL)
  DO J1 = LBOUND (SELF%GFL, 1), UBOUND (SELF%GFL, 1)
    CALL SELF%GFL (J1)%COPY (LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  ENDDO
  !$ACC ENTER DATA ATTACH (SELF%GFL)
ENDIF

END SUBROUTINE

END SUBMODULE
