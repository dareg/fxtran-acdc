SUBMODULE (TYPE_GEOMETRY) TYPE_GEOMETRY_GEOMETRY_LOAD_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE LOAD_GEOMETRY (SELF, KLUN)

IMPLICIT NONE
CLASS (GEOMETRY), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LYRELBC_GEO
READ (KLUN) SELF%LNHX_GEOM
CALL SELF%YRVERT_GEOM%LOAD (KLUN)
CALL SELF%YRSTA%LOAD (KLUN)
CALL SELF%YRLAP%LOAD (KLUN)
CALL SELF%YRCSGLEG%LOAD (KLUN)
CALL SELF%YRDIM%LOAD (KLUN)
CALL SELF%YRDIMV%LOAD (KLUN)
CALL SELF%YRMP%LOAD (KLUN)
CALL SELF%YRGEM%LOAD (KLUN)
NULLIFY (SELF%YRCSGEOM)
NULLIFY (SELF%YRGSGEOM)
READ (KLUN) SELF%AD_GEOM
NULLIFY (SELF%YRCSGEOMAD)
NULLIFY (SELF%YRGSGEOMAD)
CALL SELF%YROROG_B%LOAD (KLUN)
CALL SELF%YSPGEOM%LOAD (KLUN)
CALL SELF%YVABIO%LOAD (KLUN)
CALL SELF%YREDIM%LOAD (KLUN)
CALL SELF%YREGEO%LOAD (KLUN)
CALL SELF%YREMP%LOAD (KLUN)
CALL SELF%YRELAP%LOAD (KLUN)
CALL SELF%YREGSL%LOAD (KLUN)
READ (KLUN) LYRELBC_GEO
IF (LYRELBC_GEO) THEN
  ALLOCATE (SELF%YRELBC_GEO)
  CALL SELF%YRELBC_GEO%LOAD (KLUN)
ELSE
  NULLIFY (SELF%YRELBC_GEO)
ENDIF
END SUBROUTINE


END SUBMODULE
