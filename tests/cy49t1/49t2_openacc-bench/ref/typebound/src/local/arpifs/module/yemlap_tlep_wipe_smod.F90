SUBMODULE (YEMLAP) YEMLAP_TLEP_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_TLEP (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TLEP), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LMVALUE, LNCPL2M, LNCPL2N, LNCPL4M, LNCPL4N, LNCPLM, LNCPLN, LNESM0, LNESM0G, LNESPZERO
LOGICAL :: LNPME, LNPNE, LRLEPDIM, LRLEPDIN, LRLEPINM, LRLEPINN

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LNCPL2M = ALLOCATED (SELF%NCPL2M)
IF (LNCPL2M) THEN
  !$ACC EXIT DATA DETACH (SELF%NCPL2M)
  !$ACC EXIT DATA DETACH (SELF%NCPL2M)
ENDIF

LNCPL4M = ALLOCATED (SELF%NCPL4M)
IF (LNCPL4M) THEN
  !$ACC EXIT DATA DETACH (SELF%NCPL4M)
  !$ACC EXIT DATA DETACH (SELF%NCPL4M)
ENDIF

LNCPLM = ALLOCATED (SELF%NCPLM)
IF (LNCPLM) THEN
  !$ACC EXIT DATA DETACH (SELF%NCPLM)
  !$ACC EXIT DATA DETACH (SELF%NCPLM)
ENDIF

LNCPL2N = ALLOCATED (SELF%NCPL2N)
IF (LNCPL2N) THEN
  !$ACC EXIT DATA DETACH (SELF%NCPL2N)
  !$ACC EXIT DATA DETACH (SELF%NCPL2N)
ENDIF

LNCPL4N = ALLOCATED (SELF%NCPL4N)
IF (LNCPL4N) THEN
  !$ACC EXIT DATA DETACH (SELF%NCPL4N)
  !$ACC EXIT DATA DETACH (SELF%NCPL4N)
ENDIF

LNCPLN = ALLOCATED (SELF%NCPLN)
IF (LNCPLN) THEN
  !$ACC EXIT DATA DETACH (SELF%NCPLN)
  !$ACC EXIT DATA DETACH (SELF%NCPLN)
ENDIF

LRLEPDIN = ALLOCATED (SELF%RLEPDIN)
IF (LRLEPDIN) THEN
  !$ACC EXIT DATA DETACH (SELF%RLEPDIN)
  !$ACC EXIT DATA DETACH (SELF%RLEPDIN)
ENDIF

LRLEPINN = ALLOCATED (SELF%RLEPINN)
IF (LRLEPINN) THEN
  !$ACC EXIT DATA DETACH (SELF%RLEPINN)
  !$ACC EXIT DATA DETACH (SELF%RLEPINN)
ENDIF

LRLEPDIM = ALLOCATED (SELF%RLEPDIM)
IF (LRLEPDIM) THEN
  !$ACC EXIT DATA DETACH (SELF%RLEPDIM)
  !$ACC EXIT DATA DETACH (SELF%RLEPDIM)
ENDIF

LRLEPINM = ALLOCATED (SELF%RLEPINM)
IF (LRLEPINM) THEN
  !$ACC EXIT DATA DETACH (SELF%RLEPINM)
  !$ACC EXIT DATA DETACH (SELF%RLEPINM)
ENDIF

LNESM0 = ALLOCATED (SELF%NESM0)
IF (LNESM0) THEN
  !$ACC EXIT DATA DETACH (SELF%NESM0)
  !$ACC EXIT DATA DETACH (SELF%NESM0)
ENDIF

LNESPZERO = ALLOCATED (SELF%NESPZERO)
IF (LNESPZERO) THEN
  !$ACC EXIT DATA DETACH (SELF%NESPZERO)
  !$ACC EXIT DATA DETACH (SELF%NESPZERO)
ENDIF

LNESM0G = ALLOCATED (SELF%NESM0G)
IF (LNESM0G) THEN
  !$ACC EXIT DATA DETACH (SELF%NESM0G)
  !$ACC EXIT DATA DETACH (SELF%NESM0G)
ENDIF

LNPME = ALLOCATED (SELF%NPME)
IF (LNPME) THEN
  !$ACC EXIT DATA DETACH (SELF%NPME)
  !$ACC EXIT DATA DETACH (SELF%NPME)
ENDIF

LNPNE = ALLOCATED (SELF%NPNE)
IF (LNPNE) THEN
  !$ACC EXIT DATA DETACH (SELF%NPNE)
  !$ACC EXIT DATA DETACH (SELF%NPNE)
ENDIF

LMVALUE = ALLOCATED (SELF%MVALUE)
IF (LMVALUE) THEN
  !$ACC EXIT DATA DETACH (SELF%MVALUE)
  !$ACC EXIT DATA DETACH (SELF%MVALUE)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
