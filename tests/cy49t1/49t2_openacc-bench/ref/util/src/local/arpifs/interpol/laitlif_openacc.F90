SUBROUTINE LAITLIF_OPENACC (YDTLSCAW, KASLB1, KPROMA, KFLEV, KST, KPROF&
&, KL0, LDCOMAD, PLSCAW, PXSL, POUT, LDADD, LD2D, YDSTACK)
!$ACC ROUTINE (LAITLIF_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB

USE INTDYNSL_MOD,ONLY:TLSCAW
#include "stack.h"
USE STACK_MOD
USE ABOR1_ACC_MOD


TYPE (TLSCAW), INTENT (IN)::YDTLSCAW
INTEGER (KIND=JPIM), INTENT (IN)::KPROF
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KFLEV
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KASLB1
INTEGER (KIND=JPIM), INTENT (IN)::KL0 (KPROMA, KFLEV, 0:3)
LOGICAL, INTENT (IN)::LDCOMAD
LOGICAL, OPTIONAL, INTENT (IN)::LD2D
TYPE(STACK), INTENT (IN) :: YDSTACK
TYPE(STACK) :: YLSTACK
LOGICAL, OPTIONAL, INTENT (IN)::LDADD
REAL (KIND=JPRB), INTENT (IN)::PLSCAW (KPROMA, KFLEV, YDTLSCAW%NDIM)
REAL (KIND=JPRB), INTENT (IN)::PXSL (KASLB1, KFLEV+2)
REAL (KIND=JPRB), INTENT (OUT)::POUT (KPROMA, KFLEV)
INTEGER (KIND=JPIM)::IFLDX
INTEGER (KIND=JPIM)::IFLDN
temp (INTEGER (KIND=JPIM), ILO, (KPROMA, 2))
LOGICAL::LL2D
temp (REAL (KIND=JPRB), ZDLO, (KPROMA, 2))

#include "laitli_openacc.intfb.h"
INTEGER (KIND=JPIM) :: JROF

YLSTACK = YDSTACK



IF (KIND (ILO) == 8) THEN
    alloc8 (ILO)
ELSEIF (KIND (ILO) == 4) THEN
    alloc4 (ILO)
ELSE
    STOP 1
ENDIF


IF (KIND (ZDLO) == 8) THEN
    alloc8 (ZDLO)
ELSEIF (KIND (ZDLO) == 4) THEN
    alloc4 (ZDLO)
ELSE
    STOP 1
ENDIF


JROF = KST


LL2D=.FALSE.

IF (PRESENT (LD2D))  THEN
  LL2D=LD2D
ENDIF

IFLDN=1
IFLDX=KFLEV+2

IF (LL2D) THEN
  ILO (JROF,:)=KL0 (JROF, KFLEV, 1:2)

  IF (LDCOMAD) THEN
    ZDLO (JROF,:)=PLSCAW (JROF, KFLEV, YDTLSCAW%M_WDLOMAD+1:YDTLSCAW%M_WDLOMAD+2)
    CALL LAITLI_OPENACC (KASLB1, KPROMA, KST, KPROF, 1, IFLDN, IFLDX, PLSCAW (:, KFLEV, YDTLSCAW%M_WDLAMAD&
    &), ZDLO, ILO, PLSCAW (:, KFLEV, YDTLSCAW%M_WDVERMAD), PXSL, POUT, LDADD, YDSTACK=YLSTACK)
  ELSE
    ZDLO (JROF,:)=PLSCAW (JROF, KFLEV, YDTLSCAW%M_WDLO+1:YDTLSCAW%M_WDLO+2)
    CALL LAITLI_OPENACC (KASLB1, KPROMA, KST, KPROF, 1, IFLDN, IFLDX, PLSCAW (:, KFLEV, YDTLSCAW%M_WDLAT&
    &), ZDLO, ILO, PLSCAW (:, KFLEV, YDTLSCAW%M_WDVER), PXSL, POUT, LDADD, YDSTACK=YLSTACK)
  ENDIF

ELSE

  IF (LDCOMAD) THEN
    CALL LAITLI_OPENACC (KASLB1, KPROMA, KST, KPROF, KFLEV, IFLDN, IFLDX, PLSCAW &
    &(:,:, YDTLSCAW%M_WDLAMAD), PLSCAW (:,:, YDTLSCAW%M_WDLOMAD+1), KL0 (:,:, 1:2&
    &), PLSCAW (:,:, YDTLSCAW%M_WDVERMAD), PXSL, POUT, LDADD, YDSTACK=YLSTACK)
  ELSE
    CALL LAITLI_OPENACC (KASLB1, KPROMA, KST, KPROF, KFLEV, IFLDN, IFLDX, PLSCAW&
    & (:,:, YDTLSCAW%M_WDLAT), PLSCAW (:,:, YDTLSCAW%M_WDLO+1), KL0 (:,:, 1:2)&
    &, PLSCAW (:,:, YDTLSCAW%M_WDVER), PXSL, POUT, LDADD, YDSTACK=YLSTACK)
  ENDIF

ENDIF



ENDSUBROUTINE LAITLIF_OPENACC
