SUBROUTINE VERINTS_OPENACC (KPROMA, KST, KEND, KLEVIN, KLEVOUT, PINTE, PIN, POUTS, YDSTACK)
!$ACC ROUTINE (VERINTS_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB, JPRD

#include "stack.h"
USE STACK_MOD
USE ABOR1_ACC_MOD

IMPLICIT NONE


INTEGER (KIND=JPIM), INTENT (IN)::KEND
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KLEVOUT
INTEGER (KIND=JPIM), INTENT (IN)::KLEVIN
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
REAL (KIND=JPRD), INTENT (IN)::PINTE (KLEVOUT, KLEVIN)
REAL (KIND=JPRB), INTENT (IN), TARGET::PIN (KPROMA, KLEVIN)
REAL (KIND=JPRD), INTENT (OUT)::POUTS (KPROMA)
TYPE(STACK), INTENT (IN) :: YDSTACK
TYPE(STACK) :: YLSTACK
LOGICAL, PARAMETER::LLDOUBLE=JPRB==JPRD
LOGICAL, SAVE::LLSIMPLE_DGEMM=.FALSE.
LOGICAL, PARAMETER::LLVERINT_ON_CPU=.TRUE.
CHARACTER (LEN=8), SAVE::CLENV=''
temp (REAL (KIND=JPRD), ZIN, (KPROMA, KLEVIN))
temp (REAL (KIND=JPRD), ZIN0, (KPROMA, MERGE (KLEVIN, 0,.NOT.LLDOUBLE)))
INTEGER (KIND=JPIM)::JLEVIN
INTEGER (KIND=JPIM)::JROF


YLSTACK = YDSTACK



IF (KIND (ZIN0) == 8) THEN
    alloc8 (ZIN0)
ELSEIF (KIND (ZIN0) == 4) THEN
    alloc4 (ZIN0)
ELSE
    STOP 1
ENDIF


JROF = KST




IF (LLDOUBLE) THEN
#ifndef PARKIND1_SINGLE
  assoc (ZIN, PIN)
#endif
ELSE
  assoc (ZIN, ZIN0)
  ZIN (JROF,:)=REAL (PIN (JROF,:), JPRD)
ENDIF



POUTS (JROF)=0._JPRD


DO JLEVIN=1, KLEVIN
  
  POUTS (JROF)=POUTS (JROF)+ZIN (JROF, JLEVIN)*PINTE (KLEVOUT, JLEVIN)
  
ENDDO



ENDSUBROUTINE VERINTS_OPENACC
