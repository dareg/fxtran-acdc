#!/usr/bin/env perl

use warnings;

use Data::Dumper;

use strict;

my $bin = shift;

my @s;

for my $line (split (m/\n/o, `objdump -h $bin`))
  {
    if ($line =~ m/^\s*\d+\s*(\S+)/o)
      {
        push @s, $1;
      }
  }

for my $s (@s)
  {
    if ($s =~ m/^\.fxtran\.acdc\.parallelmethod\.(\w+)$/o)
      {
        my $method = $1;
        my @cmd = ('objcopy', '--dump-section',  "$s=fxtran.acdc.parallelmethod.$method.txt", $bin);
        system (@cmd)
          and die ("Command `@cmd' failed\n");
      }
  }



